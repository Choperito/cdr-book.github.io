<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Capítulo 11 Análisis exploratorio de datos | Fundamentos de ciencia de datos con R</title>
<meta name="author" content="Gema Fernández-Avilés y José-María Montero">
<meta name="description" content="Emilio L. Cano Universidad Rey Juan Carlos  11.1 Introducción  El análisis exploratorio de datos (AED), y en particular su visualización, es el primer análisis que se debe hacer sobre cualquier...">
<meta name="generator" content="bookdown 0.37 with bs4_book()">
<meta property="og:title" content="Capítulo 11 Análisis exploratorio de datos | Fundamentos de ciencia de datos con R">
<meta property="og:type" content="book">
<meta property="og:image" content="/img/cover.png">
<meta property="og:description" content="Emilio L. Cano Universidad Rey Juan Carlos  11.1 Introducción  El análisis exploratorio de datos (AED), y en particular su visualización, es el primer análisis que se debe hacer sobre cualquier...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Capítulo 11 Análisis exploratorio de datos | Fundamentos de ciencia de datos con R">
<meta name="twitter:description" content="Emilio L. Cano Universidad Rey Juan Carlos  11.1 Introducción  El análisis exploratorio de datos (AED), y en particular su visualización, es el primer análisis que se debe hacer sobre cualquier...">
<meta name="twitter:image" content="/img/cover.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.6.1/transition.js"></script><script src="libs/bs3compat-0.6.1/tabs.js"></script><script src="libs/bs3compat-0.6.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><link href="libs/tabwid-1.1.3/tabwid.css" rel="stylesheet">
<script src="libs/tabwid-1.1.3/tabwid.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="bs4_style.css">
<link rel="stylesheet" href="bs4_book.css">
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Fundamentos de ciencia de datos con <strong>R</strong></a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Buscar" aria-label="Buscar">
</form>

      <nav aria-label="Contenido"><h2>Contenido</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Prefacio</a></li>
<li><a class="" href="pr%C3%B3logo-by-julia-silge.html">Prólogo (by Julia Silge)</a></li>
<li><a class="" href="pr%C3%B3logo-por-yanina-bellini.html">Prólogo (por Yanina Bellini)</a></li>
<li class="book-part">Ciencia, datos, software… y científicos</li>
<li><a class="" href="ciencia-datos.html"><span class="header-section-number">1</span> ¿Es la ciencia de datos una ciencia?</a></li>
<li><a class="" href="metodologia.html"><span class="header-section-number">2</span> Metodología en ciencia de datos</a></li>
<li><a class="" href="ch-110003.html"><span class="header-section-number">3</span> R para ciencia de datos</a></li>
<li><a class="" href="cap-etica.html"><span class="header-section-number">4</span> Ética en la ciencia de datos</a></li>
<li class="book-part">Bienvenidos a la jungla de datos</li>
<li><a class="" href="datos-sql.html"><span class="header-section-number">5</span> Gestión de bases de datos relacionales</a></li>
<li><a class="" href="cap-nosql.html"><span class="header-section-number">6</span> Gestión de bases de datos NoSQL</a></li>
<li><a class="" href="DGDQM.html"><span class="header-section-number">7</span> Gobierno, gestión y calidad del dato</a></li>
<li><a class="" href="cap-130009.html"><span class="header-section-number">8</span> Integración y limpieza de datos</a></li>
<li><a class="" href="chap-feature.html"><span class="header-section-number">9</span> Selección y transformación de variables</a></li>
<li><a class="" href="chap-herramientas.html"><span class="header-section-number">10</span> Herramientas para el análisis en ciencia de datos</a></li>
<li><a class="active" href="cap-120006-aed.html"><span class="header-section-number">11</span> Análisis exploratorio de datos</a></li>
<li class="book-part">Fundamentos de estadística</li>
<li><a class="" href="Funda-probab.html"><span class="header-section-number">12</span> Probabilidad</a></li>
<li><a class="" href="Fundainfer.html"><span class="header-section-number">13</span> Inferencia estadística</a></li>
<li><a class="" href="muestreo.html"><span class="header-section-number">14</span> Muestreo y remuestreo</a></li>
<li class="book-part">Modelización estadística</li>
<li><a class="" href="cap-lm.html"><span class="header-section-number">15</span> Modelización lineal</a></li>
<li><a class="" href="cap-glm.html"><span class="header-section-number">16</span> Modelos lineales generalizados</a></li>
<li><a class="" href="cap-gam.html"><span class="header-section-number">17</span> Modelos aditivos generalizados</a></li>
<li><a class="" href="cap-mxm.html"><span class="header-section-number">18</span> Modelos mixtos</a></li>
<li><a class="" href="cap-sparse.html"><span class="header-section-number">19</span> Modelos \(\textit{sparse}\) y métodos penalizados de regresión</a></li>
<li><a class="" href="cap-series-temp.html"><span class="header-section-number">20</span> Modelización de series temporales</a></li>
<li><a class="" href="cap-discriminante.html"><span class="header-section-number">21</span> Análisis discriminante</a></li>
<li><a class="" href="cap-conjunto.html"><span class="header-section-number">22</span> Análisis conjunto</a></li>
<li><a class="" href="tablas-contingencia.html"><span class="header-section-number">23</span> Análisis de tablas de contingencia</a></li>
<li class="book-part">Machine learning supervisado</li>
<li><a class="" href="cap-arboles.html"><span class="header-section-number">24</span> Árboles de clasificación y regresión</a></li>
<li><a class="" href="cap-svm.html"><span class="header-section-number">25</span> Máquinas de vector soporte</a></li>
<li><a class="" href="cap-knn.html"><span class="header-section-number">26</span> Clasificador \(k\)-vecinos más próximos</a></li>
<li><a class="" href="cap-naive-bayes.html"><span class="header-section-number">27</span> Naive Bayes</a></li>
<li><a class="" href="cap-bagg-rf.html"><span class="header-section-number">28</span> Métodos ensamblados: \(\bf \textit {bagging}\) y \(\bf \textit{random}\) \(\bf \textit{forest}\)</a></li>
<li><a class="" href="cap-boosting-xgboost.html"><span class="header-section-number">29</span> \(\bf \textit{Boosting}\) y el algoritmo XGBoost</a></li>
<li class="book-part">Machine learning no supervisado</li>
<li><a class="" href="cap-cluster.html"><span class="header-section-number">30</span> Análisis clúster: clusterización jerárquica</a></li>
<li><a class="" href="no-jerarquico.html"><span class="header-section-number">31</span> Análisis clúster: clusterización no jerárquica</a></li>
<li><a class="" href="acp.html"><span class="header-section-number">32</span> Análisis de componentes principales</a></li>
<li><a class="" href="af.html"><span class="header-section-number">33</span> Análisis factorial</a></li>
<li><a class="" href="mds.html"><span class="header-section-number">34</span> Escalamiento multidimensional</a></li>
<li><a class="" href="correspondencias.html"><span class="header-section-number">35</span> Análisis de correspondencias</a></li>
<li class="book-part">Deep learning</li>
<li><a class="" href="capNN.html"><span class="header-section-number">36</span> Redes neuronales artificiales</a></li>
<li><a class="" href="cap-redes-convol.html"><span class="header-section-number">37</span> Redes neuronales convolucionales</a></li>
<li class="book-part">Ciencia de datos de texto y redes</li>
<li><a class="" href="mineria-textos.html"><span class="header-section-number">38</span> Minería de textos</a></li>
<li><a class="" href="grafos.html"><span class="header-section-number">39</span> Análisis de grafos y redes sociales</a></li>
<li class="book-part">Ciencia de datos espaciales</li>
<li><a class="" href="datos-espaciales.html"><span class="header-section-number">40</span> Trabajando con datos espaciales</a></li>
<li><a class="" href="geo.html"><span class="header-section-number">41</span> Geoestadística</a></li>
<li><a class="" href="cap-econom-esp.html"><span class="header-section-number">42</span> Modelos econométricos espaciales</a></li>
<li><a class="" href="cap-pp.html"><span class="header-section-number">43</span> Procesos de puntos</a></li>
<li class="book-part">Comunica y colabora</li>
<li><a class="" href="cap-120007-informes.html"><span class="header-section-number">44</span> Informes reproducibles con R Markdown y Quarto</a></li>
<li><a class="" href="shiny.html"><span class="header-section-number">45</span> Creación de aplicaciones web interactivas con Shiny</a></li>
<li><a class="" href="github.html"><span class="header-section-number">46</span> Git y GitHub R</a></li>
<li><a class="" href="geoproces.html"><span class="header-section-number">47</span> Geoprocesamiento en nube</a></li>
<li class="book-part">Casos de estudio en ciencia de datos</li>
<li><a class="" href="cap-crimen.html"><span class="header-section-number">48</span> Análisis de una red criminal</a></li>
<li><a class="" href="cap-publicidad.html"><span class="header-section-number">49</span> Optimización de inversiones publicitarias</a></li>
<li><a class="" href="cap-twitter.html"><span class="header-section-number">50</span> ¿Cómo tuitea Elon Musk?</a></li>
<li><a class="" href="cap-periodismo.html"><span class="header-section-number">51</span> Análisis electoral: de RStudio a su periódico favorito</a></li>
<li><a class="" href="paro-clm.html"><span class="header-section-number">52</span> El impacto de las crisis financiera y de la COVID-19 en el paro de CLM</a></li>
<li><a class="" href="cap-rfm.html"><span class="header-section-number">53</span> Segmentación de clientes en el comercio minorista</a></li>
<li><a class="" href="cap-medicina.html"><span class="header-section-number">54</span> Análisis de datos en medicina</a></li>
<li><a class="" href="cap-futbol.html"><span class="header-section-number">55</span> Messi y Ronaldo: dos ídolos desde la perspectiva de los datos</a></li>
<li><a class="" href="cambioclimatico.html"><span class="header-section-number">56</span> Una nota sobre el cambio climático</a></li>
<li><a class="" href="cap-sist-exp.html"><span class="header-section-number">57</span> Implementación de un sistema experto en el ámbito pediátrico</a></li>
<li><a class="" href="cap-ree.html"><span class="header-section-number">58</span> Predicción de consumo eléctrico con redes neuronales artificiales</a></li>
<li><a class="" href="nlp-textil.html"><span class="header-section-number">59</span> El procesamiento del lenguaje natural para tendencias de moda en textil</a></li>
<li><a class="" href="cap-fraude.html"><span class="header-section-number">60</span> Detección de fraude de tarjetas de crédito</a></li>
<li class="book-part">Appendix</li>
<li><a class="" href="info-session.html"><span class="header-section-number">A</span> Información de la sesión</a></li>
<li><a class="" href="referencias.html">Referencias</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="cap-120006-aed" class="section level1" number="11">
<h1>
<span class="header-section-number">Capítulo 11</span> Análisis exploratorio de datos<a class="anchor" aria-label="anchor" href="#cap-120006-aed"><i class="fas fa-link"></i></a>
</h1>
<p><em>Emilio L. Cano</em></p>
<p>Universidad Rey Juan Carlos</p>
<div id="introducción-6" class="section level2" number="11.1">
<h2>
<span class="header-section-number">11.1</span> Introducción<a class="anchor" aria-label="anchor" href="#introducci%C3%B3n-6"><i class="fas fa-link"></i></a>
</h2>
<p>
</p>
<p>El análisis exploratorio de datos (AED), y en particular su visualización,
es el primer análisis que se debe hacer sobre cualquier conjunto de datos.
El AED se realiza mediante dos herramientas: los resúmenes numéricos
y las visualizaciones gráficas.
La “historia” que nos esté contando el gráfico de los datos nos guiará
hacia las técnicas de aprendizaje estadístico más adecuadas. Incluso,
en muchas ocasiones será suficiente el AED para tomar
una decisión sobre el problema en estudio.</p>
<div id="el-cuarteto-de-anscombe" class="section level3" number="11.1.1">
<h3>
<span class="header-section-number">11.1.1</span> El cuarteto de Anscombe<a class="anchor" aria-label="anchor" href="#el-cuarteto-de-anscombe"><i class="fas fa-link"></i></a>
</h3>
<p></p>
<p>Un ejemplo clásico de la importancia del <strong>AED</strong> y, concretamente, de las representaciones gráficas es el “cuarteto de Anscombe” <span class="citation">(<a href="referencias.html#ref-Anscombe1973">Anscombe 1973</a>)</span>,
el cual está compuesto por 11 filas de 8 variables numéricas que conforman 4 conjuntos de datos (disponibles en el objeto <code>anscombe</code>), con los mismos resúmenes estadísticos pero con propiedades muy distintas, lo que se ve fácilmente cuando se representan en forma gráfica. Si se calculan, por ejemplo, la media y la desviación típica de cada variable, se observa que son prácticamente iguales. Incluso los coeficientes de correlación de cada <span class="math inline">\(X\)</span> con su <span class="math inline">\(Y\)</span> son también prácticamente idénticos.</p>
<div class="sourceCode" id="cb133"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://dplyr.tidyverse.org">"dplyr"</a></span><span class="op">)</span></span>
<span><span class="va">anscombe</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span>.fns <span class="op">=</span> <span class="va">mean</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;  x1 x2 x3 x4       y1     y2     y3     y4</span></span>
<span><span class="co">#&gt;  9  9  9  9    7.5009  7.5009  7.5   7.5009</span></span>
<span><span class="va">anscombe</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span>.fns <span class="op">=</span> <span class="va">sd</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;    x1    x2       x3       x4     y1      y2    y3      y4</span></span>
<span><span class="co">#&gt; 3.316  3.316   3.316   3.316   2.031   2.031   2.030   2.030</span></span></code></pre></div>
<p>Sin embargo, la Fig. <a href="cap-120006-aed.html#fig:ch-120006-anscombeuni">11.1</a> muestra que, a pesar de tener medias y desviaciones típicas prácticamente iguales, los datos son muy diferentes.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:ch-120006-anscombeuni"></span>
<img src="120006_Analisis_exp_files/figure-html/ch-120006-anscombeuni-1.png" alt="Representación de las variables del cuarteto de Anscombe." width="60%"><p class="caption">
Figura 11.1: Representación de las variables del cuarteto de Anscombe.
</p>
</div>
<p>Si en el análisis por separado ya se ve la necesidad de hacer un gráfico,
esta es más evidente cuando se analizan las variables conjuntamente. La
Fig. <a href="cap-120006-aed.html#fig:ch-120006-anscombelm">11.2</a> muestra los cuatro gráficos que constituyen
“el cuarteto de Anscombe” y que se puede obtener de la propia ayuda del
conjunto de datos (<code>example(anscombe)</code>). La línea de regresión que se ajusta
es prácticamente la misma, y los coeficientes de correlación entre las variables <em>X</em> e <em>Y</em> de los cuatro gráficos, idénticos: 0,8163.
Es evidente que la relación entre las variables es muy distinta en cada uno
de los casos, y si no se visualizan los datos para elegir el mejor modelo
de regresión y después interpretarlo, se pueden tomar decisiones
erróneas. El cuarteto de Anscombe es muy ilustrativo, al igual que <em>The Datasaurus Dozen</em> <span class="citation">(<a href="referencias.html#ref-Matejka2017">Matejka and Fitzmaurice 2017</a>)</span> en <a href="https://www.autodeskresearch.com/publications/samestats" class="uri">https://www.autodeskresearch.com/publications/samestats</a>.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:ch-120006-anscombelm"></span>
<img src="120006_Analisis_exp_files/figure-html/ch-120006-anscombelm-1.png" alt="Los cuatro gráficos que constituyen el cuarteto de Anscombe junto con un ajuste lineal." width="60%"><p class="caption">
Figura 11.2: Los cuatro gráficos que constituyen el cuarteto de Anscombe junto con un ajuste lineal.
</p>
</div>
</div>
<div id="conceptos-generales" class="section level3" number="11.1.2">
<h3>
<span class="header-section-number">11.1.2</span> Conceptos generales<a class="anchor" aria-label="anchor" href="#conceptos-generales"><i class="fas fa-link"></i></a>
</h3>
<p>
</p>
<p>Muy brevemente, se presenta una serie de conceptos esenciales para la mejor
comprensión de este manual.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;Para un análisis extenso de los conceptos aquí expuestos puede consultarse, por ejemplo, &lt;span class="citation"&gt;José María Montero (&lt;a href="referencias.html#ref-lorenzo2007estadistica"&gt;2007&lt;/a&gt;)&lt;/span&gt;.&lt;/p&gt;'><sup>90</sup></a> Los datos que se analizan
provienen de una determinada <strong>población</strong>, y no son más que
una <strong>muestra</strong>, es decir, un subconjunto de toda la población.
La <strong>Estadística Descriptiva</strong> se ocupa del AED en sentido amplio, que se aplica
sobre los datos concretos de la muestra. La
<strong>Inferencia Estadística</strong> (véase Cap. <a href="Fundainfer.html#Fundainfer">13</a>) hace referencia a los métodos mediante los cuales, a través de los datos muestrales, se toman decisiones, se analizan relaciones o se hacen predicciones sobre la población. Para ello, se hace uso de la <strong>Probabilidad</strong> aplicando el modelo adecuado (véase Cap. <a href="Funda-probab.html#Funda-probab">12</a>). Además, es muy importante considerar el método de obtención de la muestra (véase Cap. <a href="muestreo.html#muestreo">14</a>) que, en términos generales, debe ser representativa de la población para que las conclusiones sean válidas.
La Fig. <a href="cap-120006-aed.html#fig:ch-120006-dogma1">11.3</a> representa la esencia de la Estadística y sus métodos.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:ch-120006-dogma1"></span>
<img src="img/dogma1.png" alt="La esencia de los métodos estadísticos." width="60%"><p class="caption">
Figura 11.3: La esencia de los métodos estadísticos.
</p>
</div>
<p>Las características a observar en los elementos de una población pueden dar lugar a diferentes tipos de datos o variables. El análisis a realizar dependerá del tipo de variable, que puede ser:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Cuantitativa</strong> (se puede medir o contar). Se denomina <strong>variable cuantitativa</strong> a cualquier característica observable que pueda expresarse en valores numéricos. Se clasifican como <strong>variables discretas</strong> (se puede <em>contar</em> el número de valores que toma) y <strong>continuas</strong> (pueden tomar cualquier valor en un intervalo dado). </p></li>
<li><p><strong>Cualitativa</strong> (no se puede expresar como un número). Se denomina <strong>variable cualitativa, atributo o factor</strong> a cualquier característica observable que indica una <em>cualidad</em> o <em>atributo</em>. Estas pueden tener varios niveles (politómicas) o solo dos (dicotómicas). Si en una variable categórica se pueden <em>ordenar</em> las categorías, entonces se denomina <strong>variables ordinales</strong>.
</p></li>
</ol>
</div>
<div id="componentes-de-un-gráfico-y-su-representación-en-r" class="section level3" number="11.1.3">
<h3>
<span class="header-section-number">11.1.3</span> Componentes de un gráfico y su representación en <strong>R</strong><a class="anchor" aria-label="anchor" href="#componentes-de-un-gr%C3%A1fico-y-su-representaci%C3%B3n-en-r"><i class="fas fa-link"></i></a>
</h3>
<p></p>
<p>De los diferentes sistemas que tiene <strong>R</strong> para representar gráficos <span class="citation">(los “base,” paquete <code>graphics</code>, y los “grid,” paquete <code>lattice</code> <a href="referencias.html#ref-lattice">Sarkar 2008</a>)</span>,
este capítulo se centra en el paquete <code>ggplot2</code> <span class="citation">(<a href="referencias.html#ref-Wickham2016">Hadley Wickham 2016a</a>)</span>, que forma parte del <em>tidyverse</em>, por su amplio uso y popularidad.</p>
<p>El flujo de trabajo con <code>ggplot2</code> se puede resumir en los siguientes pasos:</p>
<ol style="list-style-type: decimal">
<li><p>Proporcionar una <strong>tabla de datos</strong> a la función <code>ggplot</code>. Es el primer argumento (<code>data</code>) y
se puede utilizar el operador <em>pipe</em>.</p></li>
<li><p>Proporcionar las <strong>columnas</strong> de la tabla de datos que serán representadas en el gráfico.
Este será el segundo argumento (<code>mapping</code>) de la función <code>ggplot</code>, y se
especifica con la función <code>aes</code> (<em>aesthetics</em>)
como una lista de pares <em>aesthetic = variable</em>, de forma que el elemento especificado
como <em>aesthetic</em> será “mapeado” a los valores de la variable. Esta especificación
se puede hacer también en las funciones que añaden capas, que se explican a continuación.
Los <em>aesthetics</em> más comunes (para muchos tipos de gráficos obligatorios) son <code>x</code> e <code>y</code>,
es decir, las columnas que se usarán para el eje horizontal y el eje vertical respectivamente.
Además, se pueden especificar columnas para el color, el tamaño, el símbolo de los puntos,
el tipo de línea, el texto, y otros específicos del tipo de gráfico. Los <em>aesthetics</em> se
pueden especificar también de forma “fija” (sin depender de ninguna variable) fuera de
la función <code>aes</code>.</p></li>
<li><p>Añadir las <strong>capas</strong> del gráfico con los <em>geoms</em>, es decir, los objetos geométricos que representan a cada variable. Esto se indica con el operador <code>+</code>, como si se “sumasen” componentes al gráfico mediante funciones <code>geom_xxx</code>.</p></li>
<li><p>Añadir otras capas al gráfico: por ejemplo, una capa de etiquetas del gráfico
(función <code>labs</code>); de ejes, para modificar los ejes y leyendas creados por defecto
(funciones <code>scale_*_xxx</code>); de estadísticos, para crear nuevas variables a representar basadas en los datos (funciones <code>stat_xxx</code>).</p></li>
<li><p>Añadir un tema al gráfico: por ejemplo, en blanco y negro, o con especificaciones
concretas, como el posicionamiento de la leyenda.</p></li>
<li><p>Añadir “facetas” (<em>facets</em>). De esta forma se divide el gráfico en varios subgráficos
basándose en los valores de una o más variables discretas (normalmente categóricas).</p></li>
</ol>
<p>En las secciones que siguen se verán ejemplos de todo el proceso. El siguiente es un ejemplo de una expresión que contiene los elementos anteriores. Se anima al lector a que los identifique con dicha lista:</p>
<div class="sourceCode" id="cb134"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">variable</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Título"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">factor</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div id="sec-120006-aeduni" class="section level2" number="11.2">
<h2>
<span class="header-section-number">11.2</span> Análisis exploratorio de una variable<a class="anchor" aria-label="anchor" href="#sec-120006-aeduni"><i class="fas fa-link"></i></a>
</h2>
<div id="variables-cualitativas" class="section level3" number="11.2.1">
<h3>
<span class="header-section-number">11.2.1</span> Variables cualitativas<a class="anchor" aria-label="anchor" href="#variables-cualitativas"><i class="fas fa-link"></i></a>
</h3>
<p></p>
<p>El resumen numérico de variables cualitativas se muestra en la tabla de frecuencias,
la cual se puede representar con un gráfico de barras o con un gráfico
de sectores.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;El gráfico de sectores no es recomendable, ya que proporciona la misma
información que el gráfico de barras y para el ojo
humano es mucho más difícil distinguir ángulos que alturas.&lt;/p&gt;"><sup>91</sup></a> Las frecuencias absolutas son el número de observaciones en cada categoría y las frecuencias relativas son la proporción de observaciones en cada categoría con respecto al total. Por ejemplo, el conjunto de datos <code>accidentes2020_data</code>
disponible en el paquete <code>CDR</code> describe los datos de accidentes de tráfico
con víctimas y/o daños al patrimonio en la ciudad de Madrid registrados por la Policía Municipal. Entre sus variables, contiene la variable cualitativa de tipología del accidente <code>tipo_accidente</code>. Un resumen puede obtenerse tanto con la función <code><a href="https://rdrr.io/r/base/table.html">table()</a></code>
como con el paquete <code>dplyr</code>, como se vio en la Sec. <a href="ch-110003.html#sec-110003-tidyverse">3.6</a>.
En variables cualitativas, la categoría más frecuente se denomina <strong>moda</strong> de la variable.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Nótese que el orden por defecto que utiliza &lt;strong&gt;R&lt;/strong&gt; es el alfabético. Se puede cambiar este comportamiento reordenando los niveles del factor; por ejemplo, para poner “Otro” en la última posición.&lt;/p&gt;"><sup>92</sup></a></p>
<p></p>
<div class="sourceCode" id="cb135"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st">"CDR"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://dplyr.tidyverse.org">"dplyr"</a></span><span class="op">)</span></span>
<span><span class="va">accidentes2020_data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op">(</span><span class="va">tipo_accidente</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>porc <span class="op">=</span> <span class="fl">100</span> <span class="op">*</span> <span class="va">n</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;                  tipo_accidente    n       porc</span></span>
<span><span class="co">#&gt;  1:                      Alcance 7294 22.4936010</span></span>
<span><span class="co">#&gt;  2:           Atropello a animal   75  0.2312887</span></span>
<span><span class="co">#&gt;  3:          Atropello a persona 2127  6.5593487</span></span>
<span><span class="co">#&gt;  4:                        Caída 2118  6.5315940</span></span>
<span><span class="co">#&gt;  5: Choque contra obstáculo fijo 4667 14.3923274</span></span>
<span><span class="co">#&gt;  6:             Colisión frontal  899  2.7723810</span></span>
<span><span class="co">#&gt;  7:      Colisión fronto-lateral 8081 24.9205909</span></span>
<span><span class="co">#&gt;  8:             Colisión lateral 4386 13.5257656</span></span>
<span><span class="co">#&gt;  9:            Colisión múltiple 2231  6.8800691</span></span>
<span><span class="co">#&gt; 10:                Despeñamiento    2  0.0061677</span></span>
<span><span class="co">#&gt; 11:                         Otro  251  0.7740463</span></span>
<span><span class="co">#&gt; 12:        Solo salida de la vía  151  0.4656613</span></span>
<span><span class="co">#&gt; 13:                       Vuelco  145  0.4471582</span></span></code></pre></div>
<p>Para representar el gráfico de barras con la función <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code>, se añade la capa de geometría con la función <code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar()</a></code> (véase Fig. <a href="cap-120006-aed.html#fig:ch-120006-geombar">11.4</a>).</p>
<div class="sourceCode" id="cb136"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://ggplot2.tidyverse.org">"ggplot2"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st">"CDR"</span><span class="op">)</span></span>
<span><span class="va">accidentes2020_data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">tipo_accidente</span><span class="op">)</span>, fill <span class="op">=</span> <span class="st">"pink"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:ch-120006-geombar"></span>
<img src="120006_Analisis_exp_files/figure-html/ch-120006-geombar-1.png" alt="Gráfico de barras con ggplot2." width="60%"><p class="caption">
Figura 11.4: Gráfico de barras con ggplot2.
</p>
</div>
<p></p>
<div class="infobox">
<p><strong>Nota</strong></p>
<p>El código anterior es la forma más básica de hacer un gráfico con <code>ggplot2</code>.
Opciones más avanzadas pueden encontrarse en <span class="citation">H. Wickham and Grolemund (<a href="referencias.html#ref-wickham2016r">2016</a>)</span>.</p>
</div>
<p>Ya se ha comentado que los gráficos de sectores no se recomiendan a menos que se incluya en ellos información numérica. El paquete <code>ggstatsplot</code> realiza gráficos que incluyen análisis estadísticos. Por ejemplo, la función <code><a href="https://indrajeetpatil.github.io/ggstatsplot/reference/ggpiestats.html">ggpiestats()</a></code> proporciona un gráfico de sectores con algunos tests estadísticos (véase la ayuda de la función) y podría utilizarse para determinar en qué medida un conjunto de 80 ayuntamientos de distinto signo político presta o no un determinado servicio <code>serv</code> (véase el conjunto de datos en el paquete del libro <code><a href="https://rdrr.io/pkg/CDR/man/ayuntam.html">?CDR::ayuntam</a></code>). El siguiente código produce el gráfico de la Fig. <a href="cap-120006-aed.html#fig:ch-120006-ggs">11.5</a>.</p>
<div class="sourceCode" id="cb137"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://indrajeetpatil.github.io/ggstatsplot/">"ggstatsplot"</a></span><span class="op">)</span></span>
<span><span class="va">ayuntam</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://indrajeetpatil.github.io/ggstatsplot/reference/ggpiestats.html">ggpiestats</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">serv</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:ch-120006-ggs"></span>
<img src="120006_Analisis_exp_files/figure-html/ch-120006-ggs-1.png" alt="Gráfico de sectores con tests. Prestación o no de un determinado servicio X en ayuntamientos de distinto signo político." width="60%"><p class="caption">
Figura 11.5: Gráfico de sectores con tests. Prestación o no de un determinado servicio X en ayuntamientos de distinto signo político.
</p>
</div>
<p>Una alternativa a los gráficos de sectores son los <em>waffle charts</em> (gráficos de gofre o de tableta de chocolate). La siguiente expresión produce de la Fig. <a href="cap-120006-aed.html#fig:ch-120006-gofre">11.6</a> usando el paquete <code>waffle</code>. Con el argumento <code>use_glyph</code> se pueden incluir iconos en vez de cuadrados.</p>
<div class="sourceCode" id="cb138"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st">"waffle"</span><span class="op">)</span></span>
<span><span class="va">freq</span> <span class="op">&lt;-</span> <span class="va">ayuntam</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op">(</span><span class="va">serv</span><span class="op">)</span></span>
<span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html">setNames</a></span><span class="op">(</span><span class="va">freq</span><span class="op">$</span><span class="va">n</span>, <span class="va">freq</span><span class="op">$</span><span class="va">serv</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/waffle/man/waffle.html">waffle</a></span><span class="op">(</span><span class="va">m</span>, rows <span class="op">=</span> <span class="fl">4</span>, colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"green"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:ch-120006-gofre"></span>
<img src="120006_Analisis_exp_files/figure-html/ch-120006-gofre-1.png" alt="Gráfico waffle. Prestación o no de un determinado servicio $X$ en 80 ayuntamientos de distinto signo político." width="60%"><p class="caption">
Figura 11.6: Gráfico waffle. Prestación o no de un determinado servicio <span class="math inline">\(X\)</span> en 80 ayuntamientos de distinto signo político.
</p>
</div>
</div>
<div id="variables-cuantitativas" class="section level3" number="11.2.2">
<h3>
<span class="header-section-number">11.2.2</span> Variables cuantitativas<a class="anchor" aria-label="anchor" href="#variables-cuantitativas"><i class="fas fa-link"></i></a>
</h3>
<p> </p>
<p>Los estadísticos descriptivos más importantes que se utilizan en un AED
se dividen en tres grandes grupos:</p>
<ul>
<li><p><strong>Medidas de posición</strong>, que su vez se dividen en (i) centrales: media (<code><a href="https://rdrr.io/r/base/mean.html">mean()</a></code>), mediana (<code><a href="https://rdrr.io/r/stats/median.html">median()</a></code>) y moda y (ii) no centrales: cuantiles <code><a href="https://rdrr.io/r/stats/quantile.html">quantile()</a></code>, mínimo (<code><a href="https://rdrr.io/r/base/Extremes.html">min()</a></code>) y máximo (<code><a href="https://rdrr.io/r/base/Extremes.html">max()</a></code>).
</p></li>
<li><p><strong>Medidas de dispersión</strong>. Las más importantes son: varianza (<code><a href="https://rdrr.io/r/stats/cor.html">var()</a></code>), desviación típica (<code><a href="https://rdrr.io/r/stats/sd.html">sd()</a></code>), rango intercuartílico (<code><a href="https://rdrr.io/r/stats/IQR.html">IQR()</a></code>), desviación absoluta mediana (<code><a href="https://rdrr.io/r/stats/mad.html">mad()</a></code>) y coeficiente de variación (<code>sd(x)/mean(x)</code>).
</p></li>
<li><p><strong>Medidas de forma</strong>: asimetría (<em>skewness</em>) y apuntamiento (<em>kurtosis</em>).
</p></li>
</ul>
<p>La función <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> de <strong>R</strong> base es una función de las llamadas “genéricas”
y solo aborda las medidas de posición.</p>
<div class="sourceCode" id="cb139"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">renta_municipio_data</span><span class="op">$</span><span class="va">`2019`</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's </span></span>
<span><span class="co">#&gt;    4053    9914   11595   12247   13690   32183    5697</span></span></code></pre></div>
<p>Sin embargo, los estadísticos descriptivos suelen presentarse juntos “describiendo” el conjunto de datos. Existen distintos paquetes, como <code>summarytools</code>, que proporcionan un resumen completo de un vector numérico con la función <code><a href="https://rdrr.io/pkg/summarytools/man/descr.html">descr()</a></code>, así como de un conjunto de datos completo (ver opciones del paquete).</p>
<div class="sourceCode" id="cb140"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/dcomtois/summarytools">"summarytools"</a></span><span class="op">)</span></span>
<span><span class="va">renta_municipio_data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">`2019`</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/summarytools/man/descr.html">descr</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#&gt;Descriptive Statistics  </span></span>
<span><span class="co">#&gt;2019  </span></span>
<span><span class="co">#&gt;N: 55273  </span></span>
<span><span class="co">#&gt;                        2019</span></span>
<span><span class="co">#&gt;----------------- ----------</span></span>
<span><span class="co">#&gt;             Mean   12246.84</span></span>
<span><span class="co">#&gt;          Std.Dev    3562.94</span></span>
<span><span class="co">#&gt;              Min    4053.00</span></span>
<span><span class="co">#&gt;               Q1    9914.00</span></span>
<span><span class="co">#&gt;           Median   11595.00</span></span>
<span><span class="co">#&gt;               Q3   13690.50</span></span>
<span><span class="co">#&gt;              Max   32183.00</span></span>
<span><span class="co">#&gt;              MAD    2742.81</span></span>
<span><span class="co">#&gt;              IQR    3776.25</span></span>
<span><span class="co">#&gt;               CV       0.29</span></span>
<span><span class="co">#&gt;         Skewness       1.82</span></span>
<span><span class="co">#&gt;      SE.Skewness       0.01</span></span>
<span><span class="co">#&gt;         Kurtosis       5.77</span></span>
<span><span class="co">#&gt;          N.Valid   49576.00</span></span>
<span><span class="co">#&gt;        Pct.Valid      89.69</span></span></code></pre></div>
<p>A continuación se proporciona una breve definición de las anteriores medidas y su fórmula matemática, como referencia general y por su uso en otras partes del libro. En las fórmulas siguientes, <span class="math inline">\(x_i\)</span> representa cada valor de la variable en la muestra y <span class="math inline">\(n\)</span> es el número de observaciones en dicha muestra.</p>
<ul>
<li>Media (<em>Mean</em>), <span class="math inline">\(\overline{x}\)</span>: es el centro de gravedad de los datos, en torno al cual varían.</li>
</ul>
<p><span class="math display">\[\bar{x}= \frac{\sum\limits_{i=1}^n x_i}{n}.\]</span></p>
<ul>
<li>Desviación típica (<em>std. dev</em>), <span class="math inline">\(s\)</span>: es la raíz cuadrada de la varianza, <span class="math inline">\(s^2\)</span>. Representa la variación promedio alrededor de la media, en las unidades de la variable y en sus unidades al cuadrado, respectivamente. La siguiente fórmula corresponde a la varianza muestral, dividiendo por <span class="math inline">\(n-1\)</span>. Para la varianza poblacional, se dividiría por el tamaño de la población <span class="math inline">\(N\)</span>. Para calcular la desviación típica, bastaría con hacer la raíz cuadrada.</li>
</ul>
<p><span class="math display">\[s^2= \frac{\sum\limits_{i=1}^n (x_i- \bar{x})^2}{n-1}.\]</span></p>
<ul>
<li><p>El mínimo (<em>Min</em>) y el máximo (<em>Max</em>) son los extremos de los datos.</p></li>
<li><p>La mediana (<em>Median</em>) es el segundo cuartil <span class="math inline">\(Q_2\)</span>. Es el punto central de los datos, dejando la mitad de las observaciones por abajo y la otra mitad por arriba. Los cuartiles <span class="math inline">\(Q_1\)</span> y <span class="math inline">\(Q_3\)</span> dividen los datos dejando por debajo de su valor el 25% y el 75%, respectivamente.</p></li>
<li><p>La desviación absoluta mediana (MAD, por sus siglas en inglés) es la mediana de las desviaciones a la mediana.</p></li>
<li><p>El rango intercuartílico es la diferencia entre el tercer y el primer cuartil. Es decir, el rango del 50% de las observaciones centrales:</p></li>
</ul>
<p><span class="math display">\[IQR = Q_3-Q_1.\]</span></p>
<ul>
<li>El coeficiente de variación es el cociente entre la desviación típica y la media (en valor absoluto). Es una medida de variabilidad relativa muy útil para comparar la variabilidad de distintas muestras o poblaciones.</li>
</ul>
<p><span class="math display">\[CV = \frac{s}{|\overline{x}|}.\]</span></p>
<ul>
<li>Coeficiente de asimetría (<em>Skewness</em>). En variables simétricas es nulo. Si es mayor de cero, los datos presentan asimetría positiva (una cola a la derecha, en los valores altos con respecto a la media) y si es menor de cero, los
datos presentan asimetría negativa (una cola a la izquierda, en valores bajos con respecto a la media).</li>
</ul>
<p><span class="math display">\[g_1 = \frac{\frac{1}{n}\sum\limits_{i=1}^n(x_i-\bar x ) ^3}{s^3}.\]</span></p>
<ul>
<li>Coeficiente de apuntamiento (<em>Kurtosis</em>). Si los datos presentan un apuntamiento similar al de la distribución normal, será próximo a cero. Cuanto más grande, más apuntado, y cuanto más pequeño, más aplanado.</li>
</ul>
<p><span class="math display">\[g_2 = \frac{\frac{1}{n}\sum\limits_{i=1}^n(x_i-\bar x ) ^4}{s^4}-3.\]</span></p>
<p>Los otros tres valores que aparecen en la salida de la función <code><a href="https://rdrr.io/pkg/summarytools/man/descr.html">descr()</a></code> son el error típico del coeficiente de asimetría (<em>SE. Skewness</em>), el número total de valores válidos (<em>N. Valid</em>) y el porcentaje respecto al total de datos (<em>Pct. Valid</em>). El complementario de este último, por tanto, es el porcentaje de valores perdidos (<em>missing</em>).</p>
<p></p>
<p>La representación gráfica de la tabla de frecuencias de una variable cuantitativa
es el <strong>histograma</strong>.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;En el caso de las variables discretas con un número de posibles valores pequeños,
es mejor proceder igual que si fuera una variable cualitativa, obteniendo una tabla de frecuencias y un gráfico de barras, con la diferencia de que el orden de los posibles valores será el numérico.&lt;/p&gt;"><sup>93</sup></a>
Para representarlo, se cuenta el número de observaciones (frecuencia) por intervalo (<em>bin</em>). Una posible regla sería el método de Sturges,<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Este es el método que utiliza por defecto la función &lt;code&gt;hist&lt;/code&gt;
de &lt;strong&gt;R&lt;/strong&gt; base, que además redondea la amplitud del intervalo para facilitar la
interpretación. Otra regla muy sencilla es tomar como número de intervalos
en torno a la raíz cuadrada del número total de datos.&lt;/p&gt;"><sup>94</sup></a> que se puede hallar con la función <code><a href="https://rdrr.io/r/grDevices/nclass.html">nclass.Sturges()</a></code>.</p>
<p></p>
<p>Para obtener la tabla de frecuencias de la renta neta per cápita en 2019
usando el número de intervalos con la regla de Sturges se procede como sigue:</p>
<div class="sourceCode" id="cb141"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">renta_municipio_data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>clases_sturges_renta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html">cut</a></span><span class="op">(</span><span class="va">`2019`</span>,</span>
<span>    breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/nclass.html">nclass.Sturges</a></span><span class="op">(</span><span class="va">`2019`</span><span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op">(</span><span class="va">clases_sturges_renta</span><span class="op">)</span></span></code></pre></div>
<p>Sin embargo, esta regla no siempre es la más apropiada,
como se verá en la Sec. <a href="datos-espaciales.html#no-mentir">40.4</a>,
pues debe estudiarse bien la naturaleza de la variable a analizar.</p>
<p>El histograma proporciona mucha información sobre la variable: (<span class="math inline">\(i\)</span>) si es aproximadamente simétrica, (<span class="math inline">\(ii\)</span>) si tiene forma de campana (se parece a la distribución normal), (<span class="math inline">\(iii\)</span>) si hay valores extremos y cómo son de frecuentes,
y (<span class="math inline">\(iv\)</span>) si puede haber mezcla de poblaciones (más de una moda).</p>
<p>La función <code><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram()</a></code> del paquete <code>ggplot2</code> añade una capa con un
histograma al gráfico. El color de las barras se controla con el <em>aesthetics</em> <code>fill</code> y la altura puede representar las frecuencias absolutas (recuentos) o
relativas (proporciones). El número de intervalos se indica con el argumento
<code>bins</code>, o alternativamente, la anchura de intervalo con <code>bin_width</code>, véase la Fig. <a href="cap-120006-aed.html#fig:ch-120006-plot-hist-bins">11.7</a>.</p>
<div class="sourceCode" id="cb142"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">renta_municipio_data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">`2019`</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">h1</span> <span class="op">&lt;-</span> <span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"yellow"</span>, fill <span class="op">=</span> <span class="st">"pink"</span><span class="op">)</span></span>
<span><span class="va">h2</span> <span class="op">&lt;-</span> <span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span></span>
<span>  color <span class="op">=</span> <span class="st">"yellow"</span>, fill <span class="op">=</span> <span class="st">"pink"</span>,</span>
<span>  bins <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/nclass.html">nclass.Sturges</a></span><span class="op">(</span><span class="va">renta_municipio_data</span><span class="op">$</span><span class="va">`2019`</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">h3</span> <span class="op">&lt;-</span> <span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"yellow"</span>, fill <span class="op">=</span> <span class="st">"pink"</span>, bins <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://patchwork.data-imaginist.com">"patchwork"</a></span><span class="op">)</span></span>
<span><span class="va">h1</span> <span class="op">+</span> <span class="va">h2</span> <span class="op">+</span> <span class="va">h3</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:ch-120006-plot-hist-bins"></span>
<img src="img/plot-hist-bins.png" alt="Histogramas de la renta neta per cápita en 2019 con distintos $bins$. Izquierda: $bins$ por defecto (n = 30); Centro: $bins$ con la regla de Strurges; Derecha: $bins$ = 20." width="60%"><p class="caption">
Figura 11.7: Histogramas de la renta neta per cápita en 2019 con distintos <span class="math inline">\(bins\)</span>. Izquierda: <span class="math inline">\(bins\)</span> por defecto (n = 30); Centro: <span class="math inline">\(bins\)</span> con la regla de Strurges; Derecha: <span class="math inline">\(bins\)</span> = 20.
</p>
</div>
<p></p>
<p>Una representación alternativa al histograma es la línea de densidad, que sustituye
las barras por una línea continua, generalmente suavizada. A continuación, se añade
la línea de densidad a uno de los histogramas de la Fig. <a href="cap-120006-aed.html#fig:ch-120006-plot-hist-bins">11.7</a> y el
resultado se puede ver en la Fig. <a href="cap-120006-aed.html#fig:ch-120006-hist-density">11.8</a>.</p>
<div class="sourceCode" id="cb143"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">renta_municipio_data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">`2019`</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span><span class="op">)</span>, </span>
<span>                   position <span class="op">=</span> <span class="st">"identity"</span>, </span>
<span>                   color <span class="op">=</span> <span class="st">"yellow"</span>, fill <span class="op">=</span> <span class="st">"pink"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span>lwd <span class="op">=</span> <span class="fl">1</span>, colour <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:ch-120006-hist-density"></span>
<img src="120006_Analisis_exp_files/figure-html/ch-120006-hist-density-1.png" alt="Histograma y línea de densidad de la renta neta per cápita española en 2019." width="60%"><p class="caption">
Figura 11.8: Histograma y línea de densidad de la renta neta per cápita española en 2019.
</p>
</div>
<p> </p>
<p>Otras representaciones gráficas muy útiles de las variables continuas son el
gráfico de <strong>caja y bigotes</strong> y el <strong>diagrama de violín</strong>, que se obtienen fácilmente combinando en <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code> las capas <code><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot()</a></code> y <code><a href="https://ggplot2.tidyverse.org/reference/geom_violin.html">geom_violin()</a></code>, respectivamente (véase Fig. <a href="cap-120006-aed.html#fig:ch-120006-plot-boxplot-violin">11.9</a>).</p>
<div class="sourceCode" id="cb144"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">renta_municipio_data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="fl">0</span>, y<span class="op">=</span> <span class="va">`2019`</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="va">boxplot</span> <span class="op">&lt;-</span> <span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"yellow"</span>, fill <span class="op">=</span> <span class="st">"pink"</span><span class="op">)</span></span>
<span><span class="va">violin</span> <span class="op">&lt;-</span> <span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_violin.html">geom_violin</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"yellow"</span>, fill <span class="op">=</span> <span class="st">"pink"</span><span class="op">)</span></span>
<span><span class="va">boxplot</span> <span class="op">+</span> <span class="va">violin</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:ch-120006-plot-boxplot-violin"></span>
<img src="img/boxplot-violin-renta.png" alt="Diagrama de caja y bigotes y diagrama de violín de la renta neta per cápita en 2019." width="60%"><p class="caption">
Figura 11.9: Diagrama de caja y bigotes y diagrama de violín de la renta neta per cápita en 2019.
</p>
</div>
<p>Otra visualización básica para una variable numérica es la visualización
secuencial de las observaciones, bien a través de puntos (<code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point()</a></code>) o a través de líneas (<code><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line()</a></code>). El orden de las observaciones puede indicar cuándo se ha producido un cambio u otros patrones.</p>
</div>
</div>
<div id="sec-120006-aedmulti" class="section level2" number="11.3">
<h2>
<span class="header-section-number">11.3</span> Análisis exploratorio de varias variables<a class="anchor" aria-label="anchor" href="#sec-120006-aedmulti"><i class="fas fa-link"></i></a>
</h2>
<p></p>
<p>En la Sec. <a href="cap-120006-aed.html#sec-120006-aeduni">11.2</a> se ha realizado un AED de
variables aisladas, pero lo usual es incluir las relaciones entre variables
en el AED.
Las herramientas estadísticas utilizadas son: (<span class="math inline">\(i\)</span>) las tablas de frecuencias conjuntas, que, en el caso de dos atributos, son tablas de doble entrada,
con un atributo en filas y el otro en columnas, para determinar si existe asociación entre dichos atributos, como se verá en el Cap. <a href="tablas-contingencia.html#tablas-contingencia">23</a>;
(<span class="math inline">\(ii\)</span>) los resúmenes numéricos, como la covarianza, el coeficiente de correlación, coeficientes de asociación, etc. y (<span class="math inline">\(iii\)</span>) los gráficos en los que se puede representar más de una variable.</p>
<div id="variables-cualitativas-1" class="section level3" number="11.3.1">
<h3>
<span class="header-section-number">11.3.1</span> Variables cualitativas<a class="anchor" aria-label="anchor" href="#variables-cualitativas-1"><i class="fas fa-link"></i></a>
</h3>
<p>El resumen numérico sigue siendo la tabla
de frecuencias, en este caso conjuntas para las distintas combinaciones de los niveles
de las variables. Este tipo de tablas se denomina <strong>tablas de contingencia</strong> (véase Cap. <a href="tablas-contingencia.html#tablas-contingencia">23</a>). Para dos atributos, se puede representar en
forma de tabla de doble entrada.</p>
<p>El resultado de la función <code><a href="https://rdrr.io/r/base/table.html">table()</a></code> se puede utilizar dentro de las funciones <code><a href="https://rdrr.io/r/base/proportions.html">prop.table()</a></code> y <code><a href="https://rdrr.io/r/stats/addmargins.html">addmargins()</a></code> para obtener las frecuencias relativas, añadir los totales marginales, o ambas cosas. Para el ejemplo de la prestación de un servicio <em>X</em> o no por parte de 80 ayuntamientos, <code><a href="https://rdrr.io/r/base/table.html">table()</a></code> podría utilizarse para dar respuesta a la siguiente pregunta: ¿La prestación pública del servicio <em>X</em> es independiente del signo político del ayuntamiento o depende de dicho signo?</p>
<div class="sourceCode" id="cb145"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">ayuntam</span><span class="op">$</span><span class="va">signo_gob</span> , <span class="va">ayuntam</span><span class="op">$</span><span class="va">serv</span><span class="op">)</span></span>
<span><span class="co">#&gt;             </span></span>
<span><span class="co">#&gt;              No Sí</span></span>
<span><span class="co">#&gt;   Avanzados  14 28</span></span>
<span><span class="co">#&gt;   Ilustrados  6 32</span></span></code></pre></div>
<p>No obstante, la representación gráfica más habitual sigue siendo los gráficos de barras, como se muestra en la Fig. <a href="cap-120006-aed.html#fig:ch-120006-barras-ayunt">11.10</a> producida con el siguiente código:</p>
<div class="sourceCode" id="cb146"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">ayuntam</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">signo_gob</span>, fill <span class="op">=</span> <span class="va">serv</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">frecuencias</span> <span class="op">&lt;-</span> <span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="op">)</span> </span>
<span><span class="va">proporciones</span> <span class="op">&lt;-</span> <span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_stack.html">position_fill</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">frecuencias</span> <span class="op">+</span> <span class="va">proporciones</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:ch-120006-barras-ayunt"></span>
<img src="120006_Analisis_exp_files/figure-html/ch-120006-barras-ayunt-1.png" alt="Gráfico de barras de la prestación pública del servicio $X$ por parte de 80 ayuntamientos de distinto signo político. Izquierda: frecuencias absolutas. Derecha: frecuencias relativas." width="80%"><p class="caption">
Figura 11.10: Gráfico de barras de la prestación pública del servicio <span class="math inline">\(X\)</span> por parte de 80 ayuntamientos de distinto signo político. Izquierda: frecuencias absolutas. Derecha: frecuencias relativas.
</p>
</div>
<p>Una visualización interesante de tablas de doble entrada son los gráficos en los que
se representan las frecuencias conjuntas por medio de puntos cuya área es proporcional a la frecuencia. La Fig. <a href="cap-120006-aed.html#fig:ch-120006-balloonplot-eda-ayunt">11.11</a> muestra gráficamente la tabla de frecuencias conjunta de los atributos <code>signo_gob</code> y <code>serv</code> del conjunto de datos <code>ayuntam</code>.</p>
<div class="sourceCode" id="cb147"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/talgalili/gplots">"gplots"</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/gplots/man/balloonplot.html">balloonplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">ayuntam</span><span class="op">$</span><span class="va">signo_gob</span> , <span class="va">ayuntam</span><span class="op">$</span><span class="va">serv</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:ch-120006-balloonplot-eda-ayunt"></span>
<img src="120006_Analisis_exp_files/figure-html/ch-120006-balloonplot-eda-ayunt-1.png" alt="Representación gráfica de tabla de frecuencias." width="60%"><p class="caption">
Figura 11.11: Representación gráfica de tabla de frecuencias.
</p>
</div>
<p>Para representar dos o más factores a la vez en un único gráfico, se dispone de los gráficos de mosaico con la función <code><a href="https://rdrr.io/r/graphics/mosaicplot.html">mosaicplot()</a></code> de <strong>R</strong> base, o bien el paquete
<code>ggmosaic</code>, que incluye una función <code><a href="https://rdrr.io/pkg/ggmosaic/man/geom_mosaic.html">geom_mosaic()</a></code> para usar en gráficos <code>ggplot2</code>. El siguiente ejemplo produce el gráfico de la Fig. <a href="cap-120006-aed.html#fig:ch-120006-mosaico-accidentes">11.12</a>:</p>
<div class="sourceCode" id="cb148"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/haleyjeppson/ggmosaic">"ggmosaic"</a></span><span class="op">)</span></span>
<span><span class="va">accidentes2020_data</span> <span class="op">|&gt;</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/ggmosaic/man/geom_mosaic.html">geom_mosaic</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ggmosaic/man/product.html">product</a></span><span class="op">(</span><span class="va">tipo_accidente</span>, <span class="va">sexo</span><span class="op">)</span>, </span>
<span>                  fill<span class="op">=</span><span class="va">sexo</span><span class="op">)</span><span class="op">)</span> </span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:ch-120006-mosaico-accidentes"></span>
<img src="120006_Analisis_exp_files/figure-html/ch-120006-mosaico-accidentes-1.png" alt="Gráfico de mosaico para relacionar el tipo de accidente y el sexo en los datos de accidentes." width="60%"><p class="caption">
Figura 11.12: Gráfico de mosaico para relacionar el tipo de accidente y el sexo en los datos de accidentes.
</p>
</div>
<p></p>
<p>En cualquier caso, se pueden representar más variables creando “subgráficos” o
facetas (<em>facets</em>). Basta con añadir una capa al gráfico <code>ggplot2</code>
con la función <code><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap()</a></code> y el argumento <code>facets</code> una lista de variables
(categóricas o discretas) para cuyos valores se quiere hacer un gráfico
distinto. Con el siguiente código<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Una sintaxis alternativa para especificar las facetas en la función &lt;code&gt;facet_wrap()&lt;/code&gt; sería la siguiente: &lt;code&gt;facet_wrap(~tipo_accidente)&lt;/code&gt;.&lt;/p&gt;"><sup>95</sup></a> se construye un gráfico para cada nivel del factor
<code>tipo_accidente</code>. Cada uno de estos gráficos es una “faceta” del gráfico, que se
muestra en la Fig. <a href="cap-120006-aed.html#fig:ch-120006-acc-3vbles">11.13</a>.</p>
<div class="sourceCode" id="cb149"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">niveles</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">accidentes2020_data</span><span class="op">$</span><span class="va">tipo_accidente</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">etiquetas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rlang.r-lib.org/reference/set_names.html">set_names</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_wrap.html">str_wrap</a></span><span class="op">(</span><span class="va">niveles</span>, width <span class="op">=</span> <span class="fl">20</span><span class="op">)</span>, </span>
<span>                       <span class="va">niveles</span><span class="op">)</span></span>
<span><span class="va">accidentes2020_data</span>  <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">sexo</span>, fill <span class="op">=</span> <span class="va">estado_meteorológico</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html">vars</a></span><span class="op">(</span><span class="va">tipo_accidente</span><span class="op">)</span>, </span>
<span>             labeller <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/as_labeller.html">as_labeller</a></span><span class="op">(</span><span class="va">etiquetas</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"Estado Meteorológico"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.text.x  <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:ch-120006-acc-3vbles"></span>
<img src="120006_Analisis_exp_files/figure-html/ch-120006-acc-3vbles-1.png" alt="Representación de tres atributos mediante gráficos de barras conjuntos y facetas." width="100%"><p class="caption">
Figura 11.13: Representación de tres atributos mediante gráficos de barras conjuntos y facetas.
</p>
</div>
</div>
<div id="variables-cuantitativas-1" class="section level3" number="11.3.2">
<h3>
<span class="header-section-number">11.3.2</span> Variables cuantitativas<a class="anchor" aria-label="anchor" href="#variables-cuantitativas-1"><i class="fas fa-link"></i></a>
</h3>
<p>
</p>
<p>La descripción conjunta de variables numéricas se
puede resumir con el vector de medias (medias de cada variable) y la
matriz de varianzas-covarianzas. La covarianza <span class="math inline">\(s_{xy}\)</span> (función <code><a href="https://rdrr.io/r/stats/cor.html">var()</a></code>) es una medida
del grado de dependencia lineal entre dos variables numéricas.
Si la covarianza es cero, no hay relación lineal (pero podría
haber otro tipo de relación, recuérdese el cuarteto de Anscombe).
Pero la covarianza es una medida que depende de la escala
de las variables, por lo que es más fácil interpretar el coeficiente de correlación lineal <span class="math inline">\(r_{xy}\)</span> (función <code><a href="https://rdrr.io/r/stats/cor.html">cor()</a></code>), que está acotado entre <span class="math inline">\(-1\)</span> y 1. Cuanto más se acerque a 1, en valor absoluto,
más fuerte será la dependencia lineal. Las fórmulas para calcular ambos estadísticos son
las siguientes:</p>
<p><span class="math display">\[s_{xy} = \frac{1}{n-1} \sum\limits_{i=1}^n(x_i-\bar x)(y_i-\bar y),\]</span></p>
<p><span class="math display">\[r_{xy}=\frac{s_{xy}}{s_x \cdot s_y}.\]</span></p>
<p>Además, la matriz de correlación suele ser un punto de partida
en las técnicas de reducción de la dimensionalidad (véanse los Cap. <a href="acp.html#acp">32</a>, <a href="af.html#af">33</a> y <a href="mds.html#mds">34</a>). Si, por ejemplo, se desea
calcular la matriz de correlaciones del conjunto de datos <code>TIC2021</code>,
que presenta las estadísticas de uso de las TIC en la Unión Europea en 2021,
se puede utilizar el paquete <code>corrplot</code>, que proporciona una forma elegante y versátil de representarla (véase la Fig. <a href="cap-120006-aed.html#fig:ch-120006-correlacion">11.14</a>).<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Una gran cantidad de ejemplos puede verse ejecutando &lt;code&gt;example(corrplot)&lt;/code&gt;.&lt;/p&gt;"><sup>96</sup></a></p>
<div class="sourceCode" id="cb150"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/taiyun/corrplot">"corrplot"</a></span><span class="op">)</span></span>
<span><span class="va">mcor_tic</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">TIC2021</span><span class="op">)</span>  </span>
<span><span class="fu"><a href="https://rdrr.io/pkg/corrplot/man/corrplot.mixed.html">corrplot.mixed</a></span><span class="op">(</span><span class="va">mcor_tic</span>, order <span class="op">=</span> <span class="st">'AOE'</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:ch-120006-correlacion"></span>
<img src="120006_Analisis_exp_files/figure-html/ch-120006-correlacion-1.png" alt="Representación gráfica de la matriz de correlaciones entre las variables del conjunto de datos TIC2021." width="60%"><p class="caption">
Figura 11.14: Representación gráfica de la matriz de correlaciones entre las variables del conjunto de datos TIC2021.
</p>
</div>
<p>La matriz de correlaciones se puede representar mediante “mapas de calor”
(<em>heatmap</em>), es decir, un cuadrado que representa las filas y columnas de
la matriz de correlaciones (variables) y donde el color de las celdas es
una gradación que depende del valor de las mismas. Un mapa de calor de la matriz de correlaciones guardada anteriormente, <code>mcor_tic</code>,
puede obtenerse con la expresión <code>heatmap(mcor_tic)</code>.</p>
<p></p>
<p>En cuanto a los resúmenes gráficos, el <strong>diagrama de dispersión</strong> es el gráfico más popular. La función <code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point()</a></code> de <code>ggplot2</code> añade una capa con los puntos (x, y), que ya nos da una idea de la relación entre las variables, y permite interpretarla
conjuntamente con el coeficiente de correlación. Se puede añadir una línea de regresión, incluida una banda de confianza, por diversos métodos (función <code><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth()</a></code> por defecto, una curva <em>loess</em> o <em>gam</em> dependiendo del número de filas).
Alternativamente a los puntos como objeto geométrico, se pueden representar líneas (<code><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line()</a></code>).</p>
<p>Por ejemplo, antes de llevar a cabo un ajuste lineal, o de otro tipo, con los datos <code>airquality</code>, tal y como se hará en los Cap. <a href="cap-lm.html#cap-lm">15</a> a <a href="cap-sparse.html#cap-sparse">19</a>, se podría hacer un AED
previo entre las variables <code>Ozone</code> y <code>Temp</code> con el gráfico de la Fig. <a href="cap-120006-aed.html#fig:ch-120006-scatter-ozono">11.15</a>.</p>
<div class="sourceCode" id="cb151"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">airquality</span> <span class="op">|&gt;</span></span>
<span>  <span class="co">#select(Ozone,Temp) |&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span> x<span class="op">=</span> <span class="va">Temp</span>, y<span class="op">=</span><span class="va">Ozone</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:ch-120006-scatter-ozono"></span>
<img src="120006_Analisis_exp_files/figure-html/ch-120006-scatter-ozono-1.png" alt="Gráfico de dispersión del ozono frente a la temperatura." width="60%"><p class="caption">
Figura 11.15: Gráfico de dispersión del ozono frente a la temperatura.
</p>
</div>
<p></p>
<p>Un caso particular es cuando la variable explicativa es el tiempo. En este caso, se tiene una serie temporal, y la representación con líneas es más adecuada (véase la Fig. <a href="cap-120006-aed.html#fig:ch-120006-nox-time">11.16</a>).</p>
<div class="sourceCode" id="cb152"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://dplyr.tidyverse.org">"dplyr"</a></span><span class="op">)</span></span>
<span><span class="va">contam_mad</span> <span class="op">|&gt;</span>  </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">nom_abv</span> <span class="op">==</span> <span class="st">"NOx"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">fecha</span>, <span class="va">nom_mag</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>media_estaciones <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">daily_mean</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">fecha</span>, y <span class="op">=</span> <span class="va">media_estaciones</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">nom_mag</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">0.5</span>, color <span class="op">=</span> <span class="st">"black"</span>, se <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> </span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:ch-120006-nox-time"></span>
<img src="120006_Analisis_exp_files/figure-html/ch-120006-nox-time-1.png" alt="Concentración media semanal de NOx en las estaciones de medición de Madrid (enero 2011 - marzo 2022)." width="60%"><p class="caption">
Figura 11.16: Concentración media semanal de NOx en las estaciones de medición de Madrid (enero 2011 - marzo 2022).
</p>
</div>
</div>
<div id="variables-cualitativas-y-cuantitativas" class="section level3" number="11.3.3">
<h3>
<span class="header-section-number">11.3.3</span> Variables cualitativas y cuantitativas<a class="anchor" aria-label="anchor" href="#variables-cualitativas-y-cuantitativas"><i class="fas fa-link"></i></a>
</h3>
<p>Cuando se trabaja en un proyecto de ciencia de datos, lo normal es tener tanto variables cualitativas como cuantitativas.
Para representar conjuntamente ambos tipos de variables
existen múltiples posibilidades, algunas
de las cuales se enumeran a continuación, con el tipo
de gráfico adecuado:</p>
<ul>
<li>Una variable numérica y una variable categórica: gráficos de cajas o de violín
para cada nivel de la categórica (Fig. <a href="cap-120006-aed.html#fig:ch-120006-plot-violin-zonas">11.17</a>), o bien gráficos de densidad para cada categoría (Fig. <a href="cap-120006-aed.html#fig:ch-120006-plot-ridges-tipos">11.18</a>).</li>
</ul>
<div class="sourceCode" id="cb153"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">contam_mad</span> <span class="op">|&gt;</span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span>  </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">nom_abv</span> <span class="op">==</span> <span class="st">"PM10"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/between.html">between</a></span><span class="op">(</span><span class="va">fecha</span>, left <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="st">"2022-03-10"</span><span class="op">)</span>, right <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="st">"2022-03-20"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">zona</span>, <span class="va">daily_mean</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_violin.html">geom_violin</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html">geom_jitter</a></span><span class="op">(</span>height <span class="op">=</span> <span class="fl">0</span>, width <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">zona</span>, y <span class="op">=</span> <span class="va">daily_mean</span>, fill <span class="op">=</span><span class="va">zona</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:ch-120006-plot-violin-zonas"></span>
<img src="img/plot-violin-zonas.png" alt="Comparación de los niveles de PM10 en las zonas de la ciudad de Madrid a efectos de calidad del aire durante la calima de marzo de 2022." width="60%"><p class="caption">
Figura 11.17: Comparación de los niveles de PM10 en las zonas de la ciudad de Madrid a efectos de calidad del aire durante la calima de marzo de 2022.
</p>
</div>
<div class="sourceCode" id="cb154"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://wilkelab.org/ggridges/">"ggridges"</a></span><span class="op">)</span></span>
<span><span class="va">contam_mad</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">nom_abv</span> <span class="op">==</span> <span class="st">"NOx"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">daily_mean</span>, y <span class="op">=</span> <span class="va">tipo</span>, fill <span class="op">=</span> <span class="va">tipo</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_density_ridges</span><span class="op">(</span><span class="op">)</span> </span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:ch-120006-plot-ridges-tipos"></span>
<img src="img/plot-ridges-tipos.png" alt="Comparación de concentraciones de NOx por tipo de estación de medición." width="60%"><p class="caption">
Figura 11.18: Comparación de concentraciones de NOx por tipo de estación de medición.
</p>
</div>
<ul>
<li>Dos variables numéricas y varias variables categóricas: gráfico de dispersión
para las numéricas y mapeado del color, tamaño y símbolo por cada nivel de las categóricas,
como en la Fig. <a href="cap-120006-aed.html#fig:plot-dispersion-conjunta-alarma">11.19</a>.</li>
</ul>
<div class="sourceCode" id="cb155"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pm10_nox_mad</span> <span class="op">&lt;-</span> <span class="va">contam_mad</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">nom_abv</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"PM10"</span>, <span class="st">"NOx"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># período del estado de alarma</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/between.html">between</a></span><span class="op">(</span><span class="va">fecha</span>,left<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="st">"2020-03-14"</span><span class="op">)</span>, right<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="st">"2020-06-30"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">estaciones</span>, <span class="va">zona</span>, <span class="va">tipo</span>, <span class="va">nom_abv</span>, <span class="va">daily_mean</span>, <span class="va">fecha</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="st">"nom_abv"</span>, values_from <span class="op">=</span> <span class="st">"daily_mean"</span>, values_fn <span class="op">=</span> <span class="va">mean</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb156"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pm10_nox_mad</span> <span class="op">|&gt;</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">PM10</span>, y <span class="op">=</span> <span class="va">NOx</span>, colour <span class="op">=</span> <span class="va">tipo</span>, size <span class="op">=</span> <span class="va">zona</span> <span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:plot-dispersion-conjunta-alarma"></span>
<img src="img/plot-dispersion-conjunta-alarma.png" alt="Gráfico de dipersión de las variables 'NOx', 'PM10', 'zona' y 'tipo' (de emplazamiento) durante el estado de alarma en la ciudad de Madrid (todas las estaciones de medición)." width="60%"><p class="caption">
Figura 11.19: Gráfico de dipersión de las variables ‘NOx’, ‘PM10’, ‘zona’ y ‘tipo’ (de emplazamiento) durante el estado de alarma en la ciudad de Madrid (todas las estaciones de medición).
</p>
</div>
<ul>
<li>Más de dos variables numéricas y más de una categórica: gráfico de dispersión
y mapeado de las otras variables a otros <em>aesthetics</em>. Combinación de geometrías
y <em>aesthetics</em>. Por ejemplo, añadir puntos con efecto <em>jitter</em> a un gráfico de cajas.</li>
</ul>
<p>En todos los casos anteriores se pueden crear “facetas” para hacer un gráfico
por cada combinación de variables categóricas, de forma que se tenga un buen número de
variables representadas en un mismo “lienzo”, como en la Fig. <a href="cap-120006-aed.html#fig:ch-120006-plot-dispersion-ms-conjunta-alarma">11.20</a>.</p>
<div class="sourceCode" id="cb157"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pm10_nox_mad</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">NOx</span>, x<span class="op">=</span> <span class="va">PM10</span>, colour <span class="op">=</span> <span class="va">tipo</span>, shape <span class="op">=</span> <span class="va">zona</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html">vars</a></span><span class="op">(</span><span class="va">estaciones</span><span class="op">)</span><span class="op">)</span> </span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:ch-120006-plot-dispersion-ms-conjunta-alarma"></span>
<img src="img/plot-dispersion-ms-conjunta-alarma.png" alt="Gráfico de dipersión de las variables 'NOx', 'PM10', 'zona' y 'tipo' (de emplazamiento) por estación de medición durante el estado de alarma en la ciudad de Madrid." width="80%"><p class="caption">
Figura 11.20: Gráfico de dipersión de las variables ‘NOx’, ‘PM10’, ‘zona’ y ‘tipo’ (de emplazamiento) por estación de medición durante el estado de alarma en la ciudad de Madrid.
</p>
</div>
</div>
<div id="resumen-10" class="section level3 unnumbered infobox_resume">
<h3>Resumen<a class="anchor" aria-label="anchor" href="#resumen-10"><i class="fas fa-link"></i></a>
</h3>
<p><em>Análisis exploratorio de una variable</em></p>
<ul>
<li><p>El análisis exploratorio es una tarea fundamental antes de abordar cualquier otra técnica estadística.</p></li>
<li><p>Las variables cualitativas se resumen con tablas de frecuencias y gráficos de barras.</p></li>
<li><p>Las variables cuantitativas discretas se pueden resumir también con tablas de frecuencias y gráficos de barras, pero si hay muchos valores distintos también pueden ser apropiados los histogramas.</p></li>
<li><p>Las variables cuantitativas continuas se pueden resumir con tablas de frecuencias por intervalos, medidas de posición y de dispersión, histogramas y gráficos de cajas.</p></li>
<li><p>Los gráficos de caja sirven, además, para identificar valores atípicos.</p></li>
</ul>
<p><em>Análisis exploratorio de varias variables</em></p>
<ul>
<li><p>Las variables cualitativas se pueden resumir con tablas de frecuencias conjuntas y su
representación gráfica y con combinaciones de gráficos de barras.</p></li>
<li><p>La principal medida conjunta de dos variables cuantitativas es el coeficiente de correlación. Más de dos variables se suelen representar en forma de matriz.</p></li>
<li><p>El gráfico de dispersión es la representación básica para dos variables cuantitativas. Se pueden representar estos gráficos por pares en forma de matriz de gráficos.</p></li>
<li><p>Para añadir más variables, se pueden “mapear” variables a <em>aesthetics</em> (tamaño, color, etc.), añadiendo más objetos geométricos, o bien añadiendo “facetas” (subgráficos) para cada variable o para cada posible valor de una variable cualitativa.</p></li>
</ul>
</div>

</div>
</div>




  <div class="chapter-nav">
<div class="prev"><a href="chap-herramientas.html"><span class="header-section-number">10</span> Herramientas para el análisis en ciencia de datos</a></div>
<div class="next"><a href="Funda-probab.html"><span class="header-section-number">12</span> Probabilidad</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="Índice del capítulo"><h2>Índice del capítulo</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#cap-120006-aed"><span class="header-section-number">11</span> Análisis exploratorio de datos</a></li>
<li>
<a class="nav-link" href="#introducci%C3%B3n-6"><span class="header-section-number">11.1</span> Introducción</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#el-cuarteto-de-anscombe"><span class="header-section-number">11.1.1</span> El cuarteto de Anscombe</a></li>
<li><a class="nav-link" href="#conceptos-generales"><span class="header-section-number">11.1.2</span> Conceptos generales</a></li>
<li><a class="nav-link" href="#componentes-de-un-gr%C3%A1fico-y-su-representaci%C3%B3n-en-r"><span class="header-section-number">11.1.3</span> Componentes de un gráfico y su representación en R</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#sec-120006-aeduni"><span class="header-section-number">11.2</span> Análisis exploratorio de una variable</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#variables-cualitativas"><span class="header-section-number">11.2.1</span> Variables cualitativas</a></li>
<li><a class="nav-link" href="#variables-cuantitativas"><span class="header-section-number">11.2.2</span> Variables cuantitativas</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#sec-120006-aedmulti"><span class="header-section-number">11.3</span> Análisis exploratorio de varias variables</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#variables-cualitativas-1"><span class="header-section-number">11.3.1</span> Variables cualitativas</a></li>
<li><a class="nav-link" href="#variables-cuantitativas-1"><span class="header-section-number">11.3.2</span> Variables cuantitativas</a></li>
<li><a class="nav-link" href="#variables-cualitativas-y-cuantitativas"><span class="header-section-number">11.3.3</span> Variables cualitativas y cuantitativas</a></li>
<li><a class="nav-link" href="#resumen-10">Resumen</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Fundamentos de ciencia de datos con <strong>R</strong></strong>" coordinado por <a href="https://blog.uclm.es/gemafaviles/" class="text-light">Gema Fernández-Avilés y José-María Montero</a>. </p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>Este libro ha sido generado con el paquete de R <a class="text-light" href="https://bookdown.org">bookdown</a>.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
