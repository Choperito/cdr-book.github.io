<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Capítulo 56 Una nota sobre el cambio climático | Fundamentos de ciencia de datos con R</title>
<meta name="author" content="Gema Fernández-Avilés y José-María Montero">
<meta name="description" content="Dominic Royé Fundación de la Investigación del Clima  56.1 Introducción La temperatura media global en la superficie terrestre ha aumentado en 1,1 ºC desde la era preindustrial (1880-1900). A...">
<meta name="generator" content="bookdown 0.28 with bs4_book()">
<meta property="og:title" content="Capítulo 56 Una nota sobre el cambio climático | Fundamentos de ciencia de datos con R">
<meta property="og:type" content="book">
<meta property="og:image" content="/img/cover.png">
<meta property="og:description" content="Dominic Royé Fundación de la Investigación del Clima  56.1 Introducción La temperatura media global en la superficie terrestre ha aumentado en 1,1 ºC desde la era preindustrial (1880-1900). A...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Capítulo 56 Una nota sobre el cambio climático | Fundamentos de ciencia de datos con R">
<meta name="twitter:description" content="Dominic Royé Fundación de la Investigación del Clima  56.1 Introducción La temperatura media global en la superficie terrestre ha aumentado en 1,1 ºC desde la era preindustrial (1880-1900). A...">
<meta name="twitter:image" content="/img/cover.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.4.2/transition.js"></script><script src="libs/bs3compat-0.4.2/tabs.js"></script><script src="libs/bs3compat-0.4.2/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><link href="libs/tabwid-1.1.0/tabwid.css" rel="stylesheet">
<link href="libs/tabwid-1.1.0/scrool.css" rel="stylesheet">
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script><link href="libs/wordcloud2-0.0.1/wordcloud.css" rel="stylesheet">
<script src="libs/wordcloud2-0.0.1/wordcloud2-all.js"></script><script src="libs/wordcloud2-0.0.1/hover.js"></script><script src="libs/wordcloud2-binding-0.2.1/wordcloud2.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="bs4_style.css">
<link rel="stylesheet" href="bs4_book.css">
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Fundamentos de ciencia de datos con <strong>R</strong></a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Buscar" aria-label="Buscar">
</form>

      <nav aria-label="Contenido"><h2>Contenido</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Prefacio</a></li>
<li class="book-part">Ciencia, datos, software… y científicos</li>
<li><a class="" href="ciencia-datos.html"><span class="header-section-number">1</span> ¿Es la ciencia de datos una ciencia?</a></li>
<li><a class="" href="metodologia.html"><span class="header-section-number">2</span> Metodología en ciencia de datos</a></li>
<li><a class="" href="ch-110003.html"><span class="header-section-number">3</span> R para ciencia de datos</a></li>
<li><a class="" href="cap-etica.html"><span class="header-section-number">4</span> Ética en la ciencia de datos</a></li>
<li class="book-part">Bienvenidos a la jungla de datos</li>
<li><a class="" href="datos-sql.html"><span class="header-section-number">5</span> Gestión de bases de datos relacionales</a></li>
<li><a class="" href="cap-nosql.html"><span class="header-section-number">6</span> Gestión de bases de datos NoSQL</a></li>
<li><a class="" href="DGDQM.html"><span class="header-section-number">7</span> Gobierno, gestión y calidad del dato</a></li>
<li><a class="" href="id_130009.html"><span class="header-section-number">8</span> Integración y limpieza de datos</a></li>
<li><a class="" href="chap-feature.html"><span class="header-section-number">9</span> Selección y transformación de variables</a></li>
<li><a class="" href="chap-herramientas.html"><span class="header-section-number">10</span> Herramientas para el análisis en ciencia de datos</a></li>
<li><a class="" href="id_120006-aed.html"><span class="header-section-number">11</span> Análisis exploratorio de datos</a></li>
<li class="book-part">Fundamentos de estadística</li>
<li><a class="" href="Funda-probab.html"><span class="header-section-number">12</span> Probabilidad</a></li>
<li><a class="" href="Fundainfer.html"><span class="header-section-number">13</span> Inferencia estadística</a></li>
<li><a class="" href="muestreo.html"><span class="header-section-number">14</span> Muestreo y remuestreo</a></li>
<li class="book-part">Modelización estadística</li>
<li><a class="" href="cap-lm.html"><span class="header-section-number">15</span> Modelización lineal</a></li>
<li><a class="" href="cap-glm.html"><span class="header-section-number">16</span> Modelos lineales generalizados</a></li>
<li><a class="" href="cap-gam.html"><span class="header-section-number">17</span> Modelos aditivos generalizados</a></li>
<li><a class="" href="cap-mxm.html"><span class="header-section-number">18</span> Modelos mixtos</a></li>
<li><a class="" href="cap-sparse.html"><span class="header-section-number">19</span> Modelos sparse y métodos penalizados de regresión</a></li>
<li><a class="" href="cap-series-temp.html"><span class="header-section-number">20</span> Modelización de series temporales</a></li>
<li><a class="" href="cap-discriminante.html"><span class="header-section-number">21</span> Análisis discriminante</a></li>
<li><a class="" href="cap-conjunto.html"><span class="header-section-number">22</span> Análisis conjunto</a></li>
<li><a class="" href="tablas-contingencia.html"><span class="header-section-number">23</span> Análisis de tablas de contingencia</a></li>
<li class="book-part">Machine learning supervisado</li>
<li><a class="" href="cap-arboles.html"><span class="header-section-number">24</span> Árboles de clasificación y regresión</a></li>
<li><a class="" href="cap-svm.html"><span class="header-section-number">25</span> Máquinas de vector soporte</a></li>
<li><a class="" href="cap-knn.html"><span class="header-section-number">26</span> Clasificador \(k\)-vecinos más próximos</a></li>
<li><a class="" href="cap-naive-bayes.html"><span class="header-section-number">27</span> Naive Bayes</a></li>
<li><a class="" href="cap-bagg-rf.html"><span class="header-section-number">28</span> Métodos ensamblados: bagging y random forest</a></li>
<li><a class="" href="cap-boosting-xgboost.html"><span class="header-section-number">29</span> Boosting y el algoritmo XGBoost</a></li>
<li class="book-part">Machine learning no supervisado</li>
<li><a class="" href="an%C3%A1lisis-cl%C3%BAster-clusterizaci%C3%B3n-jer%C3%A1rquica.html"><span class="header-section-number">30</span> Análisis clúster: clusterización jerárquica</a></li>
<li><a class="" href="no-jerarquico.html"><span class="header-section-number">31</span> Análisis clúster: clusterización no jerárquica</a></li>
<li><a class="" href="acp.html"><span class="header-section-number">32</span> Análisis de componentes principales</a></li>
<li><a class="" href="an%C3%A1lisis-factorial.html"><span class="header-section-number">33</span> Análisis factorial</a></li>
<li><a class="" href="escalamiento-multidimensional.html"><span class="header-section-number">34</span> Escalamiento multidimensional</a></li>
<li><a class="" href="correspondencias.html"><span class="header-section-number">35</span> Análisis de correspondencias</a></li>
<li class="book-part">Deep learning</li>
<li><a class="" href="capNN.html"><span class="header-section-number">36</span> Redes neuronales artificiales</a></li>
<li><a class="" href="cap-redes-convol.html"><span class="header-section-number">37</span> Redes neuronales convolucionales</a></li>
<li class="book-part">Ciencia de datos de texto y redes</li>
<li><a class="" href="mineria-textos.html"><span class="header-section-number">38</span> Minería de textos</a></li>
<li><a class="" href="grafos.html"><span class="header-section-number">39</span> Análisis de grafos y redes sociales</a></li>
<li class="book-part">Ciencia de datos espaciales</li>
<li><a class="" href="datos-espaciales.html"><span class="header-section-number">40</span> Trabajando con datos espaciales</a></li>
<li><a class="" href="geo.html"><span class="header-section-number">41</span> Geoestadística</a></li>
<li><a class="" href="cap-econom-esp.html"><span class="header-section-number">42</span> Modelos econométricos espaciales</a></li>
<li><a class="" href="cap-pp.html"><span class="header-section-number">43</span> Procesos de puntos</a></li>
<li class="book-part">Comunica y colabora</li>
<li><a class="" href="id_120007-informes.html"><span class="header-section-number">44</span> Informes reproducibles con R Markdown y Quarto</a></li>
<li><a class="" href="shiny.html"><span class="header-section-number">45</span> Creación de aplicaciones web interactivas con Shiny</a></li>
<li><a class="" href="github.html"><span class="header-section-number">46</span> Git y GitHub R</a></li>
<li><a class="" href="geoproces.html"><span class="header-section-number">47</span> Geoprocesamiento en nube</a></li>
<li class="book-part">Casos de estudio en ciencia de datos</li>
<li><a class="" href="cap-crimen.html"><span class="header-section-number">48</span> Análisis de una red criminal</a></li>
<li><a class="" href="cap-publicidad.html"><span class="header-section-number">49</span> Optimización de inversiones publicitarias</a></li>
<li><a class="" href="cap-twitter.html"><span class="header-section-number">50</span> ¿Cómo twitea Elon Musk?</a></li>
<li><a class="" href="cap-periodismo.html"><span class="header-section-number">51</span> Análisis electoral: de Rstudio a su periódico</a></li>
<li><a class="" href="paro-clm.html"><span class="header-section-number">52</span> El impacto de las crisis financiera y de la COVID en el paro de Castilla-La Mancha</a></li>
<li><a class="" href="cap-rfm.html"><span class="header-section-number">53</span> Segmentación de clientes en el comerico minorista</a></li>
<li><a class="" href="cap-medicina.html"><span class="header-section-number">54</span> Análisis de datos en medicina</a></li>
<li><a class="" href="cap-futbol.html"><span class="header-section-number">55</span> Messi y Ronaldo: dos ídolos desde la perspectiva de los datos</a></li>
<li><a class="active" href="cambioclimatico.html"><span class="header-section-number">56</span> Una nota sobre el cambio climático</a></li>
<li><a class="" href="cap-sist-exp.html"><span class="header-section-number">57</span> Implementación de un sistema experto en el ámbito pediátrico</a></li>
<li><a class="" href="cap-ree.html"><span class="header-section-number">58</span> Predicción de consumo eléctrico con redes neuronales artificiales</a></li>
<li><a class="" href="nlp-textil.html"><span class="header-section-number">59</span> El procesamiento del lenguaje natural para tendencias de moda en textil</a></li>
<li><a class="" href="cap-fraude.html"><span class="header-section-number">60</span> Detección de fraude de tarjetas de crédito</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="cambioclimatico" class="section level1" number="56">
<h1>
<span class="header-section-number">Capítulo 56</span> Una nota sobre el cambio climático<a class="anchor" aria-label="anchor" href="#cambioclimatico"><i class="fas fa-link"></i></a>
</h1>
<p><em>Dominic Royé</em></p>
<p>Fundación de la Investigación del Clima</p>
<p></p>
<div id="introducción-27" class="section level2" number="56.1">
<h2>
<span class="header-section-number">56.1</span> Introducción<a class="anchor" aria-label="anchor" href="#introducci%C3%B3n-27"><i class="fas fa-link"></i></a>
</h2>
<p>La temperatura media global en la superficie terrestre ha aumentado en 1,1 ºC desde la era preindustrial (1880-1900). A pesar de parecer un leve incremento en la temperatura, implica un aumento significativo en el calor acumulado del sistema Tierra. Cuando se combina el aumento de la temperatura en la superficie terrestre y en la superficie oceánica, la tasa de incremento promedio es de 0,08 ºC por década desde 1880. Sin embargo, la tasa promedio de aumento desde 1981 ha sido más del doble: 0,18 ºC por año. Los océanos se caracterizan por una menor tasa de calentamiento debido a su capacidad calorífica. No obstante, son los océanos los que absorben la mayoría del calor adicional del planeta debido al cambio climático.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;&lt;a href="https://www.ncei.noaa.gov/news/global-climate-202112" class="uri"&gt;https://www.ncei.noaa.gov/news/global-climate-202112&lt;/a&gt;.&lt;/p&gt;'><sup>297</sup></a></p>
<p>Entre todas las regiones, la región mediterránea se está calentando un 20 % más rápido que el promedio mundial. Este lugar representa actualmente el punto crítico más importante del cambio climático, donde se percibe un significativo aumento de las vulnerabilidades. La temperatura de las aguas superficiales en el Mediterráneo ha estado subiendo 0,34 ºC cada década desde principios de los 80 <span class="citation">(<a href="cap-fraude.html#ref-cramer2020climate">Cramer et al. 2020</a>)</span>.</p>
<p>En este caso práctico con datos sobre el cambio climático se tratan las anomalías de la temperatura superficial del mar Mediterráneo en los meses estivales desde 1982 a 2022.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;Se entiende por anomalía la diferencia entre el promedio de la temperatura estival un determinado año y el promedio estival en el periodo 1982-2010 (período de referencia para las anomalías). Véase Cap. &lt;a href="geoproces.html#geoproces"&gt;47&lt;/a&gt;.&lt;/p&gt;'><sup>298</sup></a> Igual que en el Cap. <a href="geoproces.html#geoproces">47</a> se utiliza el conjunto de datos “NOAA CDR OISST v02r01”, una interpolación óptima de la temperatura diaria de la superficie del mar (OISST, por sus siglas en inglés) con una resolución de 1/4 grados (27 km). Los datos los proporciona la <em>National Oceanic and Atmospheric Administration,</em> (NOAA) son campos completos de temperatura oceánica construidos mediante la combinación de observaciones ajustadas por sesgo de diferentes plataformas (satélites, barcos, boyas) en una cuadrícula global regular, con lagunas estimadas por interpolación. Los datos satelitales del radiómetro avanzado de muy alta resolución (AVHRR, por sus siglas en inglés) proporcionan la entrada principal que permite la alta cobertura temporal-espacial desde finales de 1981 hasta el presente. (<a href="https://developers.google.com/earth-engine/datasets/catalog/NOAA_CDR_OISST_V2_1" class="uri">https://developers.google.com/earth-engine/datasets/catalog/NOAA_CDR_OISST_V2_1</a>) <span class="citation">(<a href="cap-fraude.html#ref-reynolds2008">R. W. Reynolds, Banzon, and Program 2008</a>)</span>.</p>
</div>
<div id="consideraciones-iniciales" class="section level2" number="56.2">
<h2>
<span class="header-section-number">56.2</span> Consideraciones iniciales<a class="anchor" aria-label="anchor" href="#consideraciones-iniciales"><i class="fas fa-link"></i></a>
</h2>
<p>La información espacio-temporal es clave en muchas disciplinas, especialmente en la climatología o la meteorología, y ello hace necesario disponer de un formato que permita una estructura multidimensional. Además, es importante que ese formato tenga un alto grado de compatibilidad de intercambio y pueda almacenar un elevado número de datos. Estas características llevaron al desarrollo del estándar abierto netCDF (<em>Network Common Data Form</em>). El formato netCDF es un estándar abierto de intercambio de datos científicos multidimensionales que se utiliza con datos de observaciones o modelos, principalmente en disciplinas como la climatología, la meteorología y la oceanografía. Se trata de un formato espacio-temporal con una cuadrícula regular o irregular. La estructura multidimensional en forma de matriz (array) permite usar no sólo datos espacio-temporales, sino también multidimensionales. Los datos multidimensionales en formato <em>geotiff</em> son menos comúnes, pero también se pueden llegar a usar. Además, es posible crear objetos multidimensionales importando multiples archivos ráster.</p>
</div>
<div id="paquetes" class="section level2" number="56.3">
<h2>
<span class="header-section-number">56.3</span> Paquetes<a class="anchor" aria-label="anchor" href="#paquetes"><i class="fas fa-link"></i></a>
</h2>
<p>El manejo de datos en formato netCDF o múltiples archivos ráster es posible a través de varios paquetes de forma directa o indirecta. Destaca el paquete <code>ncdf4</code>, específicamente diseñado para esto, del que hacen uso también otros paquetes de forma oculta. El manejo con <code>ncdf4</code> es algo complejo, particularmente por la necesidad de gestionar la memoria RAM cuando se trata con grandes conjuntos de datos o también por la forma de manejar la clase <em>array</em>. Otro paquete muy potente es <code>terra</code>, clave en el trabajo con datos ráster y que permite usar sus funciones también para el manejo del formato netCDF.</p>
<div class="sourceCode" id="cb815"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># paquetes</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://tidyverse.tidyverse.org">"tidyverse"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://r-spatial.github.io/sf/">"sf"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://rspatial.org/terra/">"terra"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://lubridate.tidyverse.org">"lubridate"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://fs.r-lib.org">"fs"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://patchwork.data-imaginist.com">"patchwork"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://ropengov.github.io/giscoR/">"giscoR"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://scales.r-lib.org">"scales"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/ateucher/rmapshaper">"rmapshaper"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st">"RColorBrewer"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st">"CDR"</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="visualización-de-mapas-de-facetas" class="section level2" number="56.4">
<h2>
<span class="header-section-number">56.4</span> Visualización de mapas de facetas<a class="anchor" aria-label="anchor" href="#visualizaci%C3%B3n-de-mapas-de-facetas"><i class="fas fa-link"></i></a>
</h2>
<p></p>
<p>Una forma muy efectiva para mostrar cambios espacio-temporales son los mapas de facetas o paneles , en los que se representa, en una rejilla para cada año, la distribución espacial de las anomalías observadas, lo que permite una comparación temporal sencilla.</p>
<div id="importación-de-datos" class="section level3" number="56.4.1">
<h3>
<span class="header-section-number">56.4.1</span> Importación de datos<a class="anchor" aria-label="anchor" href="#importaci%C3%B3n-de-datos"><i class="fas fa-link"></i></a>
</h3>
<p>Se importa el polígono del mar Mediterráneo para limitar los datos al área de interés.</p>
<div class="sourceCode" id="cb816"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"med_limit"</span><span class="op">)</span> </span></code></pre></div>
<p>A continuación, se importan todos los años empleando la función <code><a href="https://fs.r-lib.org/reference/dir_ls.html">dir_ls()</a></code> del paquete <code>fs</code> y la función <code><a href="https://rdrr.io/pkg/terra/man/rast.html">rast()</a></code> de <code>terra</code>. La primera función crea un vector de todos los archivos ubicados en la carpeta “data”. Finalmente se renombran todas las capas con los correspondientes años. Es importante que se garantice el correcto orden de los archivos. Siempre que se haya realizado el geoprocesamiento en nube de las anomalías (Cap. <a href="geoproces.html#geoproces">47</a>) se puede usar la alternativa: <code>anom &lt;- dir_ls("data-cc", regexp = "tif") |&gt; rast()</code>.</p>
<div class="sourceCode" id="cb817"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># importar</span></span>
<span><span class="va">anom</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://fs.r-lib.org/reference/dir_ls.html">dir_ls</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"external/data-cc/"</span>, package <span class="op">=</span> <span class="st">"CDR"</span><span class="op">)</span>, regexp <span class="op">=</span> <span class="st">"tif"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/terra/man/rast.html">rast</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># renombrar las capas</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">anom</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">1982</span><span class="op">:</span><span class="fl">2022</span> </span></code></pre></div>
</div>
<div id="preparación-de-los-datos" class="section level3" number="56.4.2">
<h3>
<span class="header-section-number">56.4.2</span> Preparación de los datos<a class="anchor" aria-label="anchor" href="#preparaci%C3%B3n-de-los-datos"><i class="fas fa-link"></i></a>
</h3>
<p>Después de importar el polígono del mar Mediterráneo, es necesario recortar y enmascarar el área de interés. Para ello se usa primero la función <code><a href="https://rdrr.io/pkg/terra/man/crop.html">crop()</a></code> con los límites del mar Mediterraneo y se pasa el resultado a la función <code><a href="https://rdrr.io/pkg/terra/man/mask.html">mask()</a></code>. El paquete <code>terra</code> necesita los datos vectoriales en su propia clase <code>SpatVector</code>; por eso se pasa con la función <code><a href="https://rdrr.io/pkg/terra/man/vect.html">vect()</a></code>, que lo convierte de la clase <em>sf</em> a <em>SpatVector</em>. Finalmente, se reproyectan los rásters a <em>ETRS89-extended / LAEA Europe</em> con el código EPSG:3035.</p>
<div class="sourceCode" id="cb818"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">anom</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/crop.html">crop</a></span><span class="op">(</span><span class="va">anom</span>, <span class="va">med_limit</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/mask.html">mask</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/vect.html">vect</a></span><span class="op">(</span><span class="va">med_limit</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">anom</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/project.html">project</a></span><span class="op">(</span><span class="va">anom</span>, <span class="st">"EPSG:3035"</span><span class="op">)</span></span></code></pre></div>
<p>En la Fig. <a href="cambioclimatico.html#fig:raster-crop-mask-plot">56.1</a> se puede ver el resultado de los primeros años.</p>
<div class="sourceCode" id="cb819"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html">plot</a></span><span class="op">(</span><span class="va">anom</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:raster-crop-mask-plot"></span>
<img src="img/anom-med.png" alt="Distribución espacial de las anomalías en la  temperatura superficial del mar Mediterraneo: 1982-1997." width="100%"><p class="caption">
Figura 56.1: Distribución espacial de las anomalías en la temperatura superficial del mar Mediterraneo: 1982-1997.
</p>
</div>
<p>Un ráster consiste en latitud, longitud y uno o múltiples valores, también llamados capas (véase Cap. <a href="datos-espaciales.html#datos-espaciales">40</a>. Para poder visualizarlo en <code>ggplot2</code>, es necesario convertirlo en un <code>data.frame</code>. En este caso, se obtienen 41 columnas para las anomalías, además de las primeras dos columnas, que corresponden a la longitud y latitud.</p>
<p>No obstante, es necesario realizar cambios en la distribución de las variables. Ahora se tiene la misma variable, la anomalía, distribuida en muchas columnas, pero la estructura adecuada debe ser un conjunto total de dos columnas: una con las anomalías y otra con los años. Para conseguirlo se hace uso de <code><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer()</a></code>, indicando el total de columnas que deben ser fusionadas y los nombres de las dos columnas resultantes.</p>
<div class="sourceCode" id="cb820"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">anom</span>, xy <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="va">df</span>, <span class="fl">3</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>, </span>
<span>                   names_to <span class="op">=</span> <span class="st">"yr"</span>,</span>
<span>                   values_to <span class="op">=</span> <span class="st">"anom"</span><span class="op">)</span></span></code></pre></div>
<p>Se añaden los años de la década de los 80 que faltan (1980, 1981) y se limitan las anomalías a un rango entre -2 ºC y +2 ºC.</p>
<div class="sourceCode" id="cb821"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html">bind_rows</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">yr</span> <span class="op">==</span> <span class="st">"1982"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>                    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>yr <span class="op">=</span> <span class="st">"1981"</span>, anom <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span>,</span>
<span>                   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">yr</span> <span class="op">==</span> <span class="st">"1982"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>                    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>yr <span class="op">=</span> <span class="st">"1980"</span>, anom <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span>
<span>                <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>anom2 <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span><span class="va">anom</span> <span class="op">&gt;</span> <span class="fl">2</span> <span class="op">~</span> <span class="fl">2</span>,</span>
<span>                               <span class="va">anom</span> <span class="op">&lt;</span> <span class="op">-</span><span class="fl">2</span> <span class="op">~</span> <span class="op">-</span><span class="fl">2</span>,</span>
<span>                               <span class="cn">TRUE</span> <span class="op">~</span> <span class="va">anom</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Previo a la construcción del gráfico, se estima, para cada año, la media de las anomalías en toda la cuenca mediterránea. Estos datos se añaden como texto a cada mapa. Con el objetivo de obtener las coordenadas de la posición en la proyección EPSG:3035, se fija un punto vectorial que se reproyecta.</p>
<div class="sourceCode" id="cb822"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># media global</span></span>
<span><span class="va">med_anom</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/global.html">global</a></span><span class="op">(</span><span class="va">anom</span>, fun <span class="op">=</span> <span class="st">"mean"</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">med_anom</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">rownames_to_column</a></span><span class="op">(</span><span class="va">med_anom</span>, <span class="st">"yr"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># posición </span></span>
<span><span class="va">pos_global</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st.html">st_point</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">34.24</span>, <span class="fl">41.5</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>                 <span class="fu"><a href="https://r-spatial.github.io/sf/reference/sfc.html">st_sfc</a></span><span class="op">(</span>crs <span class="op">=</span> <span class="fl">4326</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>                   <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html">st_transform</a></span><span class="op">(</span><span class="fl">3035</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>                     <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_coordinates.html">st_coordinates</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="construcción-del-gráfico-de-facetas" class="section level3" number="56.4.3">
<h3>
<span class="header-section-number">56.4.3</span> Construcción del gráfico de facetas<a class="anchor" aria-label="anchor" href="#construcci%C3%B3n-del-gr%C3%A1fico-de-facetas"><i class="fas fa-link"></i></a>
</h3>
<p>En el primer paso se definen los estilos partiendo de <code><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_void()</a></code>, configurando los títulos, la leyenda y el color de fondo en <code><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme()</a></code>.</p>
<div class="sourceCode" id="cb823"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">theme_SST_facet</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">base_family</span> <span class="op">=</span> <span class="st">"Bahnschrift"</span>,</span>
<span>                            <span class="va">base_size</span> <span class="op">=</span> <span class="fl">11</span>, </span>
<span>                            <span class="va">base_line_size</span> <span class="op">=</span> <span class="va">base_size</span><span class="op">/</span><span class="fl">22</span>, </span>
<span>                            <span class="va">base_rect_size</span> <span class="op">=</span> <span class="va">base_size</span><span class="op">/</span><span class="fl">22</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_void</a></span><span class="op">(</span>base_family <span class="op">=</span> <span class="va">base_family</span>, base_size <span class="op">=</span> <span class="va">base_size</span>,</span>
<span>           base_line_size <span class="op">=</span> <span class="va">base_line_size</span>, base_rect_size <span class="op">=</span> <span class="va">base_rect_size</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>strip.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"white"</span>, </span>
<span>                                  face <span class="op">=</span> <span class="st">"bold"</span>,</span>
<span>                                  size <span class="op">=</span> <span class="fl">12</span>, </span>
<span>                                  margin <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">margin</a></span><span class="op">(</span>b <span class="op">=</span> <span class="fl">15</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        legend.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span>,</span>
<span>        legend.position <span class="op">=</span> <span class="st">"top"</span>,</span>
<span>        legend.justification <span class="op">=</span> <span class="fl">.48</span>,</span>
<span>        plot.margin <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">margin</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">20</span>, <span class="fl">20</span>, <span class="fl">20</span><span class="op">)</span>,</span>
<span>        plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"white"</span>, size <span class="op">=</span> <span class="fl">30</span>, hjust <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span>,</span>
<span>        plot.subtitle <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"white"</span>, size <span class="op">=</span> <span class="fl">15</span>, hjust <span class="op">=</span> <span class="fl">.5</span>,</span>
<span>                                     margin <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">margin</a></span><span class="op">(</span>t <span class="op">=</span> <span class="fl">5</span>, b <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        plot.caption <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"white"</span>, size <span class="op">=</span> <span class="fl">10</span>, hjust <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span>        plot.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_rect</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"grey10"</span>, colour <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span>,</span>
<span>        panel.spacing <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">2</span>, <span class="st">"lines"</span><span class="op">)</span>,</span>
<span>        panel.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_rect</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"grey10"</span>, colour <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Para representar datos ráster en forma de <code>xyz</code> se utiliza <code><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html">geom_tile()</a></code> o <code><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html">geom_raster()</a></code> en <code>ggplot2</code>. La última geometría requiere una rejilla regular. Para este primer ensayo se filtra sólo el año 2003 y, además, se añade, con <code><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf()</a></code>, el límite del mar Mediterráneo. La función <code><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">coord_sf()</a></code> permite fijar una proyección para objetos <code>sf</code> y, por último, se cambia el estilo definido anteriormente.</p>
<div class="sourceCode" id="cb824"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">yr</span> <span class="op">==</span> <span class="st">"2003"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html">geom_tile</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, fill <span class="op">=</span> <span class="va">anom2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">med_limit</span>, </span>
<span>          fill <span class="op">=</span> <span class="cn">NA</span>, colour <span class="op">=</span> <span class="st">"white"</span>, size <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">coord_sf</a></span><span class="op">(</span>crs <span class="op">=</span> <span class="fl">3035</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme_SST_facet</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Siguiendo el ejemplo, se modifica la gama de colores con <code><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_fill_gradientn()</a></code>, en la que se pasa la paleta de colores, los valores mínimo y máximo tras el re-escalamiento (en este caso -2 y 2), se reajustan los valores a una escala divergente y se definen las etiquetas y sus posiciones. Dentro de la función <code><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides()</a></code>, se cambia el ancho y altura de la barra colores empleando la función <code><a href="https://ggplot2.tidyverse.org/reference/guide_colourbar.html">guide_colorbar()</a></code>.</p>
<p>Las geometrías <code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point()</a></code> y <code><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text()</a></code> añaden la información de la anomalía global. La posición se pasa de forma directa en <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code>; además, se definen el color y el tamaño de texto. El objetivo es situar el texto a la derecha del punto. Por esa razón, es necesario un ajuste en longitud indicando un valor correspondiente en el argumento <code>nudge_x</code> en la unidad del sistema de coordenadas (SC). Recuérdese que el SC está en metros.</p>
<p>La función <code><a href="https://scales.r-lib.org/reference/number.html">number()</a></code> del paquete <code>scales</code> facilita formatear las cifras con un decimal y los símbolos negativo y positivo.</p>
<div class="sourceCode" id="cb825"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># gama de colores</span></span>
<span><span class="va">rdbu_pal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/flip.html">rev</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html">brewer.pal</a></span><span class="op">(</span><span class="fl">11</span>, <span class="st">"RdBu"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># mapa 2003</span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">yr</span> <span class="op">==</span> <span class="st">"2003"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html">geom_tile</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, fill <span class="op">=</span> <span class="va">anom2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">med_limit</span>, </span>
<span>          fill <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>          colour <span class="op">=</span> <span class="st">"white"</span>,</span>
<span>          size <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">med_anom</span>, <span class="va">yr</span> <span class="op">==</span> <span class="st">"2003"</span><span class="op">)</span>,</span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">pos_global</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">]</span>, y <span class="op">=</span> <span class="va">pos_global</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">]</span>, fill <span class="op">=</span> <span class="va">mean</span><span class="op">)</span>,</span>
<span>             size <span class="op">=</span> <span class="fl">3.5</span>, shape <span class="op">=</span> <span class="fl">21</span>, colour <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">med_anom</span>, <span class="va">yr</span> <span class="op">==</span> <span class="st">"2003"</span><span class="op">)</span>,</span>
<span>            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">pos_global</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">]</span>, y <span class="op">=</span> <span class="va">pos_global</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">]</span>, </span>
<span>                label <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/number.html">number</a></span><span class="op">(</span><span class="va">mean</span>, <span class="fl">.1</span>, style_positive <span class="op">=</span> <span class="st">"plus"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>            size <span class="op">=</span> <span class="fl">3.5</span>, nudge_x <span class="op">=</span> <span class="fl">700000</span>, colour <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_fill_gradientn</a></span><span class="op">(</span>colours <span class="op">=</span> <span class="va">rdbu_pal</span>, na.value <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>                       values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/rescale.html">rescale</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">0</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                       limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>                       breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="op">-</span><span class="fl">1.5</span>, <span class="op">-</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">0.5</span>, <span class="fl">0</span>, </span>
<span>                                  <span class="fl">.5</span>, <span class="fl">1</span>, <span class="fl">1.5</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>                       labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"&lt; -2.0"</span>, <span class="st">"-1.5"</span>, <span class="st">"-1.0"</span>, <span class="st">"-0.5"</span>, <span class="st">"0.0"</span>, </span>
<span>                                  <span class="st">"0.5"</span>, <span class="st">"1.0"</span>, <span class="st">"1.5"</span>, <span class="st">"&gt; 2.0"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_colourbar.html">guide_colorbar</a></span><span class="op">(</span>barwidth <span class="op">=</span> <span class="fl">20</span>, </span>
<span>                               barheight <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">coord_sf</a></span><span class="op">(</span>crs <span class="op">=</span> <span class="fl">3035</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_SST_facet</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>En la base de datos se han añadido dos años con valores perdidos (1980 y 1981) con el objetivo de que en cada fila del mapa de facetas (paneles o pequeños gráficos) haya 10 facetas (una para cada año de la década correspondiente, aunque las facetas de 1980 y 1981 aparezcan vacías). Para que no aparezcan las facetas de 1980 y 1981, es decir, para que los límites de la cuenca mediterránea no aparezcan en las facetas de los años 1980/81, se debe repetir la geometría para todos los añosb(excepto para 1980 y 1981, lógicamente).</p>
<div class="sourceCode" id="cb826"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">med</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice</a></span><span class="op">(</span><span class="va">med_limit</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">41</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>            <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">geometry</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>             <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>yr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="fl">1982</span><span class="op">:</span><span class="fl">2022</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>A continuación, se construye todo el gráfico con todas las facetas de mapas. Lo único nuevo es la función <code><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap()</a></code>, en la que se indica la variable por la que se crean las facetas. A diferencia de <code><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid()</a></code>, esta variable permite fijar el número de filas y/o columnas. Además, se pasa una función menor<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Una función incluida en otra función.&lt;/p&gt;"><sup>299</sup></a> en la función <code><a href="https://ggplot2.tidyverse.org/reference/labeller.html">labeller()</a></code> en el mismo argumento. Esta función permite modificar las etiquetas de las facetas (aquí únicamente el texto de los años 1980/81).</p>
<div class="sourceCode" id="cb827"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># paso 1</span></span>
<span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html">geom_tile</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, fill <span class="op">=</span> <span class="va">anom2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">med</span>, fill <span class="op">=</span> <span class="cn">NA</span>, colour <span class="op">=</span> <span class="st">"white"</span>, size <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">med_anom</span>,</span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">pos_global</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">]</span>, y <span class="op">=</span> <span class="va">pos_global</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">]</span>, fill <span class="op">=</span> <span class="va">mean</span><span class="op">)</span>,</span>
<span>             size <span class="op">=</span> <span class="fl">3.5</span>, shape <span class="op">=</span> <span class="fl">21</span>, colour <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">med_anom</span>,</span>
<span>                <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">pos_global</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">]</span>, y <span class="op">=</span> <span class="va">pos_global</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">]</span>, </span>
<span>                    label <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/number.html">number</a></span><span class="op">(</span><span class="va">mean</span>, <span class="fl">.1</span>, style_positive <span class="op">=</span> <span class="st">"plus"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                size <span class="op">=</span> <span class="fl">3.5</span>, nudge_x <span class="op">=</span> <span class="fl">700000</span>, colour <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span></span>
<span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_fill_gradientn</a></span><span class="op">(</span>colours <span class="op">=</span> <span class="va">rdbu_pal</span>,</span>
<span>                       na.value <span class="op">=</span> <span class="cn">NA</span>, values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/rescale.html">rescale</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">0</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                       limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>                       breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="op">-</span><span class="fl">1.5</span>, <span class="op">-</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">0.5</span>, <span class="fl">0</span>, </span>
<span>                                  <span class="fl">.5</span>, <span class="fl">1</span>, <span class="fl">1.5</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>                       labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"&lt; -2.0"</span>, <span class="st">"-1.5"</span>, <span class="st">"-1.0"</span>, <span class="st">"-0.5"</span>, <span class="st">"0.0"</span>, </span>
<span>                                  <span class="st">"0.5"</span>, <span class="st">"1.0"</span>, <span class="st">"1.5"</span>, <span class="st">"&gt; 2.0"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_colourbar.html">guide_colorbar</a></span><span class="op">(</span>barwidth <span class="op">=</span> <span class="fl">20</span>, </span>
<span>                               barheight <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="va">yr</span> <span class="op">~</span> <span class="va">.</span>, </span>
<span>             ncol <span class="op">=</span> <span class="fl">10</span>,</span>
<span>             labeller <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labeller.html">labeller</a></span><span class="op">(</span>yr <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">lab</span><span class="op">)</span><span class="op">{</span> </span>
<span>               <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">lab</span> <span class="op"><a href="https://rdrr.io/pkg/terra/man/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"1980"</span>, <span class="st">"1981"</span><span class="op">)</span>, <span class="st">""</span>, <span class="va">lab</span><span class="op">)</span><span class="op">}</span><span class="op">)</span><span class="op">)</span> </span></code></pre></div>
<p>Finalmente, se combina el objeto con definiciones finales, como los títulos, el sistema de coordenadas y el estilo. Es importante indicar <code>clip = off</code>, dado que en caso contrario se cortan visualmente los valores de las anomalías globales al encontrarse fuera de los límites de cada mapa.</p>
<div class="sourceCode" id="cb828"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># paso 2</span></span>
<span><span class="va">g</span> <span class="op">&lt;-</span> <span class="va">g</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"ANOMALÍA ESTIVAL DE LA TEMPERATURA DE SUPERFICIE DEL\nMar Mediterráneo"</span>, </span>
<span>       subtitle <span class="op">=</span> <span class="st">"Periodo de referencia 1982-2010."</span>, fill <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">coord_sf</a></span><span class="op">(</span>crs <span class="op">=</span> <span class="fl">3035</span>, clip <span class="op">=</span> <span class="st">"off"</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu">theme_SST_facet</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>A priori, no sería necesario una ampliación del resultado. No obstante, en ocasiones se requiere un mapa de orientación.</p>
</div>
<div id="mapa-de-orientación" class="section level3" number="56.4.4">
<h3>
<span class="header-section-number">56.4.4</span> Mapa de orientación<a class="anchor" aria-label="anchor" href="#mapa-de-orientaci%C3%B3n"><i class="fas fa-link"></i></a>
</h3>
<p>Los límites administrativos se obtienen (seleccionan) con el paquete <code>giscoR</code>. También se limita la extensión a aproximadamente la de la cuenca mediterránea. La función <code><a href="https://rdrr.io/pkg/rmapshaper/man/ms_innerlines.html">ms_innerlines()</a></code> del paquete <code>rmapshaper</code> facilita la obtención de los límites compartidos o interiores de los países seleccionados. Los nombres de los países, en forma de código ISO-3, se incluyen con ayuda de <code><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf_text()</a></code>.</p>
<div class="sourceCode" id="cb829"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># límites de países</span></span>
<span><span class="va">countries_med</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ropengov.github.io/giscoR/reference/gisco_get.html">gisco_get_countries</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>                    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">ISO3_CODE</span> <span class="op"><a href="https://rdrr.io/pkg/terra/man/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ESP"</span>, <span class="st">"MAR"</span>, <span class="st">"FRA"</span>, <span class="st">"ITA"</span>,</span>
<span>                                            <span class="st">"GRC"</span>, <span class="st">"TUR"</span>, <span class="st">"DZA"</span>, <span class="st">"TUN"</span>,</span>
<span>                                            <span class="st">"LBY"</span>, <span class="st">"EGY"</span>, <span class="st">"ALB"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>                     <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crop.html">st_crop</a></span><span class="op">(</span>xmin <span class="op">=</span> <span class="op">-</span><span class="fl">6</span>, xmax <span class="op">=</span> <span class="fl">36</span>, ymin <span class="op">=</span> <span class="fl">28</span>, ymax <span class="op">=</span> <span class="fl">45</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># límites inernos</span></span>
<span><span class="va">innerlimit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rmapshaper/man/ms_innerlines.html">ms_innerlines</a></span><span class="op">(</span><span class="va">countries_med</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># mapa </span></span>
<span><span class="va">insetp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">med</span>, size <span class="op">=</span> <span class="fl">.4</span>, colour <span class="op">=</span> <span class="cn">NA</span>, fill <span class="op">=</span> <span class="st">"grey90"</span><span class="op">)</span> <span class="op">+</span></span>
<span>            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">innerlimit</span>, size <span class="op">=</span> <span class="fl">.2</span>, colour <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span></span>
<span>            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf_text</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">countries_med</span>, </span>
<span>                          <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">ISO3_CODE</span><span class="op">)</span>, </span>
<span>                         size <span class="op">=</span> <span class="fl">2</span>, colour <span class="op">=</span> <span class="st">"white"</span>, fontface <span class="op">=</span> <span class="st">"bold"</span>, nudge_y <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">coord_sf</a></span><span class="op">(</span>crs <span class="op">=</span> <span class="fl">3035</span>, expand <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_void</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>plot.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>            panel.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> </span></code></pre></div>
</div>
<div id="exportación-del-mapa-final" class="section level3" number="56.4.5">
<h3>
<span class="header-section-number">56.4.5</span> Exportación del mapa final<a class="anchor" aria-label="anchor" href="#exportaci%C3%B3n-del-mapa-final"><i class="fas fa-link"></i></a>
</h3>
<p>El mapa de orientación se inserta en el gráfico, como elemento adicional, en la esquina superioe derecha. El paquete <code>patchwork</code> ayuda a crear composiciones de distinos gráficos. La función empleada, <code><a href="https://patchwork.data-imaginist.com/reference/inset_element.html">inset_element()</a></code>, indica la posición relativa en <em>xmin</em>, <em>ymin</em>, <em>xmax</em> e <em>ymax</em>. Es importante recordar que cualquier modificación del tamaño de impresión (veáse <em>height</em> y <em>width</em> en <code><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave()</a></code>) puede llevar a ajustes en la posición. El argumento <code>align_to = "full"</code> permite posicionar sobre todo el lienzo.</p>
<div class="sourceCode" id="cb830"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># paso 3</span></span>
<span><span class="va">p_final</span> <span class="op">&lt;-</span> <span class="va">g</span> <span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/inset_element.html">inset_element</a></span><span class="op">(</span><span class="va">insetp</span>, <span class="fl">0</span>, <span class="fl">.75</span>, <span class="fl">.25</span>, <span class="fl">.95</span>, align_to <span class="op">=</span> <span class="st">"full"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave</a></span><span class="op">(</span><span class="st">"sst_anom_med2.png"</span>, </span>
<span>       <span class="va">p_final</span>, </span>
<span>       bg <span class="op">=</span> <span class="st">"grey10"</span>,</span>
<span>       height <span class="op">=</span> <span class="fl">10</span>, </span>
<span>       width <span class="op">=</span> <span class="fl">20</span>, </span>
<span>       unit <span class="op">=</span> <span class="st">"in"</span>,</span>
<span>       type <span class="op">=</span> <span class="st">"cairo-png"</span>,</span>
<span>       dpi <span class="op">=</span> <span class="fl">400</span><span class="op">)</span></span></code></pre></div>
<p>El resultado final, un gráfico de paneles (o facetas), puede verse en la Fig. <a href="cambioclimatico.html#fig:sst-anom-med2">56.2</a>.
Los mapas muestran claramente el efecto del calentamiento global, siendo los años 2003 y 2022 los que muestran una mayor anomalía positiva. Destaca el hecho de que desde 1997 en todos los años se ha superado la media anual del periodo de referencia (1982-2010).</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:sst-anom-med2"></span>
<img src="img/sst_anom_med2.png" alt="Distribución espacial de las anomalías estivales de la temperatura de superficie del mar Mediterráneo." width="100%"><p class="caption">
Figura 56.2: Distribución espacial de las anomalías estivales de la temperatura de superficie del mar Mediterráneo.
</p>
</div>
<div class="inline-figure"><img src="img/LogoCDR_transparente.png" width="15%" style="display: block; margin: auto;"></div>
<!-- ::: {.infobox_resume data-latex=""} -->
<!-- **RESUMEN** -->
<!-- Una forma muy efectiva para mostrar cambios espacio-temporales son los mapas de pequeños múltiples, donde se representan los datos para cada unidad temporal, lo que permite una comparación sencilla. En este caso práctico con datos sobre el cambio climátio se han tratado las anomalías de la temperatura superficial del mar Mediterráneo en los meses estivales desde 1982 a 2022. El gráfico final muestra claramente el efecto del calentamiento global, siendo los años 2003 y 2022 los de mayor anomalía positiva. Destaca el hecho de que no ha habido un año con temperaturas más bajas de lo normal desde el año 1997.  -->
<!-- ::: -->

</div>
</div>
</div>

  <div class="chapter-nav">
<div class="prev"><a href="cap-futbol.html"><span class="header-section-number">55</span> Messi y Ronaldo: dos ídolos desde la perspectiva de los datos</a></div>
<div class="next"><a href="cap-sist-exp.html"><span class="header-section-number">57</span> Implementación de un sistema experto en el ámbito pediátrico</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="Índice del capítulo"><h2>Índice del capítulo</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#cambioclimatico"><span class="header-section-number">56</span> Una nota sobre el cambio climático</a></li>
<li><a class="nav-link" href="#introducci%C3%B3n-27"><span class="header-section-number">56.1</span> Introducción</a></li>
<li><a class="nav-link" href="#consideraciones-iniciales"><span class="header-section-number">56.2</span> Consideraciones iniciales</a></li>
<li><a class="nav-link" href="#paquetes"><span class="header-section-number">56.3</span> Paquetes</a></li>
<li>
<a class="nav-link" href="#visualizaci%C3%B3n-de-mapas-de-facetas"><span class="header-section-number">56.4</span> Visualización de mapas de facetas</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#importaci%C3%B3n-de-datos"><span class="header-section-number">56.4.1</span> Importación de datos</a></li>
<li><a class="nav-link" href="#preparaci%C3%B3n-de-los-datos"><span class="header-section-number">56.4.2</span> Preparación de los datos</a></li>
<li><a class="nav-link" href="#construcci%C3%B3n-del-gr%C3%A1fico-de-facetas"><span class="header-section-number">56.4.3</span> Construcción del gráfico de facetas</a></li>
<li><a class="nav-link" href="#mapa-de-orientaci%C3%B3n"><span class="header-section-number">56.4.4</span> Mapa de orientación</a></li>
<li><a class="nav-link" href="#exportaci%C3%B3n-del-mapa-final"><span class="header-section-number">56.4.5</span> Exportación del mapa final</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Fundamentos de ciencia de datos con <strong>R</strong></strong>" coordinado por <a href="https://blog.uclm.es/gemafaviles/" class="text-light">Gema Fernández-Avilés y José-María Montero</a>. Generado por última vez el día 2023-09-11.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>Este libro ha sido generado con el paquete de R <a class="text-light" href="https://bookdown.org">bookdown</a>.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
