<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Capítulo 53 Segmentación de clientes en el comerico minorista | Fundamentos de ciencia de datos con R</title>
<meta name="author" content="Gema Fernández-Avilés y José-María Montero">
<meta name="description" content="Jaime Fierro Martín\(^{a}\), Rocío González Martínez\(^{a}\) y Cristina Sánchez Figueroa\(^{b}\) \(^{a}\)Analyticae, SL\(^{b}\)Universidad Nacional de Educación a Distancia  53.1 Motivación y...">
<meta name="generator" content="bookdown 0.28 with bs4_book()">
<meta property="og:title" content="Capítulo 53 Segmentación de clientes en el comerico minorista | Fundamentos de ciencia de datos con R">
<meta property="og:type" content="book">
<meta property="og:image" content="/img/cover.png">
<meta property="og:description" content="Jaime Fierro Martín\(^{a}\), Rocío González Martínez\(^{a}\) y Cristina Sánchez Figueroa\(^{b}\) \(^{a}\)Analyticae, SL\(^{b}\)Universidad Nacional de Educación a Distancia  53.1 Motivación y...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Capítulo 53 Segmentación de clientes en el comerico minorista | Fundamentos de ciencia de datos con R">
<meta name="twitter:description" content="Jaime Fierro Martín\(^{a}\), Rocío González Martínez\(^{a}\) y Cristina Sánchez Figueroa\(^{b}\) \(^{a}\)Analyticae, SL\(^{b}\)Universidad Nacional de Educación a Distancia  53.1 Motivación y...">
<meta name="twitter:image" content="/img/cover.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.4.2/transition.js"></script><script src="libs/bs3compat-0.4.2/tabs.js"></script><script src="libs/bs3compat-0.4.2/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><link href="libs/tabwid-1.1.0/tabwid.css" rel="stylesheet">
<link href="libs/tabwid-1.1.0/scrool.css" rel="stylesheet">
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script><link href="libs/wordcloud2-0.0.1/wordcloud.css" rel="stylesheet">
<script src="libs/wordcloud2-0.0.1/wordcloud2-all.js"></script><script src="libs/wordcloud2-0.0.1/hover.js"></script><script src="libs/wordcloud2-binding-0.2.1/wordcloud2.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="bs4_style.css">
<link rel="stylesheet" href="bs4_book.css">
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Fundamentos de ciencia de datos con <strong>R</strong></a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Buscar" aria-label="Buscar">
</form>

      <nav aria-label="Contenido"><h2>Contenido</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Prefacio</a></li>
<li class="book-part">Ciencia, datos, software… y científicos</li>
<li><a class="" href="ciencia-datos.html"><span class="header-section-number">1</span> ¿Es la ciencia de datos una ciencia?</a></li>
<li><a class="" href="metodologia.html"><span class="header-section-number">2</span> Metodología en ciencia de datos</a></li>
<li><a class="" href="ch-110003.html"><span class="header-section-number">3</span> R para ciencia de datos</a></li>
<li><a class="" href="cap-etica.html"><span class="header-section-number">4</span> Ética en la ciencia de datos</a></li>
<li class="book-part">Bienvenidos a la jungla de datos</li>
<li><a class="" href="datos-sql.html"><span class="header-section-number">5</span> Gestión de bases de datos relacionales</a></li>
<li><a class="" href="cap-nosql.html"><span class="header-section-number">6</span> Gestión de bases de datos NoSQL</a></li>
<li><a class="" href="DGDQM.html"><span class="header-section-number">7</span> Gobierno, gestión y calidad del dato</a></li>
<li><a class="" href="id_130009.html"><span class="header-section-number">8</span> Integración y limpieza de datos</a></li>
<li><a class="" href="chap-feature.html"><span class="header-section-number">9</span> Selección y transformación de variables</a></li>
<li><a class="" href="chap-herramientas.html"><span class="header-section-number">10</span> Herramientas para el análisis en ciencia de datos</a></li>
<li><a class="" href="id_120006-aed.html"><span class="header-section-number">11</span> Análisis exploratorio de datos</a></li>
<li class="book-part">Fundamentos de estadística</li>
<li><a class="" href="Funda-probab.html"><span class="header-section-number">12</span> Probabilidad</a></li>
<li><a class="" href="Fundainfer.html"><span class="header-section-number">13</span> Inferencia estadística</a></li>
<li><a class="" href="muestreo.html"><span class="header-section-number">14</span> Muestreo y remuestreo</a></li>
<li class="book-part">Modelización estadística</li>
<li><a class="" href="cap-lm.html"><span class="header-section-number">15</span> Modelización lineal</a></li>
<li><a class="" href="cap-glm.html"><span class="header-section-number">16</span> Modelos lineales generalizados</a></li>
<li><a class="" href="cap-gam.html"><span class="header-section-number">17</span> Modelos aditivos generalizados</a></li>
<li><a class="" href="cap-mxm.html"><span class="header-section-number">18</span> Modelos mixtos</a></li>
<li><a class="" href="cap-sparse.html"><span class="header-section-number">19</span> Modelos sparse y métodos penalizados de regresión</a></li>
<li><a class="" href="cap-series-temp.html"><span class="header-section-number">20</span> Modelización de series temporales</a></li>
<li><a class="" href="cap-discriminante.html"><span class="header-section-number">21</span> Análisis discriminante</a></li>
<li><a class="" href="cap-conjunto.html"><span class="header-section-number">22</span> Análisis conjunto</a></li>
<li><a class="" href="tablas-contingencia.html"><span class="header-section-number">23</span> Análisis de tablas de contingencia</a></li>
<li class="book-part">Machine learning supervisado</li>
<li><a class="" href="cap-arboles.html"><span class="header-section-number">24</span> Árboles de clasificación y regresión</a></li>
<li><a class="" href="cap-svm.html"><span class="header-section-number">25</span> Máquinas de vector soporte</a></li>
<li><a class="" href="cap-knn.html"><span class="header-section-number">26</span> Clasificador \(k\)-vecinos más próximos</a></li>
<li><a class="" href="cap-naive-bayes.html"><span class="header-section-number">27</span> Naive Bayes</a></li>
<li><a class="" href="cap-bagg-rf.html"><span class="header-section-number">28</span> Métodos ensamblados: bagging y random forest</a></li>
<li><a class="" href="cap-boosting-xgboost.html"><span class="header-section-number">29</span> Boosting y el algoritmo XGBoost</a></li>
<li class="book-part">Machine learning no supervisado</li>
<li><a class="" href="an%C3%A1lisis-cl%C3%BAster-clusterizaci%C3%B3n-jer%C3%A1rquica.html"><span class="header-section-number">30</span> Análisis clúster: clusterización jerárquica</a></li>
<li><a class="" href="no-jerarquico.html"><span class="header-section-number">31</span> Análisis clúster: clusterización no jerárquica</a></li>
<li><a class="" href="acp.html"><span class="header-section-number">32</span> Análisis de componentes principales</a></li>
<li><a class="" href="an%C3%A1lisis-factorial.html"><span class="header-section-number">33</span> Análisis factorial</a></li>
<li><a class="" href="escalamiento-multidimensional.html"><span class="header-section-number">34</span> Escalamiento multidimensional</a></li>
<li><a class="" href="correspondencias.html"><span class="header-section-number">35</span> Análisis de correspondencias</a></li>
<li class="book-part">Deep learning</li>
<li><a class="" href="capNN.html"><span class="header-section-number">36</span> Redes neuronales artificiales</a></li>
<li><a class="" href="cap-redes-convol.html"><span class="header-section-number">37</span> Redes neuronales convolucionales</a></li>
<li class="book-part">Ciencia de datos de texto y redes</li>
<li><a class="" href="mineria-textos.html"><span class="header-section-number">38</span> Minería de textos</a></li>
<li><a class="" href="grafos.html"><span class="header-section-number">39</span> Análisis de grafos y redes sociales</a></li>
<li class="book-part">Ciencia de datos espaciales</li>
<li><a class="" href="datos-espaciales.html"><span class="header-section-number">40</span> Trabajando con datos espaciales</a></li>
<li><a class="" href="geo.html"><span class="header-section-number">41</span> Geoestadística</a></li>
<li><a class="" href="cap-econom-esp.html"><span class="header-section-number">42</span> Modelos econométricos espaciales</a></li>
<li><a class="" href="cap-pp.html"><span class="header-section-number">43</span> Procesos de puntos</a></li>
<li class="book-part">Comunica y colabora</li>
<li><a class="" href="id_120007-informes.html"><span class="header-section-number">44</span> Informes reproducibles con R Markdown y Quarto</a></li>
<li><a class="" href="shiny.html"><span class="header-section-number">45</span> Creación de aplicaciones web interactivas con Shiny</a></li>
<li><a class="" href="github.html"><span class="header-section-number">46</span> Git y GitHub R</a></li>
<li><a class="" href="geoproces.html"><span class="header-section-number">47</span> Geoprocesamiento en nube</a></li>
<li class="book-part">Casos de estudio en ciencia de datos</li>
<li><a class="" href="cap-crimen.html"><span class="header-section-number">48</span> Análisis de una red criminal</a></li>
<li><a class="" href="cap-publicidad.html"><span class="header-section-number">49</span> Optimización de inversiones publicitarias</a></li>
<li><a class="" href="cap-twitter.html"><span class="header-section-number">50</span> ¿Cómo twitea Elon Musk?</a></li>
<li><a class="" href="cap-periodismo.html"><span class="header-section-number">51</span> Análisis electoral: de Rstudio a su periódico</a></li>
<li><a class="" href="paro-clm.html"><span class="header-section-number">52</span> El impacto de las crisis financiera y de la COVID en el paro de Castilla-La Mancha</a></li>
<li><a class="active" href="cap-rfm.html"><span class="header-section-number">53</span> Segmentación de clientes en el comerico minorista</a></li>
<li><a class="" href="cap-medicina.html"><span class="header-section-number">54</span> Análisis de datos en medicina</a></li>
<li><a class="" href="cap-futbol.html"><span class="header-section-number">55</span> Messi y Ronaldo: dos ídolos desde la perspectiva de los datos</a></li>
<li><a class="" href="cambioclimatico.html"><span class="header-section-number">56</span> Una nota sobre el cambio climático</a></li>
<li><a class="" href="cap-sist-exp.html"><span class="header-section-number">57</span> Implementación de un sistema experto en el ámbito pediátrico</a></li>
<li><a class="" href="cap-ree.html"><span class="header-section-number">58</span> Predicción de consumo eléctrico con redes neuronales artificiales</a></li>
<li><a class="" href="nlp-textil.html"><span class="header-section-number">59</span> El procesamiento del lenguaje natural para tendencias de moda en textil</a></li>
<li><a class="" href="cap-fraude.html"><span class="header-section-number">60</span> Detección de fraude de tarjetas de crédito</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="cap-rfm" class="section level1" number="53">
<h1>
<span class="header-section-number">Capítulo 53</span> Segmentación de clientes en el comerico minorista<a class="anchor" aria-label="anchor" href="#cap-rfm"><i class="fas fa-link"></i></a>
</h1>
<p><em>Jaime Fierro Martín</em><span class="math inline">\(^{a}\)</span>, <em>Rocío González Martínez</em><span class="math inline">\(^{a}\)</span> y <em>Cristina Sánchez Figueroa</em><span class="math inline">\(^{b}\)</span></p>
<p><span class="math inline">\(^{a}\)</span>Analyticae, SL<br><span class="math inline">\(^{b}\)</span>Universidad Nacional de Educación a Distancia</p>
<div id="motivación-y-conceptos-clave" class="section level2" number="53.1">
<h2>
<span class="header-section-number">53.1</span> Motivación y conceptos clave<a class="anchor" aria-label="anchor" href="#motivaci%C3%B3n-y-conceptos-clave"><i class="fas fa-link"></i></a>
</h2>
<p>Los comercios minoristas (<em>retailers</em>) se mueven en un entorno
turbulento y necesitan acercarse a sus clientes para asegurar su
supervivencia. Su producto, o servicio, es nexo clave en dicho proceso.
En este contexto, conocer el <strong>perfil de los
clientes</strong> permitirá detectar en qué
momento de su ciclo de vida con la empresa se encuentran y desarrollar
propuestas de valor que convengan en cada momento.</p>
<p><strong>Segmentar</strong> se define como el proceso de dividir a
los clientes, actuales o potenciales, en diferentes grupos o segmentos
consistentes en individuos con características y niveles similares de
interés (véase el Cap. <a href="no-jerarquico.html#no-jerarquico">31</a>) para una explicación detallada de
las técnicas del clúster no jerárquico). Es un proceso creativo e iterativo con el fin de satisfacer con
mayor acierto las necesidades de los clientes, proporcionando una
ventaja competitiva y sostenible a la compañía. La segmentación viene
dada por las necesidades de los clientes, no de la compañía, y debería
ser revisada periódicamente.</p>
<p>Este caso práctico de negocio está basado en un proyecto real impulsado
por el departamento de marketing de una empresa del sector <em>retail</em> que
necesitaba mejorar el conocimiento de sus clientes, agrupándolos en
función de su comportamiento de compra. Los resultados obtenidos fueron
clave para definir la estrategia de marketing relacional de la compañía.</p>
</div>
<div id="el-modelo-rfm-tradicional" class="section level2" number="53.2">
<h2>
<span class="header-section-number">53.2</span> El modelo RFM tradicional<a class="anchor" aria-label="anchor" href="#el-modelo-rfm-tradicional"><i class="fas fa-link"></i></a>
</h2>
<p>El <strong>modelo RFM</strong> (<em>recency</em>, <em>frequency</em>, <em>monetary</em>) es una técnica popular que se
utiliza para analizar el comportamiento de compra de los clientes: cómo
compran, su frecuencia de compra y cuánto gastan. Es un método útil para
enriquecer la segmentación de los clientes en varios grupos que permitan
la personalización e identificación de los clientes más proclives a
responder a las promociones. El análisis RFM depende de las medidas de
actualidad <strong>(<em>recency</em>)</strong> (R), frecuencia
<strong>(<em>frequency</em>)</strong> (F) y valor monetario
<strong>(<em>monetary</em>)</strong> (M), que son tres importantes
variables relacionadas con la compra que influyen en las posibilidades
de compra futura de los clientes.</p>
<p>El <strong>modelo RFM tradicional</strong> categoriza el valor de las variables
dividiéndolas en quintiles, a partir de los cuales se calcula una
puntuación única que representa el valor del cliente. Sin embargo, no es
muy preciso. Si el intervalo de frecuencia de compras se fija entre 0 y
20, en términos de negocio podría interpretarse como que un cliente con
una sola compra será igual que otro que tenga 20. Por ello, os enfoques
de conjuntos clásicos pueden resultar poco funcionales
<span class="citation">(<a href="cap-fraude.html#ref-martinez2019comparison">Martı́nez et al. 2019</a>)</span>. En este caso práctico, se propone una mejora
en la definición de los intervalos mediante la aplicación del <strong>ranking
de percentiles</strong>. Este método, que se ha
denominado <strong>modelo RFM extendido</strong>, proporciona un procedimiento robusto para
tratar los valores atípicos (<em>outliers</em>) y además normaliza las
variables entre 0 y 1 para evitar la diferencias de peso entre las
variables, permitiendo así la correcta implementación del <strong>algoritmo de
segmentación</strong>.</p>
</div>
<div id="el-modelo-rfm-extendido" class="section level2" number="53.3">
<h2>
<span class="header-section-number">53.3</span> El modelo RFM extendido<a class="anchor" aria-label="anchor" href="#el-modelo-rfm-extendido"><i class="fas fa-link"></i></a>
</h2>
<p>Los autores de este caso práctico recomiendan seguir una metodología de
gestión de proyectos. La <strong>metodología
CRISP-DM</strong> <span class="citation">(<a href="cap-fraude.html#ref-chapman2000crisp">Chapman et al. 2000b</a>)</span>, presentada
en el Cap. <a href="metodologia.html#metodologia">2</a>, es un estándar ampliamente utilizado
en los proyectos de ciencia de datos.</p>
<p>Una vez definido el problema (mejorar el conocimiento que una empresa de
comercio minorista tiene de sus clientes, agrupándolos en función de su
comportamiento de compra), la recopilación y comprensión de los datos
(primera etapa del modelo CRISP-DM) se establece como etapa esencial
para el desarrollo del proyecto.</p>
<div id="recopilación-y-comprensión-de-los-datos" class="section level3" number="53.3.1">
<h3>
<span class="header-section-number">53.3.1</span> Recopilación y comprensión de los datos<a class="anchor" aria-label="anchor" href="#recopilaci%C3%B3n-y-comprensi%C3%B3n-de-los-datos"><i class="fas fa-link"></i></a>
</h3>
<p>Hoy en día, la mayoría de las empresas de <em>e-commerce</em> y comercio
minorista tradicional cuentan con sistemas que permiten registrar los
datos básicos de cada una de sus ventas (fecha, artículo, cantidad e
importe), asociados a un código único de cliente. La información
contenida en estos datos de compra atesora gran valor, ya que carecen
del sesgo y subjetividad propias de otras informaciones obtenidas
mediante encuestas de opinión, estudios de mercado, entrevistas y grupos
de discusión, etc. Estos datos suelen encontrarse en las plataformas ERP
(<em>Enterprise Resource Planning</em>) de gestión de pedidos y ventas o CRM
(<em>Customer Relationship Management</em>) de las empresas.</p>
<p>El lector es, o será, consciente de que la fase de extracción, carga y
limpieza de los datos es la más exigente del proyecto, y donde se
empleará gran parte de los recursos y tiempo de todo el proyecto. <strong>R</strong>
cuenta con gran cantidad de paquetes y recursos que facilitan la
extracción desde diferentes tipos de bases de datos.</p>
<p>Para este caso práctico serán necesarias las siguientes librerías:</p>
<div class="sourceCode" id="cb786"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://tidyverse.tidyverse.org">"tidyverse"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://lubridate.tidyverse.org">"lubridate"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="http://www.sthda.com/english/rpkgs/factoextra">"factoextra"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://rpkgs.datanovia.com/ggpubr/">"ggpubr"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st">"CDR"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"datos_retail"</span><span class="op">)</span></span></code></pre></div>
<p>Cualquier tipo de estudio o proyecto de ciencia de datos requiere
familiarizarse con los datos y determinar si presentan suficiente
exactitud, completitud, consistencia, credibilidad y actualidad
<span class="citation">(<a href="cap-fraude.html#ref-munoz2018calidad">Muñoz-Reja, Carretero, and Cejudo 2018</a>)</span>. Los datos de transacciones de venta registrados por
las empresas pueden contener valores perdidos,
inexactos, <em>outliers</em>, etc. Para determinar la acción a tomar, o no, de
limpieza o corrección de los datos de partida, es esencial conocer el
negocio y las consecuencias que éstas operaciones tendrán en el
resultado final de la segmentación.</p>
<p>El conjunto de datos de muestra contiene 200.000 observaciones
correspondientes a transacciones de compra. Las siguientes variables
iniciales están explicadas en el set de datos:</p>
<div class="sourceCode" id="cb787"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/headtail.html">head</a></span><span class="op">(</span><span class="va">datos_retail</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 6 x 4</span></span>
<span><span class="co">#&gt; id_ticket fecha importe_venta codigo_socio</span></span>
<span><span class="co">#&gt; &lt;chr&gt; &lt;date&gt; &lt;dbl&gt; &lt;chr&gt;</span></span>
<span><span class="co">#&gt; 1 num_1646673 2021-10-30 12.4 id_1076134</span></span>
<span><span class="co">#&gt; 2 num_2762559 2021-12-03 38.8 id_0552641</span></span>
<span><span class="co">#&gt; 3 num_0309422 2022-01-07 67.8 id_0537369</span></span></code></pre></div>
</div>
<div id="cálculo-de-las-variables-del-modelo-rfm" class="section level3" number="53.3.2">
<h3>
<span class="header-section-number">53.3.2</span> Cálculo de las variables del modelo RFM<a class="anchor" aria-label="anchor" href="#c%C3%A1lculo-de-las-variables-del-modelo-rfm"><i class="fas fa-link"></i></a>
</h3>
<p>Identificadas las variables iniciales, es necesario calcular los
factores clave del modelo RFM:</p>
<ul>
<li><p>La variable actualidad, <em>recency</em> (R), es el intervalo de tiempo
transcurrido desde la última compra de un cliente hasta la fecha de
elaboración del modelo RFM.</p></li>
<li><p>La variable frecuencia, <em>frequency</em> (F), se obtiene agrupando las
compras por cliente y contando el número total de tickets únicos.</p></li>
<li><p>La variable valor monetario, <em>monetary</em> (M), se calcula sumando
todos los importes de venta por cliente.</p></li>
</ul>
<div class="sourceCode" id="cb788"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fecha_estudio_rfm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html">ymd</a></span><span class="op">(</span><span class="st">"2022-08-01"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">rfm</span> <span class="op">&lt;-</span> <span class="va">datos_retail</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">codigo_socio</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span></span>
<span>    frecuencia <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/n_distinct.html">n_distinct</a></span><span class="op">(</span><span class="va">id_ticket</span><span class="op">)</span>,</span>
<span>    monetario <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">importe_venta</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    fecha_transaccion_reciente <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/nth.html">first</a></span><span class="op">(</span><span class="va">fecha</span>, order_by <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span><span class="op">(</span><span class="va">fecha</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>actualidad <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/time_length.html">time_length</a></span><span class="op">(</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/interval.html">interval</a></span><span class="op">(</span>start <span class="op">=</span> <span class="va">fecha_transaccion_reciente</span>, end <span class="op">=</span> <span class="va">fecha_estudio_rfm</span><span class="op">)</span>, unit <span class="op">=</span> <span class="st">"days"</span><span class="op">)</span>, .keep <span class="op">=</span> <span class="st">"unused"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb789"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/headtail.html">head</a></span><span class="op">(</span><span class="va">rfm</span><span class="op">)</span> <span class="co"># el lector puede ver las variables del Modelo RFM</span></span></code></pre></div>
</div>
<div id="breve-análisis-exploratorio-de-las-variables-del-modelo-rfm" class="section level3" number="53.3.3">
<h3>
<span class="header-section-number">53.3.3</span> Breve análisis exploratorio de las variables del modelo RFM<a class="anchor" aria-label="anchor" href="#breve-an%C3%A1lisis-exploratorio-de-las-variables-del-modelo-rfm"><i class="fas fa-link"></i></a>
</h3>
<p>Del análisis puede concluirse que:</p>
<ul>
<li><p>107.929 clientes han realizado una media de 1,85 compras, con un
importe medio total de 70,56€ y 450,4 días de media desde la última
compra hasta la fecha de realización del estudio, con una fuerte
asimetría positiva de los valores <em>frequency</em> y <em>monetary</em> (véase Fig. <a href="cap-rfm.html#fig:imagen1">53.1</a>).</p></li>
<li><p>Se detecta una gran estacionalidad de las compras, como se puede
apreciar en la agrupación de las observaciones de <em>recency</em>.
Teniendo en cuenta la fecha en la que ser realiza el análisis, los
valores obtenidos en la variable <em>recency</em> se pueden interpretar
como el periodo de ventas de la campaña navideña.</p></li>
</ul>
<div class="sourceCode" id="cb790"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">12345</span><span class="op">)</span></span>
<span><span class="va">plot_data</span> <span class="op">&lt;-</span> <span class="va">rfm</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_sample</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">2000</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="op">!</span><span class="va">codigo_socio</span>, names_to <span class="op">=</span> <span class="st">"variable"</span>, values_to <span class="op">=</span> <span class="st">"valor"</span><span class="op">)</span></span>
<span><span class="va">plot_data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">variable</span>, y <span class="op">=</span> <span class="va">valor</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>outlier.shape <span class="op">=</span> <span class="cn">NA</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html">geom_jitter</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="fl">10</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">variable</span>, ncol <span class="op">=</span> <span class="fl">6</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>strip.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>, text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">9</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:imagen1"></span>
<img src="img/Rplot01.png" alt="Box-plot de las variables RFM." width="60%"><p class="caption">
Figura 53.1: Box-plot de las variables RFM.
</p>
</div>
</div>
<div id="cálculo-del-ranking-de-percentiles" class="section level3" number="53.3.4">
<h3>
<span class="header-section-number">53.3.4</span> Cálculo del ranking de percentiles<a class="anchor" aria-label="anchor" href="#c%C3%A1lculo-del-ranking-de-percentiles"><i class="fas fa-link"></i></a>
</h3>
<p>Los valores de ranking son relativos entre clientes y no pueden ser
utilizados para objetivos de negocio, basados en valores absolutos de
puntuación por cliente.</p>
<div class="sourceCode" id="cb791"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rfm_rank</span> <span class="op">&lt;-</span> <span class="va">rfm</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span>.cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"frecuencia"</span>, <span class="st">"monetario"</span><span class="op">)</span>, <span class="va">percent_rank</span>, .names <span class="op">=</span> <span class="st">"rank_{.col}"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span>.cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"actualidad"</span><span class="op">)</span>, <span class="op">~</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/ranking.html">percent_rank</a></span><span class="op">(</span><span class="op">-</span><span class="va">.x</span><span class="op">)</span>, .names <span class="op">=</span> <span class="st">"rank_{.col}"</span><span class="op">)</span><span class="op">)</span> <span class="co"># menor recency indica mayor puntuación en rank</span></span></code></pre></div>
<p>Se podría decir que el análisis RFM combina tres atributos clave de los
clientes para construir un ranking que permite agruparlos de forma útil
para el negocio. Así, a un cliente que compró en una fecha reciente
(<em>recency</em>) se le otorgan más puntos. Si compró muchas veces (<em>frecuency</em>),
también se le coloca más arriba en el ranking. Finalmente, si gastó más
en el total de sus compras (<em>Monetary</em>), también se le puntúa más alto.
Combinando estas tres puntuaciones se obtiene un ranking RFM. Para la
elaboración de este ranking se parte del concepto de percentil. La idea
es asignar a cada cliente una puntuación según las tres variables o
factores clave del modelo RFM, de modo que los mejores clientes serán
los que tengan una puntuación mayor.</p>
<div class="sourceCode" id="cb792"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/headtail.html">head</a></span><span class="op">(</span><span class="va">rfm_rank</span><span class="op">)</span> <span class="co"># el lector puede ver la puntuación del ranking</span></span></code></pre></div>
<p>Una vez que se tienen los rankings de percentiles en las tres variables
para todos los clientes, se procede a su clusterización mediante el
método <em>k</em>-means.</p>
</div>
<div id="modelado-rfm-mediante-k-means" class="section level3" number="53.3.5">
<h3>
<span class="header-section-number">53.3.5</span> Modelado: RFM mediante <em>k</em>-means<a class="anchor" aria-label="anchor" href="#modelado-rfm-mediante-k-means"><i class="fas fa-link"></i></a>
</h3>
<p>El modelo establecido debe proporcionar una segmentación de clientes con
sentido de negocio. En este caso práctico se opta por el algoritmo de
clustering estándar que presenta la ventaja de que es muy intuitivo y
permite trabajar con grandes conjuntos de datos. Como el lector ha
podido comprobar en la Parte VI de este manual, existen otros muchos algoritmos de aprendizaje no
supervisado que pueden ser empleados.</p>
<p>El número óptimo de clústeres (o segmentos, en la jerga del marketing)
es uno de los retos a la hora de aplicar técnicas de <em>clustering</em>. No
existe una manera exclusiva de encontrar el número adecuado de clusters.
Se trata de un proceso subjetivo que depende de los datos, del tipo de
<em>clustering</em> empleado y, en este caso, de que el número elegido tenga
sentido y utilidad en el negocio. Existen numerosos métodos para
facilitar la elección del número de clústeres; entre ellos destacan el
<em>Elbow method,</em> el <em>Average silhouette method</em> y el <em>Gap statistic
method</em> (véase Cap.<a href="no-jerarquico.html#no-jerarquico">31</a>), que se pueden calcular con la función <code><a href="https://rdrr.io/pkg/factoextra/man/fviz_nbclust.html">fviz_nbclust()</a></code> del paquete
<code>factoextra</code> para realizar una buena
elección.</p>
<p>Con el método Elbow, el número óptimo de clústeres se calcula como sigue:</p>
<div class="sourceCode" id="cb793"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">muestra_clusters</span> <span class="op">&lt;-</span> <span class="va">rfm_rank</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_sample</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">5000</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">matches</a></span><span class="op">(</span><span class="st">"rank"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_nbclust.html">fviz_nbclust</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">muestra_clusters</span>, FUNcluster <span class="op">=</span> <span class="va">kmeans</span>, method <span class="op">=</span> <span class="st">"wss"</span>, k.max <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:imagen2"></span>
<img src="img/Rplot02.png" alt="Número óptimo de clusters (método Elbow)." width="60%"><p class="caption">
Figura 53.2: Número óptimo de clusters (método Elbow).
</p>
</div>
<p>En la Fig. <a href="cap-rfm.html#fig:imagen2">53.2</a> se observa que la varianza total <em>intra-cluster</em> apenas mejora a partir
del cuarto <em>cluster</em>.</p>
<p>El algoritmo de clustering <span class="math inline">\(k\)</span>-means se entrena con las variables R-F-M
normalizadas con el ranking. La salida de la función <code><a href="https://rdrr.io/r/stats/kmeans.html">kmeans()</a></code> del
paquete base <code>stats</code> es un objeto que, entre otros componentes, ofrece
un vector numérico indicativo del clúster al que pertenece cada uno
de los clientes.</p>
<div class="sourceCode" id="cb794"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">km_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/kmeans.html">kmeans</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">rfm_rank</span><span class="op">[</span>, <span class="fl">5</span><span class="op">:</span><span class="fl">7</span><span class="op">]</span>, centers <span class="op">=</span> <span class="fl">4</span>, nstart <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="va">clientes_segmentos</span> <span class="op">&lt;-</span> <span class="va">rfm_rank</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>segmento <span class="op">=</span> <span class="va">km_fit</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb795"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/headtail.html">head</a></span><span class="op">(</span><span class="va">clientes_segmentos</span><span class="op">)</span> <span class="co"># el lector puede ver el segmento al que pertence el cliente</span></span></code></pre></div>
</div>
<div id="descriptivos-e-interpretación-de-los-segmentos" class="section level3" number="53.3.6">
<h3>
<span class="header-section-number">53.3.6</span> Descriptivos e interpretación de los segmentos<a class="anchor" aria-label="anchor" href="#descriptivos-e-interpretaci%C3%B3n-de-los-segmentos"><i class="fas fa-link"></i></a>
</h3>
<p>Los segmentos obtenidos deben tener sentido y utilidad de negocio. Para
ello es imprescindible proporcionar los estadísticos descriptivos de
cada segmento y proceder a su interpretación de perfil de cliente.</p>
<div class="sourceCode" id="cb796"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">descriptivo_segmentos</span> <span class="op">&lt;-</span> <span class="va">clientes_segmentos</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">segmento</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"monetario"</span>, <span class="st">"frecuencia"</span>, <span class="st">"actualidad"</span><span class="op">)</span>,</span>
<span>    .fns <span class="op">=</span> <span class="va">mean</span>, .names <span class="op">=</span> <span class="st">"md_{.col}"</span> <span class="op">)</span>, n_clientes <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate</a></span><span class="op">(</span><span class="va">segmento</span>, <span class="va">n_clientes</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/headtail.html">head</a></span><span class="op">(</span><span class="va">descriptivo_segmentos</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 4 x 5</span></span>
<span><span class="co">#&gt; segmento n_clientes md_monetario md_frecuencia md_actualidad</span></span>
<span><span class="co">#&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 1 23551 36.2 1.07 239.</span></span>
<span><span class="co">#&gt; 2 2 23632 77.0 2.26 567.</span></span>
<span><span class="co">#&gt; 3 3 28809 128. 3.11 188.</span></span>
<span><span class="co">#&gt; 4 4 31937 39.3 1.00 757.</span></span></code></pre></div>
<p>Interpretación de los segmentos:</p>
<ul>
<li>1-<em>Nuevos probando</em>: segmento que agrupa nuevos clientes que están
realizando compras desde hace poco tiempo y tienen un gran potencial
de desarrollo. Es un segmento de clientes con interés para la
empresa.</li>
<li>2-<em>No podemos perder</em>: se trata de los clientes <em>churn</em><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;El término &lt;em&gt;customer churn&lt;/em&gt; se suele traducir como perdida de
clientes o rotación de clientes. Se compone de las palabras inglesas
&lt;em&gt;change&lt;/em&gt; (en castellano cambio) y &lt;em&gt;turn&lt;/em&gt; (en castellano abandonar).&lt;/p&gt;"><sup>293</sup></a> que
fueron buenos clientes en términos monetarios y de frecuencia pero
que hace tiempo que no realizan nuevas compras. La compañía debe
hacer un esfuerzo en recuperar estos clientes para convertirlos al
segmento TOP.</li>
<li>3-<em>Top</em>: reúne a los mejores clientes de la empresa. Son clientes
que compran con frecuencia, están activos y aportan ventas a la
compañía. Es el segmento de clientes con mayor interés para la
empresa.</li>
<li>4-<em>Una compra</em>: segmento formado por aquellos clientes que han
realizado una única compra hace tiempo. Presentan frecuencia,
actualidad y valor monetario bajo. Se trata de un segmento de
clientes con escaso interés para la compañía.</li>
</ul>
<div class="sourceCode" id="cb797"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">segmentos_descriptivo</span> <span class="op">&lt;-</span> <span class="va">clientes_segmentos</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>segmento <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span></span>
<span>    <span class="va">segmento</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">~</span> <span class="st">"1_Nuevos probando"</span>,</span>
<span>    <span class="va">segmento</span> <span class="op">==</span> <span class="fl">2</span> <span class="op">~</span> <span class="st">"2_No perder"</span>,</span>
<span>    <span class="va">segmento</span> <span class="op">==</span> <span class="fl">3</span> <span class="op">~</span> <span class="st">"3_Top"</span>,</span>
<span>    <span class="va">segmento</span> <span class="op">==</span> <span class="fl">4</span> <span class="op">~</span> <span class="st">"4_Una compra"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">segmento</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span> .cols <span class="op">=</span> <span class="fu">where</span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span>, .fns <span class="op">=</span> <span class="va">mean</span><span class="op">)</span>,</span>
<span>            n_clientes <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate</a></span><span class="op">(</span><span class="va">segmento</span>, <span class="va">n_clientes</span><span class="op">)</span></span>
<span></span>
<span><span class="va">table_dot_plot</span> <span class="op">&lt;-</span> <span class="va">segmentos_descriptivo</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"rank_monetario"</span>, <span class="st">"rank_frecuencia"</span>, <span class="st">"rank_actualidad"</span><span class="op">)</span>, names_to <span class="op">=</span> <span class="st">"Variable RFM"</span>, values_to <span class="op">=</span> <span class="st">"Puntuación"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggdotchart.html">ggdotchart</a></span><span class="op">(</span><span class="va">table_dot_plot</span>, x <span class="op">=</span> <span class="st">"Variable RFM"</span>, y <span class="op">=</span> <span class="st">"Puntuación"</span>,</span>
<span>  group <span class="op">=</span> <span class="st">"segmento"</span>, color <span class="op">=</span> <span class="st">"segmento"</span>, palette <span class="op">=</span> <span class="st">"jco"</span>,</span>
<span>  add <span class="op">=</span> <span class="st">"segment"</span>, position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html">position_dodge</a></span><span class="op">(</span><span class="fl">0.3</span><span class="op">)</span>,</span>
<span>  sorting <span class="op">=</span> <span class="st">"none"</span>, facet.by <span class="op">=</span> <span class="st">"segmento"</span>, dot.size <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  rotate <span class="op">=</span> <span class="cn">TRUE</span>, legend <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></code></pre></div>
<p>La Fig <a href="cap-rfm.html#fig:imagen3">53.3</a> muestra cada uno de los segmentos indicados. El ranking obtenido ayuda a identificar las diferencias en los tipos de clientes y es útil para decidir a qué segmentos enfocarse y qué estrategias usar para cada uno.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:imagen3"></span>
<img src="img/Rplot03.png" alt="Lollipop de variables RFM." width="55%"><p class="caption">
Figura 53.3: Lollipop de variables RFM.
</p>
</div>
</div>
<div id="puesta-en-producción" class="section level3" number="53.3.7">
<h3>
<span class="header-section-number">53.3.7</span> Puesta en producción<a class="anchor" aria-label="anchor" href="#puesta-en-producci%C3%B3n"><i class="fas fa-link"></i></a>
</h3>
<p>Calculado el modelo RFM <span class="math inline">\(k\)</span>-means, la compañía puede incorporar
periódicamente los datos de los clientes nuevos o actualizarlos. De este
modo, los segmentos de clientes se actualizarán y, más allá de las
acciones de <em>marketing mix</em> que realicen las compañías gracias a la
segmentación, podrán analizarse las migraciones de clientes entre los
diferentes segmentos en el periodo estudiado. La función <code>cl_predict()</code>
facilita la actualización periódica de los segmentos con el modelo
entrenado.</p>
<div class="inline-figure"><img src="img/LogoCDR_transparente.png" width="15%" style="display: block; margin: auto;"></div>

</div>
</div>
</div>

  <div class="chapter-nav">
<div class="prev"><a href="paro-clm.html"><span class="header-section-number">52</span> El impacto de las crisis financiera y de la COVID en el paro de Castilla-La Mancha</a></div>
<div class="next"><a href="cap-medicina.html"><span class="header-section-number">54</span> Análisis de datos en medicina</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="Índice del capítulo"><h2>Índice del capítulo</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#cap-rfm"><span class="header-section-number">53</span> Segmentación de clientes en el comerico minorista</a></li>
<li><a class="nav-link" href="#motivaci%C3%B3n-y-conceptos-clave"><span class="header-section-number">53.1</span> Motivación y conceptos clave</a></li>
<li><a class="nav-link" href="#el-modelo-rfm-tradicional"><span class="header-section-number">53.2</span> El modelo RFM tradicional</a></li>
<li>
<a class="nav-link" href="#el-modelo-rfm-extendido"><span class="header-section-number">53.3</span> El modelo RFM extendido</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#recopilaci%C3%B3n-y-comprensi%C3%B3n-de-los-datos"><span class="header-section-number">53.3.1</span> Recopilación y comprensión de los datos</a></li>
<li><a class="nav-link" href="#c%C3%A1lculo-de-las-variables-del-modelo-rfm"><span class="header-section-number">53.3.2</span> Cálculo de las variables del modelo RFM</a></li>
<li><a class="nav-link" href="#breve-an%C3%A1lisis-exploratorio-de-las-variables-del-modelo-rfm"><span class="header-section-number">53.3.3</span> Breve análisis exploratorio de las variables del modelo RFM</a></li>
<li><a class="nav-link" href="#c%C3%A1lculo-del-ranking-de-percentiles"><span class="header-section-number">53.3.4</span> Cálculo del ranking de percentiles</a></li>
<li><a class="nav-link" href="#modelado-rfm-mediante-k-means"><span class="header-section-number">53.3.5</span> Modelado: RFM mediante k-means</a></li>
<li><a class="nav-link" href="#descriptivos-e-interpretaci%C3%B3n-de-los-segmentos"><span class="header-section-number">53.3.6</span> Descriptivos e interpretación de los segmentos</a></li>
<li><a class="nav-link" href="#puesta-en-producci%C3%B3n"><span class="header-section-number">53.3.7</span> Puesta en producción</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Fundamentos de ciencia de datos con <strong>R</strong></strong>" coordinado por <a href="https://blog.uclm.es/gemafaviles/" class="text-light">Gema Fernández-Avilés y José-María Montero</a>. Generado por última vez el día 2023-09-11.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>Este libro ha sido generado con el paquete de R <a class="text-light" href="https://bookdown.org">bookdown</a>.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
