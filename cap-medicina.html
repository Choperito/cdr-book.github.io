<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Capítulo 54 Análisis de datos en medicina | Fundamentos de ciencia de datos con R</title>
<meta name="author" content="Gema Fernández-Avilés y José-María Montero">
<meta name="description" content="Alberto M. Borobia\(^{a}\) y María Jiménez-González\(^{a}\) \(^{a}\)Hospital Universitario La Paz - IdiPAZ  54.1 Justificación La aplicación de la estadística en la investigación clínica ha sido...">
<meta name="generator" content="bookdown 0.28 with bs4_book()">
<meta property="og:title" content="Capítulo 54 Análisis de datos en medicina | Fundamentos de ciencia de datos con R">
<meta property="og:type" content="book">
<meta property="og:image" content="/img/cover.png">
<meta property="og:description" content="Alberto M. Borobia\(^{a}\) y María Jiménez-González\(^{a}\) \(^{a}\)Hospital Universitario La Paz - IdiPAZ  54.1 Justificación La aplicación de la estadística en la investigación clínica ha sido...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Capítulo 54 Análisis de datos en medicina | Fundamentos de ciencia de datos con R">
<meta name="twitter:description" content="Alberto M. Borobia\(^{a}\) y María Jiménez-González\(^{a}\) \(^{a}\)Hospital Universitario La Paz - IdiPAZ  54.1 Justificación La aplicación de la estadística en la investigación clínica ha sido...">
<meta name="twitter:image" content="/img/cover.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.4.2/transition.js"></script><script src="libs/bs3compat-0.4.2/tabs.js"></script><script src="libs/bs3compat-0.4.2/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><link href="libs/tabwid-1.1.0/tabwid.css" rel="stylesheet">
<link href="libs/tabwid-1.1.0/scrool.css" rel="stylesheet">
<script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="bs4_style.css">
<link rel="stylesheet" href="bs4_book.css">
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Fundamentos de ciencia de datos con R</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Buscar" aria-label="Buscar">
</form>

      <nav aria-label="Contenido"><h2>Contenido</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Prefacio</a></li>
<li class="book-part">Ciencia, datos, software… y científicos</li>
<li><a class="" href="ciencia-datos.html"><span class="header-section-number">1</span> ¿Es la ciencia de datos una ciencia?</a></li>
<li><a class="" href="metodologia.html"><span class="header-section-number">2</span> Metodología en ciencia de datos</a></li>
<li><a class="" href="ch-110003.html"><span class="header-section-number">3</span> R para ciencia de datos</a></li>
<li><a class="" href="cap-etica.html"><span class="header-section-number">4</span> Ética en la ciencia de datos</a></li>
<li class="book-part">Bienvenidos a la jungla de datos</li>
<li><a class="" href="datos-sql.html"><span class="header-section-number">5</span> Gestión de bases de datos relacionales</a></li>
<li><a class="" href="cap-nosql.html"><span class="header-section-number">6</span> Gestión de bases de datos NoSQL</a></li>
<li><a class="" href="DGDQM.html"><span class="header-section-number">7</span> Gobierno, gestión y calidad del dato</a></li>
<li><a class="" href="id_130009.html"><span class="header-section-number">8</span> Integración y limpieza de datos</a></li>
<li><a class="" href="chap-feature.html"><span class="header-section-number">9</span> Selección y transformación de variables</a></li>
<li><a class="" href="chap-herramientas.html"><span class="header-section-number">10</span> Herramientas para el análisis en ciencia de datos</a></li>
<li><a class="" href="id_120006-aed.html"><span class="header-section-number">11</span> Análisis exploratorio de datos</a></li>
<li class="book-part">Fundamentos de estadística</li>
<li><a class="" href="Funda-probab.html"><span class="header-section-number">12</span> Probabilidad</a></li>
<li><a class="" href="Fundainfer.html"><span class="header-section-number">13</span> Inferencia estadística</a></li>
<li><a class="" href="muestreo.html"><span class="header-section-number">14</span> Muestreo y remuestreo</a></li>
<li class="book-part">Modelización estadística</li>
<li><a class="" href="cap-lm.html"><span class="header-section-number">15</span> Modelización lineal</a></li>
<li><a class="" href="cap-glm.html"><span class="header-section-number">16</span> Modelos lineales generalizados</a></li>
<li><a class="" href="cap-gam.html"><span class="header-section-number">17</span> Modelos aditivos generalizados</a></li>
<li><a class="" href="cap-mxm.html"><span class="header-section-number">18</span> Modelos mixtos</a></li>
<li><a class="" href="cap-sparse.html"><span class="header-section-number">19</span> Modelos sparse y métodos penalizados de regresión</a></li>
<li><a class="" href="cap-series-temp.html"><span class="header-section-number">20</span> Modelización de series temporales</a></li>
<li><a class="" href="cap-discriminante.html"><span class="header-section-number">21</span> Análisis discriminante</a></li>
<li><a class="" href="cap-conjunto.html"><span class="header-section-number">22</span> Análisis conjunto</a></li>
<li><a class="" href="tablas-contingencia.html"><span class="header-section-number">23</span> Análisis de tablas de contingencia</a></li>
<li class="book-part">Machine learning supervisado</li>
<li><a class="" href="cap-arboles.html"><span class="header-section-number">24</span> Árboles de clasificación y regresión</a></li>
<li><a class="" href="cap-svm.html"><span class="header-section-number">25</span> Máquinas de vector soporte</a></li>
<li><a class="" href="cap-knn.html"><span class="header-section-number">26</span> Clasificador k-vecinos más próximos</a></li>
<li><a class="" href="cap-naive-bayes.html"><span class="header-section-number">27</span> Naive Bayes</a></li>
<li><a class="" href="cap-bagg-rf.html"><span class="header-section-number">28</span> Métodos ensamblados: bagging y random forest</a></li>
<li><a class="" href="cap-boosting-xgboost.html"><span class="header-section-number">29</span> Boosting y el algoritmo XGBoost</a></li>
<li class="book-part">Machine learning no supervisado</li>
<li><a class="" href="jerarquico.html"><span class="header-section-number">30</span> Análisis cluster: clusterización jerárquica</a></li>
<li><a class="" href="no-jerarquico.html"><span class="header-section-number">31</span> Análisis cluster: clusterización no jerárquica</a></li>
<li><a class="" href="acp.html"><span class="header-section-number">32</span> Análisis de componentes principales</a></li>
<li><a class="" href="an%C3%A1lisis-factorial.html"><span class="header-section-number">33</span> Análisis factorial</a></li>
<li><a class="" href="escalamiento-multidimensional.html"><span class="header-section-number">34</span> Escalamiento multidimensional</a></li>
<li><a class="" href="correspondencias.html"><span class="header-section-number">35</span> Análisis de correspondencias</a></li>
<li class="book-part">Deep learning</li>
<li><a class="" href="capNN.html"><span class="header-section-number">36</span> Redes neuronales artificiales</a></li>
<li><a class="" href="cap-redes-convol.html"><span class="header-section-number">37</span> Redes neuronales convolucionales</a></li>
<li class="book-part">Ciencia de datos de texto y redes</li>
<li><a class="" href="mineria-textos.html"><span class="header-section-number">38</span> Minería de textos</a></li>
<li><a class="" href="grafos.html"><span class="header-section-number">39</span> Análisis de grafos y redes sociales</a></li>
<li class="book-part">Ciencia de datos espaciales</li>
<li><a class="" href="datos-espaciales.html"><span class="header-section-number">40</span> Trabajando con datos espaciales</a></li>
<li><a class="" href="geo.html"><span class="header-section-number">41</span> Geoestadística</a></li>
<li><a class="" href="cap-econom-esp.html"><span class="header-section-number">42</span> Modelos econométricos espaciales</a></li>
<li><a class="" href="cap-pp.html"><span class="header-section-number">43</span> Procesos de puntos</a></li>
<li class="book-part">Comunica y colabora</li>
<li><a class="" href="id_120007-informes.html"><span class="header-section-number">44</span> Informes reproducibles con R Markdown y Quarto</a></li>
<li><a class="" href="shiny.html"><span class="header-section-number">45</span> Creación de aplicaciones web interactivas con Shiny</a></li>
<li><a class="" href="github.html"><span class="header-section-number">46</span> Git y GitHub R</a></li>
<li><a class="" href="geoproces.html"><span class="header-section-number">47</span> Geoprocesamiento en nube</a></li>
<li class="book-part">Casos de estudio en ciencia de datos</li>
<li><a class="" href="cap-crimen.html"><span class="header-section-number">48</span> Análisis de una red criminal</a></li>
<li><a class="" href="cap-publicidad.html"><span class="header-section-number">49</span> Optimización de inversiones publicitarias</a></li>
<li><a class="" href="cap-twitter.html"><span class="header-section-number">50</span> ¿Cómo twitea Elon Musk?</a></li>
<li><a class="" href="cap-periodismo.html"><span class="header-section-number">51</span> Análisis electoral: de Rstudio a su periódico</a></li>
<li><a class="" href="paro-clm.html"><span class="header-section-number">52</span> Crisis: impacto en el paro de Castilla-La Mancha</a></li>
<li><a class="" href="cap-rfm.html"><span class="header-section-number">53</span> Segmentación de clientes en el comerico minorista</a></li>
<li><a class="active" href="cap-medicina.html"><span class="header-section-number">54</span> Análisis de datos en medicina</a></li>
<li><a class="" href="cap-futbol.html"><span class="header-section-number">55</span> Messi y Ronaldo: dos ídolos desde la perspectiva de los datos</a></li>
<li><a class="" href="cambioclimatico.html"><span class="header-section-number">56</span> Un dato sobre el cambio climático</a></li>
<li><a class="" href="cap-ree.html"><span class="header-section-number">57</span> Predicción de consumo eléctrico con redes neuronales</a></li>
<li><a class="" href="cap-sist-exp.html"><span class="header-section-number">58</span> Implementación de un sistema experto en el ámbito pediátrico</a></li>
<li><a class="" href="nlp-textil.html"><span class="header-section-number">59</span> El procesamiento del lenguaje natural para tendencias de moda en textil</a></li>
<li><a class="" href="cap-fraude.html"><span class="header-section-number">60</span> Detección de fraude de tarjetas de crédito</a></li>
<li class="book-part">Appendix</li>
<li><a class="" href="info-session.html"><span class="header-section-number">A</span> Información de la sesión</a></li>
<li><a class="" href="referncias.html">Referncias</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="cap-medicina" class="section level1" number="54">
<h1>
<span class="header-section-number">Capítulo 54</span> Análisis de datos en medicina<a class="anchor" aria-label="anchor" href="#cap-medicina"><i class="fas fa-link"></i></a>
</h1>
<p><em>Alberto M. Borobia</em><span class="math inline">\(^{a}\)</span> y <em>María Jiménez-González</em><span class="math inline">\(^{a}\)</span></p>
<p><span class="math inline">\(^{a}\)</span>Hospital Universitario La Paz - IdiPAZ</p>
<div id="justificación" class="section level2" number="54.1">
<h2>
<span class="header-section-number">54.1</span> Justificación<a class="anchor" aria-label="anchor" href="#justificaci%C3%B3n"><i class="fas fa-link"></i></a>
</h2>
<p>La aplicación de la estadística en la investigación clínica ha sido una de las herramientas clave en los últimos dos años. La pandemia mundial causada por la enfermedad por coronavirus (COVID‑19) es una enfermedad infecciosa provocada por el virus SARS-CoV-2. Drante el año 2020, más de 13 millones de casos diagnosticados en España arrojaban un diagnóstico claro: se necesita más investigación.</p>
<p>El primer apartado de este capítulo señala la importancia de la identificación de los sesgos (en concreto, del sesgo de selección) que aparecen en los estudios de investigación no aleatorizados. Tras ello, se abordará un ejemplo práctico de una de las aplicaciones más significativas de la bioestadística: el análisis de supervivencia, con el que se resuelven preguntas tan importantes cómo: ¿qué factores de riesgos están asociados a la mortalidad provocada por coronavirus?.
</p>
</div>
<div id="introducción-al-uso-de-datos-en-investigación-clínica-y-ensayos-clínicos" class="section level2" number="54.2">
<h2>
<span class="header-section-number">54.2</span> Introducción al uso de datos en investigación clínica y ensayos clínicos<a class="anchor" aria-label="anchor" href="#introducci%C3%B3n-al-uso-de-datos-en-investigaci%C3%B3n-cl%C3%ADnica-y-ensayos-cl%C3%ADnicos"><i class="fas fa-link"></i></a>
</h2>
<p>En este capítulo, y a modo ilustrativo del ámbito de la investigación clínica, se abordarán tres análisis a partir de los datos:</p>
<ul>
<li>Un análisis relativo a la eliminación de sesgos, o más concretamente, a la eliminación del sesgo de selección.</li>
<li>Un análisis relativo a la estimación e interpretación de las curvas de supervivencia.</li>
<li>Un análisis relativo a la estimación e interpretación de la Regresión de COX.</li>
</ul>
<div id="qué-es-un-ensayo-clínico" class="section level3" number="54.2.1">
<h3>
<span class="header-section-number">54.2.1</span> ¿Qué es un ensayo clínico?<a class="anchor" aria-label="anchor" href="#qu%C3%A9-es-un-ensayo-cl%C3%ADnico"><i class="fas fa-link"></i></a>
</h3>
<p>
</p>
<p>En la investigación clínica existen dos tipos de estudios: <em>estudios observacionales</em> y <em>ensayos clínicos</em>.</p>
<p>Los ensayos clínicos aleatorios se definen como el diseño experimental óptimo para proporcionar evidencia, eficacia y seguridad de una intervención <span class="citation">(<a href="referncias.html#ref-Lium3164">X. Liu et al. 2020</a>)</span>. Los tratamientos estudiados o investigados son asignados aleatoriamente en grupos que garantizan que las diferencias en los resultados después del tratamiento reflejen los efectos del mismo <span class="citation">(<a href="referncias.html#ref-rosenbaum2005observational">Rosenbaum 2005</a>)</span>. Cuando estas condiciones ideales no son posibles (falta de recursos, financiación, tiempo, etc), se definen como estudios observacionales.</p>
<p>Previo a la puesta en marcha de un ensayo clínico, es imprescindible la redacción de un <strong>Protocolo</strong> y un <strong>Plan de Análisis Estadístico (PAE)</strong>.</p>
<ul>
<li><p>El protocolo, elaborado por los investigadores del estudio, precisa y justifica los métodos y planes del proceso que se llevará a cabo en el ensayo clínico <span class="citation">(<a href="referncias.html#ref-rivera2020guidelines">Rivera et al. 2020</a>)</span>.</p></li>
<li><p>El PAE detalla las características principales del eventual análisis estadístico de los datos, que deben describirse en la sección estadística del protocolo <span class="citation">(<a href="referncias.html#ref-lewis1999statistical">Lewis 1999</a>)</span>.</p></li>
</ul>
<p>Los documentos anteriormente mencionados, y el resto de directrices necesarias para un ensayo clínico, están regulados por la “Conferencia Internacional sobre armonización de requisitos técnicos para el registro de productos farmacéuticos para uso humano” (sus siglas ICH en inglés).</p>
</div>
<div id="limitaciones-de-los-estudios-observacionales" class="section level3" number="54.2.2">
<h3>
<span class="header-section-number">54.2.2</span> Limitaciones de los estudios observacionales<a class="anchor" aria-label="anchor" href="#limitaciones-de-los-estudios-observacionales"><i class="fas fa-link"></i></a>
</h3>
<p>En el apartado anterior, se puso de manifiesto la importancia de lso ensayos clínicos aleatorizados. Sin embargo, la posible falta de recursos, financiación, tiempo o materiales, dificultan la puesta en marcha y realización de los mismos.</p>
<p>En consecuencia, la puesta en práctica de la investigación puede no ser la ideal. Los estudios observacionales, sin embargo, son una herramienta elemental en circunstancias no tan óptimas, ya que permiten analizar e investigar (contra viento y marea).</p>
<p>La limitación principal de los estudios observacionales es ue introducen sesgos en el análisis. Los ensayos clínicos tienen como principal objetivo eliminar el <strong>sesgo de selección</strong>: cuando los sujetos no son asignados aleatoriamente, por ejemplo, los resultados diferentes pueden reflejar estas diferencias iniciales en lugar de los efectos de los tratamientos <span class="citation">(<a href="referncias.html#ref-rosenbaum2005observational">Rosenbaum 2005</a>)</span>.</p>
<p>
</p>
</div>
<div id="índice-de-propensión-propensity-score" class="section level3" number="54.2.3">
<h3>
<span class="header-section-number">54.2.3</span> Índice de propensión (<em>propensity score</em>)<a class="anchor" aria-label="anchor" href="#%C3%ADndice-de-propensi%C3%B3n-propensity-score"><i class="fas fa-link"></i></a>
</h3>
<p>Una solución aconsejable y recomendable ante los sesgos “escondidos” en los estudios observacionales es la técnica <em>propensity score</em> o índice de propensión. Esta técnica de emparejamiento equilibra las covariables observadas sesgadas ajustando por su índice de propensión, eliminando presumiblemente el sesgo. Habitualmente, el índice de propensión se obtiene a partir de un modelo de regresión cuya variable dependiente corresponde a la intervención o el resultado principal (por ejemplo, la muerte) y las variables independientes o covariables corresponden a las variables que puedan tener un efecto confusor en la variable dependiente [molina2015indices].</p>
</div>
<div id="ejemplo-práctico-en-r-de-un-estudio-observacional" class="section level3" number="54.2.4">
<h3>
<span class="header-section-number">54.2.4</span> Ejemplo práctico en <strong>R</strong> de un estudio observacional<a class="anchor" aria-label="anchor" href="#ejemplo-pr%C3%A1ctico-en-r-de-un-estudio-observacional"><i class="fas fa-link"></i></a>
</h3>
<p>El <em>dataset</em> sintético <code>datos_observacional</code> reproduce los datos de un hipotético estudio observacional sobre una enfermedad <strong>X</strong>. El objetivo del estudio es estudiar los factores de riesgo asociados a la mortalidad causada por esa enfermedad.</p>
<pre><code>#&gt; # A tibble: 5 × 8
#&gt;      ID fecha_hospitalizacion sexo    edad comorbilidades         fecha…¹ exitus
#&gt;   &lt;dbl&gt; &lt;dttm&gt;                &lt;chr&gt;  &lt;dbl&gt; &lt;chr&gt;                  &lt;chr&gt;    &lt;dbl&gt;
#&gt; 1     1 2015-04-17 00:00:00   Mujer     76 1 o más comorbilidades 17/04/…      1
#&gt; 2     2 2015-03-21 00:00:00   Mujer     64 1 o más comorbilidades 31/03/…      0
#&gt; 3     3 2015-04-09 00:00:00   Hombre    65 1 o más comorbilidades 16/04/…      0
#&gt; 4     4 2015-04-04 00:00:00   Hombre    77 1 o más comorbilidades 13/04/…      0
#&gt; 5     5 2015-03-24 00:00:00   Mujer     66 1 o más comorbilidades 27/03/…      0
#&gt; # … with 1 more variable: fecha_exitus &lt;dttm&gt;, and abbreviated variable name
#&gt; #   ¹​fecha_alta</code></pre>
<p>En la literatura, se ha evidenciado que las mujeres de mayor edad y con una o más comorbilidades tienen más riesgo de fallecer (exitus) por la enfermedad <strong>XX</strong>. En investigación, la estructura de
los resultados en un paper o en un informe estadístico, independientemente de la revista o PAE,
comienza en el mismo punto: una tabla resumen de las características basales de la población
objeto de estudio El paquete <code>tableone</code> (sencillo juego de palabras) integra funciones específicas para la creación de dichas tablas. La función principal de este paquete es <code><a href="https://rdrr.io/pkg/tableone/man/CreateTableOne.html">CreateTableOne()</a></code>.</p>
<div class="sourceCode" id="cb793"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/kaz-yos/tableone">"tableone"</a></span><span class="op">)</span></span>
<span><span class="va">my_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"sexo"</span>, <span class="st">"edad"</span>, <span class="st">"comorbilidades"</span><span class="op">)</span></span>
<span><span class="va">nonnormal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"edad"</span><span class="op">)</span></span>
<span><span class="va">factor_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"sexo"</span>, <span class="st">"comorbilidades"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># crea la tabla</span></span>
<span><span class="va">tab1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/tableone/man/CreateTableOne.html">CreateTableOne</a></span><span class="op">(</span></span>
<span>  vars <span class="op">=</span> <span class="va">my_vars</span>, factorVars <span class="op">=</span> <span class="va">factor_vars</span>,</span>
<span>  strata <span class="op">=</span> <span class="st">"exitus"</span>, data <span class="op">=</span> <span class="va">datos_observacional</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># imprime la tabla</span></span>
<span><span class="va">tab1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://www.math.uzh.ch/pages/spam/reference/print.html">print</a></span><span class="op">(</span><span class="va">tab1</span>,</span>
<span>  showAllLevels <span class="op">=</span> <span class="cn">TRUE</span>, formatOptions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>big.mark <span class="op">=</span> <span class="st">","</span><span class="op">)</span>,</span>
<span>  exact <span class="op">=</span> <span class="st">"stage"</span>, nonnormal <span class="op">=</span> <span class="va">nonnormal</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Para presentar la tabla de resultados formateada basta con usar la función <code>kable()</code>:</p>
<div class="sourceCode" id="cb794"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">tab1</span>,</span>
<span>  caption <span class="op">=</span> <span class="st">"Características basales de la población"</span>,</span>
<span>  col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"level"</span>, <span class="st">"Vivo"</span>, <span class="st">"Exitus"</span>, <span class="st">"p-valor"</span>, <span class="st">"test"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<caption>
<span id="tab:tabla1">Tabla 54.1: </span>Características basales de la población
</caption>
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
level
</th>
<th style="text-align:left;">
Vivo
</th>
<th style="text-align:left;">
Exitus
</th>
<th style="text-align:left;">
p-valor
</th>
<th style="text-align:left;">
test
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
n
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
79
</td>
<td style="text-align:left;">
21
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
sexo (%)
</td>
<td style="text-align:left;">
Hombre
</td>
<td style="text-align:left;">
28 (35.4)
</td>
<td style="text-align:left;">
2 ( 9.5)
</td>
<td style="text-align:left;">
0.042
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Mujer
</td>
<td style="text-align:left;">
51 (64.6)
</td>
<td style="text-align:left;">
19 (90.5)
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
edad (median [IQR])
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
64.00 [53.00, 73.00]
</td>
<td style="text-align:left;">
82.00 [72.00, 85.00]
</td>
<td style="text-align:left;">
&lt;0.001
</td>
<td style="text-align:left;">
nonnorm
</td>
</tr>
<tr>
<td style="text-align:left;">
comorbilidades (%)
</td>
<td style="text-align:left;">
1 o más comorbilidades
</td>
<td style="text-align:left;">
43 (54.4)
</td>
<td style="text-align:left;">
18 (85.7)
</td>
<td style="text-align:left;">
0.018
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
36 (45.6)
</td>
<td style="text-align:left;">
3 (14.3)
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
</tr>
</tbody>
</table></div>
<p>En la Tabla <a href="cap-medicina.html#tab:tabla1">54.1</a> y acorde a la bibliografía existente, se confirma el sesgo de selección a través del desequilibrio de la variable principal (<code>exitus</code>) en las variables <code>sexo</code>, <code>edad</code> y <code>comorbilidades</code>, evidenciado a través de la significación de éstas. Un argumento que motiva la aplicación, en este caso, de la técnica <em>propensity score</em> se fundamenta en la viabilidad de, por ejemplo, un modelo multivariante (como puede ser un modelo de predicción). La recogida de datos de un estudio observacional, como el de este ejemplo, normalmente viene dada por la disponibilidad de la población: sujetos ingresados en el Hospital por la enfermedad (en nuestro caso, coronavirus). Por tanto, esta muestra seleccionada recogerá pacientes con pronóstico más grave que la población general (mujer de mayor edad con una o más comorbilidades).</p>
<p>El paquete <code>MatchIt</code> integra las funciones principales para el ajuste de la técnica <em>propensity score</em>, concretamente la función <code><a href="https://kosukeimai.github.io/MatchIt/reference/matchit.html">matchit()</a></code> integra la teoría de <span class="citation">(<a href="referncias.html#ref-ho2007matching">D. E. Ho et al. 2007</a>)</span> para el emparejamiento óptimo de los grupos estudiados. Los argumentos más importantes de esta función son:
- <code>formula</code>: modelo de regresión que estudia la relación entre la variable principal de estudio (exitus) con las variables sesgadas (sexo, edad y comorbilidades).
- <code>method</code>: especifica el método de <em>matching</em>.
- <code>distance</code>: especifica el método para la estimación del índice de propensión.</p>
<p>La función <code><a href="https://kosukeimai.github.io/MatchIt/reference/match.data.html">get_matches()</a></code> empareja, poteriormente, las coincidencias que resultan del <code>MatchIt</code>.</p>
<p><span style="background-color:rgba(255, 203, 230, 0.8)">
<em>Nota:</em> es imprescindible que los casos del <em>dataset</em> estén completos.
</span></p>
<div class="sourceCode" id="cb795"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://kosukeimai.github.io/MatchIt/">"MatchIt"</a></span><span class="op">)</span></span>
<span><span class="va">match</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://kosukeimai.github.io/MatchIt/reference/matchit.html">matchit</a></span><span class="op">(</span><span class="va">exitus</span> <span class="op">~</span> <span class="va">edad</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/is.bool.html">as.factor</a></span><span class="op">(</span><span class="va">sexo</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/is.bool.html">as.factor</a></span><span class="op">(</span><span class="va">comorbilidades</span><span class="op">)</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"nearest"</span>, distance <span class="op">=</span> <span class="st">"mahalanobis"</span>,</span>
<span>  data <span class="op">=</span> <span class="va">datos_observacional</span></span>
<span><span class="op">)</span></span>
<span><span class="va">datos_observacional_match</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://kosukeimai.github.io/MatchIt/reference/match.data.html">get_matches</a></span><span class="op">(</span><span class="va">match</span>, <span class="va">datos_observacional</span><span class="op">)</span></span></code></pre></div>
<p>Para comprobar que el sesgo evidenciado en estudios anteriores ha desaparecido, se reproduce la tabla anterior.</p>
<div class="sourceCode" id="cb796"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tab1_corregida</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/tableone/man/CreateTableOne.html">CreateTableOne</a></span><span class="op">(</span></span>
<span>  vars <span class="op">=</span> <span class="va">my_vars</span>, factorVars <span class="op">=</span> <span class="va">factor_vars</span>,</span>
<span>  strata <span class="op">=</span> <span class="st">"exitus"</span>, data <span class="op">=</span> <span class="va">datos_observacional_match</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># se imprime en el objeto tab1_corregida</span></span>
<span><span class="va">tab1_corregida</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://www.math.uzh.ch/pages/spam/reference/print.html">print</a></span><span class="op">(</span><span class="va">tab1_corregida</span>,</span>
<span>  showAllLevels <span class="op">=</span> <span class="cn">TRUE</span>, formatOptions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>big.mark <span class="op">=</span> <span class="st">","</span><span class="op">)</span>,</span>
<span>  exact <span class="op">=</span> <span class="st">"stage"</span>, nonnormal <span class="op">=</span> <span class="va">nonnormal</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Se formatea la salida de la tabla:</p>
<div class="sourceCode" id="cb797"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">tab1_corregida</span>,</span>
<span>  caption <span class="op">=</span> <span class="st">"Características basales de la población aplicando la técnica de propensity score"</span>,</span>
<span>  col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"level"</span>, <span class="st">"Vivo"</span>, <span class="st">"Exitus"</span>, <span class="st">"p-valor"</span>, <span class="st">"test"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<caption>
<span id="tab:tab1-corregida">Tabla 54.2: </span>Características basales de la población aplicando la técnica de propensity score
</caption>
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
level
</th>
<th style="text-align:left;">
Vivo
</th>
<th style="text-align:left;">
Exitus
</th>
<th style="text-align:left;">
p-valor
</th>
<th style="text-align:left;">
test
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
n
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
21
</td>
<td style="text-align:left;">
21
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
sexo (%)
</td>
<td style="text-align:left;">
Hombre
</td>
<td style="text-align:left;">
2 ( 9.5)
</td>
<td style="text-align:left;">
2 ( 9.5)
</td>
<td style="text-align:left;">
1.000
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Mujer
</td>
<td style="text-align:left;">
19 (90.5)
</td>
<td style="text-align:left;">
19 (90.5)
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
edad (median [IQR])
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
72.00 [69.00, 84.00]
</td>
<td style="text-align:left;">
82.00 [72.00, 85.00]
</td>
<td style="text-align:left;">
0.182
</td>
<td style="text-align:left;">
nonnorm
</td>
</tr>
<tr>
<td style="text-align:left;">
comorbilidades (%)
</td>
<td style="text-align:left;">
1 o más comorbilidades
</td>
<td style="text-align:left;">
18 (85.7)
</td>
<td style="text-align:left;">
18 (85.7)
</td>
<td style="text-align:left;">
1.000
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
3 (14.3)
</td>
<td style="text-align:left;">
3 (14.3)
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
</tr>
</tbody>
</table></div>
<p>En la Tabla @ref(tab:tab1_corregida) se observa que el sesgo de selección existente en la muestra se ha resuelto equilibrando las variables (aunque reduciendo la muestra). Tras este paso previo, podría realizarse un análisis estándar de esta muestra intentando aproximarse lo máximo posible a un estudio aleatorizado.</p>
</div>
</div>
<div id="análisis-de-supervivencia" class="section level2" number="54.3">
<h2>
<span class="header-section-number">54.3</span> Análisis de supervivencia<a class="anchor" aria-label="anchor" href="#an%C3%A1lisis-de-supervivencia"><i class="fas fa-link"></i></a>
</h2>
<p>Durante la pandemia ocasionada por el SARS-CoV-2, la pregunta principal de los investigadores clínicos se centró en un mismo objetivo: factores de riesgo asociados a la mortalidad causada por COVID-19. El análisis de supervivencia ha permitido a los investigadores intentar explicar las causas más factibles que producen esa mayor probabilidad de fallecer. El análisis de supervivencia permite estudiar los factores de riesgo asociados a la mortalidad. La ventaja principal de este análisis frente a un análisis estándar (como puede ser una regresión logística) se centra en la integración en la variable respuesta del evento y del tiempo hasta el evento, que tiene como consecuencia la interpretación de “riesgo” y no de “probabilidad” en los resultados.
</p>
<p>El <em>dataset</em> utilizado, <code>datos_supervivencia</code> está incluido en el paquete <code>CDR</code> y está formado por 301 pacientes, 101 diagnosticados con infección por SARS-CoV-2 y 100 exitus.</p>
<div class="sourceCode" id="cb798"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/headtail.html">head</a></span><span class="op">(</span><span class="va">datos_supervivencia</span>, <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 5 × 7</span></span>
<span><span class="co">#&gt;      id EXITUS_TIME DIAG_COVID EXITUS N_COMORBIDITIES SEX     EDAD</span></span>
<span><span class="co">#&gt;   &lt;dbl&gt;       &lt;dbl&gt;      &lt;dbl&gt;  &lt;dbl&gt;           &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1   262           0          1      1               5 Hombre    83</span></span>
<span><span class="co">#&gt; 2   236           1          1      1               5 Hombre    72</span></span>
<span><span class="co">#&gt; 3   170          11          0      0               2 Mujer     65</span></span>
<span><span class="co">#&gt; 4   204          11          1      1               4 Hombre    80</span></span>
<span><span class="co">#&gt; 5    46          14          1      1               5 Hombre    90</span></span></code></pre></div>
<div id="estimación-y-comparación-de-curvas-de-supervivencia" class="section level3" number="54.3.1">
<h3>
<span class="header-section-number">54.3.1</span> Estimación y comparación de curvas de supervivencia<a class="anchor" aria-label="anchor" href="#estimaci%C3%B3n-y-comparaci%C3%B3n-de-curvas-de-supervivencia"><i class="fas fa-link"></i></a>
</h3>
<p>La <strong>función (o curva) de supervivencia</strong> estudia la probabilidad de que el paciente o sujeto, sobreviva a un tiempo <strong>X</strong>. El estimador más común utilizado para el ajuste de la función de supervivencia es el estimador no paramétrico <strong>Kaplan-Meier</strong> y su función escalonada. Una vez generadas estas curvas de supervivencia, existen diferentes métodos (paramétricos y no paramétricos) para su comparación. En este apartado, se utiliza la prueba de <strong>Mantel-Cox</strong> (o test <strong>Log-Rank</strong>) para el contraste de funciones.</p>
<p>Los paquetes <code>survival</code> y <code>survminer</code> integran las funciones principales de la técnica:</p>
<ul>
<li><p>La función <code><a href="https://rdrr.io/pkg/survival/man/Surv.html">Surv()</a></code>, de la librería <code>survival</code>, crea un objeto de supervivencia formado por el evento (exitus) y el tiempo hasta la ocurrencia del evento.</p></li>
<li><p>La función <code><a href="https://rdrr.io/pkg/survival/man/survfit.html">survfit()</a></code>, de la librería <code>survival</code>, estima la función de supervivencia mediante el método <em>Kaplan-Meier</em> del objeto <code>Surv</code> y los factores de riesgo asociados.</p></li>
<li>
<p>La función <code><a href="https://rdrr.io/pkg/survminer/man/ggsurvplot.html">ggsurvplot()</a></code>, genera el gráfico de la gurva de supervivencia (basada en la librería <code>ggplot2</code>). El argumento principal de la función es la función de supervivencia estimada, <code><a href="https://rdrr.io/pkg/survival/man/survfit.html">survfit()</a></code>. Los argumentos más importantes (y recomendables) a la hora de graficar la función de supervivencia son:</p>
<ul>
<li><p><code>pval</code>: muestra el p-valor correspondiente a la comparación a través del test <em>Log-Rank</em>.</p></li>
<li><p><code>conf.int</code>: muestra los intervalos de confianza de la(s) curva(s) de supervivencia.</p></li>
<li><p><code>risk.table</code>: añade el número de sujetos (absoluto o relativo) en riesgo en cada momento del periodo objeto de estudio.</p></li>
</ul>
</li>
</ul>
<p>Se cragan los paquetes</p>
<div class="sourceCode" id="cb799"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/therneau/survival">"survival"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://rpkgs.datanovia.com/survminer/index.html">"survminer"</a></span><span class="op">)</span></span></code></pre></div>
<p>Se ajusta el modelo y, posteriormente, se representa:</p>
<div class="sourceCode" id="cb800"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/survfit.html">survfit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html">Surv</a></span><span class="op">(</span><span class="va">EXITUS_TIME</span>, <span class="va">EXITUS</span><span class="op">)</span> <span class="op">~</span> <span class="va">DIAG_COVID</span>,</span>
<span>  data <span class="op">=</span> <span class="va">datos_supervivencia</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/survminer/man/ggsurvplot.html">ggsurvplot</a></span><span class="op">(</span><span class="va">fit</span>,</span>
<span>  data <span class="op">=</span> <span class="va">datos_supervivencia</span>,</span>
<span>  pval <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  conf.int <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  ggtheme <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  palette <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#E7B800"</span>, <span class="st">"#2E9FDF"</span><span class="op">)</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">"Tiempo (días)"</span>,</span>
<span>  ylab <span class="op">=</span> <span class="st">"Probabilidad de supervivencia"</span>,</span>
<span>  legend.labs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Sano"</span>, <span class="st">"COVID"</span><span class="op">)</span>,</span>
<span>  <span class="co"># añade tabla de supervivencia</span></span>
<span>  risk.table <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  tables.height <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  tables.theme <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/survminer/man/ggsurvtheme.html">theme_cleantable</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="212051_cd_medicina_files/figure-html/survplot-1.png" width="60%" style="display: block; margin: auto;"></div>
<p>En la Fig. <a href="#fig:survplot"><strong>??</strong></a>, dónde el eje X corresponde al tiempo en días y el eje Y a la probabilidad de supervivencia, se observa que la probabilidad de supervivencia de las personas expuestas a COVID es significativamente menor (p-valor &lt; 0.001) a las personas sanas. La mediana de supervivencia (línea trazada desde el 0.5 del eje Y, correspondiente al 50% de la probabilidad de supervivencia) corresponde a los 120 días, es decir, el 50% de los sujetos diagnosticados por COVID y objeto de estudio sobrevivieron, al menos, 120 días.</p>
<p>Por tanto, se puede concluir que se ha encontrado evidencia sobre el aumento de mortalidad asociada a la enfermedad COVID-19.</p>
</div>
</div>
<div id="regresión-de-cox" class="section level2" number="54.4">
<h2>
<span class="header-section-number">54.4</span> Regresión de COX<a class="anchor" aria-label="anchor" href="#regresi%C3%B3n-de-cox"><i class="fas fa-link"></i></a>
</h2>
<p>La regresión de Cox<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;Es importante distinguir la regresión de Cox de la regresión logística (véase el Cap. &lt;a href="cap-glm.html#cap-glm"&gt;16&lt;/a&gt;). La Regresión logística relaciona la variable dependiente dicotómica con un conjunto de variables independientes sin contemplar el tiempo o contemplándolo sólo de forma estática, viendo en un punto fijo del tiempo si el suceso estudiado ha acontecido o no, pero no teniendo en consideración en qué momento ha sucedido. La Regresión de Cox proporciona un análisis más fino. No analiza, en un instante de tiempo dado, si un acontecimiento de interés ha sucedido o no, sino cuándo ha sucedido, si es que ha sucedido, y lo hace teniendo en cuenta el comportamiento de una o varias variables independientes. Es por ello que la regresión logística trabaja con la &lt;em&gt;odds ratio&lt;/em&gt; y la regresión de Cox con la &lt;em&gt;hazard ratio&lt;/em&gt;.&lt;/p&gt;'><sup>251</sup></a> o modelo de riesgos proporcionales es una técnica utilizada para el estudio del efecto de covariables sobre el tiempo hasta la ocurrencia de un evento (exitus, recaída, progresión, etc). La regresión de Cox es realmente una Regresión en la que la variable dependiente es siempre una función de riesgo o supervivencia (están íntimamente relacionadas) y los predictores son una función del tiempo y una función de las variables consideradas como explicativas. En general, se suele expresar así:
<span class="math display">\[h(t, x_1, x_2,..., x_ p)=h_0(t)+g(x_1,x_2,...,x_p),\]</span>
y más concretamente,
<span class="math display">\[h(t, x_1, x_2,..., x_ p)=h_0(t)+e^g(x_1,x_2,...,x_p),\]</span> donde <span class="math inline">\(g\)</span>, normalmente, indica una combinación lineal de las covariables o variables explicativas. Es, por tanto, una técnica semi-paramétrica.</p>
<p>La función principal para el ajuste de un modelo de regresión de Cox es <code><a href="https://rdrr.io/pkg/survival/man/coxph.html">coxph()</a></code>. Esta función, al igual que la función <code><a href="https://rdrr.io/pkg/survival/man/survfit.html">survfit()</a></code>, está formada por un objeto <code>Surv</code> y las covariables del modelo.</p>
<div class="sourceCode" id="cb801"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_cox</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/coxph.html">coxph</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html">Surv</a></span><span class="op">(</span><span class="va">EXITUS_TIME</span>, <span class="va">EXITUS</span><span class="op">)</span> <span class="op">~</span> <span class="va">DIAG_COVID</span> <span class="op">+</span> <span class="va">EDAD</span> <span class="op">+</span> <span class="va">SEX</span> <span class="op">+</span> <span class="va">N_COMORBIDITIES</span>,</span>
<span>                 data <span class="op">=</span> <span class="va">datos_supervivencia</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>
</p>
<p>El <em>output</em> principal de una regresión de Cox,
<span class="math display">\[h(t, x_1, x_2,..., x_ p),\]</span> son las <strong>razones de riesgos</strong> o *<strong>hazard ratios (HR)</strong>. Es decir, la relación entre las dos funciones de riesgo en función de los cambios operados en las variables explicativas. En concreto, la exponencial del coeficiente estimado para la va</p>
<p>El <em>output</em> principal de una regresión de Cox ,h(t, x_1, x_2,…, x_ p), son las razones de riesgos o hazard ratios (HR). Es decir, la relación entre las dos funciones de riesgo en función de los cambios operados en las variables explicativas. En concreto, la exponencial del coeficiente estimado para la variable explicativa X_i indica el incremento en el riesgo de fallecer cuando la variable explicativa aumenta en una unidad y las demás permanecen constantes. Esta razón de riesgos oscila entre 0 a <span class="math inline">\(\infty\)</span> , siendo el intervalo [0,1] una relación de riesgo bajo y [1, <span class="math inline">\(\infty\)</span> ] una relación de riesgo alto.</p>
<div class="infobox">
<p><strong>Nota</strong></p>
<ul>
<li><p>Los HR localizados entre 1 y 2 se interpretan en porcentaje. Es decir, HR = 1.5 indica a un aumento del riesgo del 50%.</p></li>
<li><p>Los HR localizados entre 2 e <span class="math inline">\(\infty\)</span> se interpretan en “veces”. Es decir, HR = 3 indica a un aumento del riesgo de 3 veces.</p></li>
<li><p>Los HR localizados entre 0 y 1 se interpretan como una reducción del riesgo del <span class="math inline">\((1-HR)\times 100 \%\)</span>. Es decir, HR = 0.8 indica a una disminución del riesgo del 20%.</p></li>
</ul>
</div>
<div class="sourceCode" id="cb802"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/summary.html">summary</a></span><span class="op">(</span><span class="va">fit_cox</span><span class="op">)</span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; coxph(formula = Surv(EXITUS_TIME, EXITUS) ~ DIAG_COVID + EDAD + </span></span>
<span><span class="co">#&gt;     SEX + N_COMORBIDITIES, data = datos_supervivencia)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   n= 271, number of events= 100 </span></span>
<span><span class="co">#&gt;    (30 observations deleted due to missingness)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                       coef  exp(coef)   se(coef)      z Pr(&gt;|z|)    </span></span>
<span><span class="co">#&gt; DIAG_COVID       1.3023581  3.6779594  0.5184547  2.512   0.0120 *  </span></span>
<span><span class="co">#&gt; EDAD             0.0006006  1.0006008  0.0116113  0.052   0.9587    </span></span>
<span><span class="co">#&gt; SEXMujer        -1.1256901  0.3244285  0.2360183 -4.770 1.85e-06 ***</span></span>
<span><span class="co">#&gt; N_COMORBIDITIES  0.1643743  1.1786554  0.0774043  2.124   0.0337 *  </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                 exp(coef) exp(-coef) lower .95 upper .95</span></span>
<span><span class="co">#&gt; DIAG_COVID         3.6780     0.2719    1.3314   10.1605</span></span>
<span><span class="co">#&gt; EDAD               1.0006     0.9994    0.9781    1.0236</span></span>
<span><span class="co">#&gt; SEXMujer           0.3244     3.0823    0.2043    0.5153</span></span>
<span><span class="co">#&gt; N_COMORBIDITIES    1.1787     0.8484    1.0127    1.3717</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Concordance= 0.815  (se = 0.025 )</span></span>
<span><span class="co">#&gt; Likelihood ratio test= 130.1  on 4 df,   p=&lt;2e-16</span></span>
<span><span class="co">#&gt; Wald test            = 117.9  on 4 df,   p=&lt;2e-16</span></span>
<span><span class="co">#&gt; Score (logrank) test = 165.9  on 4 df,   p=&lt;2e-16</span></span></code></pre></div>
<p>De la compleja salida del modelo, deben resaltarse y explicarse los siguientes puntos:</p>
<ul>
<li>Apartado 1: Fórmula del modelo, tamaño muestral y número de eventos.</li>
<li>Apartado 2: Tabla con los coeficientes del modelo y su p-valor.</li>
<li>Apartado 3: Tabla con los Hazard Ratio (exponencial de los coeficientes de la tabla anterior) y sus intervalos de confianza (lower .95 y upper .95).</li>
<li>Apartado 4: parámetros de bondad de ajuste del modelo.</li>
</ul>
<p>Por tanto, de este modelo se pueden concluir las siguientes interpretaciones:</p>
<ul>
<li><p>Un paciente diagnosticado de COVID-19 tiene 3.6 veces más riesgo de fallecer que un paciente sano.</p></li>
<li><p>Una mujer tiene un 67.6% menos riesgo de fallecer que un hombre.</p></li>
<li><p>Por cada comorbilidad, el riesgo de fallecer aumenta un 17.9%.</p></li>
</ul>
</div>
<div id="conclusión" class="section level2" number="54.5">
<h2>
<span class="header-section-number">54.5</span> Conclusión<a class="anchor" aria-label="anchor" href="#conclusi%C3%B3n"><i class="fas fa-link"></i></a>
</h2>
<p>Ha sido necesaria una pandemia mundial para que la sociedad empiece a dar visibilidad y reconocimiento no sólo a la bioestadística, sino a la investigación clínica y a la necesidad de gestionar el uso masivo de datos en salud. A pesar de los múltiples estudios y experiencias pasadas que llamaban a la prudencia y a la acción concreta si se daba una situación similar, el mundo ha sido incapaz de actuar convenientemente. Esto último se ve reflejado en el mínimo aumento de inversión, reconocimiento y notoriedad no sólo en investigación o desarrollo, sino en el apoyo a la ciencia.</p>
Es, quizá, la paradoja más extraña pero que representa el dicho popular:
<center>
La sociedad no avanzará si la ciencia no lo hace primero.
</center>

</div>
</div>

  <div class="chapter-nav">
<div class="prev"><a href="cap-rfm.html"><span class="header-section-number">53</span> Segmentación de clientes en el comerico minorista</a></div>
<div class="next"><a href="cap-futbol.html"><span class="header-section-number">55</span> Messi y Ronaldo: dos ídolos desde la perspectiva de los datos</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="Índice capítulo"><h2>Índice capítulo</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#cap-medicina"><span class="header-section-number">54</span> Análisis de datos en medicina</a></li>
<li><a class="nav-link" href="#justificaci%C3%B3n"><span class="header-section-number">54.1</span> Justificación</a></li>
<li>
<a class="nav-link" href="#introducci%C3%B3n-al-uso-de-datos-en-investigaci%C3%B3n-cl%C3%ADnica-y-ensayos-cl%C3%ADnicos"><span class="header-section-number">54.2</span> Introducción al uso de datos en investigación clínica y ensayos clínicos</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#qu%C3%A9-es-un-ensayo-cl%C3%ADnico"><span class="header-section-number">54.2.1</span> ¿Qué es un ensayo clínico?</a></li>
<li><a class="nav-link" href="#limitaciones-de-los-estudios-observacionales"><span class="header-section-number">54.2.2</span> Limitaciones de los estudios observacionales</a></li>
<li><a class="nav-link" href="#%C3%ADndice-de-propensi%C3%B3n-propensity-score"><span class="header-section-number">54.2.3</span> Índice de propensión (propensity score)</a></li>
<li><a class="nav-link" href="#ejemplo-pr%C3%A1ctico-en-r-de-un-estudio-observacional"><span class="header-section-number">54.2.4</span> Ejemplo práctico en R de un estudio observacional</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#an%C3%A1lisis-de-supervivencia"><span class="header-section-number">54.3</span> Análisis de supervivencia</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#estimaci%C3%B3n-y-comparaci%C3%B3n-de-curvas-de-supervivencia"><span class="header-section-number">54.3.1</span> Estimación y comparación de curvas de supervivencia</a></li></ul>
</li>
<li><a class="nav-link" href="#regresi%C3%B3n-de-cox"><span class="header-section-number">54.4</span> Regresión de COX</a></li>
<li><a class="nav-link" href="#conclusi%C3%B3n"><span class="header-section-number">54.5</span> Conclusión</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Fundamentos de ciencia de datos con R</strong>" coordinado por <a href="https://blog.uclm.es/gemafaviles/" class="text-light">Gema Fernández-Avilés y José-María Montero</a>. Generado por última vez el día 2023-06-16.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>Este libro ha sido generado con el paquete de R <a class="text-light" href="https://bookdown.org">bookdown</a>.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
