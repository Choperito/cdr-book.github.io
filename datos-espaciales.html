<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Capítulo 40 Trabajando con datos espaciales | Fundamentos de ciencia de datos con R</title>
<meta name="author" content="Gema Fernández-Avilés y José-María Montero">
<meta name="description" content="Gema Fernández-Avilés216 Universidad de Castilla-La Mancha   40.1 Introducción Los datos espaciales, también conocidos como datos geográficos o datos geo-referenciados, son aquellos datos...">
<meta name="generator" content="bookdown 0.28 with bs4_book()">
<meta property="og:title" content="Capítulo 40 Trabajando con datos espaciales | Fundamentos de ciencia de datos con R">
<meta property="og:type" content="book">
<meta property="og:image" content="/img/cover.png">
<meta property="og:description" content="Gema Fernández-Avilés216 Universidad de Castilla-La Mancha   40.1 Introducción Los datos espaciales, también conocidos como datos geográficos o datos geo-referenciados, son aquellos datos...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Capítulo 40 Trabajando con datos espaciales | Fundamentos de ciencia de datos con R">
<meta name="twitter:description" content="Gema Fernández-Avilés216 Universidad de Castilla-La Mancha   40.1 Introducción Los datos espaciales, también conocidos como datos geográficos o datos geo-referenciados, son aquellos datos...">
<meta name="twitter:image" content="/img/cover.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.4.2/transition.js"></script><script src="libs/bs3compat-0.4.2/tabs.js"></script><script src="libs/bs3compat-0.4.2/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><link href="libs/tabwid-1.1.0/tabwid.css" rel="stylesheet">
<link href="libs/tabwid-1.1.0/scrool.css" rel="stylesheet">
<script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="bs4_style.css">
<link rel="stylesheet" href="bs4_book.css">
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Fundamentos de ciencia de datos con R</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Buscar" aria-label="Buscar">
</form>

      <nav aria-label="Contenido"><h2>Contenido</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Prefacio</a></li>
<li class="book-part">Ciencia, datos, software… y científicos</li>
<li><a class="" href="ciencia-datos.html"><span class="header-section-number">1</span> ¿Es la ciencia de datos una ciencia?</a></li>
<li><a class="" href="metodologia.html"><span class="header-section-number">2</span> Metodología en ciencia de datos</a></li>
<li><a class="" href="ch-110003.html"><span class="header-section-number">3</span> R para ciencia de datos</a></li>
<li><a class="" href="cap-etica.html"><span class="header-section-number">4</span> Ética en la ciencia de datos</a></li>
<li class="book-part">Bienvenidos a la jungla de datos</li>
<li><a class="" href="datos-sql.html"><span class="header-section-number">5</span> Gestión de bases de datos relacionales</a></li>
<li><a class="" href="cap-nosql.html"><span class="header-section-number">6</span> Gestión de bases de datos NoSQL</a></li>
<li><a class="" href="DGDQM.html"><span class="header-section-number">7</span> Gobierno, gestión y calidad del dato</a></li>
<li><a class="" href="id_130009.html"><span class="header-section-number">8</span> Integración y limpieza de datos</a></li>
<li><a class="" href="chap-feature.html"><span class="header-section-number">9</span> Selección y transformación de variables</a></li>
<li><a class="" href="chap-herramientas.html"><span class="header-section-number">10</span> Herramientas para el análisis en ciencia de datos</a></li>
<li><a class="" href="id_120006-aed.html"><span class="header-section-number">11</span> Análisis exploratorio de datos</a></li>
<li class="book-part">Fundamentos de estadística</li>
<li><a class="" href="Funda-probab.html"><span class="header-section-number">12</span> Probabilidad</a></li>
<li><a class="" href="Fundainfer.html"><span class="header-section-number">13</span> Inferencia estadística</a></li>
<li><a class="" href="muestreo.html"><span class="header-section-number">14</span> Muestreo y remuestreo</a></li>
<li class="book-part">Modelización estadística</li>
<li><a class="" href="cap-lm.html"><span class="header-section-number">15</span> Modelización lineal</a></li>
<li><a class="" href="cap-glm.html"><span class="header-section-number">16</span> Modelos lineales generalizados</a></li>
<li><a class="" href="cap-gam.html"><span class="header-section-number">17</span> Modelos aditivos generalizados</a></li>
<li><a class="" href="cap-mxm.html"><span class="header-section-number">18</span> Modelos mixtos</a></li>
<li><a class="" href="cap-sparse.html"><span class="header-section-number">19</span> Modelos sparse y métodos penalizados de regresión</a></li>
<li><a class="" href="cap-series-temp.html"><span class="header-section-number">20</span> Modelización de series temporales</a></li>
<li><a class="" href="cap-discriminante.html"><span class="header-section-number">21</span> Análisis discriminante</a></li>
<li><a class="" href="cap-conjunto.html"><span class="header-section-number">22</span> Análisis conjunto</a></li>
<li><a class="" href="tablas-contingencia.html"><span class="header-section-number">23</span> Análisis de tablas de contingencia</a></li>
<li class="book-part">Machine learning supervisado</li>
<li><a class="" href="cap-arboles.html"><span class="header-section-number">24</span> Árboles de clasificación y regresión</a></li>
<li><a class="" href="cap-svm.html"><span class="header-section-number">25</span> Máquinas de vector soporte</a></li>
<li><a class="" href="cap-knn.html"><span class="header-section-number">26</span> Clasificador k-vecinos más próximos</a></li>
<li><a class="" href="cap-naive-bayes.html"><span class="header-section-number">27</span> Naive Bayes</a></li>
<li><a class="" href="cap-bagg-rf.html"><span class="header-section-number">28</span> Métodos ensamblados: bagging y random forest</a></li>
<li><a class="" href="cap-boosting-xgboost.html"><span class="header-section-number">29</span> Boosting y el algoritmo XGBoost</a></li>
<li class="book-part">Machine learning no supervisado</li>
<li><a class="" href="jerarquico.html"><span class="header-section-number">30</span> Análisis cluster: clusterización jerárquica</a></li>
<li><a class="" href="no-jerarquico.html"><span class="header-section-number">31</span> Análisis cluster: clusterización no jerárquica</a></li>
<li><a class="" href="acp.html"><span class="header-section-number">32</span> Análisis de componentes principales</a></li>
<li><a class="" href="an%C3%A1lisis-factorial.html"><span class="header-section-number">33</span> Análisis factorial</a></li>
<li><a class="" href="escalamiento-multidimensional.html"><span class="header-section-number">34</span> Escalamiento multidimensional</a></li>
<li><a class="" href="correspondencias.html"><span class="header-section-number">35</span> Análisis de correspondencias</a></li>
<li class="book-part">Deep learning</li>
<li><a class="" href="capNN.html"><span class="header-section-number">36</span> Redes neuronales artificiales</a></li>
<li><a class="" href="cap-redes-convol.html"><span class="header-section-number">37</span> Redes neuronales convolucionales</a></li>
<li class="book-part">Ciencia de datos de texto y redes</li>
<li><a class="" href="mineria-textos.html"><span class="header-section-number">38</span> Minería de textos</a></li>
<li><a class="" href="grafos.html"><span class="header-section-number">39</span> Análisis de grafos y redes sociales</a></li>
<li class="book-part">Ciencia de datos espaciales</li>
<li><a class="active" href="datos-espaciales.html"><span class="header-section-number">40</span> Trabajando con datos espaciales</a></li>
<li><a class="" href="geo.html"><span class="header-section-number">41</span> Geoestadística</a></li>
<li><a class="" href="cap-econom-esp.html"><span class="header-section-number">42</span> Modelos econométricos espaciales</a></li>
<li><a class="" href="cap-pp.html"><span class="header-section-number">43</span> Procesos de puntos</a></li>
<li class="book-part">Comunica y colabora</li>
<li><a class="" href="id_120007-informes.html"><span class="header-section-number">44</span> Informes reproducibles con R Markdown y Quarto</a></li>
<li><a class="" href="shiny.html"><span class="header-section-number">45</span> Creación de aplicaciones web interactivas con Shiny</a></li>
<li><a class="" href="github.html"><span class="header-section-number">46</span> Git y GitHub R</a></li>
<li><a class="" href="geoproces.html"><span class="header-section-number">47</span> Geoprocesamiento en nube</a></li>
<li class="book-part">Casos de estudio en ciencia de datos</li>
<li><a class="" href="cap-crimen.html"><span class="header-section-number">48</span> Análisis de una red criminal</a></li>
<li><a class="" href="cap-publicidad.html"><span class="header-section-number">49</span> Optimización de inversiones publicitarias</a></li>
<li><a class="" href="cap-twitter.html"><span class="header-section-number">50</span> ¿Cómo twitea Elon Musk?</a></li>
<li><a class="" href="cap-periodismo.html"><span class="header-section-number">51</span> Análisis electoral: de Rstudio a su periódico</a></li>
<li><a class="" href="paro-clm.html"><span class="header-section-number">52</span> Crisis: impacto en el paro de Castilla-La Mancha</a></li>
<li><a class="" href="cap-rfm.html"><span class="header-section-number">53</span> Segmentación de clientes en el comerico minorista</a></li>
<li><a class="" href="cap-medicina.html"><span class="header-section-number">54</span> Análisis de datos en medicina</a></li>
<li><a class="" href="cap-futbol.html"><span class="header-section-number">55</span> Messi y Ronaldo: dos ídolos desde la perspectiva de los datos</a></li>
<li><a class="" href="cambioclimatico.html"><span class="header-section-number">56</span> Un dato sobre el cambio climático</a></li>
<li><a class="" href="cap-ree.html"><span class="header-section-number">57</span> Predicción de consumo eléctrico con redes neuronales</a></li>
<li><a class="" href="cap-sist-exp.html"><span class="header-section-number">58</span> Implementación de un sistema experto en el ámbito pediátrico</a></li>
<li><a class="" href="nlp-textil.html"><span class="header-section-number">59</span> El procesamiento del lenguaje natural para tendencias de moda en textil</a></li>
<li><a class="" href="cap-fraude.html"><span class="header-section-number">60</span> Detección de fraude de tarjetas de crédito</a></li>
<li class="book-part">Appendix</li>
<li><a class="" href="info-session.html"><span class="header-section-number">A</span> Información de la sesión</a></li>
<li><a class="" href="referncias.html">Referncias</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="datos-espaciales" class="section level1" number="40">
<h1>
<span class="header-section-number">Capítulo 40</span> Trabajando con datos espaciales<a class="anchor" aria-label="anchor" href="#datos-espaciales"><i class="fas fa-link"></i></a>
</h1>
<p><em>Gema Fernández-Avilés<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Quisiera agradecer a Diego Hernangómez la ayuda prestada en la elaboración de este capítulo.&lt;/p&gt;"><sup>216</sup></a></em></p>
<p>Universidad de Castilla-La Mancha</p>
<p>
</p>
<div id="introducción-19" class="section level2" number="40.1">
<h2>
<span class="header-section-number">40.1</span> Introducción<a class="anchor" aria-label="anchor" href="#introducci%C3%B3n-19"><i class="fas fa-link"></i></a>
</h2>
<p>Los <strong>datos espaciales</strong>, también conocidos como <strong>datos geográficos</strong> o <strong>datos geo-referenciados</strong>, son aquellos datos relacionados o que contienen información de una localización o área geográfica de la superficie de la Tierra. El primer análisis de datos geoespaciales fue hecho por el médico John Snow en 1854. Éste produjo un famoso mapa que muestra las muertes causadas por un brote de cólera (que mató a 127 personas en 3 días) en Soho, Londres así como la ubicación de las bombas de agua en el área (Fig. <a href="datos-espaciales.html#fig:snow-cholera-map-ch40">40.1</a>). Snow descubrió que había un agrupamiento significativo de muertes alrededor de una determinada bomba, y al quitar la manija de la bomba se detuvo el brote. Los datos con los que trabajó Snow y aquellos que contienen coordenadas son considerados datos espaciales.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:snow-cholera-map-ch40"></span>
<img src="img/Snow-cholera-map.JPG" alt="Mapa de cólera en Londres según Snow. Fuente: Wikipedia" width="60%"><p class="caption">
Figura 40.1: Mapa de cólera en Londres según Snow. Fuente: Wikipedia
</p>
</div>
<p>El análisis espacial de Snow es considerado el antecedente más antiguo conocido de la ciencia de datos (<span class="citation">Baumer, Kaplan, and Horton (<a href="referncias.html#ref-Baumer_et_el_2021">2021</a>)</span>): (i) la información clave se obtuvo mediante la combinación de tres fuentes de datos (las muertes por cólera, las ubicaciones de las bombas de agua y el mapa de calles de Londres); (ii) se puede crear un modelo espacial directamente a partir de los datos y (iii) el problema solo se resolvió cuando la evidencia basada en datos se combinó con un modelo plausible que explicaba el fenómeno físico. Es decir, Snow era médico y su conocimiento sobre la transmisión de enfermedades fue suficiente para convencer a sus colegas de que el cólera no se transmitía por el aire.</p>
<div id="estadística-para-datos-espaciales" class="section level3" number="40.1.1">
<h3>
<span class="header-section-number">40.1.1</span> Estadística para datos espaciales<a class="anchor" aria-label="anchor" href="#estad%C3%ADstica-para-datos-espaciales"><i class="fas fa-link"></i></a>
</h3>
<p>El área que se encarga de estudiar y analizar los datos espaciales es la <strong>estadística espacial</strong> o la estadística para datos espaciales (<span class="citation">N. A. C. Cressie (<a href="referncias.html#ref-cressie1993">1993</a>)</span>, <span class="citation">José-Marı́a Montero, Fernández-Avilés, and Mateu (<a href="referncias.html#ref-montero2015spatial">2015</a>)</span>).</p>
<p>Debido a que los datos espaciales surgen en una gran variedad de campos y aplicaciones, también hay una gran variedad de tipos de datos espaciales, estructuras y escenarios <span class="citation">(<a href="referncias.html#ref-Schabenberger_Gotway_2005">Schabenberger and Gotway 2005, 6</a>)</span>. La Fig. <a href="datos-espaciales.html#fig:hengl-cressie">40.2</a> representa la clasificación de datos espaciales proporcionada por <span class="citation">N. A. C. Cressie (<a href="referncias.html#ref-cressie1993">1993</a>)</span> basada en la naturaleza del dominio espacial en estudio. Cressie distingue tres tipos de datos espaciales:</p>
<ol style="list-style-type: lower-roman">
<li><p>datos geoestadísticos,</p></li>
<li><p>datos de patrones de puntos y</p></li>
<li><p>datos lattice o reticulares. </p></li>
</ol>
<p>El estudio de los datos geoestadíticos se aborda en el Cap.<a href="geo.html#geo">41</a>, el análisis de los datos <em>lattice</em> se lleva a cabo en el Cap. <a href="cap-econom-esp.html#cap-econom-esp">42</a> dedicado a la Econometría espacial y los datos de patrones de puntos se analizan en el Cap. <a href="cap-pp.html#cap-pp">43</a>.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:hengl-cressie"></span>
<img src="img/cressie_simulados.png" alt="Clasificación de datos espaciales propuesta por Cressie (1993)" width="60%"><p class="caption">
Figura 40.2: Clasificación de datos espaciales propuesta por Cressie (1993)
</p>
</div>
</div>
</div>
<div id="conceptos-clave" class="section level2" number="40.2">
<h2>
<span class="header-section-number">40.2</span> Conceptos clave<a class="anchor" aria-label="anchor" href="#conceptos-clave"><i class="fas fa-link"></i></a>
</h2>
<p>Visto el contexto original de los datos espaciales y antes de entrar en detalle en su análisis, se debe tener en cuenta una serie de conceptos clave. La Fig. <a href="datos-espaciales.html#fig:fig-accidentes1">40.3</a>, representa la localización de los accidentes de tráfico registrados en la ciudad de Madrid durante el año 2020. Sin embargo, tal representación no aporta información útil para su análisis. Por ejemplo, sería interesante añadir un mapa de carreteras junto con la localización de los accidentes.</p>
<div class="sourceCode" id="cb596"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st">"CDR"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://tidyverse.tidyverse.org">"tidyverse"</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">accidentes2020_data</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">coordenada_x_utm</span>, y <span class="op">=</span> <span class="va">coordenada_y_utm</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>col<span class="op">=</span><span class="st">"blue"</span>, size <span class="op">=</span> <span class="fl">0.1</span>, alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html">coord_fixed</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-accidentes1"></span>
<img src="img/fig-accidentes1.png" alt="Accidentes de Tráfico en Madrid (2020)" width="60%"><p class="caption">
Figura 40.3: Accidentes de Tráfico en Madrid (2020)
</p>
</div>
<p>Ademas de las coordenadas, en la representación de geodatos es importante el marco o contexto espacial, así como el conocimiento del (i) <strong>Sistema de referencia de coordenadas</strong> o Coordinate reference system (<strong>CRS</strong>) en el que están goe-referenciadas o proyectadas las coordenadas y (ii) el tipo de datos con el que se está trabajando: vectores o ráster.</p>
<div class="sourceCode" id="cb597"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://r-spatial.github.io/sf/">"sf"</a></span><span class="op">)</span></span>
<span><span class="va">accidentes2020_sf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html">st_as_sf</a></span><span class="op">(</span><span class="va">accidentes2020_data</span>,</span>
<span>  coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"coordenada_x_utm"</span>, <span class="st">"coordenada_y_utm"</span><span class="op">)</span>,</span>
<span>  crs <span class="op">=</span> <span class="fl">25830</span> <span class="co"># proyección ETRS89/ UTM zone 30N. Área de uso: Europa  </span></span>
<span>  <span class="op">)</span>  </span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://ropenspain.github.io/mapSpain/">"mapSpain"</a></span><span class="op">)</span></span>
<span><span class="va">madrid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ropenspain.github.io/mapSpain/reference/esp_get_munic.html">esp_get_munic</a></span><span class="op">(</span>munic <span class="op">=</span> <span class="st">"^Madrid$"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html">st_transform</a></span><span class="op">(</span><span class="fl">25830</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># descara imagen de un de mapa estático de las carreteas de Madrid</span></span>
<span><span class="va">tile</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ropenspain.github.io/mapSpain/reference/esp_getTiles.html">esp_getTiles</a></span><span class="op">(</span><span class="va">madrid</span>, <span class="st">"IDErioja"</span>, zoommin <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>  </span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">tidyterra</span><span class="fu">::</span><span class="fu"><a href="https://dieghernan.github.io/tidyterra/reference/geom_spatraster_rgb.html">geom_spatraster_rgb</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">tile</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">accidentes2020_sf</span>, </span>
<span>    col <span class="op">=</span> <span class="st">"blue"</span>, size <span class="op">=</span> <span class="fl">0.1</span>, alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">coord_sf</a></span><span class="op">(</span>expand <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-accidentes2"></span>
<img src="img/accidentes2.png" alt="Accidentes de tráfico en Madrid proyectados y con mapa de carreteras (2020)" width="60%"><p class="caption">
Figura 40.4: Accidentes de tráfico en Madrid proyectados y con mapa de carreteras (2020)
</p>
</div>
<p>La Fig. <a href="datos-espaciales.html#fig:fig-accidentes2">40.4</a> permite observar ciertos patrones en la ocurrencia de accidentes. Por ejemplo, apenas se producen accidentes en la Casa de Campo o en el Monte del Pardo, y parece observarse cierta concentración en la ciudad y en las autopistas de salida de la ciudad.</p>
<div id="CRS" class="section level3" number="40.2.1">
<h3>
<span class="header-section-number">40.2.1</span> Sistema de referencia de coordenadas<a class="anchor" aria-label="anchor" href="#CRS"><i class="fas fa-link"></i></a>
</h3>
<p>Los CRS permiten identificar con exactitud la posición de los datos sobre el globo terráqueo. Cuando se trabaja con datos espaciales provenientes de distintas fuentes de información es necesario comprobar que dichos datos se encuentran definidos en el mismo CRS. Ésto se consigue transformando (o proyectando) los datos a un CRS común. Una buena referencia para profundizar este tema es el Cap. 2 de <span class="citation">E. Pebesma and Bivand (<a href="referncias.html#ref-pebesma2022spatial">2022b</a>)</span>.</p>
<p>En la Fig. <a href="datos-espaciales.html#fig:plot-puertos-error">40.5</a> se muestran los puertos en un mapa mundial. Todos los vienen representados por el punto rojo. ¿A qué se debe? A que los datos están en distintos CRS.</p>
<div class="sourceCode" id="cb598"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://ropengov.github.io/giscoR/">"giscoR"</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">paises</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ropengov.github.io/giscoR/reference/gisco_get.html">gisco_get_countries</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">puertos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ropengov.github.io/giscoR/reference/gisco_get_airports.html">gisco_get_ports</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">paises_robin</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html">st_transform</a></span><span class="op">(</span><span class="va">paises</span>, <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html">st_crs</a></span><span class="op">(</span><span class="st">"ESRI:54030"</span><span class="op">)</span><span class="op">)</span> <span class="co">#Proyección Robinson</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html">st_geometry</a></span><span class="op">(</span><span class="va">paises_robin</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">" "</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html">st_geometry</a></span><span class="op">(</span><span class="va">puertos</span><span class="op">)</span>, add <span class="op">=</span> <span class="cn">TRUE</span>, col<span class="op">=</span><span class="st">"2"</span>, pch<span class="op">=</span><span class="fl">20</span>, lwd<span class="op">=</span><span class="fl">2.5</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:plot-puertos-error"></span>
<img src="img/mapa-mundi-ko.png" alt="Localización de los puertos en el mapamundi (distinto CRS en los puertos y el mapa)" width="80%"><p class="caption">
Figura 40.5: Localización de los puertos en el mapamundi (distinto CRS en los puertos y el mapa)
</p>
</div>
<p>Los dos tipos de CRS que existen se describen a continuación:</p>
<ol style="list-style-type: lower-roman">
<li><p><strong>Geográficos</strong>: aquellos en los que los parámetros empleados para localizar una posición espacial son la latitud (Norte-Sur [-90º,90º]) y la longitud (Este-Oeste [-180º,180º]). Están basadod en la geometría esférica. En este caso las distancias entre dos puntos son <strong>distancias angulares</strong>.</p></li>
<li><p><strong>Proyectados</strong>: permiten reducir la superficie de la esfera terrestre (3D) a un sistema cartesiano (2D). Para ello, es necesario transformar las coordenadas longitud y latitud en coordenadas cartesianas <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span>. La unidad de distancia, habitualmente, es el <strong>metro</strong>.</p></li>
</ol>
<p></p>
<p>Tras proyectar los puertos al mismo CRS que el mapamundi utilizando la proyección de Robinson (la proyección cartográficas más convencional para mapamundis), la Fig. <a href="datos-espaciales.html#fig:plot-puertos-ok">40.6</a> muestra adecuadamente el mapa de la Fig. <a href="datos-espaciales.html#fig:plot-puertos-error">40.5</a>.</p>
<div class="sourceCode" id="cb599"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html">st_crs</a></span><span class="op">(</span><span class="va">puertos</span><span class="op">)</span> <span class="op">==</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html">st_crs</a></span><span class="op">(</span><span class="va">paises_robin</span><span class="op">)</span> <span class="co"># Comprueba CRS</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span>
<span><span class="va">puertos_robin</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html">st_transform</a></span><span class="op">(</span><span class="va">puertos</span>, <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html">st_crs</a></span><span class="op">(</span><span class="va">paises_robin</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html">st_geometry</a></span><span class="op">(</span><span class="va">paises_robin</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">" "</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html">st_geometry</a></span><span class="op">(</span><span class="va">puertos_robin</span><span class="op">)</span>, add <span class="op">=</span> <span class="cn">TRUE</span>, col<span class="op">=</span><span class="fl">4</span>, pch<span class="op">=</span><span class="fl">20</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:plot-puertos-ok"></span>
<img src="img/mapa-muni-ok.png" alt="Localización de los puertos en el mapa mundi (mismo CRS puertos y mapa)" width="80%"><p class="caption">
Figura 40.6: Localización de los puertos en el mapa mundi (mismo CRS puertos y mapa)
</p>
</div>
<p><strong>¿Qué proyección uso?</strong> El CRS adecuado para cada análisis depende de la localización y el rango espacial de los datos. El paquete <code>crsuggest</code> <span class="citation">(<a href="referncias.html#ref-R-crsuggest">Walker 2022</a>)</span> facilita la labor, sugiriendo la escala de estudio o el tipo de análisis más adecuado para cada zona.</p>
</div>
<div id="formatos" class="section level3" number="40.2.2">
<h3>
<span class="header-section-number">40.2.2</span> Formatos de datos espaciales<a class="anchor" aria-label="anchor" href="#formatos"><i class="fas fa-link"></i></a>
</h3>
<p>En el ámbito del análisis espacial, el formato de datos espaciales se puede clasificar en función del modelo de datos. Se pueden distinguir dos tipos de modelos de datos <span class="citation">(<a href="referncias.html#ref-Lovelance_et_al_2019">Lovelace, Nowosad, and Münchow 2019</a>)</span>: vectoriales y ráster<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;Un análisis detallado puede verse en &lt;a href="https://mdsr-2122-visualizacion.netlify.app/"&gt;&lt;span class="citation"&gt;Hernangómez and Fernández-Avilés (&lt;span&gt;2022&lt;/span&gt;)&lt;/span&gt;&lt;/a&gt;&lt;/p&gt;'><sup>217</sup></a>.</p>
<div id="vec" class="section level4" number="40.2.2.1">
<h4>
<span class="header-section-number">40.2.2.1</span> Datos de vectores<a class="anchor" aria-label="anchor" href="#vec"><i class="fas fa-link"></i></a>
</h4>
<p>Este modelo está basado en puntos georeferenciados. Los <strong>puntos</strong> pueden representar localizaciones específicas, como la localización de los Hospitales y Centros de Salud de la ciudad de Toledo (Fig. <a href="datos-espaciales.html#fig:plot-puntos">40.7</a>).</p>
<div class="sourceCode" id="cb600"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">hosp_toledo</span>, </span>
<span>          <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"Hospitales y Centros Sanitarios"</span><span class="op">)</span>, </span>
<span>          color <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="cn">NULL</span>, fill <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"right"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:plot-puntos"></span>
<img src="img/centros-toledo.png" alt="Hospitales y Centros de Salud en Toledo" width="60%"><p class="caption">
Figura 40.7: Hospitales y Centros de Salud en Toledo
</p>
</div>
<p>Los puntos también pueden estar conectados entre sí, de manera que formen geometrías más complejas, como <strong>líneas</strong> y <strong>polígonos</strong>.</p>
<p>En la Fig. <a href="datos-espaciales.html#fig:plot-lineas-pol">40.8</a>, el río Tajo está representado como una línea (<code>tajo</code>, sucesión de puntos unidos entre sí) y la ciudad de Toledo como un polígono (<code>toledo</code>, línea de puntos cerrada formando un continuo).</p>
<div class="sourceCode" id="cb601"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">toledo</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"cornsilk2"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">tajo</span>, col <span class="op">=</span> <span class="st">"lightblue2"</span>, lwd <span class="op">=</span> <span class="fl">2</span>, alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">hosp_toledo</span>, col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">coord_sf</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4.2</span>, <span class="op">-</span><span class="fl">3.8</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">39.8</span>, <span class="fl">39.95</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:plot-lineas-pol"></span>
<img src="img/rio-toledo.png" alt="Datos vector: Puntos, líneas y polígonos" width="60%"><p class="caption">
Figura 40.8: Datos vector: Puntos, líneas y polígonos
</p>
</div>
<p>Las extensiones más habituales de los archivos que contienen datos de vectores se muestran a continuación:</p>
<div class="inline-table"><table class="table table-sm">
<caption>Ficheros con datos vector</caption>
<thead><tr class="header">
<th>Tipo</th>
<th>Extensión</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Shapefile</td>
<td>
<code>.shp</code>, <code>.shx</code>, <code>.dbf</code>
</td>
</tr>
<tr class="even">
<td>GeoPackage vector</td>
<td><code>.gpkg</code></td>
</tr>
<tr class="odd">
<td>GeoJson</td>
<td><code>.geojson</code></td>
</tr>
<tr class="even">
<td>GPX</td>
<td><code>.gpx</code></td>
</tr>
<tr class="odd">
<td>Geography Markup Language</td>
<td><code>.gml</code></td>
</tr>
<tr class="even">
<td>Keyhole Markup Language</td>
<td><code>.kml</code></td>
</tr>
<tr class="odd">
<td>Otros</td>
<td>
<code>.csv</code>, <code>.txt</code>, <code>xls</code>
</td>
</tr>
</tbody>
</table></div>
<div class="infobox">
<p>ESRI Shapefile surgió como uno de los primeros formatos de intercambio de datos geográficos y en la actualidad es, quizá, el formato más empleado. Sin embargo, tiene una serie de limitaciones: es un formato multiarchivo y el CRS es opcional.</p>
</div>
</div>
<div id="raster" class="section level4" number="40.2.2.2">
<h4>
<span class="header-section-number">40.2.2.2</span> Datos ráster<a class="anchor" aria-label="anchor" href="#raster"><i class="fas fa-link"></i></a>
</h4>
<p>Los datos raster son datos proporcionados en una rejilla de píxeles (regulares o no) denominada <strong>matriz</strong>. El caso más popular de un ráster es una fotografía, donde la imagen se representa como una serie de celdas, determinadas por la resolución de la imagen, es decir, el tamaño del píxel (por ejemplo, 5 x 5 unidades, si es regular, 5 x 10 unidades, si es irregular) y el valore del pixel (RGB, por ejemplo) que determina el color que presenta cada uno de estos píxeles. En el ámbito de los datos espaciales, un archivo ráster está formado por una malla de píxeles georreferenciada, tal y como muestra la Fig. <a href="datos-espaciales.html#fig:plot-raster-to">40.9</a>. Aquí se visualiza el conjunto de datos <code>elev</code> dentro del paquete <code>CDR</code> que representa los datos de la altitud de la provincia de Toledo en metros.</p>
<div class="sourceCode" id="cb602"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://rspatial.org/terra/">"terra"</a></span><span class="op">)</span></span>
<span><span class="va">elev</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/rast.html">rast</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"external/Toledo_DEM.asc"</span>, package <span class="op">=</span> <span class="st">"CDR"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html">plot</a></span><span class="op">(</span><span class="va">elev</span>, main <span class="op">=</span> <span class="st">" "</span><span class="op">)</span></span>
<span><span class="va">pols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/as.spatvector.html">as.polygons</a></span><span class="op">(</span><span class="va">elev</span>, dissolve<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html">plot</a></span><span class="op">(</span><span class="va">pols</span>, add <span class="op">=</span> <span class="cn">TRUE</span>, border <span class="op">=</span> <span class="st">"grey90"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html">st_geometry</a></span><span class="op">(</span><span class="va">Tol_prov</span><span class="op">)</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:plot-raster-to"></span>
<img src="img/elev-toledo.png" alt="Datos ráster. Altitud de la provincia de Toledo" width="60%"><p class="caption">
Figura 40.9: Datos ráster. Altitud de la provincia de Toledo
</p>
</div>
<p>En la Fig. <a href="datos-espaciales.html#fig:plot-raster-to">40.9</a>, el objeto ráster <code>elev</code>
tiene únicamente una capa. Eso implica que cada píxel tiene asociado un único valor, en este caso, la altitud media del terreno observado. Las extensiones más habituales de los archivos que contienen datos ráster se muestran a continuación:</p>
<div class="inline-table"><table class="table table-sm">
<caption>Ficheros con datos raster</caption>
<thead><tr class="header">
<th>Tipo</th>
<th>Extensión</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>ASCII Grid</td>
<td><code>.asc</code></td>
</tr>
<tr class="even">
<td>GeoTIFF</td>
<td>
<code>.tif</code>, <code>.tiff</code>
</td>
</tr>
<tr class="odd">
<td>Enhanced Compression Wavelet</td>
<td><code>.ecw</code></td>
</tr>
</tbody>
</table></div>
</div>
</div>
</div>
<div id="primer-mapa" class="section level2" number="40.3">
<h2>
<span class="header-section-number">40.3</span> Mi primer mapa<a class="anchor" aria-label="anchor" href="#primer-mapa"><i class="fas fa-link"></i></a>
</h2>
<p>Definidos los elementos clave de los datos espaciales se llevará a cabo la representación en un mapa de la distribución municipal de la renta neta per cápita (<code>renta_municipio_data</code>) por municipio (<code>municipios</code>) en el periodo 2019 en España<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;Un análisis detallado puede verse en &lt;span class="citation"&gt;(&lt;a href="referncias.html#ref-hernangomez_fernandezaviles_2022"&gt;Hernangómez and Fernández-Avilés 2022&lt;/a&gt;)&lt;/span&gt;.&lt;/p&gt;'><sup>218</sup></a>.
Los datos están incluidos en el paquete <code>CDR</code>.</p>
<p>Ambos conjuntos deben tener, al menos, un campo en común, <code>codigo_ine</code> en este caso, para su unión.</p>
<div class="sourceCode" id="cb603"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st">"CDR"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://r-spatial.github.io/sf/">"sf"</a></span><span class="op">)</span></span>
<span><span class="va">munis_renta</span> <span class="op">&lt;-</span> <span class="va">municipios</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">renta_municipio_data</span><span class="op">)</span> <span class="op">|&gt;</span>   <span class="co"># une datasets</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">name</span>, <span class="va">cpro</span>, <span class="va">cmun</span>, <span class="va">`2019`</span><span class="op">)</span>     <span class="co"># selecciona variables</span></span>
<span><span class="co">#&gt; Joining, by = "codigo_ine"</span></span></code></pre></div>
<div class="sourceCode" id="cb604"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">munis_renta</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">`2019`</span><span class="op">)</span>, color <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_colour_continuous.html">scale_fill_continuous</a></span><span class="op">(</span></span>
<span>    labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_number.html">label_number</a></span><span class="op">(</span></span>
<span>      big.mark <span class="op">=</span> <span class="st">"."</span>, decimal.mark <span class="op">=</span> <span class="st">","</span>, suffix <span class="op">=</span> <span class="st">" €"</span> <span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:plot-renta-ko"></span>
<img src="img/renta-ko.png" alt="Distribución de la renta neta media por persona (€) en 2019" width="80%"><p class="caption">
Figura 40.10: Distribución de la renta neta media por persona (€) en 2019
</p>
</div>
<p>La Fig. <a href="datos-espaciales.html#fig:plot-renta-ko">40.10</a> presenta un mapa temático o de coropletas, es decir, una visualización sencilla de cómo varía la distribución de una variable (en este caso la renta neta media por persona) en un área geográfica (España). Adicionalmente, una serie de elementos gráficos característicos de los objetos espaciales puede verse en la información contenida en el objeto <code>munis_renta</code>: los datos son de tipo vector, el tipo de geometría es MULTIPOLYGON, el CRS es ETRS89 y una leyenda explica el significado de la variable.</p>
<div class="sourceCode" id="cb605"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/headtail.html">head</a></span><span class="op">(</span><span class="va">munis_renta</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="op">]</span></span>
<span><span class="co">#&gt; Simple feature collection with 3 features and 4 fields</span></span>
<span><span class="co">#&gt; Geometry type: MULTIPOLYGON</span></span>
<span><span class="co">#&gt; Dimension: XY</span></span>
<span><span class="co">#&gt; Bounding box: xmin: -3.140179 ymin: 36.73817 xmax: -2.741701 ymax: 37.24562</span></span>
<span><span class="co">#&gt; Geodetic CRS: ETRS89</span></span>
<span><span class="co">#&gt; name cpro cmun 2019 geom</span></span>
<span><span class="co">#&gt; 1 Abla 04 001 10192 MULTIPOLYGON (((-2.775594 3...</span></span>
<span><span class="co">#&gt; Abrucena   04  002 10021 MULTIPOLYGON (((-2.787566 3...</span></span>
<span><span class="co">#&gt; Adra   04  003  8192 MULTIPOLYGON (((-3.051988 3...</span></span></code></pre></div>
</div>
<div id="no-mentir" class="section level2" number="40.4">
<h2>
<span class="header-section-number">40.4</span> ¿Cómo (no) mentir con la visualización?<a class="anchor" aria-label="anchor" href="#no-mentir"><i class="fas fa-link"></i></a>
</h2>
<p></p>
<p>Si se realiza un mapa de coropletas como el de la Fig. <a href="datos-espaciales.html#fig:plot-renta-ko">40.10</a>, puede que la información aparezca distorsionada. Algunas consideraciones básicas en visualización son:</p>
<ul>
<li><p>La escala de color.</p></li>
<li><p>La distribución de los datos.</p></li>
<li><p>La definición de intervalos.</p></li>
</ul>
<p><strong>¿Cómo es la distribución de la variable renta?</strong> La variable no sigue una distribución Normal (la renta sigue una distribución Gamma<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;Las características de la distribución Gamma pueden verse en el Cap. &lt;a href="Funda-probab.html#Funda-probab"&gt;12&lt;/a&gt;.&lt;/p&gt;'><sup>219</sup></a>), y, si el objetivo es mostrar patrones espaciales de la variable, para una mejor representación será necesario dividir los datos en clases con el paquete <code>classInt</code> <span class="citation">(<a href="referncias.html#ref-R-classint">Bivand 2020</a>)</span>. De entre las distintas posibilidades que ofrece la función <code><a href="https://r-spatial.github.io/classInt/reference/classIntervals.html">classIntervals()</a></code>, se utiliza el método de Fisher-Jenks, que consiste en un mapa de cortes naturales que utiliza un algoritmo no lineal para agrupar observaciones de modo que se maximice la homogeneidad dentro del grupo. Este algorímo está desarrollado específicamente para la clasificación de datos espaciales y su visualización en mapas. Además, se eliminan los municipios sin datos (sombreados en color gris) y se elige una escala de color adecuada. El mapa de la Fig. <a href="datos-espaciales.html#fig:plot-mapa-fisher">40.11</a> proporciona ahora una visualización adecuada de la variable renta.</p>
<p></p>
<div class="sourceCode" id="cb606"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">munis_renta_clean</span> <span class="op">&lt;-</span> <span class="va">munis_renta</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">`2019`</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># crea Fisher-Jenks clases</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/classInt/">classInt</a></span><span class="op">)</span></span>
<span><span class="va">fisher</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/classInt/reference/classIntervals.html">classIntervals</a></span><span class="op">(</span><span class="va">munis_renta_clean</span><span class="op">$</span><span class="va">`2019`</span>,</span>
<span>style <span class="op">=</span> <span class="st">"fisher"</span>, n <span class="op">=</span> <span class="fl">10</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">munis_renta_clean</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html">cut</a></span><span class="op">(</span><span class="va">`2019`</span>, <span class="va">fisher</span><span class="op">$</span><span class="va">brks</span><span class="op">)</span><span class="op">)</span>, color <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">+</span></span>
<span>            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_fill_viridis_d</a></span><span class="op">(</span>option<span class="op">=</span> <span class="st">"A"</span> , </span>
<span>                                 labels<span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_number.html">label_number</a></span><span class="op">(</span>suffix<span class="op">=</span> <span class="st">"€"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_coloursteps.html">guide_colorsteps</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>fill<span class="op">=</span> <span class="st">"Fisher-Jenks"</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:plot-mapa-fisher"></span>
<img src="img/renta-fj.png" alt="Renta neta per cápita (€) por tramos según Fisher-Jenks" width="80%"><p class="caption">
Figura 40.11: Renta neta per cápita (€) por tramos según Fisher-Jenks
</p>
</div>
</div>
<div id="mapas-espacio-temporales" class="section level2" number="40.5">
<h2>
<span class="header-section-number">40.5</span> Mapas espacio-temporales<a class="anchor" aria-label="anchor" href="#mapas-espacio-temporales"><i class="fas fa-link"></i></a>
</h2>
<p></p>
<p>La dimensión temporal es cada vez más importante en el ámbito espacial, por ello, es importante representar en el tiempo los procesos espaciales. La Fig. <a href="datos-espaciales.html#fig:plot-tmin-st">40.13</a> representa la temperatura mínima registrada en España del 6 al 10 de Enero de 2021, <code><a href="https://rdrr.io/pkg/CDR/man/tempmin_data.html">CDR::tempmin_data</a></code>, durante la <a href="https://es.wikipedia.org/wiki/Borrasca_Filomena">Borrasca Filomena</a>.</p>
<div class="sourceCode" id="cb607"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tmin_sf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html">st_as_sf</a></span><span class="op">(</span><span class="va">tempmin_data</span>, </span>
<span>  coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"longitud"</span>, <span class="st">"latitud"</span><span class="op">)</span>,</span>
<span>  crs <span class="op">=</span> <span class="fl">4326</span> <span class="co"># coordenadas geográficas longitud/latitud WGS84</span></span>
<span>  <span class="op">)</span> </span>
<span></span>
<span><span class="va">esp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ropenspain.github.io/mapSpain/reference/esp_get_ccaa.html">esp_get_ccaa</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="co"># sf objeto, contorno de España</span></span>
<span>        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">ine.ccaa.name</span> <span class="op">!=</span> <span class="st">"Canarias"</span><span class="op">)</span> <span class="co"># excluye Canarias</span></span></code></pre></div>
<p>La primera pregunta se debe formular es: ¿tengo el CRS de las estaciones de monitoreo en la misma proyección que el contorno de España?</p>
<div class="sourceCode" id="cb608"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html">st_crs</a></span><span class="op">(</span><span class="va">tmin_sf</span><span class="op">)</span> <span class="op">==</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html">st_crs</a></span><span class="op">(</span><span class="va">esp</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span>
<span><span class="va">esp2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html">st_transform</a></span><span class="op">(</span><span class="va">esp</span>, <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html">st_crs</a></span><span class="op">(</span><span class="va">tmin_sf</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html">st_crs</a></span><span class="op">(</span><span class="va">tmin_sf</span><span class="op">)</span> <span class="op">==</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html">st_crs</a></span><span class="op">(</span><span class="va">esp2</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>Comprobado el CRS, es habitual representar las coordenadas con las que se trabaja. La Fig. <a href="datos-espaciales.html#fig:plot-aemet">40.12</a> muestra la localización de las estaciones de monitoreo en España que registran la temperatura.</p>
<div class="sourceCode" id="cb609"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">esp2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>   </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">tmin_sf</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_light</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:plot-aemet"></span>
<img src="img/ms-spain.png" alt="Estaciones de AEMET en la Península Ibérica" width="60%"><p class="caption">
Figura 40.12: Estaciones de AEMET en la Península Ibérica
</p>
</div>
<p>Por último, se representa el mapa espacio-temporal con la función <code>gglot()</code> indicando en el argumento <code><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap()</a></code> la dimension tempporal.</p>
<div class="infobox">
<p><strong>Nota</strong></p>
<p>Los paquetes <strong>tmap</strong> <span class="citation">(<a href="referncias.html#ref-R-tmap">Tennekes 2018</a>)</span> y <strong>mapsf</strong> <span class="citation">(<a href="referncias.html#ref-R-mapsf">Giraud 2022</a>)</span> son referentes para mapas temáticos y pueden utilizarse como alternativa.</p>
</div>
<div class="sourceCode" id="cb610"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># definición de intervalos</span></span>
<span><span class="va">cortes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="cn">Inf</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">20</span>, <span class="fl">20</span>, <span class="fl">2.5</span><span class="op">)</span>, <span class="cn">Inf</span><span class="op">)</span></span>
<span><span class="va">colores</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">hcl.colors</a></span><span class="op">(</span><span class="fl">15</span>, <span class="st">"PuOr"</span>, rev <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tmin_sf_sptem</span> <span class="op">&lt;-</span> <span class="va">tmin_sf</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">fecha</span>, <span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span><span class="op">(</span><span class="va">tmin</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">esp2</span>, fill <span class="op">=</span> <span class="st">"grey95"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">tmin_sf</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">tmin</span><span class="op">)</span>, size<span class="op">=</span><span class="fl">3</span>, alpha<span class="op">=</span> <span class="fl">.7</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html">vars</a></span><span class="op">(</span><span class="va">fecha</span><span class="op">)</span>,ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"Temp. mím"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_color_gradientn</a></span><span class="op">(</span></span>
<span>    colours <span class="op">=</span> <span class="va">colores</span>,</span>
<span>    breaks <span class="op">=</span> <span class="va">cortes</span>,</span>
<span>    labels <span class="op">=</span> <span class="op">~</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_c.html">str_c</a></span><span class="op">(</span><span class="va">.</span> , <span class="st">"º"</span><span class="op">)</span>,</span>
<span>    guide <span class="op">=</span> <span class="st">"legend"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:plot-tmin-st"></span>
<img src="img/st-spain.png" alt="Temperatura mínima en España (6-10 enero  2021)" width="100%"><p class="caption">
Figura 40.13: Temperatura mínima en España (6-10 enero 2021)
</p>
</div>
</div>
<div id="mapas-interactivos" class="section level2" number="40.6">
<h2>
<span class="header-section-number">40.6</span> Mapas interactivos<a class="anchor" aria-label="anchor" href="#mapas-interactivos"><i class="fas fa-link"></i></a>
</h2>
<p>
El desarrollo de la informática ha propiciado también el desarrollo de la geocomputación, que está relacionada con los desarollos webs, y permite, entre otras cosas, la representación de mapas interactivos.</p>
<p>A modo de ejemplo, el mapa de la Fig. <a href="datos-espaciales.html#fig:snow-map-png-ch40">40.14</a> representa el mapa Fig. <a href="datos-espaciales.html#fig:snow-cholera-map-ch40">40.1</a> de forma interactiva con la librería <code>leaflef</code>. Estos mapas dinámicos, ampliables y desplazables, son más informativos que los mapas estáticos y, además, son una alternativa que pueden proporcionar una experiencia diferente y una mayor interacción al usuario.</p>
<div class="sourceCode" id="cb611"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://rstudio.github.io/leaflet/">"leaflet"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/paezha/isdas">"isdas"</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"snow_deaths"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"snow_pumps"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## crea mapa interactivo</span></span>
<span><span class="va">snow_map</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/leaflet/man/leaflet.html">leaflet</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/leaflet/man/map-methods.html">setView</a></span><span class="op">(</span>lng <span class="op">=</span> <span class="op">-</span><span class="fl">0.136</span>, lat <span class="op">=</span> <span class="fl">51.513</span>, zoom <span class="op">=</span> <span class="fl">16</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/leaflet/man/map-layers.html">addTiles</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/leaflet/man/map-layers.html">addMarkers</a></span><span class="op">(</span> data <span class="op">=</span> <span class="va">snow_deaths</span>, <span class="op">~</span><span class="va">long</span>, <span class="op">~</span><span class="va">lat</span>,</span>
<span>    clusterOptions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/leaflet/man/map-options.html">markerClusterOptions</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    group <span class="op">=</span> <span class="st">"Deaths"</span> <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/leaflet/man/map-layers.html">addMarkers</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">snow_pumps</span>, <span class="op">~</span><span class="va">long</span>, <span class="op">~</span><span class="va">lat</span>,</span>
<span>    group <span class="op">=</span> <span class="st">"Pumps"</span> <span class="op">)</span></span>
<span><span class="va">snow_map</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:snow-map-png-ch40"></span>
<img src="img/snow_map.png" alt="Mapa interactivo de las muertes por cólera en Londres según Snow en 1854" width="60%"><p class="caption">
Figura 40.14: Mapa interactivo de las muertes por cólera en Londres según Snow en 1854
</p>
</div>
<div id="reumen-1" class="section level3 unnumbered infobox_resume">
<h3>Reumen<a class="anchor" aria-label="anchor" href="#reumen-1"><i class="fas fa-link"></i></a>
</h3>
<p>Los datos espaciales son aquellos que contienen información de una zona geográfica de la tierra. Vienen definidos por coordenadas y por un sistema de referencia de coordenadas que debe tenerse en cuenta para su representación.</p>
<p>Existen dos tipos de formatos de datos: vector y ráster.</p>
<p>Los datos espaciales pueden clasificarse en: geoestadísticos, reticulares y puntuales.</p>
</div>

</div>
</div>

  <div class="chapter-nav">
<div class="prev"><a href="grafos.html"><span class="header-section-number">39</span> Análisis de grafos y redes sociales</a></div>
<div class="next"><a href="geo.html"><span class="header-section-number">41</span> Geoestadística</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="Índice capítulo"><h2>Índice capítulo</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#datos-espaciales"><span class="header-section-number">40</span> Trabajando con datos espaciales</a></li>
<li>
<a class="nav-link" href="#introducci%C3%B3n-19"><span class="header-section-number">40.1</span> Introducción</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#estad%C3%ADstica-para-datos-espaciales"><span class="header-section-number">40.1.1</span> Estadística para datos espaciales</a></li></ul>
</li>
<li>
<a class="nav-link" href="#conceptos-clave"><span class="header-section-number">40.2</span> Conceptos clave</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#CRS"><span class="header-section-number">40.2.1</span> Sistema de referencia de coordenadas</a></li>
<li><a class="nav-link" href="#formatos"><span class="header-section-number">40.2.2</span> Formatos de datos espaciales</a></li>
</ul>
</li>
<li><a class="nav-link" href="#primer-mapa"><span class="header-section-number">40.3</span> Mi primer mapa</a></li>
<li><a class="nav-link" href="#no-mentir"><span class="header-section-number">40.4</span> ¿Cómo (no) mentir con la visualización?</a></li>
<li><a class="nav-link" href="#mapas-espacio-temporales"><span class="header-section-number">40.5</span> Mapas espacio-temporales</a></li>
<li>
<a class="nav-link" href="#mapas-interactivos"><span class="header-section-number">40.6</span> Mapas interactivos</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#reumen-1">Reumen</a></li></ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Fundamentos de ciencia de datos con R</strong>" coordinado por <a href="https://blog.uclm.es/gemafaviles/" class="text-light">Gema Fernández-Avilés y José-María Montero</a>. Generado por última vez el día 2023-06-16.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>Este libro ha sido generado con el paquete de R <a class="text-light" href="https://bookdown.org">bookdown</a>.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
