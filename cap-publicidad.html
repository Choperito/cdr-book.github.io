<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Capítulo 49 Optimización de inversiones publicitarias | Fundamentos de ciencia de datos con R</title>
<meta name="author" content="Gema Fernández-Avilés y José-María Montero">
<meta name="description" content="Carlos Real Ugena Deloitte  49.1 Metodologías para optimizar las inversiones publicitarias Uno de los principales retos a los que se enfrentan los departamentos de marketing de cualquier compañía...">
<meta name="generator" content="bookdown 0.28 with bs4_book()">
<meta property="og:title" content="Capítulo 49 Optimización de inversiones publicitarias | Fundamentos de ciencia de datos con R">
<meta property="og:type" content="book">
<meta property="og:image" content="/img/cover.png">
<meta property="og:description" content="Carlos Real Ugena Deloitte  49.1 Metodologías para optimizar las inversiones publicitarias Uno de los principales retos a los que se enfrentan los departamentos de marketing de cualquier compañía...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Capítulo 49 Optimización de inversiones publicitarias | Fundamentos de ciencia de datos con R">
<meta name="twitter:description" content="Carlos Real Ugena Deloitte  49.1 Metodologías para optimizar las inversiones publicitarias Uno de los principales retos a los que se enfrentan los departamentos de marketing de cualquier compañía...">
<meta name="twitter:image" content="/img/cover.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.4.2/transition.js"></script><script src="libs/bs3compat-0.4.2/tabs.js"></script><script src="libs/bs3compat-0.4.2/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><link href="libs/tabwid-1.1.0/tabwid.css" rel="stylesheet">
<link href="libs/tabwid-1.1.0/scrool.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="bs4_style.css">
<link rel="stylesheet" href="bs4_book.css">
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Fundamentos de ciencia de datos con <strong>R</strong></a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Buscar" aria-label="Buscar">
</form>

      <nav aria-label="Contenido"><h2>Contenido</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Prefacio</a></li>
<li><a class="" href="pr%C3%B3logo.html">Prólogo</a></li>
<li class="book-part">Ciencia, datos, software… y científicos</li>
<li><a class="" href="ciencia-datos.html"><span class="header-section-number">1</span> ¿Es la ciencia de datos una ciencia?</a></li>
<li><a class="" href="metodologia.html"><span class="header-section-number">2</span> Metodología en ciencia de datos</a></li>
<li><a class="" href="ch-110003.html"><span class="header-section-number">3</span> R para ciencia de datos</a></li>
<li><a class="" href="cap-etica.html"><span class="header-section-number">4</span> Ética en la ciencia de datos</a></li>
<li class="book-part">Bienvenidos a la jungla de datos</li>
<li><a class="" href="datos-sql.html"><span class="header-section-number">5</span> Gestión de bases de datos relacionales</a></li>
<li><a class="" href="cap-nosql.html"><span class="header-section-number">6</span> Gestión de bases de datos NoSQL</a></li>
<li><a class="" href="DGDQM.html"><span class="header-section-number">7</span> Gobierno, gestión y calidad del dato</a></li>
<li><a class="" href="id_130009.html"><span class="header-section-number">8</span> Integración y limpieza de datos</a></li>
<li><a class="" href="chap-feature.html"><span class="header-section-number">9</span> Selección y transformación de variables</a></li>
<li><a class="" href="chap-herramientas.html"><span class="header-section-number">10</span> Herramientas para el análisis en ciencia de datos</a></li>
<li><a class="" href="id_120006-aed.html"><span class="header-section-number">11</span> Análisis exploratorio de datos</a></li>
<li class="book-part">Fundamentos de estadística</li>
<li><a class="" href="Funda-probab.html"><span class="header-section-number">12</span> Probabilidad</a></li>
<li><a class="" href="Fundainfer.html"><span class="header-section-number">13</span> Inferencia estadística</a></li>
<li><a class="" href="muestreo.html"><span class="header-section-number">14</span> Muestreo y remuestreo</a></li>
<li class="book-part">Modelización estadística</li>
<li><a class="" href="cap-lm.html"><span class="header-section-number">15</span> Modelización lineal</a></li>
<li><a class="" href="cap-glm.html"><span class="header-section-number">16</span> Modelos lineales generalizados</a></li>
<li><a class="" href="cap-gam.html"><span class="header-section-number">17</span> Modelos aditivos generalizados</a></li>
<li><a class="" href="cap-mxm.html"><span class="header-section-number">18</span> Modelos mixtos</a></li>
<li><a class="" href="cap-sparse.html"><span class="header-section-number">19</span> Modelos sparse y métodos penalizados de regresión</a></li>
<li><a class="" href="cap-series-temp.html"><span class="header-section-number">20</span> Modelización de series temporales</a></li>
<li><a class="" href="cap-discriminante.html"><span class="header-section-number">21</span> Análisis discriminante</a></li>
<li><a class="" href="cap-conjunto.html"><span class="header-section-number">22</span> Análisis conjunto</a></li>
<li><a class="" href="tablas-contingencia.html"><span class="header-section-number">23</span> Análisis de tablas de contingencia</a></li>
<li class="book-part">Machine learning supervisado</li>
<li><a class="" href="cap-arboles.html"><span class="header-section-number">24</span> Árboles de clasificación y regresión</a></li>
<li><a class="" href="cap-svm.html"><span class="header-section-number">25</span> Máquinas de vector soporte</a></li>
<li><a class="" href="cap-knn.html"><span class="header-section-number">26</span> Clasificador \(k\)-vecinos más próximos</a></li>
<li><a class="" href="cap-naive-bayes.html"><span class="header-section-number">27</span> Naive Bayes</a></li>
<li><a class="" href="cap-bagg-rf.html"><span class="header-section-number">28</span> Métodos ensamblados: \(\bf \textit {bagging}\) y \(\bf \textit{random}\) \(\bf \textit{forest}\)</a></li>
<li><a class="" href="cap-boosting-xgboost.html"><span class="header-section-number">29</span> \(\bf \textit{Boosting}\) y el algoritmo XGBoost</a></li>
<li class="book-part">Machine learning no supervisado</li>
<li><a class="" href="an%C3%A1lisis-cl%C3%BAster-clusterizaci%C3%B3n-jer%C3%A1rquica.html"><span class="header-section-number">30</span> Análisis clúster: clusterización jerárquica</a></li>
<li><a class="" href="no-jerarquico.html"><span class="header-section-number">31</span> Análisis clúster: clusterización no jerárquica</a></li>
<li><a class="" href="acp.html"><span class="header-section-number">32</span> Análisis de componentes principales</a></li>
<li><a class="" href="an%C3%A1lisis-factorial.html"><span class="header-section-number">33</span> Análisis factorial</a></li>
<li><a class="" href="escalamiento-multidimensional.html"><span class="header-section-number">34</span> Escalamiento multidimensional</a></li>
<li><a class="" href="correspondencias.html"><span class="header-section-number">35</span> Análisis de correspondencias</a></li>
<li class="book-part">Deep learning</li>
<li><a class="" href="capNN.html"><span class="header-section-number">36</span> Redes neuronales artificiales</a></li>
<li><a class="" href="cap-redes-convol.html"><span class="header-section-number">37</span> Redes neuronales convolucionales</a></li>
<li class="book-part">Ciencia de datos de texto y redes</li>
<li><a class="" href="mineria-textos.html"><span class="header-section-number">38</span> Minería de textos</a></li>
<li><a class="" href="grafos.html"><span class="header-section-number">39</span> Análisis de grafos y redes sociales</a></li>
<li class="book-part">Ciencia de datos espaciales</li>
<li><a class="" href="datos-espaciales.html"><span class="header-section-number">40</span> Trabajando con datos espaciales</a></li>
<li><a class="" href="geo.html"><span class="header-section-number">41</span> Geoestadística</a></li>
<li><a class="" href="cap-econom-esp.html"><span class="header-section-number">42</span> Modelos econométricos espaciales</a></li>
<li><a class="" href="cap-pp.html"><span class="header-section-number">43</span> Procesos de puntos</a></li>
<li class="book-part">Comunica y colabora</li>
<li><a class="" href="id_120007-informes.html"><span class="header-section-number">44</span> Informes reproducibles con R Markdown y Quarto</a></li>
<li><a class="" href="shiny.html"><span class="header-section-number">45</span> Creación de aplicaciones web interactivas con Shiny</a></li>
<li><a class="" href="github.html"><span class="header-section-number">46</span> Git y GitHub R</a></li>
<li><a class="" href="geoproces.html"><span class="header-section-number">47</span> Geoprocesamiento en nube</a></li>
<li class="book-part">Casos de estudio en ciencia de datos</li>
<li><a class="" href="cap-crimen.html"><span class="header-section-number">48</span> Análisis de una red criminal</a></li>
<li><a class="active" href="cap-publicidad.html"><span class="header-section-number">49</span> Optimización de inversiones publicitarias</a></li>
<li><a class="" href="cap-twitter.html"><span class="header-section-number">50</span> ¿Cómo tuitea Elon Musk?</a></li>
<li><a class="" href="cap-periodismo.html"><span class="header-section-number">51</span> Análisis electoral: de RStudio a su periódico</a></li>
<li><a class="" href="paro-clm.html"><span class="header-section-number">52</span> El impacto de las crisis financiera y de la COVID-19 en el paro de CLM</a></li>
<li><a class="" href="cap-rfm.html"><span class="header-section-number">53</span> Segmentación de clientes en el comercio minorista</a></li>
<li><a class="" href="cap-medicina.html"><span class="header-section-number">54</span> Análisis de datos en medicina</a></li>
<li><a class="" href="cap-futbol.html"><span class="header-section-number">55</span> Messi y Ronaldo: dos ídolos desde la perspectiva de los datos</a></li>
<li><a class="" href="cambioclimatico.html"><span class="header-section-number">56</span> Una nota sobre el cambio climático</a></li>
<li><a class="" href="cap-sist-exp.html"><span class="header-section-number">57</span> Implementación de un sistema experto en el ámbito pediátrico</a></li>
<li><a class="" href="cap-ree.html"><span class="header-section-number">58</span> Predicción de consumo eléctrico con redes neuronales artificiales</a></li>
<li><a class="" href="nlp-textil.html"><span class="header-section-number">59</span> El procesamiento del lenguaje natural para tendencias de moda en textil</a></li>
<li><a class="" href="cap-fraude.html"><span class="header-section-number">60</span> Detección de fraude de tarjetas de crédito</a></li>
<li class="book-part">Appendix</li>
<li><a class="" href="info-session.html"><span class="header-section-number">A</span> Información de la sesión</a></li>
<li><a class="" href="referncias.html">Referncias</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="cap-publicidad" class="section level1" number="49">
<h1>
<span class="header-section-number">Capítulo 49</span> Optimización de inversiones publicitarias<a class="anchor" aria-label="anchor" href="#cap-publicidad"><i class="fas fa-link"></i></a>
</h1>
<p><em>Carlos Real Ugena</em></p>
<p>Deloitte</p>
<div id="metodologías-para-optimizar-las-inversiones-publicitarias" class="section level2" number="49.1">
<h2>
<span class="header-section-number">49.1</span> Metodologías para optimizar las inversiones publicitarias<a class="anchor" aria-label="anchor" href="#metodolog%C3%ADas-para-optimizar-las-inversiones-publicitarias"><i class="fas fa-link"></i></a>
</h2>
<p>Uno de los principales retos a los que se enfrentan los departamentos de marketing de cualquier compañía es cuantificar el impacto de la publicidad en el negocio. Esta medición es clave en la optimización de las inversiones que destinan a cada medio publicitario, existiendo múltiples métodos para medir el ROI (<em>return on investment</em>), es decir, el retorno que se obtiene por cada euro invertido en publicidad. Antes de revisar un ejemplo práctico, es necesario entender bien las características que presentan cada uno de ellos. Los métodos de cuantificación del impacto de la publicidad en el negocio, según la investigación llevada a cabo por la consultora Gartner,<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;Véase &lt;em&gt;Gartner Identifies Four Methods for Measuring Marketing’s Impact&lt;/em&gt;, disponible en &lt;a href="https://www.gartner.com/en/newsroom/press-releases/2020-03-04-gartner-identifies-four-methods-for-measuring-marketi"&gt;https://www.gartner.com/en/newsroom/press-releases/2020-03-04-gartner-identifies-four-methods-for-measuring-marketi&lt;/a&gt;&lt;/p&gt;'><sup>291</sup></a> se pueden clasificar en cuatro grandes grupos:</p>
<p></p>
<ol style="list-style-type: decimal">
<li><p><strong><em>Marketing Mix Modeling</em> (MMM)</strong>: modelos de series temporales que sirven para estimar la contribución del marketing u otras variables explicativas a las ventas desde un punto de vista estratégico. </p></li>
<li><p><strong><em>Multitouch Attribution</em> (MTA)</strong>: modelos de atribución que valoran cada punto de contacto (<em>touchpoint</em>) del recorrido del cliente (<em>customer journey</em>), asignando a cada uno un peso en la conversión (venta, descarga de folleto, etc). Son modelos tácticos que normalmente se centran en el canal online.</p></li>
<li><p><strong><em>Holdout Testing o Experiments</em> (EXP)</strong>: modelos causales que evalúan el impacto de una campaña publicitaria a partir de una muestra de control y otra de test.</p></li>
<li><p><strong><em>Unified Measurement Approaches</em> (UMA)</strong>: combinación de los modelos anteriores (MMM + MTA + EXP) con el objetivo de tener una visión unificada de los resultados.</p></li>
</ol>
<p>En la comparativa que se muestra en la Fig. <a href="cap-publicidad.html#fig:comparativa-modelos">49.1</a> se resume el objetivo de cada uno de los modelos, así como las preguntas que permiten responder:</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:comparativa-modelos"></span>
<img src="img/Comparativa_modelos2.png" alt="Comparativa de metodologías de medición." width="100%"><p class="caption">
Figura 49.1: Comparativa de metodologías de medición.
</p>
</div>
<p>En los últimos años se han producido una serie de cambios en el entorno de la industria del marketing digital enfocados a garantizar el más estricto control de la privacidad de los usuarios. Desde el lanzamiento de la nueva ley de protección de datos (GDPR), en 2018, hasta la reciente confirmación por parte de Google de la prohibición de uso de <em>cookies</em> de tercera parte en Chrome, la posibilidad de acceder a datos de identificación personal para la medición y optimización del impacto de las campañas de publicidad digital está cada vez más limitada.</p>
<p>Esta situación está provocando que el primer tipo de enfoque, el MMM, esté siendo el gran beneficiado, dado que es una técnica que no depende del acceso a datos a nivel de individuo. El ejemplo más claro sobre el protagonismo que está alcanzando el MMM es que grandes compañías como Meta, Google y Uber están desarrollando soluciones <em>open source</em> basadas en técnicas de <em>machine learning</em> que integran grandes avances y mejoras sobre las metodologías tradicionales. Entre las metodologías que han desarrollado hay claras diferencias en las bases teóricas sobre las que se rigen, así como diferencias en tiempos de computación, lenguaje en el que se han desarrollado o capacidades funcionales. A continuación se detallan las principales características de cada una de ellas:</p>
<p>• <strong>Robyn</strong>:<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;Dirección web &lt;code&gt;Robyn&lt;/code&gt;: &lt;a href="https://facebookexperimental.github.io/Robyn/" class="uri"&gt;https://facebookexperimental.github.io/Robyn/&lt;/a&gt;.&lt;/p&gt;'><sup>292</sup></a> desarrollado por Meta <span class="citation">(<a href="referncias.html#ref-Robyn">Facebook Marketing Science 2021</a>)</span> y pensado para datasets con gran cantidad de variables independientes dado que trabaja con regresiones <em>ridge</em> (cubiertas en el Cap. <a href="cap-sparse.html#cap-sparse">19</a>), las cuales están pensadas para lidiar con problemas de multicolinealidad, muy presentes en este tipo de análisis. Cabe destacar que, entre las pruebas que realiza, ofrece una serie de <em>outputs</em> visuales avanzados que permiten al usuario seleccionar el que mejor se adapta al contexto de negocio y necesidad. Requiere tiempos de cómputo alto, pudiendo llegar hasta las tres horas, y permite hacer optimizaciones de presupuesto.</p>
<p>• <strong>Lightweight</strong><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;Dirección web Lightweight: &lt;a href="https://github.com/google/lightweight_mmm" class="uri"&gt;https://github.com/google/lightweight_mmm&lt;/a&gt;.&lt;/p&gt;'><sup>293</sup></a>: desarrollado por Google, sus fundamentos teóricos se basan en modelos bayesianos. La particularidad de esta solución es la posibilidad de incluir datos geográficos para su posterior segregación. Lightweight también considera distintos tipos de <em>adstock</em> (recuerdo publicitario), así como la tendencia y estacionalidad de la serie a explicar. El uso de esta herramienta es más sencillo, aunque los resultados se exponen en un <em>notebook</em> y no posee <em>outputs</em> más elaborados como el resto de soluciones. Por último, también permite realizar optimizaciones de presupuesto.</p>
<p>• <strong>Orbit</strong>:<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;Dirección web Orbit: &lt;a href="https://www.uber.com/en-ES/blog/orbit/" class="uri"&gt;https://www.uber.com/en-ES/blog/orbit/&lt;/a&gt;.&lt;/p&gt;'><sup>294</sup></a> desarrollado por Uber, se basa en modelos bayesianos. Permite al usuario medir los retornos a lo largo del tiempo, lo cual hace que sea un modelo adecuado para compañías con grandes picos de ventas. Incluye análisis de estacionalidad mediante la descomposición de la serie en series de Fourier. Es el modelo más complejo de desarrollar; sin embargo, el tiempo de ejecución es bajo. Cabe destacar que es la librería más estable y, por lo tanto, se podría utilizar para realizar reportes con mayor frecuencia. No incluye la posibilidad de optimizar presupuestos.</p>
</div>
<div id="robyn-como-alternativa-open-source-en-r" class="section level2" number="49.2">
<h2>
<span class="header-section-number">49.2</span> Robyn como alternativa <em>open source</em> en <strong>R</strong><a class="anchor" aria-label="anchor" href="#robyn-como-alternativa-open-source-en-r"><i class="fas fa-link"></i></a>
</h2>
<p><code>Robyn</code> está ganando en popularidad debido a las continuas mejoras que se están aplicando desde Meta, así como gracias a su adaptabilidad a la realidad del anunciante. Además, existe un paquete en <strong>R</strong> validado y subido al CRAN que lo sitúa como una gran alternativa de código abierto en <strong>R</strong> para iniciarse en el campo de la medición y optimización del retorno de las inversiones publicitarias. La ecuación empleada es la siguiente:
<span class="math display">\[\begin{equation}
y_t= \beta_0 + Scurve(x_j) + \beta_{hol} hol_t + \beta_{sea} sea_t + \beta_{trend} trend_t + ... + \beta_{ETC} ETC_t + \epsilon_t
\end{equation}\]</span>
donde:</p>
<p><span class="math display">\[\begin{equation}
\begin{aligned}
y_t &amp;= \text{ventas en el instante} \,t, \\
t &amp;= \text{instante de las variables (por ejemplo, semanas)}, \\
j &amp;= \text{subíndice del medio (por ejemplo, TV o Display)},  \\
\beta_0 &amp;= \text{intercepto}, \\
Scurve(x,j) &amp;= \beta_j \times  \frac{x_{decay_{ t,j}}^\alpha}{x_{decay_{ t,j}}^\alpha + \gamma^\alpha} \, \text{transformación no lineal de curva en S}, \\
\alpha,\gamma &amp;= \text{hiperparámetros que definen la S curve}, \\
x_{decay_{t,j}} &amp;= x_{t,j} + \theta_j x_{decay_{ t,j-1}} \hspace{0,1cm}(adstock, \text{es decir, el recuerdo publicitario)}, \\
x_j &amp;= \text{inversión publicitaria en cada medio}\,j, \\
\theta_j &amp;= \text{tasa fija de decrecimiento en cada medio}\,j, \\
\gamma &amp;: \text{implementada en la S curve, donde} \,\gamma_{tran} = cuantil(x_{decay_j}, \gamma), \\
\beta_j &amp;= \text{coeficientes de cada medio}\,j, \\
hol &amp;=\, \text{festivos}, \\
sea &amp;=\, \text{estacionalidad}, \\
tren d&amp;=\, \text{tendencia}, \\
ETC &amp;=\, \text{resto de variables independientes (precio, promociones, etc)}, \\
\epsilon_t &amp;= \text{término de error en el instante} \,t. \\
\end{aligned}
\end{equation}\]</span></p>
<p>Las variables de medios no suelen presentar un efecto lineal sobre la variable de negocio que se modeliza, sino que la publicidad tiende a presentar rendimientos decrecientes no lineales. Para modelizar este efecto se utiliza la función biparamétrica de <em>S Curve</em> o curva de rendimientos decrecientes. Esta curva permite optimizar los repartos presupuestarios en todos los canales de medios, ya que su forma en “S” indica tanto el umbral a partir del cual los resultados del gasto presupuestario mejoran significativamente el objetivo (por ejemplo, ventas) como en qué punto está saturando y, por lo tanto, perdiendo eficacia.</p>
<p>A continuación, se aplica <code>Robyn</code> sobre un ejemplo con información simulada del sector hotelero, donde el objetivo es predecir el número de reservas de un hotel en función de una serie de predictores (entre ellos, las inversiones publicitarias). Toda la información sobre cómo aplicar esta metodología se puede consultar en GitHub.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;Metodología de &lt;code&gt;Robyn&lt;/code&gt; disponible en &lt;a href="https://github.com/facebookexperimental/Robyn" class="uri"&gt;https://github.com/facebookexperimental/Robyn&lt;/a&gt;.&lt;/p&gt;'><sup>295</sup></a> La versión utilizada en este ejemplo práctico es la 3.6.3, disponible en el CRAN o descargable desde GitHub.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;Versión 3.6.3 de &lt;code&gt;Robyn&lt;/code&gt; disponible en &lt;a href="https://github.com/facebookexperimental/Robyn/releases/tag/v3.6.3" class="uri"&gt;https://github.com/facebookexperimental/Robyn/releases/tag/v3.6.3&lt;/a&gt;.&lt;/p&gt;'><sup>296</sup></a> Este ejercicio traza el camino más corto que se puede seguir hasta llegar a los principales <em>outputs</em> y a la interpretación de los mismos. Sin embargo, para conocer en detalle la metodología, se recomienda seguir profundizando a través de la realización de pruebas adicionales más complejas.</p>
<p>Para comenzar, se carga el paquete <code>Robyn</code>, comprobando que se está trabajando con la versión 3.6.4 y forzando el uso de <em>multicore</em> al utilizar RStudio:</p>
<div class="sourceCode" id="cb739"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/facebookexperimental/Robyn">"Robyn"</a></span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/packageDescription.html">packageVersion</a></span><span class="op">(</span><span class="st">"Robyn"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Sys.setenv.html">Sys.setenv</a></span><span class="op">(</span>R_FUTURE_FORK_ENABLE <span class="op">=</span> <span class="st">"true"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>future.fork.enable <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>Se carga una librería de Python llamada <code>nevergrad</code> <span class="citation">(<a href="referncias.html#ref-nevergrad">Facebook Research AI 2019</a>)</span>, necesaria en el proceso de estimación de los hiperparámetros, invocándola desde <strong>R</strong>. Hay varias opciones para llevar a cabo este proceso. Una de ellas es instalar primero el paquete <code>reticulate</code> <span class="citation">(<a href="referncias.html#ref-reticulate">Ushey, Allaire, and Tang 2022</a>)</span> y, a continuación, <code>nevergrad</code> vía <code>pip</code>:</p>
<div class="sourceCode" id="cb740"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("reticulate")</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://rstudio.github.io/reticulate/">"reticulate"</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rstudio.github.io/reticulate/reference/virtualenv-tools.html">virtualenv_create</a></span><span class="op">(</span><span class="st">"r-reticulate"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rstudio.github.io/reticulate/reference/use_python.html">use_virtualenv</a></span><span class="op">(</span><span class="st">"r-reticulate"</span>, required <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rstudio.github.io/reticulate/reference/py_install.html">py_install</a></span><span class="op">(</span><span class="st">"nevergrad"</span>, pip <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rstudio.github.io/reticulate/reference/py_config.html">py_config</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>En caso de encontrar alguna dificultad al cargar <code>nevergrad</code>, existen distintas alternativas para su instalación que se pueden consultar en GitHub<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;Alternativas a la instalación de &lt;code&gt;nevergrad&lt;/code&gt; disponibles en &lt;a href="https://github.com/facebookexperimental/Robyn/issues/189"&gt;https://github.com/facebookexperimental/Robyn/issues/189&lt;/a&gt;&lt;/p&gt;'><sup>297</sup></a>.</p>
<p>Posteriormente, se carga la tabla que recoge la información simulada del sector hotelero con la que se medirá el impacto de la publicidad:</p>
<div class="sourceCode" id="cb741"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st">"CDR"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"hotel_tablonsemanal"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/headtail.html">head</a></span><span class="op">(</span><span class="va">hotel_tablonsemanal</span><span class="op">)</span></span></code></pre></div>
<p>Se detalla a continuación la información que contiene cada variable:</p>
<ol style="list-style-type: decimal">
<li>
<em>semana</em>: lunes de la semana de referencia.</li>
<li>
<em>reservas</em>: número de reservas que ha conseguido la cadena hotelera en cada una de las semanas bajo análisis.</li>
<li>
<em>turismo</em>: número de pernoctaciones.</li>
<li>
<em>covid_mov</em>: movilidad desde el comienzo de la pandemia.</li>
<li>
<em>notoriedad</em>: conocimiento espontáneo de la marca a lo largo del tiempo.</li>
<li>
<em>temperatura</em>: temperatura media.</li>
<li>
<em>tv_grps20</em> y <em>tv_inv</em>: métrica de impactos (los GRPs) e inversión realizada en TV.</li>
<li>
<em>resto_off_inv</em>: resto de inversiones offline realizadas.</li>
<li>
<em>paidsearch_imp</em> y <em>paidsearch_inv</em>: métrica de impactos (impresiones) e inversión realizada en Paid Search.</li>
<li>
<em>display_imp</em> y <em>display_inv</em>: métrica de impactos (impresiones) e inversión realizada en Display.</li>
<li>
<em>onlinevideo_imp</em> y <em>onlinevideo_inv</em>: métrica de impactos (impresiones) e inversión realizada en Online Video.</li>
<li>
<em>competidores</em>: inversión realizada por la competencia.</li>
<li>
<em>eventos</em>: recoge eventos que tienen impacto en la serie de reservas. En este caso se considera el Black Friday.</li>
</ol>
<p>El objetivo de este ejercicio es estimar el impacto de cada una de las variables detalladas sobre las reservas, poniendo especial atención en las variables de medios —TV, Resto Medios Offline, Paid Search, Display y Online Video— para medir sus efectos y, posteriormente, optimizar las inversiones en ellos.</p>
<p>Con este fin, se cargan los festivos a partir de una tabla auxiliar:</p>
<div class="sourceCode" id="cb742"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"festivos"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/headtail.html">head</a></span><span class="op">(</span><span class="va">festivos</span><span class="op">)</span></span></code></pre></div>
<p>Se fija dónde se guardarán los resultados:</p>
<div class="sourceCode" id="cb743"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">robyn_object</span> <span class="op">&lt;-</span> <span class="st">"data/MyRobyn.RDS"</span></span>
<span><span class="va">ruta_outputs</span> <span class="op">&lt;-</span> <span class="st">"data"</span></span></code></pre></div>
<p>Y se define la configuración inicial del modelo:</p>
<div class="sourceCode" id="cb744"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb744-1"><a href="cap-publicidad.html#cb744-1" tabindex="-1"></a>hotel_tablonsemanal<span class="sc">$</span>eventos <span class="ot">&lt;-</span> hotel_tablonsemanal<span class="sc">$</span>eventos <span class="sc">|&gt;</span> <span class="fu">replace_na</span>(<span class="st">'na'</span>)</span>
<span id="cb744-2"><a href="cap-publicidad.html#cb744-2" tabindex="-1"></a>InputCollect <span class="ot">&lt;-</span> <span class="fu">robyn_inputs</span>(</span>
<span id="cb744-3"><a href="cap-publicidad.html#cb744-3" tabindex="-1"></a>    <span class="at">dt_input =</span> hotel_tablonsemanal,</span>
<span id="cb744-4"><a href="cap-publicidad.html#cb744-4" tabindex="-1"></a>    <span class="at">dt_holidays =</span> festivos,</span>
<span id="cb744-5"><a href="cap-publicidad.html#cb744-5" tabindex="-1"></a>    <span class="at">date_var =</span> <span class="st">"semana"</span>, <span class="co"># tiene que tener este formato "2020-01-01"</span></span>
<span id="cb744-6"><a href="cap-publicidad.html#cb744-6" tabindex="-1"></a>    <span class="at">dep_var =</span> <span class="st">"reservas"</span>, <span class="co"># sólo una variable dependiente</span></span>
<span id="cb744-7"><a href="cap-publicidad.html#cb744-7" tabindex="-1"></a>    <span class="at">dep_var_type =</span> <span class="st">"conversion"</span>, <span class="co"># "revenue" o "conversion". En nuestro caso son reservas.</span></span>
<span id="cb744-8"><a href="cap-publicidad.html#cb744-8" tabindex="-1"></a>    <span class="at">prophet_vars =</span> <span class="fu">c</span>(<span class="st">"trend"</span>, <span class="st">"season"</span>, <span class="st">"holiday"</span>), <span class="co"># "trend=tendencia","season=estacionalidad", "weekday=dia de la semana" &amp; "holiday=festivos"</span></span>
<span id="cb744-9"><a href="cap-publicidad.html#cb744-9" tabindex="-1"></a>    <span class="at">prophet_signs =</span> <span class="fu">c</span>(<span class="st">"default"</span>, <span class="st">"default"</span>, <span class="st">"default"</span>),</span>
<span id="cb744-10"><a href="cap-publicidad.html#cb744-10" tabindex="-1"></a>    <span class="at">prophet_country =</span> <span class="st">"ES"</span>, <span class="co"># seleccione un país. España en nuestro caso</span></span>
<span id="cb744-11"><a href="cap-publicidad.html#cb744-11" tabindex="-1"></a>    <span class="at">context_vars =</span> <span class="fu">c</span>(<span class="st">"eventos"</span>, <span class="st">"turismo"</span>, <span class="st">"covid_mov"</span>, <span class="st">"notoriedad"</span>, </span>
<span id="cb744-12"><a href="cap-publicidad.html#cb744-12" tabindex="-1"></a>                     <span class="st">"temperatura"</span>, <span class="st">"competidores"</span>), <span class="co"># variables de contexto que no sean medios</span></span>
<span id="cb744-13"><a href="cap-publicidad.html#cb744-13" tabindex="-1"></a>    <span class="at">context_signs =</span> <span class="fu">c</span>(<span class="st">"default"</span>, <span class="st">"positive"</span>, <span class="st">"negative"</span>, </span>
<span id="cb744-14"><a href="cap-publicidad.html#cb744-14" tabindex="-1"></a>                      <span class="st">"positive"</span>, <span class="st">"default"</span>, <span class="st">"negative"</span>), <span class="co"># signos fijados a priori (por ejemplo, el turismo debe tener un signo positivo puesto que estamos analizando reservas de hotel)</span></span>
<span id="cb744-15"><a href="cap-publicidad.html#cb744-15" tabindex="-1"></a>    <span class="at">paid_media_spends =</span> <span class="fu">c</span>(<span class="st">"display_inv"</span>,<span class="st">"onlinevideo_inv"</span>,  <span class="st">"paidsearch_inv"</span>,</span>
<span id="cb744-16"><a href="cap-publicidad.html#cb744-16" tabindex="-1"></a>                          <span class="st">"resto_off_inv"</span>, <span class="st">"tv_inv"</span>), <span class="co"># variables de inversión</span></span>
<span id="cb744-17"><a href="cap-publicidad.html#cb744-17" tabindex="-1"></a>    <span class="at">paid_media_signs =</span> <span class="fu">c</span>(<span class="st">"positive"</span>, <span class="st">"positive"</span>, <span class="st">"positive"</span>, <span class="st">"positive"</span>, <span class="st">"positive"</span>),</span>
<span id="cb744-18"><a href="cap-publicidad.html#cb744-18" tabindex="-1"></a>    <span class="at">paid_media_vars =</span> <span class="fu">c</span>(<span class="st">"display_imp"</span>, <span class="st">"onlinevideo_imp"</span>,   </span>
<span id="cb744-19"><a href="cap-publicidad.html#cb744-19" tabindex="-1"></a>                        <span class="st">"paidsearch_imp"</span>    ,<span class="st">"resto_off_inv"</span> ,<span class="st">"tv_grps20"</span>), <span class="co"># variables de impacto si están disponibles. Si no están disponibles utilice el coste como en el caso de Resto_off_inversion</span></span>
<span id="cb744-20"><a href="cap-publicidad.html#cb744-20" tabindex="-1"></a>    <span class="at">factor_vars =</span> <span class="fu">c</span>(<span class="st">"eventos"</span>) <span class="co"># especifique variables que son factores. En nuestro caso, sólo la variable de Eventos</span></span>
<span id="cb744-21"><a href="cap-publicidad.html#cb744-21" tabindex="-1"></a>    <span class="at">window_start =</span> <span class="st">"2018-10-01"</span>, <span class="co">#fecha de inicio del modelo. En nuestro caso, octubre 2010 porque previamente no se tienen datos de reservas</span></span>
<span id="cb744-22"><a href="cap-publicidad.html#cb744-22" tabindex="-1"></a>    <span class="at">window_end =</span> <span class="st">"2021-09-27"</span>, <span class="co">#fecha fin del modelo</span></span>
<span id="cb744-23"><a href="cap-publicidad.html#cb744-23" tabindex="-1"></a>    <span class="at">adstock =</span> <span class="st">"geometric"</span> <span class="co"># tipo de adstock. Seleccione el adstock geométrico para reducir tiempos de cómputo</span></span>
<span id="cb744-24"><a href="cap-publicidad.html#cb744-24" tabindex="-1"></a>  )</span>
<span id="cb744-25"><a href="cap-publicidad.html#cb744-25" tabindex="-1"></a><span class="fu">print</span>(InputCollect)</span></code></pre></div>
<p>Después, se obtienen los nombres de los hiperparámetros a ajustar:</p>
<div class="sourceCode" id="cb745"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">hyper_names</span><span class="op">(</span>adstock <span class="op">=</span> <span class="va">InputCollect</span><span class="op">$</span><span class="va">adstock</span>, all_media <span class="op">=</span> <span class="va">InputCollect</span><span class="op">$</span><span class="va">all_media</span><span class="op">)</span></span></code></pre></div>
<p>A continuación, se definen los rangos en los que se moverán los hiperparámetros que definen la <em>S curve</em> de cada medio. En este ejemplo se utilizan los mismos límites para <span class="math inline">\(\alpha\)</span> y <span class="math inline">\(\gamma\)</span>, que controlan la forma de la curva y el punto de inflexión, respectivamente. Por otro lado, <span class="math inline">\(\theta\)</span> define el <em>adstock</em>, que se puede acotar teniendo en cuenta los intervalos recomendados por Meta: TV (entre 0,3 y 0,8), Resto Medios Offline (entre 0,1 y 0,4) y Digital (entre 0 y 0,3). En este caso, se deja <span class="math inline">\(\theta\)</span> libre entre 0 y 0,99 para todos los medios:</p>
<div class="sourceCode" id="cb746"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hyperparameters</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>  display_inv_alphas <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.0001</span>, <span class="fl">3</span><span class="op">)</span>,display_inv_gammas <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  display_inv_thetas <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.99</span><span class="op">)</span>, onlinevideo_inv_alphas <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.0001</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  onlinevideo_inv_gammas <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">1</span><span class="op">)</span>, onlinevideo_inv_thetas <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.99</span><span class="op">)</span>,</span>
<span>  paidsearch_inv_alphas <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.0001</span>, <span class="fl">3</span><span class="op">)</span>, paidsearch_inv_gammas <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  paidsearch_inv_thetas <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.99</span><span class="op">)</span>, resto_off_inv_alphas <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.0001</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  resto_off_inv_gammas <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">1</span><span class="op">)</span>, resto_off_inv_thetas <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.99</span><span class="op">)</span>,</span>
<span>  tv_inv_alphas <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.0001</span>, <span class="fl">3</span><span class="op">)</span>, tv_inv_gammas <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">1</span><span class="op">)</span>,tv_inv_thetas <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.99</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Se añaden los hiperparámetros al <em>input</em> para ajustar los modelos:</p>
<div class="sourceCode" id="cb747"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">InputCollect</span> <span class="op">&lt;-</span> <span class="fu">robyn_inputs</span><span class="op">(</span>InputCollect <span class="op">=</span> <span class="va">InputCollect</span>, </span>
<span>                             hyperparameters <span class="op">=</span> <span class="va">hyperparameters</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://www.math.uzh.ch/pages/spam/reference/print.html">print</a></span><span class="op">(</span><span class="va">InputCollect</span><span class="op">)</span></span></code></pre></div>
<p>y se ejecuta el modelo definiendo el número de iteraciones y <em>trials</em>. En este ejercicio, el número de iteraciones será 2.000 y el de <em>trials</em>, 10, obteniendo un total de 20.000 posibles soluciones del modelo:</p>
<div class="sourceCode" id="cb748"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">OutputModels</span> <span class="op">&lt;-</span> <span class="fu">robyn_run</span><span class="op">(</span></span>
<span>  InputCollect <span class="op">=</span> <span class="va">InputCollect</span>, </span>
<span>  iterations <span class="op">=</span> <span class="fl">2000</span>,</span>
<span>  trials <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  outputs <span class="op">=</span> <span class="cn">FALSE</span> <span class="co"># se desactivan los outputs que se guardarán después</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://www.math.uzh.ch/pages/spam/reference/print.html">print</a></span><span class="op">(</span><span class="va">OutputModels</span><span class="op">)</span></span></code></pre></div>
<p>Los mejores resultados de la modelización según el frente de Pareto (conjunto de óptimos de Pareto que minimizan el error cuadrático medio normalizado –<em>normalized root mean square error</em>, NRMSE– y la descomposición de la suma cuadrática de la distancia<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Indicador clave de Robyn que representa la diferencia entre la cuota de gasto y la cuota de efecto para las variables de medios.&lt;/p&gt;"><sup>298</sup></a> –<em>decomposition root sum of squared distance</em>, DECOMP.RSSD–) se guardan en la carpeta seleccionada:</p>
<div class="sourceCode" id="cb749"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">OutputCollect</span> <span class="op">&lt;-</span> <span class="fu">robyn_outputs</span><span class="op">(</span></span>
<span>  <span class="va">InputCollect</span>, <span class="va">OutputModels</span>,</span>
<span>  pareto_fronts <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  csv_out <span class="op">=</span> <span class="st">"all"</span>,</span>
<span>  clusters <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plot_pareto <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plot_folder <span class="op">=</span> <span class="va">ruta_outputs</span> <span class="co">#ruta para exportar los resultados</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://www.math.uzh.ch/pages/spam/reference/print.html">print</a></span><span class="op">(</span><span class="va">OutputCollect</span><span class="op">)</span></span></code></pre></div>
<p>Para finalizar, se revisan los distintos modelos obtenidos y el resumen gráfico proporcionado por <code>Robyn</code>. Se recomienda profundizar en la interpretación de uno de los modelos obtenidos con buen ajuste. A través del <em>one-pager</em> (Fig. <a href="cap-publicidad.html#fig:output-robyn">49.2</a>), se puede consultar toda la información relativa al impacto de la publicidad, incluyendo métricas relativas a la bondad del ajuste como el coeficiente de determinación o R2 y el NRMSE (panel superior izquierdo).</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:output-robyn"></span>
<img src="img/Output_Robyn_7_394_4.PNG" alt="One-pager de resultados de Robyn." width="100%"><p class="caption">
Figura 49.2: One-pager de resultados de Robyn.
</p>
</div>
<p>Los principales <em>outputs</em> a evaluar de los modelos se visualizan en los gráficos del <em>one-pager</em>:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Descomposición en cascada de la repuesta por predictor</strong> (<em>Response Decomposition Waterfall by Predictor</em>): representa el peso de cada una de las variables en el modelo. En el ejemplo, el peso de la publicidad es del 54,5% (suma de los pesos de las variables de inversiones).</p></li>
<li><p><strong>Respuesta real</strong> <strong><em>vs.</em></strong> <strong>estimada</strong> (<em>Actual vs. Predicted Response</em>): muestra el ajuste del modelo. En este caso, la línea del ajuste (azul) y la real (naranja) se aproximan bastante, indicando que el modelo es capaz de explicar la mayor parte de la variabilidad de la serie de reservas.</p></li>
<li><p><strong>Cuota de gasto frente a cuota de efecto con coste por adqusisición (CPA) total</strong> (<em>Share of Spend vs. Share of Effect with total CPA</em>): muestra la relación entre la cuota de inversión y la cuota de contribución generada por las inversiones publicitarias. En este ejercicio, se puede observar que tanto Online Video como Display obtienen un aporte mayor de lo esperado por su cuota de inversión, lo que hace que el CPA (valores en azul) sea menor para estos medios. La TV se encuentra en el polo opuesto, con el máximo CPA, es decir, es el medio menos eficiente a la hora de generar reservas.</p></li>
<li><p><strong>Curvas de respuesta y gastos medios por canal</strong> (<em>Response Curves and Mean Spends by Channel</em>): muestra la relación no lineal existente entre las inversiones y las reservas. Es el <em>input</em> principal a la hora de optimizar las inversiones.</p></li>
<li><p><strong>Adstock geométrico: tasa constante de decrecimiento en el tiempo</strong> (<em>Geometric Adstock: Fixed Decay Rate Over Time</em>): muestra el efecto recuerdo (<em>adstock</em>) de cada medio publicitario. Se puede observar que los medios offline (TV y Resto Medios Offline) son aquellos que presentan un efecto recuerdo más prolongado. No se debe olvidar que la configuración del modelo permite fijar el rango de valores que puede tomar el <em>adstock</em> en cada uno de los medios.</p></li>
<li><p><strong>Ajustados frente a residuos</strong> (<em>Fitted vs. Residual</em>): muestra la nube de puntos para los datos ajustados (eje x) y los residuos (eje y). Este gráfico debe mostrar que los puntos están aleatoriamente ubicados alrededor del eje horizontal.</p></li>
</ol>
<p>Y, ¿cómo se pueden optimizar las inversiones en medios empleando estos resultados? En primer lugar, se pueden utilizar las curvas obtenidas (parámetros guardados en el fichero <em>all_hyperparameters.csv</em>) para simular distintos escenarios y seleccionar el que genere un mayor número de reservas. La segunda opción es utilizar la documentación de código<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;Documentación de &lt;code&gt;Robyn&lt;/code&gt; disponible en &lt;a href="https://github.com/facebookexperimental/Robyn/blob/main/demo/demo.R"&gt;https://github.com/facebookexperimental/Robyn/blob/main/demo/demo.R&lt;/a&gt;&lt;/p&gt;'><sup>299</sup></a> incluida en el paso 5 para generar el reparto óptimo de inversión basado en un presupuesto preestablecido.</p>
<p>En este capítulo se dan los primeros pasos en la medición y optimización del ROI de las inversiones publicitarias. Se anima al lector a que siga profundizando en este campo tan apasionante y complejo para basar las decisiones futuras de inversión en análisis desarrollados en <strong>R</strong>.</p>
<!-- ```{r img-paq-cdr, echo=FALSE, out.width='15%',} -->
<!-- knitr::include_graphics("img/LogoCDR_transparente.png") -->
<!-- ``` -->

</div>
</div>

  <div class="chapter-nav">
<div class="prev"><a href="cap-crimen.html"><span class="header-section-number">48</span> Análisis de una red criminal</a></div>
<div class="next"><a href="cap-twitter.html"><span class="header-section-number">50</span> ¿Cómo tuitea Elon Musk?</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="Índice del capítulo"><h2>Índice del capítulo</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#cap-publicidad"><span class="header-section-number">49</span> Optimización de inversiones publicitarias</a></li>
<li><a class="nav-link" href="#metodolog%C3%ADas-para-optimizar-las-inversiones-publicitarias"><span class="header-section-number">49.1</span> Metodologías para optimizar las inversiones publicitarias</a></li>
<li><a class="nav-link" href="#robyn-como-alternativa-open-source-en-r"><span class="header-section-number">49.2</span> Robyn como alternativa open source en R</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Fundamentos de ciencia de datos con <strong>R</strong></strong>" coordinado por <a href="https://blog.uclm.es/gemafaviles/" class="text-light">Gema Fernández-Avilés y José-María Montero</a>. Generado por última vez el día 2023-11-13.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>Este libro ha sido generado con el paquete de R <a class="text-light" href="https://bookdown.org">bookdown</a>.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
