<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Capítulo 14 Muestreo y remuestreo | Fundamentos de ciencia de datos con R</title>
<meta name="author" content="Gema Fernández-Avilés y José-María Montero">
<meta name="description" content="Mª Leticia Meseguer Santamaría\(^{a}\) y Manuel Vargas Vargas\(^{a}\) \(^{a}\) Universidad de Castilla-La Mancha  14.1 Introducción al muestreo Muchas investigaciones científicas abordan el...">
<meta name="generator" content="bookdown 0.37 with bs4_book()">
<meta property="og:title" content="Capítulo 14 Muestreo y remuestreo | Fundamentos de ciencia de datos con R">
<meta property="og:type" content="book">
<meta property="og:image" content="/img/cover.png">
<meta property="og:description" content="Mª Leticia Meseguer Santamaría\(^{a}\) y Manuel Vargas Vargas\(^{a}\) \(^{a}\) Universidad de Castilla-La Mancha  14.1 Introducción al muestreo Muchas investigaciones científicas abordan el...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Capítulo 14 Muestreo y remuestreo | Fundamentos de ciencia de datos con R">
<meta name="twitter:description" content="Mª Leticia Meseguer Santamaría\(^{a}\) y Manuel Vargas Vargas\(^{a}\) \(^{a}\) Universidad de Castilla-La Mancha  14.1 Introducción al muestreo Muchas investigaciones científicas abordan el...">
<meta name="twitter:image" content="/img/cover.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.6.1/transition.js"></script><script src="libs/bs3compat-0.6.1/tabs.js"></script><script src="libs/bs3compat-0.6.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><link href="libs/tabwid-1.1.3/tabwid.css" rel="stylesheet">
<script src="libs/tabwid-1.1.3/tabwid.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="bs4_style.css">
<link rel="stylesheet" href="bs4_book.css">
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Fundamentos de ciencia de datos con <strong>R</strong></a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Buscar" aria-label="Buscar">
</form>

      <nav aria-label="Contenido"><h2>Contenido</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Prefacio</a></li>
<li><a class="" href="pr%C3%B3logo-by-julia-silge.html">Prólogo (by Julia Silge)</a></li>
<li><a class="" href="pr%C3%B3logo-por-yanina-bellini.html">Prólogo (por Yanina Bellini)</a></li>
<li class="book-part">Ciencia, datos, software… y científicos</li>
<li><a class="" href="ciencia-datos.html"><span class="header-section-number">1</span> ¿Es la ciencia de datos una ciencia?</a></li>
<li><a class="" href="metodologia.html"><span class="header-section-number">2</span> Metodología en ciencia de datos</a></li>
<li><a class="" href="ch-110003.html"><span class="header-section-number">3</span> R para ciencia de datos</a></li>
<li><a class="" href="cap-etica.html"><span class="header-section-number">4</span> Ética en la ciencia de datos</a></li>
<li class="book-part">Bienvenidos a la jungla de datos</li>
<li><a class="" href="datos-sql.html"><span class="header-section-number">5</span> Gestión de bases de datos relacionales</a></li>
<li><a class="" href="cap-nosql.html"><span class="header-section-number">6</span> Gestión de bases de datos NoSQL</a></li>
<li><a class="" href="DGDQM.html"><span class="header-section-number">7</span> Gobierno, gestión y calidad del dato</a></li>
<li><a class="" href="cap-130009.html"><span class="header-section-number">8</span> Integración y limpieza de datos</a></li>
<li><a class="" href="chap-feature.html"><span class="header-section-number">9</span> Selección y transformación de variables</a></li>
<li><a class="" href="chap-herramientas.html"><span class="header-section-number">10</span> Herramientas para el análisis en ciencia de datos</a></li>
<li><a class="" href="cap-120006-aed.html"><span class="header-section-number">11</span> Análisis exploratorio de datos</a></li>
<li class="book-part">Fundamentos de estadística</li>
<li><a class="" href="Funda-probab.html"><span class="header-section-number">12</span> Probabilidad</a></li>
<li><a class="" href="Fundainfer.html"><span class="header-section-number">13</span> Inferencia estadística</a></li>
<li><a class="active" href="muestreo.html"><span class="header-section-number">14</span> Muestreo y remuestreo</a></li>
<li class="book-part">Modelización estadística</li>
<li><a class="" href="cap-lm.html"><span class="header-section-number">15</span> Modelización lineal</a></li>
<li><a class="" href="cap-glm.html"><span class="header-section-number">16</span> Modelos lineales generalizados</a></li>
<li><a class="" href="cap-gam.html"><span class="header-section-number">17</span> Modelos aditivos generalizados</a></li>
<li><a class="" href="cap-mxm.html"><span class="header-section-number">18</span> Modelos mixtos</a></li>
<li><a class="" href="cap-sparse.html"><span class="header-section-number">19</span> Modelos \(\textit{sparse}\) y métodos penalizados de regresión</a></li>
<li><a class="" href="cap-series-temp.html"><span class="header-section-number">20</span> Modelización de series temporales</a></li>
<li><a class="" href="cap-discriminante.html"><span class="header-section-number">21</span> Análisis discriminante</a></li>
<li><a class="" href="cap-conjunto.html"><span class="header-section-number">22</span> Análisis conjunto</a></li>
<li><a class="" href="tablas-contingencia.html"><span class="header-section-number">23</span> Análisis de tablas de contingencia</a></li>
<li class="book-part">Machine learning supervisado</li>
<li><a class="" href="cap-arboles.html"><span class="header-section-number">24</span> Árboles de clasificación y regresión</a></li>
<li><a class="" href="cap-svm.html"><span class="header-section-number">25</span> Máquinas de vector soporte</a></li>
<li><a class="" href="cap-knn.html"><span class="header-section-number">26</span> Clasificador \(k\)-vecinos más próximos</a></li>
<li><a class="" href="cap-naive-bayes.html"><span class="header-section-number">27</span> Naive Bayes</a></li>
<li><a class="" href="cap-bagg-rf.html"><span class="header-section-number">28</span> Métodos ensamblados: \(\bf \textit {bagging}\) y \(\bf \textit{random}\) \(\bf \textit{forest}\)</a></li>
<li><a class="" href="cap-boosting-xgboost.html"><span class="header-section-number">29</span> \(\bf \textit{Boosting}\) y el algoritmo XGBoost</a></li>
<li class="book-part">Machine learning no supervisado</li>
<li><a class="" href="cap-cluster.html"><span class="header-section-number">30</span> Análisis clúster: clusterización jerárquica</a></li>
<li><a class="" href="no-jerarquico.html"><span class="header-section-number">31</span> Análisis clúster: clusterización no jerárquica</a></li>
<li><a class="" href="acp.html"><span class="header-section-number">32</span> Análisis de componentes principales</a></li>
<li><a class="" href="af.html"><span class="header-section-number">33</span> Análisis factorial</a></li>
<li><a class="" href="mds.html"><span class="header-section-number">34</span> Escalamiento multidimensional</a></li>
<li><a class="" href="correspondencias.html"><span class="header-section-number">35</span> Análisis de correspondencias</a></li>
<li class="book-part">Deep learning</li>
<li><a class="" href="capNN.html"><span class="header-section-number">36</span> Redes neuronales artificiales</a></li>
<li><a class="" href="cap-redes-convol.html"><span class="header-section-number">37</span> Redes neuronales convolucionales</a></li>
<li class="book-part">Ciencia de datos de texto y redes</li>
<li><a class="" href="mineria-textos.html"><span class="header-section-number">38</span> Minería de textos</a></li>
<li><a class="" href="grafos.html"><span class="header-section-number">39</span> Análisis de grafos y redes sociales</a></li>
<li class="book-part">Ciencia de datos espaciales</li>
<li><a class="" href="datos-espaciales.html"><span class="header-section-number">40</span> Trabajando con datos espaciales</a></li>
<li><a class="" href="geo.html"><span class="header-section-number">41</span> Geoestadística</a></li>
<li><a class="" href="cap-econom-esp.html"><span class="header-section-number">42</span> Modelos econométricos espaciales</a></li>
<li><a class="" href="cap-pp.html"><span class="header-section-number">43</span> Procesos de puntos</a></li>
<li class="book-part">Comunica y colabora</li>
<li><a class="" href="cap-120007-informes.html"><span class="header-section-number">44</span> Informes reproducibles con R Markdown y Quarto</a></li>
<li><a class="" href="shiny.html"><span class="header-section-number">45</span> Creación de aplicaciones web interactivas con Shiny</a></li>
<li><a class="" href="github.html"><span class="header-section-number">46</span> Git y GitHub R</a></li>
<li><a class="" href="geoproces.html"><span class="header-section-number">47</span> Geoprocesamiento en nube</a></li>
<li class="book-part">Casos de estudio en ciencia de datos</li>
<li><a class="" href="cap-crimen.html"><span class="header-section-number">48</span> Análisis de una red criminal</a></li>
<li><a class="" href="cap-publicidad.html"><span class="header-section-number">49</span> Optimización de inversiones publicitarias</a></li>
<li><a class="" href="cap-twitter.html"><span class="header-section-number">50</span> ¿Cómo tuitea Elon Musk?</a></li>
<li><a class="" href="cap-periodismo.html"><span class="header-section-number">51</span> Análisis electoral: de RStudio a su periódico favorito</a></li>
<li><a class="" href="paro-clm.html"><span class="header-section-number">52</span> El impacto de las crisis financiera y de la COVID-19 en el paro de CLM</a></li>
<li><a class="" href="cap-rfm.html"><span class="header-section-number">53</span> Segmentación de clientes en el comercio minorista</a></li>
<li><a class="" href="cap-medicina.html"><span class="header-section-number">54</span> Análisis de datos en medicina</a></li>
<li><a class="" href="cap-futbol.html"><span class="header-section-number">55</span> Messi y Ronaldo: dos ídolos desde la perspectiva de los datos</a></li>
<li><a class="" href="cambioclimatico.html"><span class="header-section-number">56</span> Una nota sobre el cambio climático</a></li>
<li><a class="" href="cap-sist-exp.html"><span class="header-section-number">57</span> Implementación de un sistema experto en el ámbito pediátrico</a></li>
<li><a class="" href="cap-ree.html"><span class="header-section-number">58</span> Predicción de consumo eléctrico con redes neuronales artificiales</a></li>
<li><a class="" href="nlp-textil.html"><span class="header-section-number">59</span> El procesamiento del lenguaje natural para tendencias de moda en textil</a></li>
<li><a class="" href="cap-fraude.html"><span class="header-section-number">60</span> Detección de fraude de tarjetas de crédito</a></li>
<li class="book-part">Appendix</li>
<li><a class="" href="info-session.html"><span class="header-section-number">A</span> Información de la sesión</a></li>
<li><a class="" href="referencias.html">Referencias</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="muestreo" class="section level1" number="14">
<h1>
<span class="header-section-number">Capítulo 14</span> Muestreo y remuestreo<a class="anchor" aria-label="anchor" href="#muestreo"><i class="fas fa-link"></i></a>
</h1>
<p><em>Mª Leticia Meseguer Santamaría</em><span class="math inline">\(^{a}\)</span> y <em>Manuel Vargas Vargas</em><span class="math inline">\(^{a}\)</span></p>
<p><span class="math inline">\(^{a}\)</span> Universidad de Castilla-La Mancha</p>
<div id="introducción-al-muestreo" class="section level2" number="14.1">
<h2>
<span class="header-section-number">14.1</span> Introducción al muestreo<a class="anchor" aria-label="anchor" href="#introducci%C3%B3n-al-muestreo"><i class="fas fa-link"></i></a>
</h2>
<p>Muchas investigaciones científicas abordan el estudio de características de un conjunto de elementos, que se denomina <strong>población</strong>. Sin embargo, no siempre es posible estudiar la totalidad del colectivo, por problemas de accesibilidad, confidencialidad, costes económicos o temporales, etc. En estos casos, se recurre a extraer un subconjunto de la población que se pretende que sea representativo de esta respecto a las características estudiadas. El objetivo es obtener información relevante que pueda extrapolarse al total de la población, proceso denominado genéricamente <strong>muestreo</strong>.</p>
<p>En otros casos, la conveniencia de muestrear una población está relacionada con la credibilidad de los resultados obtenidos o de las propiedades de los modelos utilizados. Así, muchas técnicas cuantitativas dividen la información (muestra) disponible en un subconjunto de <strong>entrenamiento</strong> o <strong>estimación</strong> y otro de <strong>contraste</strong> o <strong>validación</strong>; una elección inadecuada puede alterar los resultados e invalidar las conclusiones. Por último, caso muy común en ciencias sociales, no se puede acceder a la medición directa de los fenómenos (por ser una población muy grande o un fenómeno subjetivo), por lo que se accede a ella mediante encuestas, que precisan de una metodología de muestreo rigurosa y diseñada previamente.</p>
<p>Para fijar terminología, se define <strong>población</strong> como el conjunto de casos de interés a los que se quieren generalizar los resultados de la investigación, denominados genéricamente <strong>individuos</strong>; a veces, solo es posible acceder a una parte de la población, por lo que se utiliza el término <strong>población objetivo</strong> para el conjunto total y <strong>población muestreable</strong> al conjunto al que se tiene acceso. Por coherencia, cuando ambos colectivos no coincidan, los resultados deben extrapolarse solo al último de ellos.</p>
<p>Las características de interés de la población se consideran <strong>variables</strong>, en el sentido estadístico del término, por lo que son estudiadas mediante su distribución. En algunos casos, esta será completamente desconocida, siendo de interés su determinación completa; en otros muchos, se buscará determinar sólo algunos aspectos (medidas de posición, dispersión, etc.) o los parámetros que rigen una distribución funcionalmente conocida. En todo caso, el objetivo del estudio es determinar la distribución estadística de estas variables, conocida como <strong>distribución poblacional</strong>; a veces, por simplicidad en el lenguaje, a esta distribución o, incluso, a las variables, se las denomina población (por ejemplo, no es infrecuente encontrar enunciados del tipo “la población sigue una distribución binomial”, identificando población con variable, o “la población es una distribución normal”, identificando población con distribución).</p>
<p>Se define <strong>muestra</strong> como un subconjunto de la población, que será utilizado para caracterizar la distribución poblacional y <strong>unidad muestral</strong> a cada individuo de la muestra. Si la muestra tiene la misma distribución que la población, se dice que es <strong>representativa</strong>, mientras que en caso contrario se denomina <strong>sesgada</strong>.</p>
<p>Siempre será preferible un método de muestreo que proporcione muestras representativas, característica ligada a la forma de seleccionar la muestra y al tamaño de esta. Así, siempre que sea posible, se recomienda utilizar un <strong>muestreo probabilístico</strong>, basado en la selección aleatoria de la muestra (conociéndose, por tanto, la probabilidad de que cada individuo salga seleccionado), lo que permite extender los resultados a toda la población, cuantificando posibles sesgos y detallando un error máximo dentro de un nivel de confianza seleccionado al inicio del proceso.</p>
<p>No siempre será posible utilizar un muestreo probabilístico, por lo que existe una colección de métodos de muestreo no probabilístico (conveniencia, bola de nieve, cuotas, etc.), que no se detallarán en este capítulo. La característica común a todos ellos es que los resultados obtenidos de la muestra no se deben extrapolar a la población, ya que no está garantizada la representatividad.</p>
<p>En el resto del capítulo se presentarán brevemente los métodos de muestreo probabilístico más usuales. Para mayor detalle, se pueden consultar las referencias <span class="citation">Chaudhuri and Stenger (<a href="referencias.html#ref-ChaudhuriStenger2005">2005</a>)</span>, <span class="citation">Arnab (<a href="referencias.html#ref-Arnab2017">2017</a>)</span> o <span class="citation">C. Wu and Thompson (<a href="referencias.html#ref-WuThompson2020">2020</a>)</span>.</p>
</div>
<div id="MAS" class="section level2" number="14.2">
<h2>
<span class="header-section-number">14.2</span> Muestreo aleatorio simple<a class="anchor" aria-label="anchor" href="#MAS"><i class="fas fa-link"></i></a>
</h2>
<p>El método básico de muestreo es el conocido como <strong>muestreo aleatorio simple (m.a.s.)</strong>, ya introducido en la Sec. <a href="Fundainfer.html#mas">13.2</a>, consistente en seleccionar totalmente al azar a los individuos de la muestra, por lo que todos tienen la misma probabilidad de formar parte de ella. Si cada individuo solo puede aparecer una vez en la muestra, se habla de <strong>muestreo aleatorio sin reemplazamiento</strong> o <strong>muestreo aleatorio irrestricto</strong>, mientras que, en caso contrario, se denomina <strong>muestreo con reemplazamiento</strong> o, en general, <strong>muestreo aleatorio simple</strong>.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Un muestreo aleatorio con reemplazamiento garantiza la independencia entre los elementos de la muestra seleccionada, mientras que un muestreo irrestricto no garantiza tal propiedad. Como consecuencia, el cálculo de las varianzas en ambos casos difiere ligeramente; sin embargo, dicha diferencia converge a cero cuando el tamaño poblacional aumenta. Así, para tamaños grandes, es casi equivalente hablar de muestreo irrestricto (sin reemplazo) que de m.a.s. (con reemplazo). En este epígrafe se ha optado por presentar los resultados en el primer caso y, como límite, los del segundo.&lt;/p&gt;"><sup>111</sup></a></p>
<p>Este procedimiento es el que se asume en la inmensa mayoría de las técnicas estadísticas convencionales, pero presenta dos inconvenientes. En primer lugar, presupone que existe un registro, o listado, completo de todos los individuos de la población (lo que no siempre es posible), y su aplicación práctica puede resultar costosa (en medios, tiempo y dinero). En segundo lugar, presupone que la característica estudiada es homogénea en todos los individuos de la población, es decir, la distribución poblacional es idéntica en todos los individuos. Frecuentemente, esta homogeneidad poblacional no se cumple, por lo que sería necesario abordar otros métodos de muestreo que se expondrán más adelante. En todo caso, si se utiliza un m.a.s., la heterogeneidad induce un aumento de la variabilidad muestral, hecho que debe ser tenido en cuenta en la interpretación de resultados.</p>
<p>Además de la forma de selección, el factor que determina la representatividad de una muestra es su tamaño (véase el teorema de Glivenko-Cantelli mostrado en la ecuación <a href="Fundainfer.html#eq:glivenko">(13.3)</a>). Al utilizar la información muestral para aproximar los aspectos o parámetros desconocidos en la población se comete el llamado <strong>error muestral</strong>, que representa el margen de error que se está dispuesto a aceptar (por tanto, está íntimamente relacionado con los intervalos de confianza)<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Por ejemplo, si la proporción de votantes que vota a un determinado partido ha sido estimada en el 60% y el margen de error muestral se fija en el 3%, para un nivel de confianza del 95%, se puede concluir que, con dicho nivel de confianza, el porcentaje de votantes a dicho partido estará entre el 57% y el 63% del total de votantes.&lt;/p&gt;"><sup>112</sup></a>; si el tamaño de la muestra está determinado, el margen de error muestral marca el grado de precisión con el que se pueden extrapolar los resultados. Una alternativa es predeterminar un error muestral a cierto nivel de confianza y calcular cuál es el menor tamaño muestral que cumple ese requisito.</p>
<p>El margen de error (o simplemente error muestral), <span class="math inline">\(\epsilon\)</span>, depende del aspecto o parámetro poblacional que se quiera conocer (frecuentemente, la media, el total poblacional o la proporción), del estimador utilizado y del nivel de confianza. Si se asume una distribución poblacional normal, la expresión general sería:</p>
<p><span class="math display" id="eq:error">\[\begin{equation}
\tag{14.1}
\epsilon_\alpha = z_{1-\alpha/2}\sigma(\hat \theta),
\end{equation}\]</span></p>
<p>expresión que es frecuentemente extrapolada a distribuciones poblacionales no normales.</p>
<p>Para el caso de estimar la media poblacional utilizando la media muestral, sustituyendo en la ecuación anterior <a href="muestreo.html#eq:error">(14.1)</a>, la relación entre error muestral, nivel de confianza y tamaño muestral sería:</p>
<p><span class="math display" id="eq:error2">\[\begin{equation}
\tag{14.2}
\epsilon_\alpha = z_{1-\alpha/2}\sqrt{(1-{n\over N}) {s^2 \over n}}.
\end{equation}\]</span></p>
<p>Operando y despejando el tamaño muestral, se obtiene la expresión:</p>
<p><span class="math display" id="eq:tam">\[\begin{equation}
\tag{14.3}
n = {z^2_{1-\alpha/2} Ns^2 \over N\epsilon^2_\alpha + z^2_{1-\alpha/2}s^2}.
\end{equation}\]</span></p>
<p>En algunos casos se considera que se está muestreando una población de tamaño infinito, lo que produce una simplificación de la fórmula de obtención del tamaño muestral:</p>
<p><span class="math display" id="eq:error3">\[\begin{equation}
\tag{14.4}
\epsilon_\alpha = z_{1-\alpha/2}\sqrt{s^2 \over n} \Longrightarrow n = {z^2_{1-\alpha/2} s^2 \over \epsilon^2_\alpha}.
\end{equation}\]</span></p>
<p>Si se está interesado en estimar el total poblacional, un procedimiento análogo conduce a las ecuaciones:</p>
<p><span class="math display" id="eq:tot">\[\begin{equation}
\tag{14.5}
\epsilon_\alpha = z_{1-\alpha/2}\sqrt{N^2(1-{n\over N}) {s^2 \over n}} \Longrightarrow n = {z^2_{1-\alpha/2} N^2s^2 \over \epsilon^2_\alpha + z^2_{1-\alpha/2}Ns^2}.
\end{equation}\]</span></p>
<p>Por último, si se desea estimar la proporción poblacional, <span class="math inline">\(P\)</span>, de individuos que cumplen algún criterio, se puede particularizar el caso del estimador de la media poblacional sobre una población binomial, por lo que el resultado obtenido es:</p>
<p><span class="math display" id="eq:prop">\[\begin{equation}
\tag{14.6}
n = {z^2_{1-\alpha/2} Npq \over (N-1)\epsilon^2_\alpha + z^2_{1-\alpha/2}pq},
\end{equation}\]</span></p>
<p>siendo <span class="math inline">\(q=1-p\)</span>.</p>
<p>En la práctica es muy frecuente que se desconozca la varianza poblacional, por lo que se suele recurrir a alguna estimación previa, con lo que se tiene una aproximación al tamaño muestral requerido.</p>
<div id="ejemMAS" class="section level3" number="14.2.1">
<h3>
<span class="header-section-number">14.2.1</span> Ejemplo de m.a.s. en <strong>R</strong><a class="anchor" aria-label="anchor" href="#ejemMAS"><i class="fas fa-link"></i></a>
</h3>
<p>Para ejemplificar el proceso de obtención de una muestra aleatoria simple en <strong>R</strong>, se usará el paquete <code>samplingbook</code> y el conjunto de datos <code>iris</code>, correspondiente a las medidas, en centímetros, de largo y ancho de los sépalos y pétalos de 150 flores, equidistribuidas entre las especies <em>setosa</em>, <em>versicolor</em> y <em>virginica</em>.</p>
<div class="sourceCode" id="cb184"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://www.samplingbook.manitz.org">"samplingbook"</a></span><span class="op">)</span></span>
<span><span class="va">datos_ej</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span></span></code></pre></div>
<p>En este caso, por simplicidad, se considerará que la población es el conjunto de las 150 flores disponibles, y que se desea una muestra aleatoria simple con reemplazamiento para determinar la longitud media de los sépalos con un error de 0,3 centímetros al 95% de confianza. La función <code><a href="https://www.samplingbook.manitz.org/reference/sample.size.mean.html">sample.size.mean()</a></code> permite calcular el tamaño de muestra necesario para cumplir estos requisitos.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;Dado el tamaño poblacional finito &lt;span class="math inline"&gt;\((N = 150)\)&lt;/span&gt;, la función utiliza una corrección de población finita para la obtención del tamaño muestral que garantice el error máximo prefijado.&lt;/p&gt;'><sup>113</sup></a></p>
<div class="sourceCode" id="cb185"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">datos_ej</span><span class="op">$</span><span class="va">Sepal.Length</span><span class="op">)</span> <span class="co"># Se considera como la desviación típica poblacional</span></span>
<span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">datos_ej</span><span class="op">)</span> <span class="co"># Tamaño de la población</span></span>
<span><span class="va">e</span> <span class="op">&lt;-</span> <span class="fl">0.3</span> <span class="co"># Margen de error prefijado</span></span>
<span><span class="fu"><a href="https://www.samplingbook.manitz.org/reference/sample.size.mean.html">sample.size.mean</a></span><span class="op">(</span><span class="va">e</span>, <span class="va">sd</span>, <span class="va">N</span>, level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; sample.size.mean object: Sample size for mean estimate</span></span>
<span><span class="co">#&gt; With finite population correction: N=150, precision e=0.3 and standard deviation S=0.8281</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Sample size needed: 25</span></span></code></pre></div>
<p>Así, basta con una muestra aleatoria simple de tamaño 25 para poder estimar la longitud media de los sépalos con los requisitos dados. Para obtener la muestra concreta, la función <code>sample</code> proporciona los valores obtenidos (conjunto de 25 valores aleatorios entre 1 y N=150) y permite seleccionar los casos que conforman la muestra:</p>
<div class="sourceCode" id="cb186"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">196</span><span class="op">)</span> <span class="co"># Fija la semilla de aleatorización para poder reproducir los resultados</span></span>
<span><span class="va">muestra</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">N</span>, <span class="fl">25</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># Si se quisiera un muestreo sin reemplazo, se utilizaría la sentencia replace=FALSE</span></span>
<span><span class="va">datos_muestra</span> <span class="op">&lt;-</span> <span class="va">datos_ej</span><span class="op">[</span><span class="va">muestra</span>, <span class="op">]</span> <span class="co"># Se seleccionan los datos que conforman la muestra</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">datos_muestra</span><span class="op">)</span></span>
<span><span class="co">#&gt;      Sepal.Length Sepal.Width Petal.Length Petal.Width    Species</span></span>
<span><span class="co">#&gt; 122           5.6         2.8          4.9         2.0  virginica</span></span>
<span><span class="co">#&gt; 133           6.4         2.8          5.6         2.2  virginica</span></span>
<span><span class="co">#&gt; 104           6.3         2.9          5.6         1.8  virginica</span></span>
<span><span class="co">#&gt; 95            5.6         2.7          4.2         1.3 versicolor</span></span>
<span><span class="co">#&gt; 95.1          5.6         2.7          4.2         1.3 versicolor</span></span>
<span><span class="co">#&gt; 73            6.3         2.5          4.9         1.5 versicolor</span></span></code></pre></div>
<p>Para finalizar, usando la función <code><a href="https://www.samplingbook.manitz.org/reference/Smean.html">Smean()</a></code> se puede obtener la estimación de la media poblacional, así como su error estándar y un intervalo de confianza. Aunque en la práctica el valor poblacional es desconocido, en este ejemplo sí se puede obtener a partir del conjunto de todos los datos, lo que permite comparar la estimación con el verdadero valor buscado.</p>
<div class="sourceCode" id="cb187"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://www.samplingbook.manitz.org/reference/Smean.html">Smean</a></span><span class="op">(</span><span class="va">datos_muestra</span><span class="op">$</span><span class="va">Sepal.Length</span>, <span class="va">N</span>, level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Smean object: Sample mean estimate</span></span>
<span><span class="co">#&gt; With finite population correction: N=150</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Mean estimate: 5.976</span></span>
<span><span class="co">#&gt; Standard error: 0.1115</span></span>
<span><span class="co">#&gt; 95% confidence interval: [5.7575,6.1945]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">datos_ej</span><span class="op">$</span><span class="va">Sepal.Length</span><span class="op">)</span> <span class="co"># Valor de la media poblacional</span></span>
<span><span class="co">#&gt; [1] 5.843333</span></span></code></pre></div>
<p>En este ejemplo, el error cometido sería de 5,976 - 5,843 = 0,133 cm.</p>
<p>Si interesa estimar el total poblacional, basta con multiplicar la estimación de la media por el tamaño poblacional, <span class="math inline">\(N\)</span>. Por último, si se desea estimar una proporción poblacional, el proceso sería idéntico al descrito, pero usando la función <code><a href="https://www.samplingbook.manitz.org/reference/Sprop.html">Sprop()</a></code>.</p>
</div>
</div>
<div id="muestestra" class="section level2" number="14.3">
<h2>
<span class="header-section-number">14.3</span> Muestreo estratificado<a class="anchor" aria-label="anchor" href="#muestestra"><i class="fas fa-link"></i></a>
</h2>
<p>Una consecuencia del muestreo aleatorio simple es que “reproduce” las características de la población, entre otros aspectos, su variabilidad, que se asumen comunes a todos los individuos. Sin embargo, es frecuente que haya “grupos” de individuos que presenten diferencias en los parámetros que rigen la distribución poblacional (por ejemplo, en sus medias o en sus varianzas) de la característica que se quiere estudiar.</p>
<p>En el ejemplo anterior (<a href="muestreo.html#ejemMAS">14.2.1</a>), se ha muestreado para estimar la longitud media de los sépalos de las 150 flores recogidas en los datos. Sin embargo, al calcular la media y la desviación típica agrupando según la especie:</p>
<div class="sourceCode" id="cb188"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="http://had.co.nz/plyr">"plyr"</a></span><span class="op">)</span></span>
<span><span class="va">estratos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/plyr/man/ddply.html">ddply</a></span><span class="op">(</span><span class="va">datos_ej</span>, <span class="fu"><a href="https://rdrr.io/pkg/plyr/man/quoted.html">.</a></span><span class="op">(</span><span class="va">Species</span><span class="op">)</span>, <span class="va">summarize</span>,</span>
<span>  media.sl <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Sepal.Length</span><span class="op">)</span>,</span>
<span>  desv.sl <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">Sepal.Length</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">estratos</span></span>
<span><span class="co">#&gt;      Species media.sl   desv.sl</span></span>
<span><span class="co">#&gt; 1     setosa    5.006 0.3524897</span></span>
<span><span class="co">#&gt; 2 versicolor    5.936 0.5161711</span></span>
<span><span class="co">#&gt; 3  virginica    6.588 0.6358796</span></span></code></pre></div>
<p>puede observarse que las tres especies no se comportan igual respecto al parámetro de interés (longitud media de los sépalos). La especie <em>setosa</em> presenta unos valores menores de longitud media y desviación típica, mientras que la especie <em>virginica</em> presenta los valores más elevados.</p>
<p>Si no se considerara la especie, un muestreo aleatorio simple podría sesgar los resultados, por ejemplo, con un predominio de las <em>setosa</em> o de las <em>virginica</em>. En todo caso, la variabilidad del conjunto de datos es más elevada que en cualquiera de las especies, pues a la variación dentro de cada especie se une la variación entre especies. Este hecho hace aumentar el tamaño muestral necesario para estimar con un margen de error prefijado.</p>
<p>En general, cuando existen grupos de individuos con un comportamiento más homogéneo dentro del grupo y diferenciado entre grupos, no resulta apropiado aplicar un m.a.s. En estos casos, es recomendable el denominado <strong>muestreo estratificado</strong>, donde se realiza previamente una partición de la población en <strong>estratos</strong> y se selecciona una m.a.s. dentro de cada grupo.</p>
<p>La estratificación presenta ventajas, como el aumento de la representatividad de la muestra (se necesita un menor tamaño muestral total que en el m.a.s.), la reducción del error muestral (la variabilidad es menor en cada estrato) y el incremento de probabilidad de representación en la muestra de grupos con características diferenciadas. Por el contrario, no siempre resulta evidente la relación entre la variable de estratificación y las de interés.</p>
<p>Una de las decisiones que se han de tomar en el muestreo estratificado es el reparto de tamaño muestral entre los distintos estratos, procedimiento conocido como <strong>afijación</strong>. Las dos opciones más utilizadas son la <strong>afijación proporcional</strong>, que reparte el tamaño muestral en función de los tamaños poblacionales de cada estrato, y la <strong>afijación óptima</strong>, que considera también los diferentes valores de la variabilidad dentro de cada estrato.</p>
<p>Para ejemplificar el proceso de muestreo estratificado en el caso de la base de datos utilizada, se procede a considerar cada especie de iris como un estrato, ya que se ha comprobado que presentan distintas distribuciones poblacionales respecto a la variable <em>longitud del sépalo</em>. Como en la Sec. <a href="muestreo.html#ejemMAS">14.2.1</a>, se quiere estimar la longitud media de la variable con un margen de error de 0,3 al 95% de confianza. Dentro del paquete <code>samplingbook</code> se puede utilizar la función <code><a href="https://www.samplingbook.manitz.org/reference/stratasize.html">stratasize()</a></code> para determinar el tamaño muestral que cumple estos requisitos</p>
<div class="sourceCode" id="cb189"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://www.samplingbook.manitz.org/reference/stratasize.html">stratasize</a></span><span class="op">(</span><span class="va">e</span>, Nh <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">50</span>, <span class="fl">50</span><span class="op">)</span>, Sh <span class="op">=</span> <span class="va">estratos</span><span class="op">[</span>, <span class="fl">3</span><span class="op">]</span>, level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; stratamean object: Stratified sample size determination</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; type of sample: prop</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; total sample size determinated: 11</span></span></code></pre></div>
<p>Como se aprecia, para garantizar al 95% de confianza un margen de error de 0,3 cm es necesario un tamaño muestral de 11, sensiblemente inferior al requerido con un m.a.s. (25). Una vez determinado el tamaño, el criterio de afijación elegido distribuye la muestra entre los estratos.</p>
<div class="sourceCode" id="cb190"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://www.samplingbook.manitz.org/reference/stratasamp.html">stratasamp</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">11</span>, Nh <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">50</span>, <span class="fl">50</span><span class="op">)</span>, Sh <span class="op">=</span> <span class="va">estratos</span><span class="op">[</span>, <span class="fl">3</span><span class="op">]</span>, type <span class="op">=</span> <span class="st">"prop"</span><span class="op">)</span></span>
<span><span class="co">#&gt;              </span></span>
<span><span class="co">#&gt; Stratum 1 2 3</span></span>
<span><span class="co">#&gt; Size    4 4 4</span></span>
<span><span class="fu"><a href="https://www.samplingbook.manitz.org/reference/stratasamp.html">stratasamp</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">11</span>, Nh <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">50</span>, <span class="fl">50</span><span class="op">)</span>, Sh <span class="op">=</span> <span class="va">estratos</span><span class="op">[</span>, <span class="fl">3</span><span class="op">]</span>, type <span class="op">=</span> <span class="st">"opt"</span><span class="op">)</span></span>
<span><span class="co">#&gt;              </span></span>
<span><span class="co">#&gt; Stratum 1 2 3</span></span>
<span><span class="co">#&gt; Size    3 4 5</span></span></code></pre></div>
<p>Como los tres estratos tienen el mismo tamaño poblacional, la afijación proporcional distribuye la muestra equitativamente; sin embargo, la afijación óptima, al considerar las diferencias en variabilidad, asigna más muestra al estrato con mayor variabilidad y menos muestra al de menor variabilidad (como los tamaños muestrales son necesariamente números enteros, se puede producir una ligera diferencia entre el tamaño muestral calculado globalmente y la suma de los tamaños de cada estrato).</p>
<p>Con la afijación óptima estimada, se procede a la selección de la submuestra en cada estrato (m.a.s.) y a la obtención de los datos que conforman la muestra.</p>
<div class="sourceCode" id="cb191"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">195</span><span class="op">)</span> <span class="co"># Fija la semilla de aleatorización</span></span>
<span><span class="va">muestra1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">50</span>, <span class="fl">3</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">muestra2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">51</span><span class="op">:</span><span class="fl">100</span>, <span class="fl">4</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">muestra3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">101</span><span class="op">:</span><span class="fl">150</span>, <span class="fl">5</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># m.a.s. en cada estrato</span></span>
<span><span class="va">muestra_estr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">muestra1</span>, <span class="va">muestra2</span>, <span class="va">muestra3</span><span class="op">)</span></span>
<span><span class="va">datos_muestra_estr</span> <span class="op">&lt;-</span> <span class="va">datos_ej</span><span class="op">[</span><span class="va">muestra_estr</span>, <span class="op">]</span> <span class="co"># Selección de los datos que conforman la muestra</span></span>
<span><span class="va">datos_muestra_estr</span></span>
<span><span class="co">#&gt;      Sepal.Length Sepal.Width Petal.Length Petal.Width    Species</span></span>
<span><span class="co">#&gt; 26            5.0         3.0          1.6         0.2     setosa</span></span>
<span><span class="co">#&gt; 38            4.9         3.6          1.4         0.1     setosa</span></span>
<span><span class="co">#&gt; 5             5.0         3.6          1.4         0.2     setosa</span></span>
<span><span class="co">#&gt; 61            5.0         2.0          3.5         1.0 versicolor</span></span>
<span><span class="co">#&gt; 61.1          5.0         2.0          3.5         1.0 versicolor</span></span>
<span><span class="co">#&gt; 65            5.6         2.9          3.6         1.3 versicolor</span></span>
<span><span class="co">#&gt; 58            4.9         2.4          3.3         1.0 versicolor</span></span>
<span><span class="co">#&gt; 147           6.3         2.5          5.0         1.9  virginica</span></span>
<span><span class="co">#&gt; 146           6.7         3.0          5.2         2.3  virginica</span></span>
<span><span class="co">#&gt; 134           6.3         2.8          5.1         1.5  virginica</span></span>
<span><span class="co">#&gt; 130           7.2         3.0          5.8         1.6  virginica</span></span>
<span><span class="co">#&gt; 141           6.7         3.1          5.6         2.4  virginica</span></span></code></pre></div>
<p>Finalmente, usando la función <code><a href="https://www.samplingbook.manitz.org/reference/Smean.html">Smean()</a></code> se obtiene la estimación de la media poblacional, así como su error estándar y un intervalo de confianza, al igual que se hizo con el m.a.s.</p>
<div class="sourceCode" id="cb192"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://www.samplingbook.manitz.org/reference/Smean.html">Smean</a></span><span class="op">(</span><span class="va">datos_muestra_estr</span><span class="op">$</span><span class="va">Sepal.Length</span>, <span class="va">N</span>, level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Smean object: Sample mean estimate</span></span>
<span><span class="co">#&gt; With finite population correction: N=150</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Mean estimate: 5.7167</span></span>
<span><span class="co">#&gt; Standard error: 0.2393</span></span>
<span><span class="co">#&gt; 95% confidence interval: [5.2476,6.1857]</span></span></code></pre></div>
</div>
<div id="otrosmuestreos" class="section level2" number="14.4">
<h2>
<span class="header-section-number">14.4</span> Otros tipos de muestreo probabilístico<a class="anchor" aria-label="anchor" href="#otrosmuestreos"><i class="fas fa-link"></i></a>
</h2>
<p>Existen otros métodos de muestreo probabilístico que buscan simplificar la extracción de una muestra representativa, entre los que destacan el <strong>muestreo por conglomerados</strong> y el <strong>muestreo sistemático</strong>.</p>
<p>Cuando la población es muy grande, es frecuente que se puedan establecer (o construir a partir de alguna variable) subgrupos, o clústeres, que tengan las mismas características que todo el conjunto respecto a la variable de interés. En esos casos, a efectos de estimación, sería equivalente muestrear toda la población o solo un clúster, con el consiguiente ahorro de tamaño muestral, tiempo y coste. Es el conocido como <strong>muestreo por conglomerados</strong>.</p>
<p>Por ejemplo, se puede estar interesado en estimar el tiempo medio que el alumnado de educación secundaria obligatoria (ESO) dedica a estudiar matemáticas en España. Obtener una muestra para todo el país puede ser costoso en tiempo, recursos materiales y tamaño muestral; sin embargo, se puede asumir que no existen diferencias entre provincias respecto a esta variable, por lo que sería posible muestrear solo en una provincia (o pocas). En este caso, el muestreo por conglomerados consistiría en una primera etapa de selección aleatoria de clústeres (provincia/s en este ejemplo) y, posteriormente, aplicar un método de muestreo sobre dicha selección (que, a su vez, podría ser un m.a.s. o un muestreo estratificado).</p>
<p>No conviene confundir los conceptos de estrato y clúster, aunque ambos sean subgrupos de la población total. En el primer caso, los individuos de cada estrato son muy homogéneos entre sí y diferenciados del resto de estratos. En el segundo caso, los individuos de cada clúster tienen la misma variabilidad que el conjunto de la población, no habiendo diferencias entre clústers respecto a la variable de interés. Así, la ganancia en el muestreo estratificado proviene de trabajar con menores variabilidades intraestratos, mientras que en el muestreo por conglomerados proviene de utilizar una subpoblación más pequeña.</p>
<p>En otras situaciones, si se dispone de un marco poblacional (listado completo de los individuos), es posible plantear un mecanismo sencillo de obtención de la muestra. Si se tiene un tamaño poblacional <span class="math inline">\(N\)</span> y se quiere una muestra de tamaño <span class="math inline">\(n\)</span>, se pueden establecer <span class="math inline">\(k=N/n\)</span> bloques, elegir al azar un número entre 1 y <span class="math inline">\(k\)</span> (que permite seleccionar el primer elemento de la muestra) y, a partir de esa posición, dar saltos de magnitud <span class="math inline">\(k\)</span> en el listado para seleccionar el resto de unidades muestrales. Es el método conocido como <strong>muestreo sistemático</strong> o, más técnicamente, <strong>muestreo sistemático uniforme de paso <span class="math inline">\(k\)</span></strong>.</p>
<p>Como ejemplo, supóngase que se quiere obtener una muestra de 50 individuos en una población de 2.000. El paso sería <em>k</em> = 2.000/50 = 40 unidades y se selecciona aleatoriamente una unidad entre las 40 primeras (supóngase que la número 13); el resto de la muestra se obtendría sumándole el paso a la primera seleccionada (13, 53, 93, 133, 173, y así hasta la 1.973).</p>
<p>Por último, los métodos expuestos no son incompatibles, sino que se pueden combinar por etapas, dando lugar a los conocidos como <strong>muestreos polietápicos</strong>. Por ejemplo, la Encuesta de Población Activa, elaborada por el Instituto Nacional de Estadística, adopta un muestreo bietápico, en primer lugar, estratificado entre secciones censales y, en segundo lugar, muestreando entre las viviendas familiares de cada sección.</p>
</div>
<div id="bootstrap" class="section level2" number="14.5">
<h2>
<span class="header-section-number">14.5</span> Técnicas de remuestreo: <span class="math inline">\(\bf{\textit{bootstrap}}\)</span><a class="anchor" aria-label="anchor" href="#bootstrap"><i class="fas fa-link"></i></a>
</h2>
<p>Cuando se infiere una característica poblacional a partir de una muestra, solo se dispone del valor concreto que el estadístico toma sobre dicha muestra. Salvo en raras ocasiones, no se dispone de su distribución en el muestreo, o solo se tiene una aproximación asintótica, por lo que no se pueden evaluar sus propiedades estadísticas con tamaños muestrales no elevados. En otros casos, es la complejidad analítica de muchas técnicas actuales de análisis de datos la que dificulta la determinación de la distribución de las estimaciones de los parámetros.</p>
<p>En estos casos, el método <strong><em>bootstrap</em></strong> propone sustituir la distribución poblacional (desconocida) por una estimación conocida (como puede ser la distribución empírica o una aproximación paramétrica) que, mediante remuestreo, sirva para generar muestras aleatorias a partir de la muestra original. Se obtiene así una distribución de remuestreo, llamada también <strong>distribución</strong> <strong><em>bootstrap</em></strong>, cuyo comportamiento sobre la estimación aproxima a la de la distribución muestral en torno al parámetro, lo que permite evaluar la precisión de las estimaciones.</p>
<p>El método <em>bootstrap</em> más sencillo, llamado <strong><em>bootstrap</em></strong> <strong>uniforme</strong> o <strong><em>bootstrap naïve</em></strong>, parte de la aproximación de la distribución poblacional por la distribución empírica de la muestra. Supóngase que se tiene una muestra <span class="math inline">\(X=(x_1,...,x_n)\)</span> que es utilizada para obtener un estimador <span class="math inline">\(T(X)=\hat{\theta}\)</span> para un parámetro poblacional <span class="math inline">\(\theta\)</span>. Utilizando su distribución empírica (véase ecuación <a href="Fundainfer.html#eq:distrempirica">(13.2)</a>):</p>
<ul>
<li><p>Se genera una primera muestra <span class="math inline">\(X^{*1}=(x_1^{*1},...,x_n^{*1})\)</span>, obtenida mediante muestreo aleatorio simple con reemplazamiento de la muestra original, que permite evaluar el estadístico <span class="math inline">\(T^{*1}(X^{*1})=\hat{\theta^{*1}}\)</span>.</p></li>
<li><p>Siguiendo el mismo procedimiento, se puede generar un número elevado (<span class="math inline">\(B\)</span>) de muestras <em>bootstrap</em>, <span class="math inline">\(X^{*1}, ..., X^{*B}\)</span>, que permiten obtener el valor del estadístico sobre cada una de ellas <span class="math inline">\(T^{*1}(X^{*1}), ..., T^{*B}(X^{*B})\)</span>.</p></li>
<li><p>Con estos valores, se obtiene la distribución <em>bootstrap</em>. Por ejemplo, se puede utilizar esta distribución para calcular la media <em>bootstrap</em> del estadístico <span class="math inline">\(T(X)\)</span>, <span class="math inline">\(\bar {T}^*= {1 \over B} \sum_{b=1}^B T^*(X^{*b})\)</span>, y cuyo error estándar es:</p></li>
</ul>
<p><span class="math display" id="eq:error4">\[\begin{equation}
\tag{14.7}
\hat{S}_{boot}= \sqrt{{1 \over {B-1}} \sum_{b=1}^B \left ( T(X^{*b})-\bar{T}^* \right ) ^2},
\end{equation}\]</span></p>
<p>expresión que aproxima al error del estadístico <span class="math inline">\(T(X)\)</span> para estimar <span class="math inline">\(\theta\)</span>.</p>
<div id="ejemplo-de-bootstrap-con-r" class="section level3" number="14.5.1">
<h3>
<span class="header-section-number">14.5.1</span> Ejemplo de <em>bootstrap</em> con <strong>R</strong><a class="anchor" aria-label="anchor" href="#ejemplo-de-bootstrap-con-r"><i class="fas fa-link"></i></a>
</h3>
<p>Los datos sobre calidad del aire en la ciudad de Nueva York (<code>airquality</code>) recogen la variable <code>Temp</code> que mide la temperatura, en grados Fahrenheit, entre el día 1 de mayo y el 30 de septiembre. Se ha visto en la Sec. <a href="Fundainfer.html#ejemplopobnorm">13.7</a> que no se puede asumir que dicha variable esté generada por una distribución normal, por lo que no se podrían utilizar los intervalos de confianza mostrados en la Sec. <a href="Fundainfer.html#pobnormales">13.6</a>.
El objetivo es calcular una estimación de la temperatura media y dar un intervalo al 95% de confianza.</p>
<p>En este ejemplo, se utiliza la muestra para obtener un valor del estadístico <strong>media muestral</strong> (<span class="math inline">\(\bar X\)</span> = 77,88), estimador insesgado de la media poblacional. Sin embargo, al no conocer la distribución en el muestreo (no se asume ningún tipo de distribución poblacional ni se puede hacer uso de aproximaciones asintóticas), no se podría construir un intervalo de confianza.</p>
<p>Aplicando el método <em>bootstrap</em> (en su versión uniforme), se van a obtener 5.000 muestras de tamaño 20, mediante remuestreo con reemplazamiento:</p>
<div class="sourceCode" id="cb193"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">196</span><span class="op">)</span> <span class="co"># Se fija la semilla para permitir la reproducibilidad</span></span>
<span><span class="va">B</span> <span class="op">&lt;-</span> <span class="fl">5000</span> <span class="co"># Se fija el número de remuestras</span></span>
<span><span class="va">muestras_boot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">numeric</a></span><span class="op">(</span><span class="va">B</span><span class="op">)</span> <span class="co"># Se almacenan todos los valores del estadístico</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">k</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">B</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">remuestra</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="va">airquality</span><span class="op">$</span><span class="va">Temp</span>, <span class="fl">20</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="va">muestras_boot</span><span class="op">[</span><span class="va">k</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">remuestra</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">media_boot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">muestras_boot</span><span class="op">)</span></span>
<span><span class="va">media_boot</span> <span class="co"># Media de los 5000 valores medios de las remuestras</span></span>
<span><span class="co">#&gt; [1] 77.87309</span></span>
<span><span class="va">desv_boot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">muestras_boot</span><span class="op">)</span></span>
<span><span class="va">desv_boot</span> <span class="co"># Desviación típica de los 5000 valores medios de las remuestras</span></span>
<span><span class="co">#&gt; [1] 2.090255</span></span></code></pre></div>
<p>Para construir los intervalos de confianza, se calculan los valores críticos al 95% de confianza sobre la distribución empírica de los valores medios remuestreados:</p>
<div class="sourceCode" id="cb194"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">val_crit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">muestras_boot</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.975</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">val_crit</span> <span class="co"># Valores críticos</span></span>
<span><span class="co">#&gt;  2.5% 97.5% </span></span>
<span><span class="co">#&gt; 73.75 81.95</span></span></code></pre></div>
<p>Así, con el método <em>bootstrap</em>, no es necesario asumir ninguna distribución en el muestreo. Aún así, la representación gráfica de la distribución empírica de los valores medios remuestreados y los extremos del intervalo de confianza (Fig. <a href="muestreo.html#fig:150015dist">14.1</a>) muestran cómo la distribución de las remuestras sobre el estadístico se asemeja a la distribución del estadístico sobre el parámetro.</p>
<div class="sourceCode" id="cb195"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">muestras_boot</span>, freq <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span><span class="va">muestras_boot</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="va">val_crit</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:150015dist"></span>
<img src="img/150015img04.png" alt="Distribución empírica de la media remuestreada." width="60%"><p class="caption">
Figura 14.1: Distribución empírica de la media remuestreada.
</p>
</div>
<p>El paquete <code>boot</code> de <strong>R</strong> permite también obtener réplicas de un estadístico sobre una muestra. La función básica de este paquete es <code><a href="https://rdrr.io/pkg/boot/man/boot.html">boot()</a></code>, que permite utilizar distintos métodos de remuestreo. En su estructura más simple, basta con indicar los datos originales, el estadístico que se quiere remuestrear y el número de réplicas.</p>
<p>Así, si se quiere estimar, por ejemplo, la mediana de la población con 1.000 remuestras, se puede recurrir a la función <code><a href="https://rdrr.io/pkg/boot/man/boot.html">boot()</a></code>:</p>
<div class="sourceCode" id="cb196"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">boot</span><span class="op">)</span></span>
<span><span class="va">estadistico</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">i</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">data</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span> <span class="co"># Se especifica aquí el estadístico remuestreado</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">196</span><span class="op">)</span></span>
<span><span class="va">mediana_boot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/boot/man/boot.html">boot</a></span><span class="op">(</span><span class="va">airquality</span><span class="op">$</span><span class="va">Temp</span>, <span class="va">estadistico</span>, R <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span><span class="va">mediana_boot</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ORDINARY NONPARAMETRIC BOOTSTRAP</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; boot(data = airquality$Temp, statistic = estadistico, R = 1000)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Bootstrap Statistics :</span></span>
<span><span class="co">#&gt;     original  bias    std. error</span></span>
<span><span class="co">#&gt; t1*       79  -0.052    1.071655</span></span></code></pre></div>
<p>Como resultado, se obtiene el valor del estadístico sobre la muestra original, el sesgo estimado y el error estándar.
Para calcular los intervalos de confianza, basta con utilizar la función <code><a href="https://rdrr.io/pkg/boot/man/boot.ci.html">boot.ci()</a></code> sobre la muestra <em>bootstrap</em> obtenida, indicando el nivel de confianza y el tipo de intervalo (por defecto, <code>all</code> proporciona todos los intervalos disponibles; en el ejemplo, se usa el método de los percentiles)</p>
<div class="sourceCode" id="cb197"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/boot/man/boot.ci.html">boot.ci</a></span><span class="op">(</span><span class="va">mediana_boot</span>, conf <span class="op">=</span> <span class="fl">0.95</span>, type <span class="op">=</span> <span class="st">"perc"</span><span class="op">)</span></span>
<span><span class="co">#&gt; BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS</span></span>
<span><span class="co">#&gt; Based on 1000 bootstrap replicates</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; CALL : </span></span>
<span><span class="co">#&gt; boot.ci(boot.out = mediana_boot, conf = 0.95, type = "perc")</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Intervals : </span></span>
<span><span class="co">#&gt; Level     Percentile     </span></span>
<span><span class="co">#&gt; 95%   (77, 81 )  </span></span>
<span><span class="co">#&gt; Calculations and Intervals on Original Scale</span></span></code></pre></div>
<p>La función <code><a href="https://rdrr.io/pkg/boot/man/boot.html">boot()</a></code> permite modificaciones del <em>bootstrap</em> uniforme mediante parámetros adicionales. Por ejemplo, el parámetro <code>strata</code> se utiliza para generar remuestreos estratificados cuando la muestra original también lo es. Aunque no se han comentado dado el carácter introductorio de este capítulo, existen otros métodos <em>bootstrap</em>, que se pueden obtener especificándolos mediante el parámetro <code>sim</code>. Por defecto, el valor es <code>ordinary</code>, que corresponde al <em>bootstrap</em> uniforme; otras alternativas pueden ser <code>parametric</code> para <em>bootstrap</em> paramétrico, <code>balanced</code>, <code>permutation</code> o <code>antithetic</code> para otros métodos más avanzados.</p>
</div>
<div id="resumen-13" class="section level3 unnumbered infobox_resume">
<h3>Resumen<a class="anchor" aria-label="anchor" href="#resumen-13"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li><p>El muestreo probabilístico busca seleccionar una muestra representativa de una población, que permita inferir la distribución poblacional o alguno de sus parámetros.</p></li>
<li><p>Las decisiones básicas para un correcto proceso de muestreo son el método utilizado (aleatorio simple, estratificado, polietápico, etc.), que depende de la estructura de la población, y la determinación del tamaño muestral que garantice el margen de error asumible.</p></li>
<li><p>La técnica <em>bootstrap</em> de remuestreo permite aproximar la distribución de estadísticos muestrales sin asumir ninguna hipótesis sobre la distribución poblacional, ventaja muy útil para evaluar la precisión de los estimadores en muchísimas técnicas complejas.</p></li>
</ul>
</div>

</div>
</div>




  <div class="chapter-nav">
<div class="prev"><a href="Fundainfer.html"><span class="header-section-number">13</span> Inferencia estadística</a></div>
<div class="next"><a href="cap-lm.html"><span class="header-section-number">15</span> Modelización lineal</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="Índice del capítulo"><h2>Índice del capítulo</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#muestreo"><span class="header-section-number">14</span> Muestreo y remuestreo</a></li>
<li><a class="nav-link" href="#introducci%C3%B3n-al-muestreo"><span class="header-section-number">14.1</span> Introducción al muestreo</a></li>
<li>
<a class="nav-link" href="#MAS"><span class="header-section-number">14.2</span> Muestreo aleatorio simple</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#ejemMAS"><span class="header-section-number">14.2.1</span> Ejemplo de m.a.s. en R</a></li></ul>
</li>
<li><a class="nav-link" href="#muestestra"><span class="header-section-number">14.3</span> Muestreo estratificado</a></li>
<li><a class="nav-link" href="#otrosmuestreos"><span class="header-section-number">14.4</span> Otros tipos de muestreo probabilístico</a></li>
<li>
<a class="nav-link" href="#bootstrap"><span class="header-section-number">14.5</span> Técnicas de remuestreo: \(\bf{\textit{bootstrap}}\)</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#ejemplo-de-bootstrap-con-r"><span class="header-section-number">14.5.1</span> Ejemplo de bootstrap con R</a></li>
<li><a class="nav-link" href="#resumen-13">Resumen</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Fundamentos de ciencia de datos con <strong>R</strong></strong>" coordinado por <a href="https://blog.uclm.es/gemafaviles/" class="text-light">Gema Fernández-Avilés y José-María Montero</a>. </p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>Este libro ha sido generado con el paquete de R <a class="text-light" href="https://bookdown.org">bookdown</a>.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
