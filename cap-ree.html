<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Capítulo 58 Predicción de consumo eléctrico con redes neuronales artificiales | Fundamentos de ciencia de datos con R</title>
<meta name="author" content="Gema Fernández-Avilés y José-María Montero">
<meta name="description" content="Jose Manuel Sanz Candales Red Eléctrica de España  58.1 Introducción  Red Eléctrica, como operador del sistema eléctrico español, tiene como misión principal garantizar la continuidad del...">
<meta name="generator" content="bookdown 0.28 with bs4_book()">
<meta property="og:title" content="Capítulo 58 Predicción de consumo eléctrico con redes neuronales artificiales | Fundamentos de ciencia de datos con R">
<meta property="og:type" content="book">
<meta property="og:image" content="/img/cover.png">
<meta property="og:description" content="Jose Manuel Sanz Candales Red Eléctrica de España  58.1 Introducción  Red Eléctrica, como operador del sistema eléctrico español, tiene como misión principal garantizar la continuidad del...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Capítulo 58 Predicción de consumo eléctrico con redes neuronales artificiales | Fundamentos de ciencia de datos con R">
<meta name="twitter:description" content="Jose Manuel Sanz Candales Red Eléctrica de España  58.1 Introducción  Red Eléctrica, como operador del sistema eléctrico español, tiene como misión principal garantizar la continuidad del...">
<meta name="twitter:image" content="/img/cover.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.4.2/transition.js"></script><script src="libs/bs3compat-0.4.2/tabs.js"></script><script src="libs/bs3compat-0.4.2/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><link href="libs/tabwid-1.1.0/tabwid.css" rel="stylesheet">
<link href="libs/tabwid-1.1.0/scrool.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="bs4_style.css">
<link rel="stylesheet" href="bs4_book.css">
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Fundamentos de ciencia de datos con <strong>R</strong></a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Buscar" aria-label="Buscar">
</form>

      <nav aria-label="Contenido"><h2>Contenido</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Prefacio</a></li>
<li><a class="" href="pr%C3%B3logo.html">Prólogo</a></li>
<li class="book-part">Ciencia, datos, software… y científicos</li>
<li><a class="" href="ciencia-datos.html"><span class="header-section-number">1</span> ¿Es la ciencia de datos una ciencia?</a></li>
<li><a class="" href="metodologia.html"><span class="header-section-number">2</span> Metodología en ciencia de datos</a></li>
<li><a class="" href="ch-110003.html"><span class="header-section-number">3</span> R para ciencia de datos</a></li>
<li><a class="" href="cap-etica.html"><span class="header-section-number">4</span> Ética en la ciencia de datos</a></li>
<li class="book-part">Bienvenidos a la jungla de datos</li>
<li><a class="" href="datos-sql.html"><span class="header-section-number">5</span> Gestión de bases de datos relacionales</a></li>
<li><a class="" href="cap-nosql.html"><span class="header-section-number">6</span> Gestión de bases de datos NoSQL</a></li>
<li><a class="" href="DGDQM.html"><span class="header-section-number">7</span> Gobierno, gestión y calidad del dato</a></li>
<li><a class="" href="id_130009.html"><span class="header-section-number">8</span> Integración y limpieza de datos</a></li>
<li><a class="" href="chap-feature.html"><span class="header-section-number">9</span> Selección y transformación de variables</a></li>
<li><a class="" href="chap-herramientas.html"><span class="header-section-number">10</span> Herramientas para el análisis en ciencia de datos</a></li>
<li><a class="" href="id_120006-aed.html"><span class="header-section-number">11</span> Análisis exploratorio de datos</a></li>
<li class="book-part">Fundamentos de estadística</li>
<li><a class="" href="Funda-probab.html"><span class="header-section-number">12</span> Probabilidad</a></li>
<li><a class="" href="Fundainfer.html"><span class="header-section-number">13</span> Inferencia estadística</a></li>
<li><a class="" href="muestreo.html"><span class="header-section-number">14</span> Muestreo y remuestreo</a></li>
<li class="book-part">Modelización estadística</li>
<li><a class="" href="cap-lm.html"><span class="header-section-number">15</span> Modelización lineal</a></li>
<li><a class="" href="cap-glm.html"><span class="header-section-number">16</span> Modelos lineales generalizados</a></li>
<li><a class="" href="cap-gam.html"><span class="header-section-number">17</span> Modelos aditivos generalizados</a></li>
<li><a class="" href="cap-mxm.html"><span class="header-section-number">18</span> Modelos mixtos</a></li>
<li><a class="" href="cap-sparse.html"><span class="header-section-number">19</span> Modelos sparse y métodos penalizados de regresión</a></li>
<li><a class="" href="cap-series-temp.html"><span class="header-section-number">20</span> Modelización de series temporales</a></li>
<li><a class="" href="cap-discriminante.html"><span class="header-section-number">21</span> Análisis discriminante</a></li>
<li><a class="" href="cap-conjunto.html"><span class="header-section-number">22</span> Análisis conjunto</a></li>
<li><a class="" href="tablas-contingencia.html"><span class="header-section-number">23</span> Análisis de tablas de contingencia</a></li>
<li class="book-part">Machine learning supervisado</li>
<li><a class="" href="cap-arboles.html"><span class="header-section-number">24</span> Árboles de clasificación y regresión</a></li>
<li><a class="" href="cap-svm.html"><span class="header-section-number">25</span> Máquinas de vector soporte</a></li>
<li><a class="" href="cap-knn.html"><span class="header-section-number">26</span> Clasificador \(k\)-vecinos más próximos</a></li>
<li><a class="" href="cap-naive-bayes.html"><span class="header-section-number">27</span> Naive Bayes</a></li>
<li><a class="" href="cap-bagg-rf.html"><span class="header-section-number">28</span> Métodos ensamblados: \(\bf \textit {bagging}\) y \(\bf \textit{random}\) \(\bf \textit{forest}\)</a></li>
<li><a class="" href="cap-boosting-xgboost.html"><span class="header-section-number">29</span> \(\bf \textit{Boosting}\) y el algoritmo XGBoost</a></li>
<li class="book-part">Machine learning no supervisado</li>
<li><a class="" href="an%C3%A1lisis-cl%C3%BAster-clusterizaci%C3%B3n-jer%C3%A1rquica.html"><span class="header-section-number">30</span> Análisis clúster: clusterización jerárquica</a></li>
<li><a class="" href="no-jerarquico.html"><span class="header-section-number">31</span> Análisis clúster: clusterización no jerárquica</a></li>
<li><a class="" href="acp.html"><span class="header-section-number">32</span> Análisis de componentes principales</a></li>
<li><a class="" href="an%C3%A1lisis-factorial.html"><span class="header-section-number">33</span> Análisis factorial</a></li>
<li><a class="" href="escalamiento-multidimensional.html"><span class="header-section-number">34</span> Escalamiento multidimensional</a></li>
<li><a class="" href="correspondencias.html"><span class="header-section-number">35</span> Análisis de correspondencias</a></li>
<li class="book-part">Deep learning</li>
<li><a class="" href="capNN.html"><span class="header-section-number">36</span> Redes neuronales artificiales</a></li>
<li><a class="" href="cap-redes-convol.html"><span class="header-section-number">37</span> Redes neuronales convolucionales</a></li>
<li class="book-part">Ciencia de datos de texto y redes</li>
<li><a class="" href="mineria-textos.html"><span class="header-section-number">38</span> Minería de textos</a></li>
<li><a class="" href="grafos.html"><span class="header-section-number">39</span> Análisis de grafos y redes sociales</a></li>
<li class="book-part">Ciencia de datos espaciales</li>
<li><a class="" href="datos-espaciales.html"><span class="header-section-number">40</span> Trabajando con datos espaciales</a></li>
<li><a class="" href="geo.html"><span class="header-section-number">41</span> Geoestadística</a></li>
<li><a class="" href="cap-econom-esp.html"><span class="header-section-number">42</span> Modelos econométricos espaciales</a></li>
<li><a class="" href="cap-pp.html"><span class="header-section-number">43</span> Procesos de puntos</a></li>
<li class="book-part">Comunica y colabora</li>
<li><a class="" href="id_120007-informes.html"><span class="header-section-number">44</span> Informes reproducibles con R Markdown y Quarto</a></li>
<li><a class="" href="shiny.html"><span class="header-section-number">45</span> Creación de aplicaciones web interactivas con Shiny</a></li>
<li><a class="" href="github.html"><span class="header-section-number">46</span> Git y GitHub R</a></li>
<li><a class="" href="geoproces.html"><span class="header-section-number">47</span> Geoprocesamiento en nube</a></li>
<li class="book-part">Casos de estudio en ciencia de datos</li>
<li><a class="" href="cap-crimen.html"><span class="header-section-number">48</span> Análisis de una red criminal</a></li>
<li><a class="" href="cap-publicidad.html"><span class="header-section-number">49</span> Optimización de inversiones publicitarias</a></li>
<li><a class="" href="cap-twitter.html"><span class="header-section-number">50</span> ¿Cómo tuitea Elon Musk?</a></li>
<li><a class="" href="cap-periodismo.html"><span class="header-section-number">51</span> Análisis electoral: de RStudio a su periódico</a></li>
<li><a class="" href="paro-clm.html"><span class="header-section-number">52</span> El impacto de las crisis financiera y de la COVID-19 en el paro de CLM</a></li>
<li><a class="" href="cap-rfm.html"><span class="header-section-number">53</span> Segmentación de clientes en el comercio minorista</a></li>
<li><a class="" href="cap-medicina.html"><span class="header-section-number">54</span> Análisis de datos en medicina</a></li>
<li><a class="" href="cap-futbol.html"><span class="header-section-number">55</span> Messi y Ronaldo: dos ídolos desde la perspectiva de los datos</a></li>
<li><a class="" href="cambioclimatico.html"><span class="header-section-number">56</span> Una nota sobre el cambio climático</a></li>
<li><a class="" href="cap-sist-exp.html"><span class="header-section-number">57</span> Implementación de un sistema experto en el ámbito pediátrico</a></li>
<li><a class="active" href="cap-ree.html"><span class="header-section-number">58</span> Predicción de consumo eléctrico con redes neuronales artificiales</a></li>
<li><a class="" href="nlp-textil.html"><span class="header-section-number">59</span> El procesamiento del lenguaje natural para tendencias de moda en textil</a></li>
<li><a class="" href="cap-fraude.html"><span class="header-section-number">60</span> Detección de fraude de tarjetas de crédito</a></li>
<li class="book-part">Appendix</li>
<li><a class="" href="info-session.html"><span class="header-section-number">A</span> Información de la sesión</a></li>
<li><a class="" href="referncias.html">Referncias</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="cap-ree" class="section level1" number="58">
<h1>
<span class="header-section-number">Capítulo 58</span> Predicción de consumo eléctrico con redes neuronales artificiales<a class="anchor" aria-label="anchor" href="#cap-ree"><i class="fas fa-link"></i></a>
</h1>
<p><em>Jose Manuel Sanz Candales</em></p>
<p>Red Eléctrica de España</p>
<div id="introducción-29" class="section level2" number="58.1">
<h2>
<span class="header-section-number">58.1</span> Introducción<a class="anchor" aria-label="anchor" href="#introducci%C3%B3n-29"><i class="fas fa-link"></i></a>
</h2>
<p>
</p>
<p>Red Eléctrica, como operador del sistema eléctrico español, tiene como misión principal garantizar la continuidad del suministro eléctrico en España. Para ello, entre otras muchas tareas, se desarrollan, evolucionan y mantienen algoritmos de previsión del consumo eléctrico y de la producción con las principales energías renovables (eólica y solar) para distintas frecuencias (horas, días, meses, años, etc.) y escalas temporales (anual, horaria, quinceminutal).</p>
<p>Este caso de uso se sitúa en el departamento de Ciencia de Datos del Operador del Sistema. Es el principio del año 2018 y el área de planificación de la empresa solicita una <strong>predicción del consumo eléctrico en España</strong>, medida en MWH, para el año actual y el siguiente (2018 y 2019). La predicción se llevará a cabo con una red neuronal artificial (RNA, véase Cap. <a href="capNN.html#capNN">36</a>) y es importante destacar que este desarrollo no está previsto en el presupuesto del año, por lo que tanto el software como los datos de entrada deben ser, en la medida de lo posible, gratuitos.</p>
</div>
<div id="ree-datos" class="section level2" number="58.2">
<h2>
<span class="header-section-number">58.2</span> Datos de entrada<a class="anchor" aria-label="anchor" href="#ree-datos"><i class="fas fa-link"></i></a>
</h2>
<p>Respecto a los datos de entrada de la RNA, se requiere tanto una serie histórica de la variable a predecir (el consumo eléctrico) como de las variables que se seleccionen para explicar adecuadamente su comportamiento.</p>
<p>En cuanto a la serie histórica de consumo eléctrico anual, Red Eléctrica, en su web corporativa, publica datos estadísticos accesibles de forma abierta. Sin embargo, el histórico publicado comienza en 2012 y sería conveniente tener un período de tiempo más amplio para poder entrenar adecuadamente las RNA candidatas a ser utilizadas. Se realiza una búsqueda de otras fuentes y, afortunadamente, se encuentra que el Instituto para la Diversificación y Ahorro de la Energía (IDAE) publica datos desde 1990, con agregación anual, del consumo final de energía eléctrica en miles de toneladas equivalentes de petróleo –ktep–.</p>
<p>Como los datos se deben entregar en MWh, la predicción resultante se tendrá que convertir con el coeficiente que indican en la web del IDAE (1 MWh = 0,086 tep).</p>
<p>En cuanto a la elección de las <em>features</em> o variables explicativas, se sabe que, históricamente, las variaciones interanuales del consumo eléctrico dependen del comportamiento de la economía de una forma directa: si la economía crece, también crece el consumo eléctrico. Como indicador del comportamiento de la economía se decide tomar el PIB per cápita, que se puede encontrar en el siguiente enlace, disponible de forma pública en Expansión - datos macro: <a href="https://datosmacro.expansion.com/pib/espana" class="uri">https://datosmacro.expansion.com/pib/espana</a>. Además del PIB per cápita, se utilizarán otras dos variables explicativas: una relacionada con el mercado inmobiliario y otra relacionada con el empleo. Dado que no son públicas, están anonimizadas; también están escaladas entre 0 y 1 (dividiendo todos los valores de cada variable entre el mayor de su serie). Dado que se dispone de datos de estas dos variables desde el año 2000, el conjunto de datos comienza en este año.</p>
<p>Una vez definido el conjunto de datos que se utiliza para determinar la RNA que mejor prediga el consumo eléctrico en España en los años 2018 y 2019, que como se verá a continuación es un conjunto de datos muy pequeño y sencillo, se puede comenzar a modelar la RNA en <strong>R</strong>.</p>
</div>
<div id="modelización-1" class="section level2" number="58.3">
<h2>
<span class="header-section-number">58.3</span> Modelización<a class="anchor" aria-label="anchor" href="#modelizaci%C3%B3n-1"><i class="fas fa-link"></i></a>
</h2>
<p>En el siguiente fragmento de código (<em>chunk</em>) se lee el conjunto de datos, <code>consumoelectricoanual_2</code>, del paquete <code>CDR</code>, se convierte el formato <code>data.table</code> al formato <code>data.frame</code> y se visualizan sus primeras 3 filas:</p>
<div class="sourceCode" id="cb840"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st">"CDR"</span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">CDR</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/CDR/man/consumoelectricoanual_2.html">consumoelectricoanual_2</a></span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/headtail.html">head</a></span><span class="op">(</span><span class="va">df</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Año   PIB Consumo     Inmob    Empleo</span></span>
<span><span class="co">#&gt; 1 2000 15.97  16.205 0.7525093 0.6561190</span></span>
<span><span class="co">#&gt; 2 2001 17.20  17.279 0.7687356 0.6832698</span></span>
<span><span class="co">#&gt; 3 2002 18.09  17.671 0.7836143 0.7104178</span></span></code></pre></div>
<p>En este caso de uso ya se dispone de los datos reales de 2018 y 2019 (lo que permitirá validar la precisión del modelo), pero en un caso real, a principios de 2018 el PIB per cápita de 2018 y 2019 será una predicción. Lógicamente, el consumo eléctrico anual también será desconocido, siendo, precisamente, el objeto de la predicción. Es decir, se supone que los datos de consumo eléctrico de 2018 y 2019 no existen y, en consecuencia, no se pueden utilizar ni para entrenar ni para evaluar la precisión del modelo (para ello habrá que utilizar datos anteriores a 2018).</p>
<p>La siguiente <em>chunk</em> proporciona la matriz de varianzas-covarianzas de las variables <code>PIB per cápita</code>, <code>Consumo</code>, <code>Inmob</code>, <code>Empleo</code>:</p>
<div class="sourceCode" id="cb841"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cormat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">df</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"PIB"</span>, <span class="st">"Consumo"</span>, <span class="st">"Inmob"</span>, <span class="st">"Empleo"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/headtail.html">head</a></span><span class="op">(</span><span class="va">cormat</span><span class="op">)</span></span>
<span><span class="co">#&gt;          PIB Consumo Inmob Empleo</span></span>
<span><span class="co">#&gt; PIB     1.00    0.81  0.90   0.93</span></span>
<span><span class="co">#&gt; Consumo 0.81    1.00  0.64   0.71</span></span>
<span><span class="co">#&gt; Inmob   0.90    0.64  1.00   0.99</span></span>
<span><span class="co">#&gt; Empleo  0.93    0.71  0.99   1.00</span></span></code></pre></div>
<p>Como se puede observar en la matriz anterior, la correlación entre la variable a predecir y las distintas variables explicativas es fuerte y positiva (es decir, cuando crece una también crece la otra). Si, además, se visualiza la gráfica entre PIB y consumo en el tiempo (Fig. <a href="cap-ree.html#fig:plot-ree1">58.1</a>), se aprecia de forma aún más clara esta intensa correlación:</p>
<div class="sourceCode" id="cb842"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://ggplot2.tidyverse.org">"ggplot2"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/hadley/reshape">"reshape2"</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">df_m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html">melt</a></span><span class="op">(</span><span class="va">df</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Año"</span>,<span class="st">"PIB"</span>,<span class="st">"Consumo"</span><span class="op">)</span><span class="op">]</span>, id.vars <span class="op">=</span> <span class="st">"Año"</span><span class="op">)</span></span>
<span><span class="va">df_m_plot</span> <span class="op">&lt;-</span> <span class="va">df</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">df_m_plot</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'Año'</span>,<span class="st">'PIB per cápita (k€/año)'</span>,</span>
<span>                         <span class="st">'Consumo eléctrico anual (ktep)'</span><span class="op">)</span></span>
<span><span class="va">df_m_plot_melt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html">melt</a></span><span class="op">(</span><span class="va">df_m_plot</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Año"</span>,<span class="st">"PIB per cápita (k€/año)"</span>,</span>
<span>                                   <span class="st">"Consumo eléctrico anual (ktep)"</span><span class="op">)</span><span class="op">]</span>, id.vars <span class="op">=</span> <span class="st">"Año"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>repr.plot.width <span class="op">=</span> <span class="fl">15</span>, repr.plot.height <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df_m_plot_melt</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">Año</span>, <span class="va">value</span>, col <span class="op">=</span> <span class="va">variable</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">2.5</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:plot-ree1"></span>
<img src="212054_cd_electricidad_files/figure-html/plot-ree1-1.png" alt="Evolución del PIB y el consumo eléctrico en España." width="80%"><p class="caption">
Figura 58.1: Evolución del PIB y el consumo eléctrico en España.
</p>
</div>
<p>En la Fig. <a href="cap-ree.html#fig:plot-ree1">58.1</a> se observa que hasta 2005 las curvas que representan la evolución temporal de ambas variables están prácticamente superpuestas, pero desde 2006 las líneas se separan. ¿A qué puede deberse? Uno de los principales motivos probablemente sea las medidas de eficiencia energética que se han ido introduciendo en los últimos lustros (iluminación led, electrodomésticos, dispositivos con menor consumo, etc.).</p>
<p>Una vez se han explorado los datos (en este caso la exploración ha sido muy breve, pero es muy habitual en proyectos reales que la exploración y limpieza de los datos requiera en torno al 80% del tiempo), se procede a dividir el conjunto de datos (desde 2000 hasta 2017, ya que 2018 y 2019 son los años en los que se pretende predecir) en dos partes:</p>
<ol style="list-style-type: lower-roman">
<li>Subconjunto de entrenamiento y la validación (90% de las filas);</li>
<li>subconjunto de test (10% restante).</li>
</ol>
<p>Previamente, se debe escalar también la variable PIB per cápita para que sus valores varíen entre 0 y 1 (las otras dos variables explicativas ya venían escaladas en la fuente de la cual se tomaron) y que la RNA funcione de forma correcta:<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;De esta manera se evita que una variable explicativa tenga más “influencia” que otra en la salida de la RNA.&lt;/p&gt;"><sup>310</sup></a></p>
<div class="sourceCode" id="cb843"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># estandarizar la variable explicativa "PIB" entre 0 y 1</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">PIB</span> <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">PIB</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">PIB</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">df_aux</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">Año</span> <span class="op">&lt;</span> <span class="fl">2018</span>, <span class="op">]</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/dimensions.html">nrow</a></span><span class="op">(</span><span class="va">df_aux</span><span class="op">)</span></span>
<span><span class="va">trainIndex</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">n</span>, size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">0.85</span> <span class="op">*</span> <span class="va">n</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">df_train</span> <span class="op">&lt;-</span> <span class="va">df_aux</span><span class="op">[</span><span class="va">trainIndex</span>, <span class="op">]</span></span>
<span><span class="va">df_test</span> <span class="op">&lt;-</span> <span class="va">df_aux</span><span class="op">[</span><span class="op">-</span><span class="va">trainIndex</span>, <span class="op">]</span></span>
<span><span class="va">df_test</span></span></code></pre></div>
<p>El siguiente paso sería modelizar los datos con distintos modelos de <em>machine learning</em> y comparar sus resultados para determinar cuál es el más preciso para este conjunto de datos. En este ejemplo, por simplicidad no se incluye este proceso de prueba y comparación entre distintos modelos, que en el caso de uso real da lugar a elegir una red neuronal simple o perceptrón multicapa (véase Cap. <a href="capNN.html#capNN">36</a>), también conocido por su acrónimo en inglés MLP (<em>multi layer perceptron</em>).</p>
<p>Para elegir el valor de los hiperparámetros que faciliten el mejor resultado (en este caso el número de capas ocultas y el número de neuronas en cada una de estas capas) se utilizan las dos siguientes técnicas: <span class="math inline">\((i)\)</span> <em>grid search</em> (para probar distintas combinaciones de hiperparámetros) y <span class="math inline">\((ii)\)</span> <em>cross-validation</em> (para entrenar y validar aprovechando todos los registros del conjunto de entrenamiento-validación).</p>
<p>En este caso de uso, se realizan distintas pruebas combinando el número de neuronas de cada capa oculta. En concreto, en la primera y la segunda capa oculta se deja un número constante de neuronas (5), y en la tercera se prueba con 4 y 5 neuronas. Es decir, se entrenará un modelo con tres capas ocultas y con 5 neuronas en cada capa oculta y otro con 5 neuronas en las dos primeras capas y 4 neuronas en la tercera.</p>
<p>En la siguiente <em>chunk</em> se importan los paquetes necesarios, <code>neuralnet</code> y <code>caret</code>, se construye la estructura de la red en la variable <code>grid</code> y se define el número de <em>folds</em> (en cuántas partes se divide en conjunto de entrenamiento para entrenar y validar con todos los datos del conjunto) de la validación cruzada (véase Cap. <a href="chap-herramientas.html#chap-herramientas">10</a>, Sec. <a href="chap-herramientas.html#enfoque-validacion">10.4</a>). Por último, se entrena el modelo.</p>
<p>El proceso está muy simplificado para que sea fácil de entender. No obstante, lo habitual en la práctica es probar más opciones de <em>grid search</em> y hacer una división mayor del conjunto de datos para <em>cross-validation</em> (es bastante habitual entre 5 y 10 partes):</p>
<div class="sourceCode" id="cb844"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># lee paquetes</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/bips-hb/neuralnet">"neuralnet"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/topepo/caret/">"caret"</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># define la estructura de la red</span></span>
<span><span class="va">grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html">expand.grid</a></span><span class="op">(</span>layer1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span>, layer2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span>, layer3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># establece semilla para que los resultados del entrenamiento sean siempre los mismos</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="co"># define el número de folds en validación cruzada</span></span>
<span><span class="va">train_control</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/caret/man/trainControl.html">trainControl</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"cv"</span>,</span>
<span>                              number <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                              verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co"># entrenar el modelo</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/caret/man/train.html">train</a></span><span class="op">(</span><span class="va">Consumo</span> <span class="op">~</span> <span class="va">PIB</span><span class="op">+</span><span class="va">Inmob</span><span class="op">+</span><span class="va">Empleo</span>,</span>
<span>               data <span class="op">=</span> <span class="va">df_train</span>,</span>
<span>               trControl <span class="op">=</span> <span class="va">train_control</span>,</span>
<span>               method <span class="op">=</span> <span class="st">"neuralnet"</span>,</span>
<span>               tuneGrid <span class="op">=</span> <span class="va">grid</span><span class="op">)</span></span></code></pre></div>
<p>Para mostrar los resultados se aplica la función <code>print</code> sobre la variable <code>model</code>, cuya salida es el texto comentado debajo de la línea de <code>print</code>.</p>
<div class="sourceCode" id="cb845"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://www.math.uzh.ch/pages/spam/reference/print.html">print</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span>
<span><span class="co">#&gt; Neural Network</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; 15 samples</span></span>
<span><span class="co">#&gt; 3 predictor</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; No pre-processing</span></span>
<span><span class="co">#&gt; Resampling: Cross-Validated (2 fold)</span></span>
<span><span class="co">#&gt; Summary of sample sizes: 8, 7</span></span>
<span><span class="co">#&gt; Resampling results across tuning parameters:</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt;  layer3  RMSE       Rsquared  MAE      </span></span>
<span><span class="co">#&gt;  4       0.9713547  0.7631649 0.8521702</span></span>
<span><span class="co">#&gt;  5       0.9452518  0.72532010.8165410</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; Tuning parameter 'layer1' was held constant at a value of 5</span></span>
<span><span class="co">#&gt; Tuning parameter 'layer2' was held constant at a value of 5</span></span>
<span><span class="co">#&gt; RMSE was used to select the optimal model using the smallest value.</span></span>
<span><span class="co">#&gt; The final values used for the model were layer1 = 5, layer2 = 5 and layer3 = 5.</span></span></code></pre></div>
<p>La RNA con mejor resultado (menor error en el conjunto de entrenamiento / validación) es la que tiene 3 capas con 5 neuronas cada una. Con esta arquitectura de red se predice el consumo eléctrico para el conjunto de datos que se habían reservado para test (años 2006, 2007 y 2017), para comprobar que el modelo generaliza bien (es decir, para datos nuevos los resultados de las predicciones tienen un error del orden de los que resultan del entrenamiento del modelo). Para ello, se calcula una métrica de error, por ejemplo, el <em>mean absolute error</em> (MAE) de las predicciones para dicho conjunto de test:</p>
<div class="sourceCode" id="cb846"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_test</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Año"</span>, <span class="st">"Consumo"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#&gt; Año     Consumo</span></span>
<span><span class="co">#&gt; 7  2006 21.163</span></span>
<span><span class="co">#&gt; 8  2007 21.564</span></span>
<span><span class="co">#&gt; 18 2017 20.559</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/predict.html">predict</a></span><span class="op">(</span><span class="va">model</span>, <span class="va">df_test</span><span class="op">)</span></span>
<span><span class="co">#&gt;       7        8       18</span></span>
<span><span class="co">#&gt;   21.50816 21.83445 20.12596</span></span>
<span></span>
<span><span class="va">MAE_test</span> <span class="op">=</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="fl">21.163</span><span class="op">-</span><span class="fl">21.50816</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="fl">21.564</span><span class="op">-</span><span class="fl">21.83445</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="fl">20.559</span><span class="op">-</span><span class="fl">20.12596</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fl">3</span></span>
<span><span class="va">MAE_test</span></span>
<span><span class="co">#&gt;  [1] 0.34955</span></span></code></pre></div>
<!-- El modelo seleccionado ya está listo para realizar predicciones de consumo eléctrico para los años solicitados (2018 y 2019). Como se avanzó anteriormente, el objetivo del conjunto de test es comprobar la precisión del modelo con datos totalmente desconocidos para él (es decir, no utilizados en la fase de entrenamiento-validación), principalmente para asegurar que el modelo funciona bien para datos distintos a los utilizados en el entrenamiento. -->
<p>El modelo seleccionado ya está listo para predecir el consumo eléctrico anual en 2018 y 2019, el encargo del área de planificación de la empresa. Para ello, simplemente se utiliza la función <code><a href="https://rdrr.io/pkg/terra/man/predict.html">predict()</a></code> del modelo. Previamente, se añade una columna en el conjunto de datos original <code>df</code> que contendrá los valores predichos, para más adelante comprobar gráficamente el valor predicho frente al real que, en este caso ficticio, ya es conocido:</p>
<div class="sourceCode" id="cb847"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span><span class="op">[</span><span class="st">"Prediccion_MLP"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span></code></pre></div>
<p>A continuación, se hace la predicción del año 2018 y se añade el resultado a esta nueva columna del conjunto de datos:</p>
<div class="sourceCode" id="cb848"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_pred_2018</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">Año</span> <span class="op">==</span> <span class="fl">2018</span>, <span class="op">]</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">Prediccion_MLP</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">Año</span> <span class="op">==</span> <span class="fl">2018</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/predict.html">predict</a></span><span class="op">(</span><span class="va">model</span>, </span>
<span>                                             <span class="va">df_pred_2018</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"PIB"</span>,<span class="st">"Inmob"</span>,<span class="st">"Empleo"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p>Se hace también la predicción para el año 2019 y se visualizan las predicciones añadidas al conjunto de datos para ambos años:</p>
<div class="sourceCode" id="cb849"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_pred_2019</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">Año</span> <span class="op">==</span> <span class="fl">2019</span>, <span class="op">]</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">Prediccion_MLP</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">Año</span> <span class="op">==</span> <span class="fl">2019</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/predict.html">predict</a></span><span class="op">(</span><span class="va">model</span>, <span class="va">df_pred_2019</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"PIB"</span>,<span class="st">"Inmob"</span>,<span class="st">"Empleo"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/headtail.html">tail</a></span><span class="op">(</span><span class="va">df</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt;      Año      PIBConsumo      Inmob    Empleo Prediccion_MLP</span></span>
<span><span class="co">#&gt; 18 2017 0.9451173  20.559 0.9907827 0.9816742             NA</span></span>
<span><span class="co">#&gt; 19 2018 0.9746404  20.504 0.9939372 0.9913677       20.22787</span></span>
<span><span class="co">#&gt; 20 2019 1.0000000  20.166 1.0000000 1.0000000       20.16409</span></span></code></pre></div>
<p>Estos son los datos que se entregarían como resultado de la petición de información (convertidos a MWh aplicando el coeficiente que se mencionó en la Sec. <span class="math inline">\(\ref{ree-datos}\)</span>).</p>
<p>Claro está, en el momento en que se entregan las predicciones para 2018 y 2019 todavía no se sabe cuál es su precisión, pero a principios de 2020 ya es posible calcular la bondad del modelo seleccionado, y es lo que se hace en las siguientes <em>chunks</em>:</p>
<div class="sourceCode" id="cb850"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_m_mlp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html">melt</a></span><span class="op">(</span><span class="va">df</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Año"</span>,<span class="st">"Consumo"</span>,<span class="st">"Prediccion_MLP"</span><span class="op">)</span><span class="op">]</span>, id.vars <span class="op">=</span> <span class="st">"Año"</span><span class="op">)</span></span>
<span><span class="va">df_mlp_plot</span> <span class="op">&lt;-</span> <span class="va">df</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">df_mlp_plot</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'Año'</span>,<span class="st">'PIB'</span>,<span class="st">'Consumo eléctrico anual real'</span>, </span>
<span>                           <span class="st">'Inmob'</span>,<span class="st">'Empleo'</span>,<span class="st">'Prediccion MLP Consumo eléctrico anual'</span><span class="op">)</span></span>
<span><span class="va">df_m_mlp_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html">melt</a></span><span class="op">(</span><span class="va">df_mlp_plot</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Año"</span>,<span class="st">"Consumo eléctrico anual real"</span>,</span>
<span>                                    <span class="st">"Prediccion MLP Consumo eléctrico anual"</span><span class="op">)</span><span class="op">]</span>, id.vars <span class="op">=</span> <span class="st">"Año"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df_m_mlp_plot</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">Año</span>, <span class="va">value</span>, col <span class="op">=</span> <span class="va">variable</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>  </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:reshape-plot-ree2"></span>
<img src="img/212054PIBConsumoPrediccion.png" alt="Consumo electrico real y predicho en España: 2018 y 2019." width="100%"><p class="caption">
Figura 58.2: Consumo electrico real y predicho en España: 2018 y 2019.
</p>
</div>
<p>En la Fig. <a href="cap-ree.html#fig:reshape-plot-ree2">58.2</a>, se puede comprobar que las predicciones (puntos azules) las predicciones son bastante buenas, con unos errores del orden de los que se habían obtenido en el conjunto de test, por lo que parece que no hay sobreentrenamiento.</p>

</div>
</div>

  <div class="chapter-nav">
<div class="prev"><a href="cap-sist-exp.html"><span class="header-section-number">57</span> Implementación de un sistema experto en el ámbito pediátrico</a></div>
<div class="next"><a href="nlp-textil.html"><span class="header-section-number">59</span> El procesamiento del lenguaje natural para tendencias de moda en textil</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="Índice del capítulo"><h2>Índice del capítulo</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#cap-ree"><span class="header-section-number">58</span> Predicción de consumo eléctrico con redes neuronales artificiales</a></li>
<li><a class="nav-link" href="#introducci%C3%B3n-29"><span class="header-section-number">58.1</span> Introducción</a></li>
<li><a class="nav-link" href="#ree-datos"><span class="header-section-number">58.2</span> Datos de entrada</a></li>
<li><a class="nav-link" href="#modelizaci%C3%B3n-1"><span class="header-section-number">58.3</span> Modelización</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Fundamentos de ciencia de datos con <strong>R</strong></strong>" coordinado por <a href="https://blog.uclm.es/gemafaviles/" class="text-light">Gema Fernández-Avilés y José-María Montero</a>. Generado por última vez el día 2023-11-13.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>Este libro ha sido generado con el paquete de R <a class="text-light" href="https://bookdown.org">bookdown</a>.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
