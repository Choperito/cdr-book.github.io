<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Capítulo 43 Procesos de puntos | Fundamentos de ciencia de datos con R</title>
<meta name="author" content="Gema Fernández-Avilés y José-María Montero">
<meta name="description" content="Jorge Mateu\(^{a}\) y Mehdi Moradi\(^{b}\) \(^{a}\)Universidad Jaume I\(^{b}\)Umeå Universitet  43.1 Introducción La estadística espacial es una rama de la estadística que se ha desarrollado...">
<meta name="generator" content="bookdown 0.36 with bs4_book()">
<meta property="og:title" content="Capítulo 43 Procesos de puntos | Fundamentos de ciencia de datos con R">
<meta property="og:type" content="book">
<meta property="og:image" content="/img/cover.png">
<meta property="og:description" content="Jorge Mateu\(^{a}\) y Mehdi Moradi\(^{b}\) \(^{a}\)Universidad Jaume I\(^{b}\)Umeå Universitet  43.1 Introducción La estadística espacial es una rama de la estadística que se ha desarrollado...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Capítulo 43 Procesos de puntos | Fundamentos de ciencia de datos con R">
<meta name="twitter:description" content="Jorge Mateu\(^{a}\) y Mehdi Moradi\(^{b}\) \(^{a}\)Universidad Jaume I\(^{b}\)Umeå Universitet  43.1 Introducción La estadística espacial es una rama de la estadística que se ha desarrollado...">
<meta name="twitter:image" content="/img/cover.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.6.0/transition.js"></script><script src="libs/bs3compat-0.6.0/tabs.js"></script><script src="libs/bs3compat-0.6.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><link href="libs/tabwid-1.1.3/tabwid.css" rel="stylesheet">
<script src="libs/tabwid-1.1.3/tabwid.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="bs4_style.css">
<link rel="stylesheet" href="bs4_book.css">
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Fundamentos de ciencia de datos con <strong>R</strong></a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Buscar" aria-label="Buscar">
</form>

      <nav aria-label="Contenido"><h2>Contenido</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Prefacio</a></li>
<li><a class="" href="pr%C3%B3logo-by-julia-silge.html">Prólogo (by Julia Silge)</a></li>
<li><a class="" href="pr%C3%B3logo-por-yanina-bellini.html">Prólogo (por Yanina Bellini)</a></li>
<li class="book-part">Ciencia, datos, software… y científicos</li>
<li><a class="" href="ciencia-datos.html"><span class="header-section-number">1</span> ¿Es la ciencia de datos una ciencia?</a></li>
<li><a class="" href="metodologia.html"><span class="header-section-number">2</span> Metodología en ciencia de datos</a></li>
<li><a class="" href="ch-110003.html"><span class="header-section-number">3</span> R para ciencia de datos</a></li>
<li><a class="" href="cap-etica.html"><span class="header-section-number">4</span> Ética en la ciencia de datos</a></li>
<li class="book-part">Bienvenidos a la jungla de datos</li>
<li><a class="" href="datos-sql.html"><span class="header-section-number">5</span> Gestión de bases de datos relacionales</a></li>
<li><a class="" href="cap-nosql.html"><span class="header-section-number">6</span> Gestión de bases de datos NoSQL</a></li>
<li><a class="" href="DGDQM.html"><span class="header-section-number">7</span> Gobierno, gestión y calidad del dato</a></li>
<li><a class="" href="id_130009.html"><span class="header-section-number">8</span> Integración y limpieza de datos</a></li>
<li><a class="" href="chap-feature.html"><span class="header-section-number">9</span> Selección y transformación de variables</a></li>
<li><a class="" href="chap-herramientas.html"><span class="header-section-number">10</span> Herramientas para el análisis en ciencia de datos</a></li>
<li><a class="" href="id_120006-aed.html"><span class="header-section-number">11</span> Análisis exploratorio de datos</a></li>
<li class="book-part">Fundamentos de estadística</li>
<li><a class="" href="Funda-probab.html"><span class="header-section-number">12</span> Probabilidad</a></li>
<li><a class="" href="Fundainfer.html"><span class="header-section-number">13</span> Inferencia estadística</a></li>
<li><a class="" href="muestreo.html"><span class="header-section-number">14</span> Muestreo y remuestreo</a></li>
<li class="book-part">Modelización estadística</li>
<li><a class="" href="cap-lm.html"><span class="header-section-number">15</span> Modelización lineal</a></li>
<li><a class="" href="cap-glm.html"><span class="header-section-number">16</span> Modelos lineales generalizados</a></li>
<li><a class="" href="cap-gam.html"><span class="header-section-number">17</span> Modelos aditivos generalizados</a></li>
<li><a class="" href="cap-mxm.html"><span class="header-section-number">18</span> Modelos mixtos</a></li>
<li><a class="" href="cap-sparse.html"><span class="header-section-number">19</span> Modelos \(\textit{sparse}\) y métodos penalizados de regresión</a></li>
<li><a class="" href="cap-series-temp.html"><span class="header-section-number">20</span> Modelización de series temporales</a></li>
<li><a class="" href="cap-discriminante.html"><span class="header-section-number">21</span> Análisis discriminante</a></li>
<li><a class="" href="cap-conjunto.html"><span class="header-section-number">22</span> Análisis conjunto</a></li>
<li><a class="" href="tablas-contingencia.html"><span class="header-section-number">23</span> Análisis de tablas de contingencia</a></li>
<li class="book-part">Machine learning supervisado</li>
<li><a class="" href="cap-arboles.html"><span class="header-section-number">24</span> Árboles de clasificación y regresión</a></li>
<li><a class="" href="cap-svm.html"><span class="header-section-number">25</span> Máquinas de vector soporte</a></li>
<li><a class="" href="cap-knn.html"><span class="header-section-number">26</span> Clasificador \(k\)-vecinos más próximos</a></li>
<li><a class="" href="cap-naive-bayes.html"><span class="header-section-number">27</span> Naive Bayes</a></li>
<li><a class="" href="cap-bagg-rf.html"><span class="header-section-number">28</span> Métodos ensamblados: \(\bf \textit {bagging}\) y \(\bf \textit{random}\) \(\bf \textit{forest}\)</a></li>
<li><a class="" href="cap-boosting-xgboost.html"><span class="header-section-number">29</span> \(\bf \textit{Boosting}\) y el algoritmo XGBoost</a></li>
<li class="book-part">Machine learning no supervisado</li>
<li><a class="" href="cap-cluster.html"><span class="header-section-number">30</span> Análisis clúster: clusterización jerárquica</a></li>
<li><a class="" href="no-jerarquico.html"><span class="header-section-number">31</span> Análisis clúster: clusterización no jerárquica</a></li>
<li><a class="" href="acp.html"><span class="header-section-number">32</span> Análisis de componentes principales</a></li>
<li><a class="" href="af.html"><span class="header-section-number">33</span> Análisis factorial</a></li>
<li><a class="" href="mds.html"><span class="header-section-number">34</span> Escalamiento multidimensional</a></li>
<li><a class="" href="correspondencias.html"><span class="header-section-number">35</span> Análisis de correspondencias</a></li>
<li class="book-part">Deep learning</li>
<li><a class="" href="capNN.html"><span class="header-section-number">36</span> Redes neuronales artificiales</a></li>
<li><a class="" href="cap-redes-convol.html"><span class="header-section-number">37</span> Redes neuronales convolucionales</a></li>
<li class="book-part">Ciencia de datos de texto y redes</li>
<li><a class="" href="mineria-textos.html"><span class="header-section-number">38</span> Minería de textos</a></li>
<li><a class="" href="grafos.html"><span class="header-section-number">39</span> Análisis de grafos y redes sociales</a></li>
<li class="book-part">Ciencia de datos espaciales</li>
<li><a class="" href="datos-espaciales.html"><span class="header-section-number">40</span> Trabajando con datos espaciales</a></li>
<li><a class="" href="geo.html"><span class="header-section-number">41</span> Geoestadística</a></li>
<li><a class="" href="cap-econom-esp.html"><span class="header-section-number">42</span> Modelos econométricos espaciales</a></li>
<li><a class="active" href="cap-pp.html"><span class="header-section-number">43</span> Procesos de puntos</a></li>
<li class="book-part">Comunica y colabora</li>
<li><a class="" href="id_120007-informes.html"><span class="header-section-number">44</span> Informes reproducibles con R Markdown y Quarto</a></li>
<li><a class="" href="shiny.html"><span class="header-section-number">45</span> Creación de aplicaciones web interactivas con Shiny</a></li>
<li><a class="" href="github.html"><span class="header-section-number">46</span> Git y GitHub R</a></li>
<li><a class="" href="geoproces.html"><span class="header-section-number">47</span> Geoprocesamiento en nube</a></li>
<li class="book-part">Casos de estudio en ciencia de datos</li>
<li><a class="" href="cap-crimen.html"><span class="header-section-number">48</span> Análisis de una red criminal</a></li>
<li><a class="" href="cap-publicidad.html"><span class="header-section-number">49</span> Optimización de inversiones publicitarias</a></li>
<li><a class="" href="cap-twitter.html"><span class="header-section-number">50</span> ¿Cómo tuitea Elon Musk?</a></li>
<li><a class="" href="cap-periodismo.html"><span class="header-section-number">51</span> Análisis electoral: de RStudio a su periódico favorito</a></li>
<li><a class="" href="paro-clm.html"><span class="header-section-number">52</span> El impacto de las crisis financiera y de la COVID-19 en el paro de CLM</a></li>
<li><a class="" href="cap-rfm.html"><span class="header-section-number">53</span> Segmentación de clientes en el comercio minorista</a></li>
<li><a class="" href="cap-medicina.html"><span class="header-section-number">54</span> Análisis de datos en medicina</a></li>
<li><a class="" href="cap-futbol.html"><span class="header-section-number">55</span> Messi y Ronaldo: dos ídolos desde la perspectiva de los datos</a></li>
<li><a class="" href="cambioclimatico.html"><span class="header-section-number">56</span> Una nota sobre el cambio climático</a></li>
<li><a class="" href="cap-sist-exp.html"><span class="header-section-number">57</span> Implementación de un sistema experto en el ámbito pediátrico</a></li>
<li><a class="" href="cap-ree.html"><span class="header-section-number">58</span> Predicción de consumo eléctrico con redes neuronales artificiales</a></li>
<li><a class="" href="nlp-textil.html"><span class="header-section-number">59</span> El procesamiento del lenguaje natural para tendencias de moda en textil</a></li>
<li><a class="" href="cap-fraude.html"><span class="header-section-number">60</span> Detección de fraude de tarjetas de crédito</a></li>
<li class="book-part">Appendix</li>
<li><a class="" href="info-session.html"><span class="header-section-number">A</span> Información de la sesión</a></li>
<li><a class="" href="referencias.html">Referencias</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="cap-pp" class="section level1" number="43">
<h1>
<span class="header-section-number">Capítulo 43</span> Procesos de puntos<a class="anchor" aria-label="anchor" href="#cap-pp"><i class="fas fa-link"></i></a>
</h1>
<p><em>Jorge Mateu</em><span class="math inline">\(^{a}\)</span> y <em>Mehdi Moradi</em><span class="math inline">\(^{b}\)</span></p>
<p><span class="math inline">\(^{a}\)</span>Universidad Jaume I<br><span class="math inline">\(^{b}\)</span>Umeå Universitet</p>
<div id="introducción-22" class="section level2" number="43.1">
<h2>
<span class="header-section-number">43.1</span> Introducción<a class="anchor" aria-label="anchor" href="#introducci%C3%B3n-22"><i class="fas fa-link"></i></a>
</h2>
<p>La <strong>estadística espacial</strong> es una rama de la estadística que se ha desarrollado rápidamente durante los últimos treinta años, tanto en el plano teórico como en el práctico. A ello han contribuido, de manera significativa, la creciente disponibilidad de potencia computacional y variedad en software, que han estimulado la capacidad de resolver problemas cada vez más complejos. Lo cierto es que estos problemas tienen como elemento común la estructura espacial. En general, se ha observado un desarrollo científico notable en el campo de la estadística espacial: los nuevos problemas, bien definidos, con un carácter común, que saltaron a la agenda del investigador, y la disponibilidad de datos motivaron nuevos desarrollos teóricos.</p>
<p>La estadística espacial reconoce y explota las ubicaciones espaciales de los datos al diseñar, recopilar, administrar, analizar y mostrar dichos datos. Los datos espaciales suelen ser dependientes, por lo que se necesitan clases de modelos espaciales que permitan la predicción de procesos espaciales y la estimación de sus parámetros. Los <strong>patrones espaciales</strong> ocurren en una variedad sorprendentemente amplia de disciplinas científicas: los ecologistas estudian las interacciones entre plantas y animales, los silvicultores y agricultores deben investigar la capacidad de las plantas y tener en cuenta las variaciones del suelo en sus experimentos. Así pues, cualquier disciplina que trabaje con datos recopilados en diferentes ubicaciones espaciales necesita desarrollar modelos que indiquen cuándo hay dependencia entre mediciones en diferentes lugares y cómo llevar a cabo estimaciones y predicciones en presencia de dependencia espacial. Referencias modernas sobre estadística espacial incluyen los libros de <span class="citation">Diggle (<a href="referencias.html#ref-diggle2013">2013</a>)</span>, <span class="citation">N. Cressie and Wikle (<a href="referencias.html#ref-cressie2015statistics">2015</a>)</span>, <span class="citation">J. M. Montero, Fernández-Avilés, and Mateu (<a href="referencias.html#ref-montero2015spatial">2015</a>)</span>, <span class="citation">Wikle, Zammit-Mangion, and Cressie (<a href="referencias.html#ref-Wikletal19">2019</a>)</span>, <span class="citation">Diggle and Giorgi (<a href="referencias.html#ref-DiggGio19">2019</a>)</span>, entre otros.</p>
<p>Este capítulo se centra en los <strong>patrones espaciales de puntos</strong>. Datos en forma de conjunto de puntos distribuidos irregularmente dentro de una región del espacio surgen en muchos contextos diferentes; por ejemplo, localizaciones de incendios forestales (véase Fig. <a href="cap-pp.html#fig:kernelnepal">43.1</a>), delitos (véase Fig. <a href="cap-pp.html#fig:medker">43.2</a>), árboles en un bosque, nidos en una colonia de cría de pájaros, ubicación de núcleos en una sección microscópica de tejido, depósitos de oro mapeados en un estudio geológico, estrellas en un cúmulo estelar, accidentes de tráfico, terremotos, llamadas de teléfonos móviles, avistamientos de animales o casos de una enfermedad rara.</p>
<p>Se llama <strong>patrón espacial de puntos</strong> a cualquier conjunto de datos de este tipo. La disposición espacial de los puntos es el principal foco de investigación. Son muchos los campos de la ciencia donde este tipo de estructuras son de interés; por ejemplo, en ecología, epidemiología, geociencia, astronomía, econometría e investigación criminal.
El análisis estadístico de la disposición espacial de los puntos puede revelar características importantes, como que los yacimientos de oro suelen encontrarse cerca de una gran falla geológica o que los casos de una enfermedad son más frecuentes cerca de una fuente de contaminación.</p>
<p>El análisis de los datos de patrones de puntos ha proporcionado evidencia fundamental para importantes investigaciones, desde la transmisión del cólera hasta el comportamiento de los asesinos en serie y la estructura a gran escala
del universo. Los puntos en un patrón de puntos pueden tener todo tipo de atributos. Un estudio forestal podría registrar cada ubicación, especie y diámetro del árbol; un catálogo de estrellas puede dar sus posiciones en el cielo, masas, formas y colores; las ubicaciones de los casos de enfermedades pueden estar vinculadas a registros clínicos detallados. Esta información auxiliar adjunta a cada punto en el patrón de puntos se llama <strong>marca</strong> y en ese caso se habla de un patrón de puntos marcado. La colección de localizaciones de un patrón puntual puede venir definida en una <strong>región plana</strong> (Sec. <a href="cap-pp.html#secplana">43.2</a>) o bien en una <strong>red lineal</strong> (Sec. <a href="cap-pp.html#seclineal">43.3</a>), haciendo que las distancias dejen de ser euclidianas para pasar a ser del camino más corto. Esto introduce ciertos cambios metodológicos en cuanto a las construcciones de ciertas características, que en el caso de intensidades de primer orden se tratan en este capítulo.</p>
</div>
<div id="secplana" class="section level2" number="43.2">
<h2>
<span class="header-section-number">43.2</span> Patrones puntuales espaciales en <span class="math inline">\(\mathbb R^2\)</span><a class="anchor" aria-label="anchor" href="#secplana"><i class="fas fa-link"></i></a>
</h2>
<p>La teoría de procesos puntuales espaciales constituye la base para el análisis de eventos observados geográficamente a través de sus coordenadas (longitud, latitud) en un espacio bi-dimensional.
Esta rama de los procesos puntuales pertenece al campo de la estadística espacial en conjunción con la de procesos estocásticos. De hecho, un proceso puntual espacial es un proceso estocástico cuyas realizaciones consisten en un conjunto numerable de puntos en el plano (patrón puntual). Heurísticamente, se trata de un conjunto de datos que se encuentra en una región concreta (o área de estudio).</p>
<p>Sea <span class="math inline">\({\bf x} =\{ {\bf x}_1, {\bf x}_2, \ldots, {\bf x}_n \}, \hspace{0,1cm}0 \leq n &lt; \infty\)</span> una realización (patrón puntual) observada de un proceso puntual simple (<em>i. e.</em> sin múltiples eventos por localización) y finito <span class="math inline">\(X\)</span> en <span class="math inline">\(\mathbb R^2\)</span> en la región <span class="math inline">\(W \subset \mathbb R^2\)</span> y con la métrica (distancia) asociada <span class="math inline">\(d(\bf u,\bf v)\)</span>, siendo <span class="math inline">\(\bf u\)</span> y <span class="math inline">\(\bf v\)</span> dos localizaciones espaciales en <span class="math inline">\(W\)</span>. En general, las realizaciones consisten en un conjunto numerable de puntos (llamados en muchas ocasiones eventos). Las Figs. <a href="cap-pp.html#fig:kernelnepal">43.1</a> y <a href="cap-pp.html#fig:medker">43.2</a> permiten ver algunos ejemplos de patrones puntuales. Para cualquier conjunto arbitrario <span class="math inline">\(A \subset \mathbb R^2\)</span>, el cardinal de <span class="math inline">\(X\)</span> viene dado por la función de conteo:</p>
<p><span class="math display">\[\begin{equation*}
N(X \cap A)
=
\sum\limits_{{\bf x} \in X}  {\mathbf 1} \{ {\bf x} \in A \} &lt; \infty
,
\end{equation*}\]</span></p>
<p>donde <span class="math inline">\(\mathbf 1\)</span> es una función indicadora.</p>
<p>Además, como establece la fórmula de Campbell <span class="citation">(<a href="referencias.html#ref-BRT15">Baddeley, Rubak, and Turner 2015</a>)</span>, para cualquier función medible <span class="math inline">\(f: \mathbb R^2 \to [0, \infty)\)</span> se cumple que:
<span class="math display" id="eq:compR2">\[\begin{equation*}
\mathbb E
\left[
\sum\limits_{{\bf x} \in X}
f({\bf x})
\right]
=
\int_{\mathbb R ^2}
f({\bf u})
\lambda({\bf u})
\mathrm{d} {\bf u},
\tag{43.1}
\end{equation*}\]</span>
donde <span class="math inline">\(\lambda (\cdot)\)</span> determina la <strong>función de intensidad</strong> de <span class="math inline">\(X\)</span> y gobierna su distribución espacial. De hecho, <span class="math inline">\(\lambda({\bf u})\)</span> proporciona el valor esperado de eventos por unidad de área en un entorno de <span class="math inline">\({\bf u} \in \mathbb R^2\)</span>. Teniendo en cuenta que <span class="math inline">\(f({\bf x}) = { 1} \{{ \bf x} \in A \}\)</span>, se puede observar fácilmente la relación entre la función de intensidad <span class="math inline">\(\lambda(\cdot)\)</span> y la de conteo <span class="math inline">\(N\)</span>:
<span class="math display">\[\begin{equation*}
\mathbb E
\left[
N(X \cap A)
\right]
=
\int_A
\lambda({\bf u})
\mathrm{d} {\bf u}.
\end{equation*}\]</span>
Si la función de intensidad <span class="math inline">\(\lambda(\cdot)\)</span> es constante, <em>i.e.</em> <span class="math inline">\(\lambda(\cdot) = \lambda\)</span>, se dice que el proceso <span class="math inline">\(X\)</span> es homogéneo, mientras que, en caso contrario, se dice que es inhomogéneo; en este último caso, la distribución espacial varía a lo largo de la región soporte (para el lector con un mayor interés en conceptos y desarrollos se aconseja consultar <span class="citation">Møller and Waagepetersen (<a href="referencias.html#ref-moller2003">2003</a>)</span>, <span class="citation">Illian et al. (<a href="referencias.html#ref-illian2008">2008</a>)</span>, <span class="citation">Diggle (<a href="referencias.html#ref-diggle2013">2013</a>)</span> y <span class="citation">Baddeley, Rubak, and Turner (<a href="referencias.html#ref-BRT15">2015</a>)</span>.</p>
<p>En la práctica se suele observar solo una única realización y, por ello, es importante disponer de una estimación de <span class="math inline">\(\lambda(\cdot)\)</span> que represente fielmente la distribución espacial del proceso subyacente que ha generado el patrón observado. A continuación se exponen diferentes <strong>estimadores no paramétricos de la intensidad</strong>.</p>
<div id="secestimaciones" class="section level3" number="43.2.1">
<h3>
<span class="header-section-number">43.2.1</span> Estimación de la intensidad basada en funciones núcleo<a class="anchor" aria-label="anchor" href="#secestimaciones"><i class="fas fa-link"></i></a>
</h3>
<p>Dos estimadores no paramétricos de la función de intensidad ampliamente utilizados en patrones puntuales en <span class="math inline">\(\mathbb R^2\)</span>, basados en <strong>funciones núcleo</strong>, vienen dados por:
<span class="math display" id="eq:kde2Dunif">\[\begin{equation}
\widehat \lambda^{\text{U}}_{\sigma}({\bf u})
=
\frac{1}{c_{\sigma,W}({\bf u})} \sum_{i=1}^n \kappa_{\sigma}({\bf u} - {\bf{x}}_i),
\quad {\bf u} \in W
\tag{43.2}
\end{equation}\]</span>
y
<span class="math display" id="eq:kde2DJD">\[\begin{equation}
\widehat \lambda^{\text{JD}}_{\sigma}({\bf u})
=
\sum_{i=1}^n \frac{\kappa_{\sigma}({\bf u} - {\bf x}_i)}{c_{\sigma,W}({\bf x}_i)},
\quad {\bf u} \in W,
\tag{43.3}
\end{equation}\]</span></p>
<p>donde <span class="math inline">\(\kappa_{\sigma}\)</span> es una función de densidad de probabilidad en <span class="math inline">\(\mathbb R^2\)</span> con parámetro de suavizado (ancho de banda) <span class="math inline">\(\sigma\)</span>, y</p>
<p><span class="math display">\[\begin{equation}
c_{\sigma,W}({\bf u})
=
\int_W \kappa_{\sigma}({\bf u} - {\bf v}) \mathrm{d} {\bf v},
\quad {\bf u} \in W
\end{equation}\]</span>
es el área del núcleo centrado en <span class="math inline">\({\bf u} \in W\)</span>, y equivale a un corrector de borde que compensa por la falta de información fuera de <span class="math inline">\(W\)</span>. Hay que recordar que, en la práctica, solo se observa una realización de <span class="math inline">\(X\)</span> en la región acotada <span class="math inline">\(W\)</span>. Más allá de la elección de <span class="math inline">\(\sigma\)</span>, el estimador <a href="cap-pp.html#eq:kde2Dunif">(43.2)</a> es insesgado si la función de intensidad es constante <span class="citation">(<a href="referencias.html#ref-diggle1985">Diggle 1985</a>)</span>, mientras que el estimador <a href="cap-pp.html#eq:kde2DJD">(43.3)</a> conserva la masa total <span class="citation">(<a href="referencias.html#ref-jones1993simple">Jones 1993</a>)</span>. Los estimadores <a href="cap-pp.html#eq:kde2Dunif">(43.2)</a> y <a href="cap-pp.html#eq:kde2DJD">(43.3)</a> suelen ser llamados “uniformly-edge-corrected” y “Jones-Diggle” <span class="citation">(<a href="referencias.html#ref-rakshit2019fast">Rakshit et al. 2019</a>)</span>. En este capítulo, se considera en todo momento la función núcleo gaussiana <span class="citation">(<a href="referencias.html#ref-silverman1986">Bernard W. Silverman 1986</a>)</span>.</p>
<p>En términos prácticos, la adecuación de los estimadores basados en núcleos depende del parámetro de suavizado, de forma que un suavizamiento pequeño lleva a un sesgo bajo y una varianza alta, mientras que un parámetro de suavizado alto resulta en un sesgo alto y a una varianza pequeña. Para un determinado patrón puntual <span class="math inline">\({\mathbf x}\)</span>, los estimadores <a href="cap-pp.html#eq:kde2Dunif">(43.2)</a> y <a href="cap-pp.html#eq:kde2DJD">(43.3)</a> pueden ser calculados utilizando la función <code>density.ppp()</code> de <code>spatstat.core</code>, especificando <code>diggle=FALSE</code> y <code>diggle=TRUE</code>, respectivamente.</p>
<div id="secbw" class="section level4" number="43.2.1.1">
<h4>
<span class="header-section-number">43.2.1.1</span> Selección del parámetro de suavizado<a class="anchor" aria-label="anchor" href="#secbw"><i class="fas fa-link"></i></a>
</h4>
<p></p>
<p><span class="citation">Scott (<a href="referencias.html#ref-scott1992">1992</a>)</span> propuso elegir este parámetro a través de un regla un tanto naíf (llamada <em>rule of thumb</em>) de la forma:
<span class="math display">\[
(s_x n^{-1/6}, s_y n^{-1/6}),
\]</span>
para cada coordenada cartesiana <span class="math inline">\(x,y\)</span>, donde <span class="math inline">\(s_x, s_y\)</span> son las desviaciones típicas de las coordenadas (<span class="math inline">\(x,y\)</span>) de los eventos. Este procedimiento es útil para análisis exploratorios. La función <code>bw.scott()</code> de <code>spatstat.explore</code> proporciona este estimador. Nótese que, en el caso de Scott, el parámetro de suavizado es, por construcción, un vector de dos componentes para suavizar ambas coordenadas cartesianas.</p>
<p><span class="citation">Cronie and Van Lieshout (<a href="referencias.html#ref-cronie2018">2018</a>)</span> propusieron encontrar el parámetro óptimo minimizando:
<span class="math display">\[
CvL(\sigma)
=
\left(
|W|
-
\sum\limits_{i=1}^n
\frac {1}
{
\widehat{\lambda}^*_{\sigma}({\bf x}_i)}
\right)^2,
\]</span></p>
<p>donde <span class="math inline">\(|W|\)</span> es el tamaño de la región <span class="math inline">\(W\)</span> y <span class="math inline">\(\widehat{\lambda}^*_{\sigma}({\bf x}_i)\)</span> es un estimador de la intensidad sin corregir (bien sea la expresión <a href="cap-pp.html#eq:kde2Dunif">(43.2)</a> o la expresión <a href="cap-pp.html#eq:kde2DJD">(43.3)</a>, pero sin el término de corrección) evaluado en <span class="math inline">\({\bf x}_i\)</span> y con parámetro de suavizado <span class="math inline">\(\sigma\)</span>. La idea de este estimador proviene de la fórmula de Campbell, ya que:
<span class="math display">\[
\mathbb E
\left[
\sum\limits_{x \in X}
1
/
\lambda(x)
\right]
=
\int_W
(1
/
\lambda(x)
)
\lambda(x)
\mathrm{d} u
=
|W|.
\]</span>
Para un patrón puntual <span class="math inline">\({\mathbf x}\)</span>, la función <code>bw.CvL()</code> de <code>spatstat.explore</code> calcula el parámetro de suavizado mediante el método de Cronie y van Lieshout (se denotará por Cronie–van Lieshout).</p>
</div>
</div>
<div id="ejemplos-prácticos" class="section level3" number="43.2.2">
<h3>
<span class="header-section-number">43.2.2</span> Ejemplos prácticos<a class="anchor" aria-label="anchor" href="#ejemplos-pr%C3%A1cticos"><i class="fas fa-link"></i></a>
</h3>
<p>En esta sección se hace uso de los estimadores de la intensidad anteriormente mostrados y de los diferentes métodos de selección del parámetro de suavizado para analizar la distribución espacial de dos conjuntos de datos: incendios forestales en Nepal (Fig. <a href="cap-pp.html#fig:kernelnepal">43.1</a>), y eventos de crímenes en Medellín, Colombia (Fig. <a href="cap-pp.html#fig:medker">43.2</a>). Para ello, se utilizan las librerías <code>spatstat</code>, versión 2.3-0, <span class="citation">(<a href="referencias.html#ref-spatstat">Baddeley and Turner 2005a</a>; <a href="referencias.html#ref-BRT15">Baddeley, Rubak, and Turner 2015</a>)</span> para el análisis de patrones puntuales y <code>raster</code>, versión 3.5-15, <span class="citation">(<a href="referencias.html#ref-raster">Hijmans 2022a</a>)</span> para determinadas representaciones gráficas.</p>
<div class="infobox">
<p><strong>Nota</strong></p>
<p>La librería <code>spatstat</code> ha sido recientemente dividida en una familia de sub-librerías <code>spatstat.utils</code>, <code>spatstat.data</code>, <code>spatstat.sparse</code>, <code>spatstat.geom</code>, <code>spatstat.random</code>, <code>spatstat.core</code>, <code>spatstat.linnet</code>, <code>spatstat.explore</code>, <code>spatstat.model</code>, de forma que <code>spatstat</code> actúa como una libería paraguas de todas ellas. Los lectores deben estar atentos a posibles futuros cambios en <code>spatstat</code> y <code>raster</code> para satisfacer ciertas restricciones de CRAN en relación con los tamaños de sus librerías.</p>
</div>
<div id="secnepalfire" class="section level4" number="43.2.2.1">
<h4>
<span class="header-section-number">43.2.2.1</span> Ejemplo 1: incendios forestales en Nepal<a class="anchor" aria-label="anchor" href="#secnepalfire"><i class="fas fa-link"></i></a>
</h4>
<p></p>
<p>Por cortesía de Ganesh Prasad Sigdel, se dispone de localizaciones georreferenciadas de incendios forestales en Nepal durante 2016, datos cedidos por la institución ICIMOD-Nepal. En 2016, Nepal sufrió 5.757 incendios, de los cuales 475 ocurrieron en el distrito de Surkhet, en la provincia de Karnali, en el medio-oeste de Nepal. Se comienza llamando a algunas librerías de <strong>R</strong>, útiles para nuestros propósitos.</p>
<div class="sourceCode" id="cb644"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># library("raster")</span></span>
<span><span class="co"># library("spatstat")</span></span>
<span><span class="co"># library("CDR")</span></span></code></pre></div>
<p>Utilizando los métodos descritos en la Sec. <a href="cap-pp.html#secbw">43.2.1.1</a>, se estima el correspondiente parámetro de suavizado. La regla de Scott proporciona los valores (50.253,47 m, 21.158,42 m) y el método de validación cruzada de Cronie–van Lieshout estima el valor como 36.513,16 m. Mediante el argumento <code>ns</code> de <code>bw.CvL()</code>, se puede controlar mejor la búsqueda del parámetro óptimo a través de un <em>grid</em> más fino.</p>
<div class="sourceCode" id="cb645"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">nepal</span><span class="op">)</span></span>
<span><span class="va">scott_nepal</span> <span class="op">&lt;-</span> <span class="fu">bw.scott</span><span class="op">(</span><span class="va">nepal</span><span class="op">)</span> <span class="co"># Scott’s rule</span></span>
<span><span class="va">CvL_nepal</span> <span class="op">&lt;-</span> <span class="fu">bw.CvL</span><span class="op">(</span><span class="va">nepal</span><span class="op">)</span> <span class="co"># Cronie and van Lieshout’s criterio</span></span></code></pre></div>
<p>Conocido el parámetro de suavizado, se estima la intensidad mediante los estimadores <a href="cap-pp.html#eq:kde2Dunif">(43.2)</a> y <a href="cap-pp.html#eq:kde2DJD">(43.3)</a>. La función <code>density.ppp()</code> proporciona una estimación basada en funciones núcleo para patrones en <span class="math inline">\(\mathbb R^2\)</span>, teniendo en cuenta que, por defecto, esta función hace uso del estimador con corrección uniforme para los bordes (<em>uniformly-edge-corrected estimator</em>) <a href="cap-pp.html#eq:kde2Dunif">(43.2)</a> con un núcleo gaussiano. Se fija <code>leaveoneout=FALSE</code> para no calcular el estimador <em>leave-one-out</em>, mientras que se establece <code>positive=TRUE</code> para forzar valores positivos en la densidad. Esto último obedece a que, debido a errores numéricos en el cálculo de la transformada rápida de Fourier, se pueden obtener valores negativos en ciertas áreas (véase la ayuda de <code>density.ppp()</code>).</p>
<div class="sourceCode" id="cb646"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d_scott_nepal</span> <span class="op">&lt;-</span> <span class="fu">density.ppp</span><span class="op">(</span><span class="va">nepal</span>, sigma <span class="op">=</span> <span class="va">scott_nepal</span>, </span>
<span>                             leaveoneout <span class="op">=</span> <span class="cn">FALSE</span>, positive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">d_cvl_nepal</span> <span class="op">&lt;-</span> <span class="fu">density.ppp</span><span class="op">(</span><span class="va">nepal</span>, sigma <span class="op">=</span> <span class="va">CvL_nepal</span>, </span>
<span>                           leaveoneout <span class="op">=</span> <span class="cn">FALSE</span>, positive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>La estimación de la intensidad mediante el estimador de Jones-Diggle <a href="cap-pp.html#eq:kde2Dunif">(43.2)</a> se lleva a cabo escribiendo <code>diggle=TRUE</code> en <code>density.ppp()</code>:</p>
<div class="sourceCode" id="cb647"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d_scott_dig_nepal</span> <span class="op">&lt;-</span> <span class="fu">density.ppp</span><span class="op">(</span><span class="va">nepal</span>, sigma <span class="op">=</span> <span class="va">scott_nepal</span>, </span>
<span>                                 leaveoneout <span class="op">=</span> <span class="cn">FALSE</span>, positive <span class="op">=</span> <span class="cn">TRUE</span>, diggle <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">d_cvl_dig_nepal</span> <span class="op">&lt;-</span> <span class="fu">density.ppp</span><span class="op">(</span><span class="va">nepal</span>, sigma <span class="op">=</span> <span class="va">CvL_nepal</span>, </span>
<span>                               leaveoneout <span class="op">=</span> <span class="cn">FALSE</span>, positive <span class="op">=</span> <span class="cn">TRUE</span>, diggle <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>Tras obtener diferentes estimadores de la intensidad bajo diferentes métodos de selección del parámetro de suavizado, a continuación se muestran estas estimaciones y se comentan sus discrepancias. Para una mejor representación gráfica, se convierten las imágenes de intensidad dadas en la clase <code>im</code> a objetos de clase <code>raster</code> para luego juntarlas en un <code>RasterStack</code>. La Fig. <a href="cap-pp.html#fig:kernelnepal">43.1</a> muestra estas estimaciones, observándose una mayor intensidad en el sur y suroeste de Nepal, indicando una clara distribución no uniforme de dicha intensidad, lo que, a su vez, indica un alto grado de inhomogeneidad.</p>
<div class="sourceCode" id="cb648"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sp_int_nepal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/stack.html">stack</a></span><span class="op">(</span><span class="fu">raster</span><span class="op">(</span><span class="va">d_scott_nepal</span><span class="op">)</span>, <span class="fu">raster</span><span class="op">(</span><span class="va">d_cvl_nepal</span><span class="op">)</span>, <span class="fu">raster</span><span class="op">(</span><span class="va">d_scott_dig_nepal</span><span class="op">)</span>, <span class="fu">raster</span><span class="op">(</span><span class="va">d_cvl_dig_nepal</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">sp_int_nepal</span> <span class="op">&lt;-</span> <span class="va">sp_int_nepal</span> <span class="op">*</span> <span class="fl">10</span><span class="op">^</span><span class="fl">7</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">sp_int_nepal</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"scott_gaus_U"</span>, <span class="st">"CvL_gaus_U"</span>, <span class="st">"scott_gaus_JD"</span>, <span class="st">"CvL_gaus_JD"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">at</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1.4</span>, <span class="fl">0.2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">pts_nepal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">nepal</span><span class="op">)</span></span>
<span><span class="fu">coordinates</span><span class="op">(</span><span class="va">pts_nepal</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="op">~</span> <span class="va">x</span> <span class="op">+</span> <span class="va">y</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="http://latticeextra.r-forge.r-project.org/">"latticeExtra"</a></span><span class="op">)</span></span>
<span><span class="fu">spplot</span><span class="op">(</span><span class="va">sp_int_nepal</span>, at <span class="op">=</span> <span class="va">at</span>, scales <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>draw <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>, col.regions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/flip.html">rev</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">topo.colors</a></span><span class="op">(</span><span class="fl">20</span><span class="op">)</span><span class="op">)</span>, colorkey <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>cex <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span>, par.strip.text <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>cex <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/layer.html">layer</a></span><span class="op">(</span><span class="fu">sp.points</span><span class="op">(</span><span class="va">pts_nepal</span>, pch <span class="op">=</span> <span class="fl">20</span>, col <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:kernelnepal"></span>
<img src="img/nepal2016.png" alt="Estimación basada en funciones núcleo para los incendios forestales (puntos negros) en Nepal en 2016. Las etiquetas de los nombres comienzan con el método de suavizado, seguido del núcleo utilizado y de la corrección de borde.  Los valores de la intensidad indican el número de incendios por 10.000 km2. Se usan JD y U para indicar los estimadores de Jones-Diggle y con corrección uniforme para los bordes, respectivamente." width="70%"><p class="caption">
Figura 43.1: Estimación basada en funciones núcleo para los incendios forestales (puntos negros) en Nepal en 2016. Las etiquetas de los nombres comienzan con el método de suavizado, seguido del núcleo utilizado y de la corrección de borde. Los valores de la intensidad indican el número de incendios por 10.000 km2. Se usan JD y U para indicar los estimadores de Jones-Diggle y con corrección uniforme para los bordes, respectivamente.
</p>
</div>
</div>
<div id="ejemplo-2-crímenes-en-medellín" class="section level4" number="43.2.2.2">
<h4>
<span class="header-section-number">43.2.2.2</span> Ejemplo 2: crímenes en Medellín<a class="anchor" aria-label="anchor" href="#ejemplo-2-cr%C3%ADmenes-en-medell%C3%ADn"><i class="fas fa-link"></i></a>
</h4>
<p>Medellín es la segunda ciudad con más población en Colombia <span class="citation">(<a href="referencias.html#ref-DANE">DANE 2019</a>)</span>, con un territorio urbano de <span class="math inline">\(105\)</span> km<span class="math inline">\(^2\)</span>, que ha sufrido de múltiples acciones criminales durante muchos años, como es bien conocido. En 2018, la Secretaría de Seguridad de Medellín reportó que el <span class="math inline">\(40\%\)</span> de los ciudadanos se sentía inseguro: a modo de ejemplo, en dicho año el número de quejas por robo se elevó a 20.607 <span class="citation">(<a href="referencias.html#ref-Restrepo">Restrepo 2019</a>)</span>. Adicionalmente, el departamento de policía reconocía la necesidad de contratar al menos 2.000 policías más para luchar contra los homicidios, robos y microtráfico <span class="citation">(<a href="referencias.html#ref-Monsalve">Monsalve 2019</a>)</span>.</p>
<p>En esta sección solo se analiza la distribución espacial de los eventos georreferenciados de crímenes ocurridos en Medellín durante 2005 <span class="citation">(<a href="referencias.html#ref-sanabria2022">Sanabria et al. 2022</a>)</span>. En 2005 ocurrieron 910 crímenes, de los cuales el porcentaje de víctimas varones fue del <span class="math inline">\(66\%\)</span> y el <span class="math inline">\(28\%\)</span> fueron cometidos durante los fines de semana; el porcentaje de robos fue del <span class="math inline">\(42\%\)</span> y el de víctimas con edades entre 20 y 40 fue del <span class="math inline">\(60\%\)</span>.</p>
<p>Nótese que el conjunto de localizaciones donde ocurrieron estos crímenes no hace referencia necesariamente a las calles de la ciudad y, por tanto, se considera que el patrón puntual tiene como dominio de definición todo <span class="math inline">\(\mathbb R^2\)</span>.</p>
<div class="sourceCode" id="cb649"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">medellin</span><span class="op">)</span></span>
<span><span class="va">scott_med</span> <span class="op">&lt;-</span> <span class="fu">bw.scott</span><span class="op">(</span><span class="va">medellin</span><span class="op">)</span> <span class="co"># Scott’s rule</span></span>
<span><span class="va">CvL_med</span> <span class="op">&lt;-</span> <span class="fu">bw.CvL</span><span class="op">(</span><span class="va">medellin</span><span class="op">)</span> <span class="co"># Cronie and van Lieshout’s criterio</span></span></code></pre></div>
<p>La regla de Scott estima el parámetro de suavizado en (691,31 m, 954,20 m) mientras que el criterio de validación cruzada (CvL) lleva a un valor estimado de 692,31 m. Para obtener las distintas estimaciones de la intensidad <a href="cap-pp.html#eq:kde2Dunif">(43.2)</a> y <a href="cap-pp.html#eq:kde2DJD">(43.3)</a> bajo los mismos escenarios que en la Sec. <a href="cap-pp.html#secnepalfire">43.2.2.1</a> se utiliza la función <code>density.ppp()</code></p>
<div class="sourceCode" id="cb650"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d_scott_med</span> <span class="op">&lt;-</span> <span class="fu">density.ppp</span><span class="op">(</span><span class="va">medellin</span>, sigma <span class="op">=</span> <span class="va">scott_med</span>,</span>
<span>                           leaveoneout <span class="op">=</span> <span class="cn">FALSE</span>, positive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">d_cvl_med</span> <span class="op">&lt;-</span> <span class="fu">density.ppp</span><span class="op">(</span><span class="va">medellin</span>, sigma <span class="op">=</span> <span class="va">CvL_med</span>,</span>
<span>                         leaveoneout <span class="op">=</span> <span class="cn">FALSE</span>, positive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">d_scott_dig_med</span> <span class="op">&lt;-</span> <span class="fu">density.ppp</span><span class="op">(</span><span class="va">medellin</span>, sigma <span class="op">=</span> <span class="va">scott_med</span>,</span>
<span>                               leaveoneout <span class="op">=</span> <span class="cn">FALSE</span>, positive <span class="op">=</span> <span class="cn">TRUE</span>, diggle <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">d_cvl_dig_med</span> <span class="op">&lt;-</span> <span class="fu">density.ppp</span><span class="op">(</span><span class="va">medellin</span>, sigma <span class="op">=</span> <span class="va">CvL_med</span>,</span>
<span>                             leaveoneout <span class="op">=</span> <span class="cn">FALSE</span>, positive <span class="op">=</span> <span class="cn">TRUE</span>, diggle <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>La Fig. <a href="cap-pp.html#fig:medker">43.2</a> muestra la intensidad estimada bajo diferentes parámetros de suavizado. Se observa, en general, una distribución no homogénea de los crímenes. Independientemente del método utilizado, se identifican dos grandes <em>hotspots</em> en la zona central de Medellín, aunque con diferentes magnitudes. El efecto de la corrección de borde es solo marginal.</p>
<div class="sourceCode" id="cb651"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sp_int_med</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/stack.html">stack</a></span><span class="op">(</span><span class="fu">raster</span><span class="op">(</span><span class="va">d_scott_med</span><span class="op">)</span>, <span class="fu">raster</span><span class="op">(</span><span class="va">d_cvl_med</span><span class="op">)</span>,</span>
<span>                    <span class="fu">raster</span><span class="op">(</span><span class="va">d_scott_dig_med</span><span class="op">)</span>, <span class="fu">raster</span><span class="op">(</span><span class="va">d_cvl_dig_med</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">sp_int_med</span> <span class="op">&lt;-</span> <span class="va">sp_int_med</span> <span class="op">*</span> <span class="fl">10</span><span class="op">^</span><span class="fl">5</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">sp_int_med</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">sp_int_nepal</span><span class="op">)</span></span>
<span><span class="va">at</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3</span>, by <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">pts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">medellin</span><span class="op">)</span></span>
<span><span class="fu">coordinates</span><span class="op">(</span><span class="va">pts</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="op">~</span> <span class="va">x</span> <span class="op">+</span> <span class="va">y</span></span>
<span></span>
<span><span class="fu">sp</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/sp/man/spplot.html">spplot</a></span><span class="op">(</span><span class="va">sp_int_med</span>, at <span class="op">=</span> <span class="va">at</span>, scales <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>draw <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>           col.regions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/flip.html">rev</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">topo.colors</a></span><span class="op">(</span><span class="fl">20</span><span class="op">)</span><span class="op">)</span>, colorkey <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>cex <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span>,</span>
<span>           par.strip.text <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>cex <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/layer.html">layer</a></span><span class="op">(</span><span class="fu">sp.points</span><span class="op">(</span><span class="va">pts</span>, pch <span class="op">=</span> <span class="fl">20</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:medker"></span>
<img src="img/med2005.png" alt="Estimación de la intensidad basada en funciones núcleo para los datos de Medellín (puntos negros) durante 2005. Las etiquetas de los nombres comienzan con el método de suavizado, seguido del núcleo utilizado y de la corrección de borde. Los valores de la intensidad indican el  número de crímenes por 100 km2. Se usan JD y U para indicar los estimadores de Jones-Diggle y con corrección uniforme para los bordes, respectivamente." width="60%"><p class="caption">
Figura 43.2: Estimación de la intensidad basada en funciones núcleo para los datos de Medellín (puntos negros) durante 2005. Las etiquetas de los nombres comienzan con el método de suavizado, seguido del núcleo utilizado y de la corrección de borde. Los valores de la intensidad indican el número de crímenes por 100 km2. Se usan JD y U para indicar los estimadores de Jones-Diggle y con corrección uniforme para los bordes, respectivamente.
</p>
</div>
</div>
</div>
<div id="estimación-de-la-intensidad-basada-en-funciones-núcleo-en-dominios-irregulares" class="section level3" number="43.2.3">
<h3>
<span class="header-section-number">43.2.3</span> Estimación de la intensidad basada en funciones núcleo en dominios irregulares<a class="anchor" aria-label="anchor" href="#estimaci%C3%B3n-de-la-intensidad-basada-en-funciones-n%C3%BAcleo-en-dominios-irregulares"><i class="fas fa-link"></i></a>
</h3>
<p>Los estimadores <a href="cap-pp.html#eq:kde2Dunif">(43.2)</a> y <a href="cap-pp.html#eq:kde2DJD">(43.3)</a> pueden mostrar deficiencias importantes como no cumplir la condición de que la integral sea el número de puntos, sesgo cerca de las fronteras o presentar suavizamientos artificiales que lleven a resultados inverosímiles en ciertas ocasiones <span class="citation">(<a href="referencias.html#ref-baddeley2022diffusion">Baddeley et al. 2022</a>)</span>. Estos problemas son más aparentes en caso de dominios irregulares. Como remedio, <span class="citation">Baddeley et al. (<a href="referencias.html#ref-baddeley2022diffusion">2022</a>)</span> propusieron estimar la intensidad vía una <strong>función núcleo-calor</strong> (<em>heat kernel</em>), que puede definirse como una densidad de probabilidad de transición de un movimiento browniano en <span class="math inline">\(W\)</span> que respeta las fronteras. De hecho, su propuesta, denominada <strong>estimador de difusión</strong>, toma la forma:
<span class="math display" id="eq:heat">\[\begin{equation}
\widehat \lambda_t ({\bf u})
=
\sum\limits_{i=1}^n
\kappa_t ({\bf u}|{\bf x}_i)
,
\tag{43.4}
\end{equation}\]</span>
donde <span class="math inline">\(t= \sigma^2\)</span> (<span class="math inline">\(\sigma\)</span> es el parámetro de suavizado en las expresiones <a href="cap-pp.html#eq:kde2Dunif">(43.2)</a> y <a href="cap-pp.html#eq:kde2DJD">(43.3)</a>) y <span class="math inline">\(\kappa_t (\cdot| {\bf x}_i)\)</span> es el núcleo-calor. Este estimador es insesgado (baja homogeneidad) y preserva la masa (es decir, integra el número de puntos). <span class="citation">Baddeley et al. (<a href="referencias.html#ref-baddeley2022diffusion">2022</a>)</span> proponen algunos nuevos métodos de selección del parámetro de suavizado, adaptados a su estimador de difusión, incluyendo el de Cronie–van Lieshout. El estimador de difusión se puede calcular con la función <code>densityHeat.ppp()</code>, y el criterio de Cronie–van Lieshout viene en la función <code>bw.CvLHeat()</code>. Todas estas funciones pertenecen al paquete <code>spatstat.explore</code>.
</p>
<p>A continuación, a partir de un conjunto de datos de incendios activos en EE. UU. y América Central (sin considerar las islas) desde el 24 de febrero al 3 de marzo de 2022,<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;&lt;a href="https://firms.modaps.eosdis.nasa.gov/active%5C_fire/" class="uri"&gt;https://firms.modaps.eosdis.nasa.gov/active\_fire/&lt;/a&gt;&lt;/p&gt;'><sup>274</sup></a> se analiza el comportamiento del estimador de difusión en comparación con el estimador <a href="cap-pp.html#eq:kde2Dunif">(43.2)</a>. Hay que hacer notar que las localizaciones, en este caso, no necesariamente confirman la existencia de un incendio, sino más bien píxeles susceptibles de existencia de incendio que han sido clasificados por medio de algoritmos preparados para ello. Este formato está relacionado con el contexto de datos en <em>Near Real-Time</em> (NRT).</p>
<p>Los parámetros de suavizado para los estimadores <a href="cap-pp.html#eq:kde2Dunif">(43.2)</a> y <a href="cap-pp.html#eq:heat">(43.4)</a> siguen el criterio de Cronie–van Lieshout. Nótese que al tomar un área mucho más grande que en los ejemplos precedentes, se considera <code>ns=50</code>, es decir, se usa un vector de tamaño 50 para buscar el parámetro de suavizado óptimo (por defecto es 16), y <code>dimyx=512</code> para obtener imágenes de intensidad con una mejor resolución (por defecto, las imágenes son de tamaño <span class="math inline">\(128\times 128\)</span> píxeles). Los parámetros de suavizado elegidos para calcular <a href="cap-pp.html#eq:kde2Dunif">(43.2)</a> y <a href="cap-pp.html#eq:heat">(43.4)</a> son 556,3 km y 104,9 km.</p>
<div class="sourceCode" id="cb652"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">activefires</span><span class="op">)</span></span>
<span><span class="va">CvL_northcentre</span> <span class="op">&lt;-</span> <span class="fu">bw.CvL</span><span class="op">(</span><span class="va">activefires</span>, ns <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span>
<span><span class="va">d_CvL_northcentre</span> <span class="op">&lt;-</span> <span class="fu">density.ppp</span><span class="op">(</span><span class="va">activefires</span>, sigma <span class="op">=</span> <span class="va">CvL_northcentre</span>,</span>
<span>                                 leaveoneout <span class="op">=</span> <span class="cn">FALSE</span>, dimyx <span class="op">=</span> <span class="fl">512</span><span class="op">)</span></span>
<span></span>
<span><span class="va">heat_CvL_northcentre</span> <span class="op">&lt;-</span> <span class="fu">bw.CvLHeat</span><span class="op">(</span><span class="va">activefires</span>, ns <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span>
<span><span class="va">dheat_CvL_northcentre</span> <span class="op">&lt;-</span> <span class="fu">densityHeat.ppp</span><span class="op">(</span><span class="va">activefires</span>, sigma <span class="op">=</span> <span class="va">heat_CvL_northcentre</span>,</span>
<span>                                         leaveoneout <span class="op">=</span> <span class="cn">FALSE</span>, dimyx <span class="op">=</span> <span class="fl">512</span><span class="op">)</span></span></code></pre></div>
<p>Ambas estimaciones se juntan en un objeto <code>RasterBrick</code> que se representa en la Fig. <a href="cap-pp.html#fig:USfiresintensity">43.3</a>. Obsérvese que el dominio no es regular, pues los estados de Florida, California del Sur y América Central hacen que la región objeto de estudio sea ciertamente irregular. Esta irregularidad del dominio provocaría valores de intensidad totalmente irrealistas en dichas zonas. El mapa de intensidad que se muestra en el panel izquierdo de la Fig. <a href="cap-pp.html#fig:USfiresintensity">43.3</a> muestra que el estimador con corrección uniforme (<em>uniformly-edge-corrected</em>) distribuye la masa total por toda la región, provocando una sobresuavización. Sin embargo, el mapa del panel derecho, construido con el estimador de difusión, muestra una situación más realista, distribuyendo la masa de la intensidad acorde a los sucesos ocurridos.</p>
<div class="sourceCode" id="cb653"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d_northcentre_stack</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/stack.html">stack</a></span><span class="op">(</span><span class="fu">raster</span><span class="op">(</span><span class="va">d_CvL_northcentre</span><span class="op">)</span>, <span class="fu">raster</span><span class="op">(</span><span class="va">dheat_CvL_northcentre</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">d_northcentre_stack</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"CvL_gaus_U"</span>, <span class="st">"Diffusion"</span><span class="op">)</span></span>
<span><span class="va">pts_northcentre</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">activefires</span><span class="op">)</span></span>
<span><span class="fu">coordinates</span><span class="op">(</span><span class="va">pts_northcentre</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="op">~</span> <span class="va">x</span> <span class="op">+</span> <span class="va">y</span></span>
<span><span class="va">d_northcentre_stack</span> <span class="op">&lt;-</span> <span class="va">d_northcentre_stack</span> <span class="op">*</span> <span class="fl">10</span><span class="op">^</span><span class="fl">6</span></span>
<span></span>
<span><span class="fu">spplot</span><span class="op">(</span><span class="va">d_northcentre_stack</span>, scales <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>draw <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>       col.regions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/flip.html">rev</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">terrain.colors</a></span><span class="op">(</span><span class="fl">20</span><span class="op">)</span><span class="op">)</span>, colorkey <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>cex <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span>,</span>
<span>       par.strip.text <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>cex <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/layer.html">layer</a></span><span class="op">(</span><span class="fu">sp.points</span><span class="op">(</span><span class="va">pts_northcentre</span>, pch <span class="op">=</span> <span class="fl">20</span>, col <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:USfiresintensity"></span>
<img src="img/Fire_NorthCentralAmerica_int.png" alt="Estimación basada en función núcleo para incendios (puntos negros) en EE. UU. y Centroamérica (sin las islas) desde el 24 de febrero hasta el 3 de marzo de 2022. Izquierda: estimador con corrección uniforme con núcleo gaussiano. Derecha: estimador de difusión. El parámetro de suavizado fue obtenido con el criterio de Cronie--van Lieshout. Los valores de la intensidad son fuegos por 1.000 km2." width="80%"><p class="caption">
Figura 43.3: Estimación basada en función núcleo para incendios (puntos negros) en EE. UU. y Centroamérica (sin las islas) desde el 24 de febrero hasta el 3 de marzo de 2022. Izquierda: estimador con corrección uniforme con núcleo gaussiano. Derecha: estimador de difusión. El parámetro de suavizado fue obtenido con el criterio de Cronie–van Lieshout. Los valores de la intensidad son fuegos por 1.000 km2.
</p>
</div>
</div>
<div id="estimadores-basados-en-teselaciones-de-voronoi" class="section level3" number="43.2.4">
<h3>
<span class="header-section-number">43.2.4</span> Estimadores basados en teselaciones de Voronoi<a class="anchor" aria-label="anchor" href="#estimadores-basados-en-teselaciones-de-voronoi"><i class="fas fa-link"></i></a>
</h3>
<p></p>
<p>Como se ha visto, el comportamiento de los estimadores basados en funciones núcleo depende del parámetro de suavizado. Sin embargo, en situaciones en las que hay cambios abruptos en la distribución espacial de los puntos, un único valor constante de este parámetro no puede representar el suavizamiento necesario en toda la región. Para dar una solución a este problema, se propuso un parámetro con variación espacial (adaptable a la estructura espacial), aunque a costa de una mayor complejidad <span class="citation">(<a href="referencias.html#ref-davies2018fast">Davies and Baddeley 2018</a>; <a href="referencias.html#ref-baddeley2022diffusion">Baddeley et al. 2022</a>)</span>. Como alternativa a esta propuesta se pueden utilizar estimadores basados en teselaciones de Voronoi, que son no paramétricos <span class="citation">(<a href="referencias.html#ref-BSV10">Barr and Schoenberg 2010</a>)</span>.</p>
<p>Para cada <span class="math inline">\({\bf x}_i\in{\mathbf x}\)</span>, su celda de Voronoi/Dirichlet <span class="math inline">\({\mathcal V}_{{\bf x}_i}\)</span>, consistente en todos los <span class="math inline">\({\bf u} \in W\)</span> más cercanos a <span class="math inline">\({\bf x}_i\)</span> que a cualquier otro elemento <span class="math inline">\({\bf x}_{\neq i}\in{\mathbf x}\setminus\{{\bf x}_i\}\)</span>, viene dada por:
<span class="math display">\[\begin{align}
\mathcal V_{{\bf x}_i} =
\{ {\bf u} \in W: d({\bf x}_i,{\bf u}) \leq d({\bf x}_{\neq i}, {\bf u}), \hspace{0,2cm} \forall {\bf x}_{\neq i}\in \mathbf{x}\setminus\{{\bf x}_i\} \}.
\end{align}\]</span></p>
<p>El <strong>estimador basado en teselaciones de Voronoi</strong>, evaluado en cualquier punto arbitrario <span class="math inline">\({\bf u} \in W\)</span>, es de la forma:</p>
<p><span class="math display" id="eq:Vor">\[\begin{align}
\widehat{\lambda}^{V}({\bf u}) =
\sum_{{{\bf x}_i}\in \mathbf{x}}
\frac{\mathbf 1 \{ {\bf u}\in\mathcal V_{{\bf x}_i}\}}{\left | \mathcal V_{{\bf x}_i}\right|}.
\tag{43.5}
\end{align}\]</span></p>
<p>El estimador <span class="math inline">\(\widehat{\lambda}^{V}({\bf u})\)</span> conserva la masa (al igual que <span class="math inline">\(\widehat \lambda^{\text{JD}}_{\sigma}({\bf u})\)</span>) y es insesgado si la intensidad real es constante (igual que <span class="math inline">\(\widehat \lambda^{\text{U}}_{\sigma}({\bf u})\)</span>), propiedades compartidas por el estimador de difusión. Sin embargo, <span class="citation">Moradi et al. (<a href="referencias.html#ref-moradi2019resample">2019</a>)</span> demostraron que <span class="math inline">\(\widehat{\lambda}^{V}({\bf u})\)</span> tiene una varianza alta, lo que implica una infrasuavización en áreas densas de puntos y una sobresuavización en áreas con pocos puntos. Estos autores proponen corregir el problema de <span class="math inline">\(\widehat{\lambda}^{V}({\bf u})\)</span> mediante un submuestreo de <span class="math inline">\(m \geq 1\)</span> copias reescaladas <span class="math inline">\({\mathbf x}\)</span> a través de adelgazamientos independientes con probabilidad <span class="math inline">\(p\)</span> (<em>independent <span class="math inline">\(p\)</span>-thinning</em>).<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;Una forma de crear nuevos procesos puntuales es aplicar un “adelgazamiento” a un proceso puntual. Un adelgazamiento es una operación aleatoria aplicada a los puntos de un proceso puntual subyacente, donde los puntos se adelgazan (o eliminan) o se retienen (o mantienen) de acuerdo con alguna regla probabilística. Tanto los puntos adelgazados (eliminados) como los retenidos forman dos procesos de puntos separados, pero usualmente el interés se pone en los puntos retenidos. En cuanto a &lt;span class="math inline"&gt;\(p\)&lt;/span&gt;, es la probabilidad de eliminación (adelgazamiento) de un punto cualquiera, que, al ser los adelgazamientos independientes, no depende de la ubicación del punto.&lt;/p&gt;'><sup>275</sup></a> Su propuesta viene dada por:</p>
<p><span class="math display" id="eq:SmoothVor">\[\begin{align}
\widehat{\lambda}_{p,m}^{V}({\bf u})
=
\frac{1}{m}\sum_{i=1}^m
\frac{\widehat{\lambda}_i^{V}({\bf u})}{p}
,
\ {\bf u}\in W,
\tag{43.6}
\end{align}\]</span>
donde <span class="math inline">\(\widehat{\lambda}_i^{V}({\bf u})\)</span> es el estimador de Voronoi del <span class="math inline">\(i\)</span>-ésimo patrón adelgazado. Este nuevo estimador trata de forma más adecuada el equilibrio entre sesgo y varianza, que depende de la cantidad de puntos presentes en la subregión. Este efecto se consigue con muestras de menor tamaño procedentes del patrón original. El estimador <span class="math inline">\(\widehat{\lambda}_{p,m}^{V}({\bf u})\)</span> se conoce como <strong>estimador de remuestreo-suavizado</strong> <em>(resample-smoothed)</em> y, además de las propiedades estadísticas de <span class="math inline">\(\widehat{\lambda}^{V}({\bf u})\)</span>, tiene una varianza bastante más pequeña. En este caso, también se debe seleccionar <em>a priori</em> (<span class="math inline">\(m,p\)</span>); sin embargo, <span class="citation">Moradi et al. (<a href="referencias.html#ref-moradi2019resample">2019</a>)</span> proponen tanto una <em>rule of thumb</em> (<span class="math inline">\(m=400\)</span> y <span class="math inline">\(p \leq 0,2\)</span>) como una validación cruzada. Ambos estimadores <a href="cap-pp.html#eq:Vor">(43.5)</a> y <a href="cap-pp.html#eq:SmoothVor">(43.6)</a> son accesibles por medio de la función <code>densityVoronoi.ppp</code> de <code>spatstat.explore</code>, y en la que los argumentos <code>f</code> y <code>nrep</code> controlan la probabilidad <span class="math inline">\(p\)</span> y el número de adelgazamientos <span class="math inline">\(m\)</span>. Fijando <code>f=1</code> se puede obtener el estimador basado en Voronoi <a href="cap-pp.html#eq:Vor">(43.5)</a>.</p>
<p>A modo de ejemplo, se estima la intensidad de los incendios en Nepal (Sec. <a href="cap-pp.html#secnepalfire">43.2.2.1</a>) mediante el método de estimador de remuestreo-suavizado de Voronoi <a href="cap-pp.html#eq:SmoothVor">(43.6)</a> considerando diferentes probabilidades de retención para el adelgazamiento correspondiente.</p>
<div class="sourceCode" id="cb654"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d_vor_1_nepal</span> <span class="op">&lt;-</span> <span class="fu">densityVoronoi.ppp</span><span class="op">(</span><span class="va">nepal</span>, f <span class="op">=</span> <span class="fl">1</span>, nrep <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">d_vor_2_nepal</span> <span class="op">&lt;-</span> <span class="fu">densityVoronoi.ppp</span><span class="op">(</span><span class="va">nepal</span>, f <span class="op">=</span> <span class="fl">0.8</span>, nrep <span class="op">=</span> <span class="fl">400</span><span class="op">)</span></span>
<span><span class="va">d_vor_3_nepal</span> <span class="op">&lt;-</span> <span class="fu">densityVoronoi.ppp</span><span class="op">(</span><span class="va">nepal</span>, f <span class="op">=</span> <span class="fl">0.6</span>, nrep <span class="op">=</span> <span class="fl">400</span><span class="op">)</span></span>
<span><span class="va">d_vor_4_nepal</span> <span class="op">&lt;-</span> <span class="fu">densityVoronoi.ppp</span><span class="op">(</span><span class="va">nepal</span>, f <span class="op">=</span> <span class="fl">0.5</span>, nrep <span class="op">=</span> <span class="fl">400</span><span class="op">)</span></span>
<span><span class="va">d_vor_5_nepal</span> <span class="op">&lt;-</span> <span class="fu">densityVoronoi.ppp</span><span class="op">(</span><span class="va">nepal</span>, f <span class="op">=</span> <span class="fl">0.4</span>, nrep <span class="op">=</span> <span class="fl">400</span><span class="op">)</span></span>
<span><span class="va">d_vor_6_nepal</span> <span class="op">&lt;-</span> <span class="fu">densityVoronoi.ppp</span><span class="op">(</span><span class="va">nepal</span>, f <span class="op">=</span> <span class="fl">0.2</span>, nrep <span class="op">=</span> <span class="fl">400</span><span class="op">)</span></span>
<span><span class="va">d_vor_7_nepal</span> <span class="op">&lt;-</span> <span class="fu">densityVoronoi.ppp</span><span class="op">(</span><span class="va">nepal</span>, f <span class="op">=</span> <span class="fl">0.1</span>, nrep <span class="op">=</span> <span class="fl">400</span><span class="op">)</span></span>
<span><span class="va">d_vor_8_nepal</span> <span class="op">&lt;-</span> <span class="fu">densityVoronoi.ppp</span><span class="op">(</span><span class="va">nepal</span>, f <span class="op">=</span> <span class="fl">0.05</span>, nrep <span class="op">=</span> <span class="fl">400</span><span class="op">)</span></span></code></pre></div>
<p>Las estimaciones obtenidas, igual que las que proceden de <code>density.ppp</code>, son de clase <code>im</code> y se unen en un objeto <code>RasterBrick</code> para su representación gráfica.</p>
<div class="sourceCode" id="cb655"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sp_int_nepal_v</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/stack.html">stack</a></span><span class="op">(</span><span class="fu">raster</span><span class="op">(</span><span class="va">d_vor_1_nepal</span><span class="op">)</span>, <span class="fu">raster</span><span class="op">(</span><span class="va">d_vor_2_nepal</span><span class="op">)</span>, </span>
<span>                        <span class="fu">raster</span><span class="op">(</span><span class="va">d_vor_3_nepal</span><span class="op">)</span>, <span class="fu">raster</span><span class="op">(</span><span class="va">d_vor_4_nepal</span><span class="op">)</span>, <span class="fu">raster</span><span class="op">(</span><span class="va">d_vor_5_nepal</span><span class="op">)</span>,</span>
<span>                        <span class="fu">raster</span><span class="op">(</span><span class="va">d_vor_6_nepal</span><span class="op">)</span>, <span class="fu">raster</span><span class="op">(</span><span class="va">d_vor_7_nepal</span><span class="op">)</span>, <span class="fu">raster</span><span class="op">(</span><span class="va">d_vor_8_nepal</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">sp_int_nepal_v</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="va">names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/sort.html">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">.2</span>, <span class="fl">1</span>, <span class="fl">.2</span><span class="op">)</span>, <span class="fl">0.1</span>, <span class="fl">0.05</span>, <span class="fl">0.5</span><span class="op">)</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"p ="</span>, <span class="va">names</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sp_int_nepal_v</span> <span class="op">&lt;-</span> <span class="va">sp_int_nepal_v</span> <span class="op">*</span> <span class="fl">10</span><span class="op">^</span><span class="fl">7</span></span>
<span><span class="va">at</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.3</span>, <span class="fl">0.7</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">5</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fl">30</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">spplot</span><span class="op">(</span><span class="va">sp_int_nepal_v</span>, at <span class="op">=</span> <span class="va">at</span>, colorkey <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>cex <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span>, </span>
<span>       col.regions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">topo.colors</a></span><span class="op">(</span><span class="fl">20</span><span class="op">)</span>, scales <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>draw <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>, </span>
<span>       par.strip.text <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>cex <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>, names.attr <span class="op">=</span> <span class="va">names</span><span class="op">)</span></span></code></pre></div>
<p>La Fig. <a href="cap-pp.html#fig:nepalvor">43.4</a> muestra las intensidades procedentes de los estimadores de remuestreo-suavizado de Voronoi para los incendios de Nepal y para diferentes probabilidades de retención. Se puede observar un menor suavizado y una mayor varianza para valores elevados de las probabilidades de retención <span class="math inline">\(p\)</span>. Asimismo, se puede ver que para probabilidades de retención menores que 0,2 el estimador proporciona mejores suavizados locales que los estimadores basados en suavizados fijos.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:nepalvor"></span>
<img src="img/nepal2016_V.png" alt="Estimaciones de la intensidad mediante estimadores de remuestreo-suavizado de Voronoi para los incendios en Nepal en 2016 con  diferentes probabilidades de retención. La intensidad proporciona el número de incendios por 10.000 km2." width="90%"><p class="caption">
Figura 43.4: Estimaciones de la intensidad mediante estimadores de remuestreo-suavizado de Voronoi para los incendios en Nepal en 2016 con diferentes probabilidades de retención. La intensidad proporciona el número de incendios por 10.000 km2.
</p>
</div>
</div>
<div id="características-de-segundo-orden-la-función-k-de-ripley" class="section level3" number="43.2.5">
<h3>
<span class="header-section-number">43.2.5</span> Características de segundo orden: la función <span class="math inline">\(K\)</span> de Ripley<a class="anchor" aria-label="anchor" href="#caracter%C3%ADsticas-de-segundo-orden-la-funci%C3%B3n-k-de-ripley"><i class="fas fa-link"></i></a>
</h3>
<p></p>
<p>La función de intensidad presentada en las secciones anteriores proporciona el número esperado de puntos por unidad de espacio y no tiene en cuenta la estructura de dependencia entre dichos puntos. Esta estructura, sin embargo, viene caracterizada a través de lo que se llaman características de segundo orden. Las funciones de segundo orden determinan la estructura de dependencia espacial (o en su caso espaciotemporal, si interviene el tiempo) inherente al patrón puntual. La literatura ha propuesto varias funciones de segundo orden, de entre las cuales la función <span class="math inline">\(K\)</span> de Ripley es posiblemnte la más utilizada. Esta función se define de forma pragmática como el número medio de eventos en un radio <span class="math inline">\(r\)</span> alrededor de cualquier otro evento. Dicho de otra forma, la función <span class="math inline">\(K(r)\)</span> representa el número medio de eventos dentro de un círculo de radio <span class="math inline">\(r\)</span> alrededor de un evento típico del patrón (sin contar dicho evento central). De esta forma, <span class="math inline">\(K(r)\)</span> describe características del proceso de puntos a muchas escalas (tantas como diferentes <span class="math inline">\(r\)</span> se consideren). Esta función puede venir corregida por la intensidad de primer orden en el caso de procesos inhomogéneos. Ambas versiones de la función <span class="math inline">\(K\)</span> vienen implementadas en <code>spatstat</code> a través de las funciones <code>Kest()</code> y <code>Kinhom()</code> para los casos homogéneo e inhomogéneo. Una propiedad interesante de esta función es que tiene una forma cerrada bajo el caso de aleatoriedad espacial completa, es decir, bajo la situación en la que el patrón de puntos es totalmente aleatorio, sin dependencia espacial alguna (llamado, en este caso, <strong>proceso de Poisson</strong>). Como bajo esta suposición <span class="math inline">\(K(r)=\pi r^2\)</span>, se puede contrastar si un cierto patrón es o no aleatorio construyendo bandas de confianza sobre la función <span class="math inline">\(K\)</span> evaluada bajo simulaciones de aleatoriedad y evaluando la función <span class="math inline">\(K\)</span> empírica procedente de los datos. La función <code><a href="https://rdrr.io/pkg/boot/man/envelope.html">envelope()</a></code> permite construir tales intervalos de confianza.</p>
<p>También se han utilizado otras funciones para describir y contrastar patrones espaciales; estas funciones están basadas en la distribución de las distancias entre puntos que existiría en un patrón de Poisson, como, por ejemplo, la función de distribución de la distancia al vecino más próximo, la función de distribución de la distancia a un punto fijo aleatorio o la función <span class="math inline">\(J\)</span>, una combinación de las anteriores. Todas estas funciones, incluida la función <span class="math inline">\(K\)</span>, son en cierta forma funciones de distribución ya que, a cada escala o distancia <span class="math inline">\(r\)</span>, todos los pares de puntos separados por una distancia menor que <span class="math inline">\(r\)</span> se usan para estimar el valor de la correspondiente función. En ocasiones puede ser necesario disponer de una función que caracterice el patrón de puntos de forma no acumulativa, es decir, que tenga en cuenta tan solo los pares de puntos que se encuentran separados por una distancia exactamente igual o similar a la distancia <span class="math inline">\(r\)</span>. La función de correlación de par <span class="math inline">\(g(r)\)</span> (<em>pair correlation function</em>) es la herramienta apropiada en este caso <span class="citation">(<a href="referencias.html#ref-BRT15">Baddeley, Rubak, and Turner 2015</a>)</span>.</p>
<p>A continuación se retoman los ejemplos de los incendios en Nepal y los delitos en Medellín para mostrar el código y los resultados de llevar a la práctica la estimación de la funcion <span class="math inline">\(K\)</span> (inhomogénea) y la construcción de los correspondientes intervalos de confianza bajo el supuesto de aleatoriedad (véase Fig. <a href="cap-pp.html#fig:kplots">43.5</a>).</p>
<div class="sourceCode" id="cb656"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d_nepal</span> <span class="op">&lt;-</span> <span class="fu">density.ppp</span><span class="op">(</span><span class="va">nepal</span>, <span class="va">bw.scott</span>, leaveoneout <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">en_nepal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/boot/man/envelope.html">envelope</a></span><span class="op">(</span><span class="va">nepal</span>, fun <span class="op">=</span> <span class="va">Kinhom</span>, correction <span class="op">=</span> <span class="st">"border"</span>, nsim <span class="op">=</span> <span class="fl">99</span>, </span>
<span>                     simulate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="fu">rpoispp</span><span class="op">(</span><span class="va">d_nepal</span><span class="op">)</span><span class="op">)</span>, </span>
<span>                     sigma <span class="op">=</span> <span class="va">bw.scott</span>, normpower <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">d_med</span> <span class="op">&lt;-</span> <span class="fu">density.ppp</span><span class="op">(</span><span class="va">medellin</span>, <span class="va">bw.scott</span>, leaveoneout <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">en_med</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/boot/man/envelope.html">envelope</a></span><span class="op">(</span><span class="va">medellin</span>, fun <span class="op">=</span> <span class="va">Kinhom</span>, correction <span class="op">=</span> <span class="st">"border"</span>, nsim <span class="op">=</span> <span class="fl">99</span>, </span>
<span>                   simulate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="fu">rpoispp</span><span class="op">(</span><span class="va">d_med</span><span class="op">)</span><span class="op">)</span>, </span>
<span>                   sigma <span class="op">=</span> <span class="va">bw.scott</span>, normpower <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb657"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">en_nepal</span><span class="op">$</span><span class="va">mmean</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html">plot</a></span><span class="op">(</span><span class="va">en_nepal</span>, main <span class="op">=</span> <span class="st">""</span>, lwd <span class="op">=</span> <span class="fl">3</span>, cex.axis <span class="op">=</span> <span class="fl">2.5</span>, cex.lab <span class="op">=</span> <span class="fl">2.5</span>, legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">en_med</span><span class="op">$</span><span class="va">mmean</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html">plot</a></span><span class="op">(</span><span class="va">en_med</span>, main <span class="op">=</span> <span class="st">""</span>, lwd <span class="op">=</span> <span class="fl">3</span>, cex.axis <span class="op">=</span> <span class="fl">2.5</span>, cex.lab <span class="op">=</span> <span class="fl">2.5</span>, legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:kplots"></span>
<img src="img/nepalk.png" alt="Funciones $K$ de Ripley para incendios en Nepal y delitos en Medellín." width="40%"><img src="img/medk.png" alt="Funciones $K$ de Ripley para incendios en Nepal y delitos en Medellín." width="40%"><p class="caption">
Figura 43.5: Funciones <span class="math inline">\(K\)</span> de Ripley para incendios en Nepal y delitos en Medellín.
</p>
</div>
</div>
</div>
<div id="seclineal" class="section level2" number="43.3">
<h2>
<span class="header-section-number">43.3</span> Patrones puntuales espaciales sobre redes lineales<a class="anchor" aria-label="anchor" href="#seclineal"><i class="fas fa-link"></i></a>
</h2>
<p>En los últimos diez años, los patrones de puntos en redes lineales han recibido mucha atención científica. Una red lineal es un conjunto de segmentos (o aristas) unidos por nodos con un formato lineal, como una combinación convexa entre dos nodos. La explicación inicial detrás de la consideración de redes lineales como espacios de estado de algunos procesos puntuales podría estar en el hecho de que los objetos definidos en tales estructuras no pueden usar todo el espacio, y sus movimientos dependen fuertemente de su libertad sobre tales estructuras <span class="citation">(<a href="referencias.html#ref-OS12">Okabe and Sugihara 2012</a>)</span>. En consecuencia, entre otras cosas, la distribución espacial de los puntos, así como la correlación entre ellos, debe estudiarse con respecto a la red subyacente. Sin embargo, no ha sido tan fácil lidiar con este cambio de soporte cuando se pretende adaptar metodologías estadísticas existentes al análisis de patrones de puntos en redes lineales. Los principales desafíos no fueron solo matemáticos/estadísticos, sino también computacionales <span class="citation">(<a href="referencias.html#ref-moradi2018spatial">Moradi 2018</a>; <a href="referencias.html#ref-baddeley2021">Baddeley et al. 2021</a>)</span>.</p>
<p>Una red lineal es una unión de segmentos de línea <span class="math inline">\(l_i=[u_i,v_i]=\{tu_i + (1-t)v_i:0\leq t\leq 1\} \subset \mathbb R^2\)</span>. La métrica más común sobre dicha estructura fue inicialmente la distancia de ruta más corta <em>(shortest-path distance)</em> <span class="math inline">\(d_L({\bf u}, {\bf v})\)</span>, aunque más tarde <span class="citation">Rakshit, Nair, and Baddeley (<a href="referencias.html#ref-rakshit2017second">2017</a>)</span> propusieron otros tipos de distancias, incluida la euclidiana. La idea es que moverse por la red de segmentos implica respetar la geometría de dicha red y, por tanto, las líneas rectas (que sería el caso al usar distancias euclidianas) no son adecuadas. La distancia de ruta más corta sí que permite adaptarse a esta geometría. Sea <span class="math inline">\(Y\)</span> un proceso puntual en una red lineal <span class="math inline">\(L\)</span>; entonces, la fórmula de Campbell <a href="cap-pp.html#eq:compR2">(43.1)</a> se adapta como sigue:
<span class="math display">\[\begin{equation*}
\mathbb E
\left[
\sum\limits_{y \in Y}
f(y)
\right]
=
\int_{L}
f({\bf z})
\lambda(´{\bf z})
\mathrm{d}_1 {\bf z},
\end{equation*}\]</span>
donde <span class="math inline">\(\mathrm{d}_1\)</span> denota integración con respecto a la longitud de arco. En este caso, <span class="math inline">\(\lambda({\bf z})\)</span> proporciona el número esperado de puntos por unidad de longitud de <span class="math inline">\(L\)</span> en una vecindad de <span class="math inline">\({\bf z} \in L\)</span>. Se han desarrollado distintos estimadores de la intensidad para patrones en redes considerando métricas adecuadas y resolviendo ciertos obstáculos matemáticos. El lector puede consultar más detalles al respecto en <span class="citation">Moradi (<a href="referencias.html#ref-moradi2018spatial">2018</a>)</span> y <span class="citation">Baddeley et al. (<a href="referencias.html#ref-baddeley2021">2021</a>)</span>; en particular, se recomienda leer sobre el método de estimación no paramétrica basado en convoluciones bidimensionales de <span class="citation">Rakshit et al. (<a href="referencias.html#ref-rakshit2019fast">2019</a>)</span>. Dada una realización <span class="math inline">\({\mathbf y}= \{ {\bf y}_1, {\bf y}_2, \ldots, {\bf y}_n \}\)</span> de un proceso puntual <span class="math inline">\(Y\)</span> sobre una red lineal <span class="math inline">\(L\)</span>, estos autores propusieron:
<span class="math display" id="eq:eqlu">\[\begin{equation}
    \widehat{\lambda}^\text{U}_{\sigma}({\bf z})
    =
    \frac{1}{c_{\sigma,L}({\bf z})}
    \sum_{i=1}^{n}
    \kappa_{\sigma}({\bf z}-{\bf y}_i),
    \qquad
    {\bf z} \in L,
    \tag{43.7}
\end{equation}\]</span>
con una corrección uniforme, y</p>
<p><span class="math display" id="eq:eqljd">\[\begin{equation}
    \widehat{\lambda}^\text{JD}_{\sigma}({\bf z})
    =
    \sum_{i=1}^{n}
    \frac{
    \kappa_{\sigma}({\bf z}-{\bf y}_i)
    }{
    c_{\sigma,L}({\bf y}_i)
    },
    \qquad {\bf z} \in L,
    \tag{43.8}
\end{equation}\]</span>
con la corrección de Jones-Diggle, donde <span class="math inline">\(\kappa_{\sigma}\)</span> es una función núcleo bivariante con suavizado <span class="math inline">\({\sigma}\)</span>, y
<span class="math display">\[\begin{equation*}
    c_{\sigma,L}({\bf z})=\int_L \kappa_{\sigma}({\bf z}- {\bf v}) \mathrm{d}_1 {\bf v}
\end{equation*}\]</span>
es una corrección de borde.</p>
<p>Los dos estimadores anteriores tienen propiedades estadísticas similares a las de sus análogos para patrones de puntos espaciales en <span class="math inline">\(\mathbb R^2\)</span> (es decir, los estimadores <a href="cap-pp.html#eq:kde2Dunif">(43.2)</a> y
<a href="cap-pp.html#eq:kde2DJD">(43.3)</a>) y sus estimaciones se pueden calcular rápidamente incluso en redes grandes y para grandes anchos de banda (parámetros de suavización). El cálculo rápido se logra mediante la transformada rápida de Fourier <span class="citation">(<a href="referencias.html#ref-silverman1982algorithm">Bernhard W. Silverman 1982</a>)</span>. Además, <span class="citation">Rakshit et al. (<a href="referencias.html#ref-rakshit2019fast">2019</a>)</span> propusieron utilizar las versiones adaptadas de la regla de Scott, a la cual se puede acceder a través de la función <code>bw.scott.iso()</code> de <code>spatstat.linnet</code>, para obtener un ancho de banda óptimo. Nótese que el cálculo rápido de los valores de los estimadores anteriores simplifica aún más el cálculo de los valores de los estimadores de intensidad basados en el núcleo adaptativo y el riesgo relativo sobre las estructuras de red <span class="citation">(<a href="referencias.html#ref-rakshit2019fast">Rakshit et al. 2019</a>)</span>.</p>
<p>También se recuerda que <span class="citation">Moradi et al. (<a href="referencias.html#ref-moradi2019resample">2019</a>)</span> propusieron su enfoque de submuestreo basado en Voronoi para procesos de puntos generales; para patrones de puntos en redes lineales puede calcularse mediante la función <code>densityVoronoi.lpp()</code> de <code>spatstat.linnet</code>.</p>
<p>Como ejemplo práctico para esta sección, se estudia la distribución espacial de delitos callejeros en Valencia. Valencia es la tercera ciudad más grande de España, siendo la capital de la Comunidad Valenciana. El territorio urbano de Valencia encierra un área de 134.65 km<span class="math inline">\(^2\)</span>, con más de 800.000 habitantes en el municipio. El conjunto de datos consta de las ubicaciones de 90.247 delitos callejeros como agresión (55.610 casos), robo (25.342 casos), robo contra la mujer con violencia (454 casos) y otros tipos de delitos (8.841 casos). Estos delitos se cometieron entre 2010 y 2020. Sin embargo, en lo que sigue, el análisis únicamente se centra en los datos correspondientes al año 2020, 6.868 casos, de los cuales 4.077 son agresiones, 2.060 son robos y 66 se relacionan con delitos contra la mujer con violencia.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Este conjunto de datos es propiedad de la Generalitat Valenciana (GV), se obtuvo a través del teléfono de emergencias 112 y se puso a disposición de los autores gracias a un convenio entre la GV y la Universidad Jaume I.&lt;/p&gt;"><sup>276</sup></a></p>
<p>A continuación se estima el parámetro de suavizado utilizando la regla general de Scott (téngase en cuenta que ahora solo se considera una dimensión). El valor de la estimación es 584,1 m. La función <code>densityQuick.lpp()</code> de <code>spatstat.linnet</code> se usa para obtener el valor de los estimadores <a href="cap-pp.html#eq:eqlu">(43.7)</a> y <a href="cap-pp.html#eq:eqljd">(43.8)</a>, teniendo en cuenta que por defecto esta función de <code>spatstat</code> usa el estimador de borde uniforme corregido <a href="cap-pp.html#eq:eqlu">(43.7)</a>.</p>
<div class="sourceCode" id="cb658"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">valencia</span><span class="op">)</span></span>
<span><span class="va">scott_valencia</span> <span class="op">&lt;-</span> <span class="fu">bw.scott.iso</span><span class="op">(</span><span class="va">valencia</span><span class="op">)</span> <span class="co"># Scott rule</span></span>
<span><span class="va">d_scott_valencia</span> <span class="op">&lt;-</span> <span class="fu">densityQuick.lpp</span><span class="op">(</span><span class="va">valencia</span>, sigma <span class="op">=</span> <span class="va">scott_valencia</span>, </span>
<span>                                     leaveoneout <span class="op">=</span> <span class="cn">FALSE</span>, positive <span class="op">=</span> <span class="cn">TRUE</span>, dimyx <span class="op">=</span> <span class="fl">512</span><span class="op">)</span></span>
<span><span class="va">d_scott_valencia</span> <span class="op">&lt;-</span> <span class="va">d_scott_valencia</span> <span class="op">*</span> <span class="fl">1000</span></span></code></pre></div>
<p>Las imágenes obtenidas son de tipo <code>linim</code>, y se convierten en objetos de clase <code>im</code> antes de pasarlas a objetos <code>raster</code>.</p>
<div class="sourceCode" id="cb659"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html">plot</a></span><span class="op">(</span><span class="va">valencia</span><span class="op">$</span><span class="va">domain</span><span class="op">$</span><span class="va">window</span>, lwd <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html">plot</a></span><span class="op">(</span><span class="va">valencia</span>, pch <span class="op">=</span> <span class="fl">20</span>, main <span class="op">=</span> <span class="st">""</span>, lwd <span class="op">=</span> <span class="fl">4</span>, cex <span class="op">=</span> <span class="fl">1</span>, add <span class="op">=</span> <span class="cn">T</span>, </span>
<span>     cols <span class="op">=</span> <span class="st">"red"</span>, col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html">plot</a></span><span class="op">(</span><span class="fu">raster</span><span class="op">(</span><span class="fu">as.im</span><span class="op">(</span><span class="va">d_scott_valencia</span><span class="op">)</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">""</span>, axis.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>cex.axis <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>, </span>
<span>     legend.width <span class="op">=</span> <span class="fl">2</span>, zlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">6</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html">plot</a></span><span class="op">(</span><span class="va">valencia</span><span class="op">$</span><span class="va">domain</span><span class="op">$</span><span class="va">window</span>, add <span class="op">=</span> <span class="cn">TRUE</span>, lwd <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>La Fig. <a href="cap-pp.html#fig:titleV">43.6</a> muestra la intensidad estimada junto con los eventos de delitos. Dicha intensidad identifica las zonas central y norte de la ciudad de Valencia como áreas de alto riesgo junto
con otras zonas de bajo riesgo como son el este y la costa de la ciudad.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:titleV"></span>
<img src="img/2020_vlc_scott.png" alt="Intensidad estimada por función núcleo, usando el  estimador de borde uniforme corregido (izquierda), para los datos de delitos (puntos rojos) en Valencia durante 2020 (derecha). Los valores de intensidad muestran el número de crímenes por km lineal." width="40%"><img src="img/2020_vlc.png" alt="Intensidad estimada por función núcleo, usando el  estimador de borde uniforme corregido (izquierda), para los datos de delitos (puntos rojos) en Valencia durante 2020 (derecha). Los valores de intensidad muestran el número de crímenes por km lineal." width="40%"><p class="caption">
Figura 43.6: Intensidad estimada por función núcleo, usando el estimador de borde uniforme corregido (izquierda), para los datos de delitos (puntos rojos) en Valencia durante 2020 (derecha). Los valores de intensidad muestran el número de crímenes por km lineal.
</p>
</div>
<div class="sourceCode" id="cb660"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d_vlc</span> <span class="op">&lt;-</span> <span class="fu">densityQuick.lpp</span><span class="op">(</span><span class="va">valencia</span>, sigma <span class="op">=</span> <span class="va">scott_valencia</span>, leaveoneout <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                          positive <span class="op">=</span> <span class="cn">TRUE</span>, at <span class="op">=</span> <span class="st">"points"</span>, dimyx <span class="op">=</span> <span class="fl">512</span><span class="op">)</span></span>
<span><span class="va">d_vlc_im</span> <span class="op">&lt;-</span> <span class="fu">densityQuick.lpp</span><span class="op">(</span><span class="va">valencia</span>, sigma <span class="op">=</span> <span class="va">scott_valencia</span>, leaveoneout <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                             positive <span class="op">=</span> <span class="cn">TRUE</span>, dimyx <span class="op">=</span> <span class="fl">512</span><span class="op">)</span></span></code></pre></div>
<p>Finalmente, se muestra la función <span class="math inline">\(K\)</span> de Ripley y el intervalo de confianza bajo un proceso de Poisson en una red lineal <span class="citation">(véase la Fig. <a href="cap-pp.html#fig:VlcK">43.7</a> y las siguientes referencias: <a href="referencias.html#ref-ang2012geometrically">Ang, Baddeley, and Nair 2012</a>; <a href="referencias.html#ref-rakshit2019efficient">Rakshit, Baddeley, and Nair 2019</a>)</span>. Se observa que la función <span class="math inline">\(K\)</span> empírica cae dentro de las bandas, lo que indica que el tipo de delitos considerados, en 2020, es compatible con un proceso aleatorio. Obsérvese que al no considerar el tiempo, se pueden detectar clústeres espaciales que no existen en realidad, pues desaparecerían con la evolución temporal.</p>
<div class="sourceCode" id="cb661"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim_vlc</span> <span class="op">&lt;-</span> <span class="fu">rpoislpp</span><span class="op">(</span>lambda <span class="op">=</span> <span class="va">d_vlc_im</span>, L <span class="op">=</span> <span class="va">net_vlc</span>, nsim <span class="op">=</span> <span class="fl">199</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">spatstat.Knet</span><span class="op">)</span></span>
<span><span class="va">K_vlc</span> <span class="op">&lt;-</span> <span class="fu">Knetinhom</span><span class="op">(</span><span class="va">valencia</span>, lambda <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">d_vlc</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">r</span> <span class="op">&lt;-</span> <span class="va">K_vlc</span><span class="op">$</span><span class="va">r</span></span>
<span></span>
<span><span class="va">K_sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span>X <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">199</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">sigma</span> <span class="op">&lt;-</span> <span class="fu">bw.scott.iso</span><span class="op">(</span><span class="va">sim_vlc</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">lambda</span> <span class="op">&lt;-</span> <span class="fu">densityQuick.lpp</span><span class="op">(</span><span class="va">sim_vlc</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>, sigma <span class="op">=</span> <span class="va">sigma</span>, leaveoneout <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                             positive <span class="op">=</span> <span class="cn">TRUE</span>, at <span class="op">=</span> <span class="st">"points"</span>, dimyx <span class="op">=</span> <span class="fl">512</span><span class="op">)</span></span>
<span>  <span class="va">Ksim</span> <span class="op">&lt;-</span> <span class="fu">Knetinhom</span><span class="op">(</span><span class="va">sim_vlc</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>, lambda <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">lambda</span><span class="op">)</span>, r <span class="op">=</span> <span class="va">r</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">Ksim</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb662"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">K_nsim_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="va">cbind</span>, <span class="va">d_nsim</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">K_nsim_df_est</span> <span class="op">&lt;-</span> <span class="va">K_nsim_df</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">399</span>, by <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="va">maxn</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="va">x</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">[</span><span class="va">n</span><span class="op">]</span></span>
<span><span class="va">minn</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="va">x</span>, decreasing <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">[</span><span class="va">n</span><span class="op">]</span></span>
<span></span>
<span><span class="va">Kmin</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">K_nsim_df_est</span>, <span class="fl">1</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">[</span><span class="fu">minn</span><span class="op">(</span><span class="fl">5</span><span class="op">)</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">Kmax</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">K_nsim_df_est</span>, <span class="fl">1</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">[</span><span class="fu">maxn</span><span class="op">(</span><span class="fl">5</span><span class="op">)</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb663"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html">plot</a></span><span class="op">(</span><span class="va">r</span>, <span class="va">Kmin</span>, type <span class="op">=</span> <span class="st">"n"</span>, col <span class="op">=</span> <span class="st">"grey"</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">270</span><span class="op">)</span>, </span>
<span>     xlab <span class="op">=</span> <span class="st">"r"</span>, ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="fu">italic</span><span class="op">(</span><span class="va">K</span><span class="op">[</span><span class="va">inhom</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/lines.html">points</a></span><span class="op">(</span><span class="va">r</span>, <span class="va">Kmax</span>, type <span class="op">=</span> <span class="st">"n"</span>, col <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/polygon.html">polygon</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">r</span>, <span class="fu"><a href="https://rdrr.io/pkg/terra/man/flip.html">rev</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">Kmax</span>, <span class="fu"><a href="https://rdrr.io/pkg/terra/man/flip.html">rev</a></span><span class="op">(</span><span class="va">Kmin</span><span class="op">)</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"grey"</span>, border <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/lines.html">points</a></span><span class="op">(</span><span class="va">r</span>, <span class="va">K_vlc</span><span class="op">$</span><span class="va">est</span>, type <span class="op">=</span> <span class="st">"l"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:VlcK"></span>
<img src="img/vlcK.png" alt="Función $K$ para los delitos en Valencia (2020) junto con la envoltura bajo un proceso de Poisson." width="40%"><p class="caption">
Figura 43.7: Función <span class="math inline">\(K\)</span> para los delitos en Valencia (2020) junto con la envoltura bajo un proceso de Poisson.
</p>
</div>
<div id="resumen-42" class="section level3 unnumbered infobox_resume">
<h3>Resumen<a class="anchor" aria-label="anchor" href="#resumen-42"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li><p>La teoría de procesos puntuales espaciales constituye la base para el análisis de eventos observados geográficamente a través de sus coordenadas (longitud y latitud) en un espacio bidimensional. Esta es una de las ramas del campo de la estadística espacial en conjunción con la de procesos estocásticos. De hecho, un proceso puntual espacial es un proceso estocástico cuyas realizaciones consisten en un conjunto numerable de puntos (llamados en muchas ocasiones eventos). Heurísticamente, se trata de un conjunto de datos que se encuentra en una región concreta (área de estudio). Los puntos pueden representar cualquier población espacialmente explícita, como localizaciones de animales, nidos de aves, epicentros de terremotos, galaxias, crímenes, etc.</p></li>
<li><p>El modelo estadístico más conocido para el análisis de patrones puntuales espaciales es el proceso puntual espacial de Poisson (asociado a la condición de aleatoriedad espacial completa). A partir del modelo de Poisson se construyen modelos más complejos.</p></li>
<li><p>La modelización pasa por determinar las intensidades de primer y segundo orden que caracterizarán las propiedades básicas del comportamiento de los puntos. En este capítulo se proponen varios estimadores de la función de intensidad de primer orden junto con sus elementos asociados relacionados con funciones núcleo, parámetro de suavizado y correcciones de borde. Se consideran también algunos aspectos de medidas de segundo orden. El capítulo finaliza con algunas cuestiones sobre el cambio de soporte del plano euclídeo a redes lineales.</p></li>
</ul>
</div>

</div>
</div>




  <div class="chapter-nav">
<div class="prev"><a href="cap-econom-esp.html"><span class="header-section-number">42</span> Modelos econométricos espaciales</a></div>
<div class="next"><a href="id_120007-informes.html"><span class="header-section-number">44</span> Informes reproducibles con R Markdown y Quarto</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="Índice del capítulo"><h2>Índice del capítulo</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#cap-pp"><span class="header-section-number">43</span> Procesos de puntos</a></li>
<li><a class="nav-link" href="#introducci%C3%B3n-22"><span class="header-section-number">43.1</span> Introducción</a></li>
<li>
<a class="nav-link" href="#secplana"><span class="header-section-number">43.2</span> Patrones puntuales espaciales en \(\mathbb R^2\)</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#secestimaciones"><span class="header-section-number">43.2.1</span> Estimación de la intensidad basada en funciones núcleo</a></li>
<li><a class="nav-link" href="#ejemplos-pr%C3%A1cticos"><span class="header-section-number">43.2.2</span> Ejemplos prácticos</a></li>
<li><a class="nav-link" href="#estimaci%C3%B3n-de-la-intensidad-basada-en-funciones-n%C3%BAcleo-en-dominios-irregulares"><span class="header-section-number">43.2.3</span> Estimación de la intensidad basada en funciones núcleo en dominios irregulares</a></li>
<li><a class="nav-link" href="#estimadores-basados-en-teselaciones-de-voronoi"><span class="header-section-number">43.2.4</span> Estimadores basados en teselaciones de Voronoi</a></li>
<li><a class="nav-link" href="#caracter%C3%ADsticas-de-segundo-orden-la-funci%C3%B3n-k-de-ripley"><span class="header-section-number">43.2.5</span> Características de segundo orden: la función \(K\) de Ripley</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#seclineal"><span class="header-section-number">43.3</span> Patrones puntuales espaciales sobre redes lineales</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#resumen-42">Resumen</a></li></ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Fundamentos de ciencia de datos con <strong>R</strong></strong>" coordinado por <a href="https://blog.uclm.es/gemafaviles/" class="text-light">Gema Fernández-Avilés y José-María Montero</a>. </p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>Este libro ha sido generado con el paquete de R <a class="text-light" href="https://bookdown.org">bookdown</a>.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
