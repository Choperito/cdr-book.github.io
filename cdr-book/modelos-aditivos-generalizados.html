<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Capítulo 17 Modelos aditivos generalizados | Fundamentos de ciencia de datos con R</title>
  <meta name="description" content="Falta hacer" />
  <meta name="generator" content="bookdown 0.28 and GitBook 2.6.7" />

  <meta property="og:title" content="Capítulo 17 Modelos aditivos generalizados | Fundamentos de ciencia de datos con R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Falta hacer" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Capítulo 17 Modelos aditivos generalizados | Fundamentos de ciencia de datos con R" />
  
  <meta name="twitter:description" content="Falta hacer" />
  

<meta name="author" content="Gema Fernández-Avilés y José-María Montero" />


<meta name="date" content="2022-12-01" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="modelos-lineales-generalizados.html"/>
<link rel="next" href="modelos-mixtos.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-33KQ1S5ZCJ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-33KQ1S5ZCJ');
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./"> Ciencia de datos con <strong>R</strong></a></li>

<li class="divider"></li>
<li class="part"><span><b>I Fundamentos y ‘tool-kit’ de la ciencia de datos</b></span></li>
<li class="chapter" data-level="1" data-path="ciencia-datos.html"><a href="ciencia-datos.html"><i class="fa fa-check"></i><b>1</b> ¿Es la Ciencia de datos una Ciencia?</a>
<ul>
<li class="chapter" data-level="1.1" data-path="ciencia-datos.html"><a href="ciencia-datos.html#ciencia"><i class="fa fa-check"></i><b>1.1</b> ¿Qué se entiende por Ciencia?</a></li>
<li class="chapter" data-level="1.2" data-path="ciencia-datos.html"><a href="ciencia-datos.html#qué-es-la-ciencia-de-datos"><i class="fa fa-check"></i><b>1.2</b> ¿Qué es la Ciencia de Datos?</a></li>
<li class="chapter" data-level="1.3" data-path="ciencia-datos.html"><a href="ciencia-datos.html#lo-científico-de-la-ciencia-de-datos"><i class="fa fa-check"></i><b>1.3</b> Lo científico de la Ciencia de datos</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="metodología.html"><a href="metodología.html"><i class="fa fa-check"></i><b>2</b> Metodología para la Ciencia de datos</a>
<ul>
<li class="chapter" data-level="2.1" data-path="metodología.html"><a href="metodología.html#preliminares"><i class="fa fa-check"></i><b>2.1</b> Preliminares</a></li>
<li class="chapter" data-level="2.2" data-path="metodología.html"><a href="metodología.html#principales-metodologías-en-ciencia-de-datos"><i class="fa fa-check"></i><b>2.2</b> Principales metodologías en Ciencia de datos</a></li>
<li class="chapter" data-level="2.3" data-path="metodología.html"><a href="metodología.html#met-crisp-dm"><i class="fa fa-check"></i><b>2.3</b> CRISP-DM para Ciencia de datos</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="ch-110003.html"><a href="ch-110003.html"><i class="fa fa-check"></i><b>3</b> R para ciencia de datos</a>
<ul>
<li class="chapter" data-level="3.1" data-path="ch-110003.html"><a href="ch-110003.html#introducción"><i class="fa fa-check"></i><b>3.1</b> Introducción</a></li>
<li class="chapter" data-level="3.2" data-path="ch-110003.html"><a href="ch-110003.html#id_110003-bases"><i class="fa fa-check"></i><b>3.2</b> La sesión de R</a></li>
<li class="chapter" data-level="3.3" data-path="ch-110003.html"><a href="ch-110003.html#instalación-de-r"><i class="fa fa-check"></i><b>3.3</b> Instalación de R</a></li>
<li class="chapter" data-level="3.4" data-path="ch-110003.html"><a href="ch-110003.html#id_110003-proyectos"><i class="fa fa-check"></i><b>3.4</b> Trabajar con proyectos de RStudio</a></li>
<li class="chapter" data-level="3.5" data-path="ch-110003.html"><a href="ch-110003.html#manipulación-de-datos-con-r"><i class="fa fa-check"></i><b>3.5</b> Manipulación de datos con R</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="ch-110003.html"><a href="ch-110003.html#id_110003-estructuras"><i class="fa fa-check"></i><b>3.5.1</b> Estructuras y tipos de datos</a></li>
<li class="chapter" data-level="3.5.2" data-path="ch-110003.html"><a href="ch-110003.html#id_110003-importacion"><i class="fa fa-check"></i><b>3.5.2</b> Importación de datos</a></li>
<li class="chapter" data-level="3.5.3" data-path="ch-110003.html"><a href="ch-110003.html#exportación-y-archivos-de-datos-de-r"><i class="fa fa-check"></i><b>3.5.3</b> Exportación y archivos de datos de R</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="ch-110003.html"><a href="ch-110003.html#id_110003-tidyverse"><i class="fa fa-check"></i><b>3.6</b> Organización de datos con el <em>tidyverse</em></a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="ch-110003.html"><a href="ch-110003.html#el-tidyverse-y-su-flujo-de-trabajo"><i class="fa fa-check"></i><b>3.6.1</b> El <em>tidyverse</em> y su flujo de trabajo</a></li>
<li class="chapter" data-level="3.6.2" data-path="ch-110003.html"><a href="ch-110003.html#transformación-de-datos-con-dplyr"><i class="fa fa-check"></i><b>3.6.2</b> Transformación de datos con <code>dplyr</code></a></li>
<li class="chapter" data-level="3.6.3" data-path="ch-110003.html"><a href="ch-110003.html#combinación-de-datos"><i class="fa fa-check"></i><b>3.6.3</b> Combinación de datos</a></li>
<li class="chapter" data-level="3.6.4" data-path="ch-110003.html"><a href="ch-110003.html#reorganización-de-datos"><i class="fa fa-check"></i><b>3.6.4</b> Reorganización de datos</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="gestión-y-operación-de-datos-con-bases-de-datos-relacionales.html"><a href="gestión-y-operación-de-datos-con-bases-de-datos-relacionales.html"><i class="fa fa-check"></i><b>4</b> Gestión y operación de datos con bases de datos relacionales</a>
<ul>
<li class="chapter" data-level="4.1" data-path="gestión-y-operación-de-datos-con-bases-de-datos-relacionales.html"><a href="gestión-y-operación-de-datos-con-bases-de-datos-relacionales.html#introducción-1"><i class="fa fa-check"></i><b>4.1</b> Introducción</a></li>
<li class="chapter" data-level="4.2" data-path="gestión-y-operación-de-datos-con-bases-de-datos-relacionales.html"><a href="gestión-y-operación-de-datos-con-bases-de-datos-relacionales.html#concepto-de-base-de-datos"><i class="fa fa-check"></i><b>4.2</b> Concepto de Base de datos</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="gestión-y-operación-de-datos-con-bases-de-datos-relacionales.html"><a href="gestión-y-operación-de-datos-con-bases-de-datos-relacionales.html#gestión-de-los-datos-en-una-base-o-repositorio-de-datos"><i class="fa fa-check"></i><b>4.2.1</b> Gestión de los datos en una base o repositorio de datos</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="gestión-y-operación-de-datos-con-bases-de-datos-relacionales.html"><a href="gestión-y-operación-de-datos-con-bases-de-datos-relacionales.html#el-lenguaje-estructurado-de-consulta-sql"><i class="fa fa-check"></i><b>4.3</b> El Lenguaje Estructurado de Consulta (SQL)</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="gestión-y-operación-de-datos-con-bases-de-datos-relacionales.html"><a href="gestión-y-operación-de-datos-con-bases-de-datos-relacionales.html#sql-como-lenguaje-de-definición-de-datos-ldd"><i class="fa fa-check"></i><b>4.3.1</b> SQL como Lenguaje de Definición de Datos (LDD)</a></li>
<li class="chapter" data-level="4.3.2" data-path="gestión-y-operación-de-datos-con-bases-de-datos-relacionales.html"><a href="gestión-y-operación-de-datos-con-bases-de-datos-relacionales.html#sql-como-lenguaje-de-manipulación-de-datos-lmd"><i class="fa fa-check"></i><b>4.3.2</b> SQL como Lenguaje de Manipulación de Datos (LMD)</a></li>
<li class="chapter" data-level="4.3.3" data-path="gestión-y-operación-de-datos-con-bases-de-datos-relacionales.html"><a href="gestión-y-operación-de-datos-con-bases-de-datos-relacionales.html#sql-como-lenguaje-de-administración-de-datos-lad"><i class="fa fa-check"></i><b>4.3.3</b> SQL como Lenguaje de Administración de Datos (LAD)</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="gestión-y-operación-de-datos-con-bases-de-datos-relacionales.html"><a href="gestión-y-operación-de-datos-con-bases-de-datos-relacionales.html#usando-bases-de-datos-desde-r"><i class="fa fa-check"></i><b>4.4</b> Usando bases de datos desde R</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="gestión-y-operación-de-datos-con-bases-de-datos-relacionales.html"><a href="gestión-y-operación-de-datos-con-bases-de-datos-relacionales.html#conexión-a-una-base-de-datos"><i class="fa fa-check"></i><b>4.4.1</b> Conexión a una base de datos</a></li>
<li class="chapter" data-level="4.4.2" data-path="gestión-y-operación-de-datos-con-bases-de-datos-relacionales.html"><a href="gestión-y-operación-de-datos-con-bases-de-datos-relacionales.html#operaciones-de-lectura-selección-read-de-datos"><i class="fa fa-check"></i><b>4.4.2</b> Operaciones de lectura / selección (<em>read</em>) de datos</a></li>
<li class="chapter" data-level="4.4.3" data-path="gestión-y-operación-de-datos-con-bases-de-datos-relacionales.html"><a href="gestión-y-operación-de-datos-con-bases-de-datos-relacionales.html#operaciones-de-inserción-create-y-actualización-update-de-datos"><i class="fa fa-check"></i><b>4.4.3</b> Operaciones de inserción (<em>create</em>) y actualización (<em>update</em>) de datos</a></li>
<li class="chapter" data-level="4.4.4" data-path="gestión-y-operación-de-datos-con-bases-de-datos-relacionales.html"><a href="gestión-y-operación-de-datos-con-bases-de-datos-relacionales.html#operaciones-de-borrado-de-datos-delete"><i class="fa fa-check"></i><b>4.4.4</b> Operaciones de Borrado de datos (<em>delete</em>)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="datos-no-sql.html"><a href="datos-no-sql.html"><i class="fa fa-check"></i><b>5</b> Gestión y operación de datos masivos (BigData) con bases de datos NoSQL</a>
<ul>
<li class="chapter" data-level="5.1" data-path="datos-no-sql.html"><a href="datos-no-sql.html#introducción-al-big-data"><i class="fa fa-check"></i><b>5.1</b> Introducción al Big Data</a></li>
<li class="chapter" data-level="5.2" data-path="datos-no-sql.html"><a href="datos-no-sql.html#VsBigData"><i class="fa fa-check"></i><b>5.2</b> Las V’s del Big Data</a></li>
<li class="chapter" data-level="5.3" data-path="datos-no-sql.html"><a href="datos-no-sql.html#fuentes-de-datos-en-entornos-big-data"><i class="fa fa-check"></i><b>5.3</b> Fuentes de Datos en entornos Big Data</a></li>
<li class="chapter" data-level="5.4" data-path="datos-no-sql.html"><a href="datos-no-sql.html#bases-de-datos-relacionales-vs.-nosql"><i class="fa fa-check"></i><b>5.4</b> Bases de datos Relacionales vs. NoSQL</a></li>
<li class="chapter" data-level="5.5" data-path="datos-no-sql.html"><a href="datos-no-sql.html#bases-de-datos-nosql"><i class="fa fa-check"></i><b>5.5</b> Bases de datos NoSQL</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="datos-no-sql.html"><a href="datos-no-sql.html#definición-de-bases-de-datos-nosql"><i class="fa fa-check"></i><b>5.5.1</b> Definición de bases de datos NoSQL</a></li>
<li class="chapter" data-level="5.5.2" data-path="datos-no-sql.html"><a href="datos-no-sql.html#necesidades-no-cubiertas-por-las-bases-de-datos-relacionales"><i class="fa fa-check"></i><b>5.5.2</b> Necesidades no cubiertas por las bases de datos relacionales</a></li>
<li class="chapter" data-level="5.5.3" data-path="datos-no-sql.html"><a href="datos-no-sql.html#tipos-de-almacenamiento-en-bases-de-datos-nosql"><i class="fa fa-check"></i><b>5.5.3</b> Tipos de almacenamiento en bases de datos NoSQL</a></li>
<li class="chapter" data-level="5.5.4" data-path="datos-no-sql.html"><a href="datos-no-sql.html#limitaciones-de-las-bases-de-datos-nosql"><i class="fa fa-check"></i><b>5.5.4</b> Limitaciones de las bases de datos NoSQL</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="datos-no-sql.html"><a href="datos-no-sql.html#ejemplo-de-integración-de-una-base-de-datos-nosql-y-análisis-de-datos-en-r"><i class="fa fa-check"></i><b>5.6</b> Ejemplo de integración de una base de datos NoSQL y análisis de datos en R</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="datos-no-sql.html"><a href="datos-no-sql.html#introMongo"><i class="fa fa-check"></i><b>5.6.1</b> Introducción a MongoDB</a></li>
<li class="chapter" data-level="5.6.2" data-path="datos-no-sql.html"><a href="datos-no-sql.html#paquetesCaso"><i class="fa fa-check"></i><b>5.6.2</b> Plataforma tecnológica para el caso práctico</a></li>
<li class="chapter" data-level="5.6.3" data-path="datos-no-sql.html"><a href="datos-no-sql.html#conexionMongo"><i class="fa fa-check"></i><b>5.6.3</b> Conexión y acceso a MongoDB desde R</a></li>
<li class="chapter" data-level="5.6.4" data-path="datos-no-sql.html"><a href="datos-no-sql.html#consultaViajes"><i class="fa fa-check"></i><b>5.6.4</b> Obtención de datos en R desde MongoDB</a></li>
<li class="chapter" data-level="5.6.5" data-path="datos-no-sql.html"><a href="datos-no-sql.html#analisisViajes"><i class="fa fa-check"></i><b>5.6.5</b> Analizando datos de MongoDB en R</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="id_120007-informes.html"><a href="id_120007-informes.html"><i class="fa fa-check"></i><b>6</b> Informes reproducibles con R-markdown -&gt; Quarto</a>
<ul>
<li class="chapter" data-level="6.1" data-path="id_120007-informes.html"><a href="id_120007-informes.html#introducción-2"><i class="fa fa-check"></i><b>6.1</b> Introducción</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="id_120007-informes.html"><a href="id_120007-informes.html#por-qué-informes-reproducibles"><i class="fa fa-check"></i><b>6.1.1</b> ¿Por qué informes reproducibles?</a></li>
<li class="chapter" data-level="6.1.2" data-path="id_120007-informes.html"><a href="id_120007-informes.html#markdown-r-markdown-y-rstudio"><i class="fa fa-check"></i><b>6.1.2</b> Markdown, R Markdown y RStudio</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="id_120007-informes.html"><a href="id_120007-informes.html#documentos-r-markdown"><i class="fa fa-check"></i><b>6.2</b> Documentos R Markdown</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="id_120007-informes.html"><a href="id_120007-informes.html#encabezado-yaml-y-configuración"><i class="fa fa-check"></i><b>6.2.1</b> Encabezado YAML y configuración</a></li>
<li class="chapter" data-level="6.2.2" data-path="id_120007-informes.html"><a href="id_120007-informes.html#formateado-de-texto"><i class="fa fa-check"></i><b>6.2.2</b> Formateado de texto</a></li>
<li class="chapter" data-level="6.2.3" data-path="id_120007-informes.html"><a href="id_120007-informes.html#inclusión-de-código"><i class="fa fa-check"></i><b>6.2.3</b> Inclusión de código</a></li>
<li class="chapter" data-level="6.2.4" data-path="id_120007-informes.html"><a href="id_120007-informes.html#opciones-de-los-bloques-de-código-chunks"><i class="fa fa-check"></i><b>6.2.4</b> Opciones de los bloques de código (<em>chunks</em>)</a></li>
<li class="chapter" data-level="6.2.5" data-path="id_120007-informes.html"><a href="id_120007-informes.html#editor-visual"><i class="fa fa-check"></i><b>6.2.5</b> Editor visual</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="id_120007-informes.html"><a href="id_120007-informes.html#otros-formatos"><i class="fa fa-check"></i><b>6.3</b> Otros formatos</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="github.html"><a href="github.html"><i class="fa fa-check"></i><b>7</b> Git y GitHub en R</a>
<ul>
<li class="chapter" data-level="7.1" data-path="github.html"><a href="github.html#qué-es-git"><i class="fa fa-check"></i><b>7.1</b> ¿Qué es Git?</a></li>
<li class="chapter" data-level="7.2" data-path="github.html"><a href="github.html#qué-es-github"><i class="fa fa-check"></i><b>7.2</b> ¿Qué es GitHub?</a></li>
<li class="chapter" data-level="7.3" data-path="github.html"><a href="github.html#por-qué-usar-git-y-github"><i class="fa fa-check"></i><b>7.3</b> ¿Por qué usar Git y GitHub?</a></li>
<li class="chapter" data-level="7.4" data-path="github.html"><a href="github.html#configuración"><i class="fa fa-check"></i><b>7.4</b> Configuración</a></li>
<li class="chapter" data-level="7.5" data-path="github.html"><a href="github.html#configurar-git"><i class="fa fa-check"></i><b>7.5</b> Configurar git</a></li>
<li class="chapter" data-level="7.6" data-path="github.html"><a href="github.html#workflow"><i class="fa fa-check"></i><b>7.6</b> Workflow</a></li>
</ul></li>
<li class="part"><span><b>II Manipulación de datos con R. Técnicas y herramientas</b></span></li>
<li class="chapter" data-level="8" data-path="id_120006-aed.html"><a href="id_120006-aed.html"><i class="fa fa-check"></i><b>8</b> Análisis exploratorio de datos</a>
<ul>
<li class="chapter" data-level="8.1" data-path="id_120006-aed.html"><a href="id_120006-aed.html#introducción-3"><i class="fa fa-check"></i><b>8.1</b> Introducción</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="id_120006-aed.html"><a href="id_120006-aed.html#el-cuarterto-de-anscombe"><i class="fa fa-check"></i><b>8.1.1</b> El cuarterto de Anscombe</a></li>
<li class="chapter" data-level="8.1.2" data-path="id_120006-aed.html"><a href="id_120006-aed.html#conceptos-generales"><i class="fa fa-check"></i><b>8.1.2</b> Conceptos generales</a></li>
<li class="chapter" data-level="8.1.3" data-path="id_120006-aed.html"><a href="id_120006-aed.html#componentes-de-un-gráfico-y-su-representación-en-r"><i class="fa fa-check"></i><b>8.1.3</b> Componentes de un gráfico y su representación en R</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="id_120006-aed.html"><a href="id_120006-aed.html#id_120006-aeduni"><i class="fa fa-check"></i><b>8.2</b> Análisis exploratorio de una característica</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="id_120006-aed.html"><a href="id_120006-aed.html#variables-cualitativas"><i class="fa fa-check"></i><b>8.2.1</b> Variables cualitativas</a></li>
<li class="chapter" data-level="8.2.2" data-path="id_120006-aed.html"><a href="id_120006-aed.html#variables-cuantitativas"><i class="fa fa-check"></i><b>8.2.2</b> Variables cuantitativas</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="id_120006-aed.html"><a href="id_120006-aed.html#id_120006-aedmulti"><i class="fa fa-check"></i><b>8.3</b> Análisis exploratorio de varias características</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="id_120006-aed.html"><a href="id_120006-aed.html#variables-cualitativas-1"><i class="fa fa-check"></i><b>8.3.1</b> Variables cualitativas</a></li>
<li class="chapter" data-level="8.3.2" data-path="id_120006-aed.html"><a href="id_120006-aed.html#variables-cuantitativas-1"><i class="fa fa-check"></i><b>8.3.2</b> Variables cuantitativas</a></li>
<li class="chapter" data-level="8.3.3" data-path="id_120006-aed.html"><a href="id_120006-aed.html#variables-cualitativas-y-cuantitativas"><i class="fa fa-check"></i><b>8.3.3</b> Variables cualitativas y cuantitativas</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III Preparación de datos: evaluación de la calidad de los datos. Integración, limpieza y transformación</b></span></li>
<li class="chapter" data-level="9" data-path="DGDQM.html"><a href="DGDQM.html"><i class="fa fa-check"></i><b>9</b> Gobierno y gestión de calidad de Datos</a>
<ul>
<li class="chapter" data-level="9.1" data-path="DGDQM.html"><a href="DGDQM.html#introducción-4"><i class="fa fa-check"></i><b>9.1</b> Introducción</a></li>
<li class="chapter" data-level="9.2" data-path="DGDQM.html"><a href="DGDQM.html#concepto-de-gobierno-de-datos"><i class="fa fa-check"></i><b>9.2</b> Concepto de Gobierno de datos</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="DGDQM.html"><a href="DGDQM.html#beneficiosDG"><i class="fa fa-check"></i><b>9.2.1</b> Beneficios del Gobierno de Datos</a></li>
<li class="chapter" data-level="9.2.2" data-path="DGDQM.html"><a href="DGDQM.html#artefactosDG"><i class="fa fa-check"></i><b>9.2.2</b> Artefactos de un sistema de Gobierno de Datos</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="DGDQM.html"><a href="DGDQM.html#marcos-y-metodologías-existentes-de-gobierno-de-datos"><i class="fa fa-check"></i><b>9.3</b> Marcos y metodologías existentes de Gobierno de Datos</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="DGDQM.html"><a href="DGDQM.html#modelo-alarcos-de-mejora-de-datos-mamd"><i class="fa fa-check"></i><b>9.3.1</b> Modelo Alarcos de Mejora de Datos (MAMD)</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="DGDQM.html"><a href="DGDQM.html#gestión-de-calidad-de-datos"><i class="fa fa-check"></i><b>9.4</b> Gestión de calidad de datos</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="DGDQM.html"><a href="DGDQM.html#medición-de-calidad-de-datos-vs-perfilado-de-datos"><i class="fa fa-check"></i><b>9.4.1</b> Medición de calidad de datos vs perfilado de datos</a></li>
<li class="chapter" data-level="9.4.2" data-path="DGDQM.html"><a href="DGDQM.html#mejora-de-datos"><i class="fa fa-check"></i><b>9.4.2</b> Mejora de datos</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="id_130009.html"><a href="id_130009.html"><i class="fa fa-check"></i><b>10</b> Integración y limpieza de datos</a>
<ul>
<li class="chapter" data-level="10.1" data-path="id_130009.html"><a href="id_130009.html#introducción-5"><i class="fa fa-check"></i><b>10.1</b> Introducción</a></li>
<li class="chapter" data-level="10.2" data-path="id_130009.html"><a href="id_130009.html#problemas-de-calidad-de-datos"><i class="fa fa-check"></i><b>10.2</b> Problemas de calidad de datos</a></li>
<li class="chapter" data-level="10.3" data-path="id_130009.html"><a href="id_130009.html#niveles-inadecuados-de-completitud-valores-missing"><i class="fa fa-check"></i><b>10.3</b> Niveles inadecuados de completitud: Valores <em>missing</em></a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="id_130009.html"><a href="id_130009.html#visualización"><i class="fa fa-check"></i><b>10.3.1</b> Visualización</a></li>
<li class="chapter" data-level="10.3.2" data-path="id_130009.html"><a href="id_130009.html#imputacion"><i class="fa fa-check"></i><b>10.3.2</b> Técnicas de Imputación</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="id_130009.html"><a href="id_130009.html#mejorando-la-exactitud-y-la-precisión-eliminación-del-ruido-estadístico"><i class="fa fa-check"></i><b>10.4</b> Mejorando la exactitud y la precisión: eliminación del ruido estadístico</a></li>
<li class="chapter" data-level="10.5" data-path="id_130009.html"><a href="id_130009.html#integración-de-datos"><i class="fa fa-check"></i><b>10.5</b> Integración de datos</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="id_130010.html"><a href="id_130010.html"><i class="fa fa-check"></i><b>11</b> Feature Selection and Engineering</a>
<ul>
<li class="chapter" data-level="11.1" data-path="id_130010.html"><a href="id_130010.html#introducción-6"><i class="fa fa-check"></i><b>11.1</b> Introducción</a></li>
<li class="chapter" data-level="11.2" data-path="id_130010.html"><a href="id_130010.html#feature-selection-selección-de-variables"><i class="fa fa-check"></i><b>11.2</b> <em>Feature Selection</em> (Selección de variables)</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="id_130010.html"><a href="id_130010.html#métodos-de-selección-tipo-filtro"><i class="fa fa-check"></i><b>11.2.1</b> Métodos de selección tipo Filtro</a></li>
<li class="chapter" data-level="11.2.2" data-path="id_130010.html"><a href="id_130010.html#métodos-de-selección-de-variables-tipo-wrapper"><i class="fa fa-check"></i><b>11.2.2</b> Métodos de selección de variables tipo <em>wrapper</em></a></li>
<li class="chapter" data-level="11.2.3" data-path="id_130010.html"><a href="id_130010.html#métodos-de-selección-tipo-embedded"><i class="fa fa-check"></i><b>11.2.3</b> Métodos de selección tipo Embedded</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="id_130010.html"><a href="id_130010.html#transformaciones-de-escala-y-de-la-distribución-de-la-variable-objetivo"><i class="fa fa-check"></i><b>11.3</b> Transformaciones de escala y de la distribución de la variable objetivo</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="id_130010.html"><a href="id_130010.html#id_31"><i class="fa fa-check"></i><b>11.3.1</b> Transformaciones de la variable objetivo</a></li>
<li class="chapter" data-level="11.3.2" data-path="id_130010.html"><a href="id_130010.html#escalado-de-datos"><i class="fa fa-check"></i><b>11.3.2</b> Escalado de datos</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="id_130010.html"><a href="id_130010.html#feature-engineering"><i class="fa fa-check"></i><b>11.4</b> <em>Feature engineering</em></a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="id_130010.html"><a href="id_130010.html#binning"><i class="fa fa-check"></i><b>11.4.1</b> <em>Binning</em></a></li>
<li class="chapter" data-level="11.4.2" data-path="id_130010.html"><a href="id_130010.html#codificación"><i class="fa fa-check"></i><b>11.4.2</b> Codificación</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="id_130010.html"><a href="id_130010.html#reducción-de-dimensionalidad"><i class="fa fa-check"></i><b>11.5</b> Reducción de dimensionalidad</a></li>
<li class="chapter" data-level="11.6" data-path="id_130010.html"><a href="id_130010.html#otras-transformaciones"><i class="fa fa-check"></i><b>11.6</b> Otras transformaciones</a>
<ul>
<li class="chapter" data-level="11.6.1" data-path="id_130010.html"><a href="id_130010.html#particionado-de-datos"><i class="fa fa-check"></i><b>11.6.1</b> Particionado de datos</a></li>
<li class="chapter" data-level="11.6.2" data-path="id_130010.html"><a href="id_130010.html#técnicas-para-manejar-datos-no-balanceados"><i class="fa fa-check"></i><b>11.6.2</b> Técnicas para manejar datos no balanceados</a></li>
<li class="chapter" data-level="11.6.3" data-path="id_130010.html"><a href="id_130010.html#métodos-de-remuestreo"><i class="fa fa-check"></i><b>11.6.3</b> Métodos de remuestreo</a></li>
<li class="chapter" data-level="11.6.4" data-path="id_130010.html"><a href="id_130010.html#ajuste-de-hiperparámetros"><i class="fa fa-check"></i><b>11.6.4</b> Ajuste de hiperparámetros</a></li>
<li class="chapter" data-level="11.6.5" data-path="id_130010.html"><a href="id_130010.html#evaluación-de-modelos"><i class="fa fa-check"></i><b>11.6.5</b> Evaluación de modelos</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>IV Técnicas de modelización estadísticas avanzadas</b></span></li>
<li class="chapter" data-level="12" data-path="Funda-probab.html"><a href="Funda-probab.html"><i class="fa fa-check"></i><b>12</b> Fundamentos de probabilidad</a>
<ul>
<li class="chapter" data-level="12.1" data-path="Funda-probab.html"><a href="Funda-probab.html#introducción-a-la-probabilidad"><i class="fa fa-check"></i><b>12.1</b> Introducción a la probabilidad</a></li>
<li class="chapter" data-level="12.2" data-path="Funda-probab.html"><a href="Funda-probab.html#probabilidad-elementos-básicos-definición-y-teoremas"><i class="fa fa-check"></i><b>12.2</b> Probabilidad: elementos básicos, definición y teoremas</a></li>
<li class="chapter" data-level="12.3" data-path="Funda-probab.html"><a href="Funda-probab.html#variable-aleatoria-y-su-distribución-tipos-de-variables-aleatorias"><i class="fa fa-check"></i><b>12.3</b> Variable aleatoria y su distribución: tipos de variables aleatorias</a></li>
<li class="chapter" data-level="12.4" data-path="Funda-probab.html"><a href="Funda-probab.html#modelos-de-distribución-de-probabilidad"><i class="fa fa-check"></i><b>12.4</b> Modelos de distribución de probabilidad</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="Funda-probab.html"><a href="Funda-probab.html#modelos-discretos"><i class="fa fa-check"></i><b>12.4.1</b> Modelos discretos</a></li>
<li class="chapter" data-level="12.4.2" data-path="Funda-probab.html"><a href="Funda-probab.html#modelos-continuos"><i class="fa fa-check"></i><b>12.4.2</b> Modelos continuos</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="Funda-probab.html"><a href="Funda-probab.html#tcl"><i class="fa fa-check"></i><b>12.5</b> Teorema central del límite (TCL)</a></li>
<li class="chapter" data-level="12.6" data-path="Funda-probab.html"><a href="Funda-probab.html#ejemplo-de-distribuciones-usando-r"><i class="fa fa-check"></i><b>12.6</b> Ejemplo de distribuciones usando <strong>R</strong></a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="Fundainfer.html"><a href="Fundainfer.html"><i class="fa fa-check"></i><b>13</b> Fundamentos de Inferencia Estadística</a>
<ul>
<li class="chapter" data-level="13.1" data-path="Fundainfer.html"><a href="Fundainfer.html#introinfer"><i class="fa fa-check"></i><b>13.1</b> Introducción a la Inferencia Estadística</a></li>
<li class="chapter" data-level="13.2" data-path="Fundainfer.html"><a href="Fundainfer.html#mas"><i class="fa fa-check"></i><b>13.2</b> Muestreo aleatorio simple</a></li>
<li class="chapter" data-level="13.3" data-path="Fundainfer.html"><a href="Fundainfer.html#estimpuntual"><i class="fa fa-check"></i><b>13.3</b> Estimación puntual</a></li>
<li class="chapter" data-level="13.4" data-path="Fundainfer.html"><a href="Fundainfer.html#estimintervalos"><i class="fa fa-check"></i><b>13.4</b> Estimación por intervalos</a></li>
<li class="chapter" data-level="13.5" data-path="Fundainfer.html"><a href="Fundainfer.html#contrhip"><i class="fa fa-check"></i><b>13.5</b> Contrastes de hipótesis</a></li>
<li class="chapter" data-level="13.6" data-path="Fundainfer.html"><a href="Fundainfer.html#pobnormales"><i class="fa fa-check"></i><b>13.6</b> Inferencia estadística paramétrica sobre poblaciones normales</a></li>
<li class="chapter" data-level="13.7" data-path="Fundainfer.html"><a href="Fundainfer.html#ejemplopobnorm"><i class="fa fa-check"></i><b>13.7</b> Inferencia sobre poblaciones normales con <strong>R</strong></a></li>
<li class="chapter" data-level="13.8" data-path="Fundainfer.html"><a href="Fundainfer.html#contrnormalidad"><i class="fa fa-check"></i><b>13.8</b> Inferencia estadística no paramétrica: contrastes de normalidad</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="muestreo.html"><a href="muestreo.html"><i class="fa fa-check"></i><b>14</b> Métodos de muestreo y remuestreo</a>
<ul>
<li class="chapter" data-level="14.1" data-path="muestreo.html"><a href="muestreo.html#introducción-al-muestreo"><i class="fa fa-check"></i><b>14.1</b> Introducción al muestreo</a></li>
<li class="chapter" data-level="14.2" data-path="muestreo.html"><a href="muestreo.html#muestreo-aleatorio-simple-1"><i class="fa fa-check"></i><b>14.2</b> Muestreo aleatorio simple</a></li>
<li class="chapter" data-level="14.3" data-path="muestreo.html"><a href="muestreo.html#muestestra"><i class="fa fa-check"></i><b>14.3</b> Muestreo estratificado</a></li>
<li class="chapter" data-level="14.4" data-path="muestreo.html"><a href="muestreo.html#otros-tipos-de-muestreo-probabilístico"><i class="fa fa-check"></i><b>14.4</b> Otros tipos de muestreo probabilístico</a></li>
<li class="chapter" data-level="14.5" data-path="muestreo.html"><a href="muestreo.html#técnicas-de-remuestreo-bootstrap."><i class="fa fa-check"></i><b>14.5</b> Técnicas de remuestreo: Bootstrap.</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="modelización-lineal.html"><a href="modelización-lineal.html"><i class="fa fa-check"></i><b>15</b> Modelización lineal</a>
<ul>
<li class="chapter" data-level="15.1" data-path="modelización-lineal.html"><a href="modelización-lineal.html#modelización"><i class="fa fa-check"></i><b>15.1</b> Modelización</a></li>
<li class="chapter" data-level="15.2" data-path="modelización-lineal.html"><a href="modelización-lineal.html#procedimiento-de-modelización"><i class="fa fa-check"></i><b>15.2</b> Procedimiento de modelización</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="modelización-lineal.html"><a href="modelización-lineal.html#Bondad"><i class="fa fa-check"></i><b>15.2.1</b> Estimación del modelo</a></li>
<li class="chapter" data-level="15.2.2" data-path="modelización-lineal.html"><a href="modelización-lineal.html#validación-del-modelo"><i class="fa fa-check"></i><b>15.2.2</b> Validación del modelo</a></li>
<li class="chapter" data-level="15.2.3" data-path="modelización-lineal.html"><a href="modelización-lineal.html#interpretación-de-los-coeficientes"><i class="fa fa-check"></i><b>15.2.3</b> Interpretación de los coeficientes</a></li>
<li class="chapter" data-level="15.2.4" data-path="modelización-lineal.html"><a href="modelización-lineal.html#predicción"><i class="fa fa-check"></i><b>15.2.4</b> Predicción</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="modelización-lineal.html"><a href="modelización-lineal.html#procedimiento-con-r-la-función-lm"><i class="fa fa-check"></i><b>15.3</b> Procedimiento con R: la función <code>lm</code></a></li>
<li class="chapter" data-level="15.4" data-path="modelización-lineal.html"><a href="modelización-lineal.html#Casos"><i class="fa fa-check"></i><b>15.4</b> Casos prácticos</a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="modelización-lineal.html"><a href="modelización-lineal.html#estimación-de-los-coeficientes"><i class="fa fa-check"></i><b>15.4.1</b> Estimación de los coeficientes</a></li>
<li class="chapter" data-level="15.4.2" data-path="modelización-lineal.html"><a href="modelización-lineal.html#validación"><i class="fa fa-check"></i><b>15.4.2</b> Validación</a></li>
<li class="chapter" data-level="15.4.3" data-path="modelización-lineal.html"><a href="modelización-lineal.html#interpretación-de-los-coeficientes-1"><i class="fa fa-check"></i><b>15.4.3</b> Interpretación de los coeficientes</a></li>
<li class="chapter" data-level="15.4.4" data-path="modelización-lineal.html"><a href="modelización-lineal.html#predicción-1"><i class="fa fa-check"></i><b>15.4.4</b> Predicción</a></li>
<li class="chapter" data-level="15.4.5" data-path="modelización-lineal.html"><a href="modelización-lineal.html#nuevo-ajuste-con-logozone"><i class="fa fa-check"></i><b>15.4.5</b> Nuevo ajuste con <code>log(Ozone)</code></a></li>
<li class="chapter" data-level="15.4.6" data-path="modelización-lineal.html"><a href="modelización-lineal.html#coeficientes-de-variables-categóricas"><i class="fa fa-check"></i><b>15.4.6</b> Coeficientes de variables categóricas</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="modelización-lineal.html"><a href="modelización-lineal.html#comentarios-finales"><i class="fa fa-check"></i><b>15.5</b> Comentarios finales</a>
<ul>
<li class="chapter" data-level="" data-path="modelización-lineal.html"><a href="modelización-lineal.html#resumen"><i class="fa fa-check"></i>Resumen</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html"><i class="fa fa-check"></i><b>16</b> Modelos lineales generalizados</a>
<ul>
<li class="chapter" data-level="16.1" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html#motivación"><i class="fa fa-check"></i><b>16.1</b> Motivación</a></li>
<li class="chapter" data-level="16.2" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html#modelo-y-sus-componentes"><i class="fa fa-check"></i><b>16.2</b> Modelo y sus componentes</a>
<ul>
<li class="chapter" data-level="16.2.1" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html#función-enlace"><i class="fa fa-check"></i><b>16.2.1</b> Función enlace </a></li>
<li class="chapter" data-level="16.2.2" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html#glms-en-r"><i class="fa fa-check"></i><b>16.2.2</b> GLMs en <code>R</code></a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html#regresión-logística"><i class="fa fa-check"></i><b>16.3</b> Regresión logística</a>
<ul>
<li class="chapter" data-level="16.3.1" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html#procedimiento-de-ajuste"><i class="fa fa-check"></i><b>16.3.1</b> Procedimiento de ajuste</a></li>
<li class="chapter" data-level="16.3.2" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html#adecuación-del-modelo"><i class="fa fa-check"></i><b>16.3.2</b> Adecuación del modelo</a></li>
<li class="chapter" data-level="16.3.3" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html#SECCinterp"><i class="fa fa-check"></i><b>16.3.3</b> Interpretación de resultados</a></li>
<li class="chapter" data-level="16.3.4" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html#predicción.-curva-roc-y-auc"><i class="fa fa-check"></i><b>16.3.4</b> Predicción. Curva ROC y AUC</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html#regresión-de-poisson"><i class="fa fa-check"></i><b>16.4</b> Regresión de Poisson</a></li>
<li class="chapter" data-level="16.5" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html#casos-prácticos"><i class="fa fa-check"></i><b>16.5</b> Casos prácticos</a>
<ul>
<li class="chapter" data-level="16.5.1" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html#ejemplos-de-regresión-logística"><i class="fa fa-check"></i><b>16.5.1</b> Ejemplos de regresión logística</a></li>
<li class="chapter" data-level="16.5.2" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html#ejemplo-de-regresión-de-poisson"><i class="fa fa-check"></i><b>16.5.2</b> Ejemplo de regresión de Poisson</a></li>
<li class="chapter" data-level="" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html#resumen-1"><i class="fa fa-check"></i>Resumen</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="modelos-aditivos-generalizados.html"><a href="modelos-aditivos-generalizados.html"><i class="fa fa-check"></i><b>17</b> Modelos aditivos generalizados</a>
<ul>
<li class="chapter" data-level="17.1" data-path="modelos-aditivos-generalizados.html"><a href="modelos-aditivos-generalizados.html#introducción-7"><i class="fa fa-check"></i><b>17.1</b> Introducción</a></li>
<li class="chapter" data-level="17.2" data-path="modelos-aditivos-generalizados.html"><a href="modelos-aditivos-generalizados.html#splines-con-penalizaciones"><i class="fa fa-check"></i><b>17.2</b> Splines con penalizaciones</a></li>
<li class="chapter" data-level="17.3" data-path="modelos-aditivos-generalizados.html"><a href="modelos-aditivos-generalizados.html#aspectos-metodológicos"><i class="fa fa-check"></i><b>17.3</b> Aspectos metodológicos</a>
<ul>
<li class="chapter" data-level="17.3.1" data-path="modelos-aditivos-generalizados.html"><a href="modelos-aditivos-generalizados.html#estimación-de-los-paraámetros-del-modelo"><i class="fa fa-check"></i><b>17.3.1</b> Estimación de los paraámetros del modelo</a></li>
<li class="chapter" data-level="17.3.2" data-path="modelos-aditivos-generalizados.html"><a href="modelos-aditivos-generalizados.html#inferencia-sobre-las-funciones-suaves"><i class="fa fa-check"></i><b>17.3.2</b> Inferencia sobre las funciones suaves</a></li>
<li class="chapter" data-level="17.3.3" data-path="modelos-aditivos-generalizados.html"><a href="modelos-aditivos-generalizados.html#suavizado-mutidimensional-y-para-datos-no-gaussianos"><i class="fa fa-check"></i><b>17.3.3</b> Suavizado mutidimensional y para datos no Gaussianos</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="modelos-aditivos-generalizados.html"><a href="modelos-aditivos-generalizados.html#la-función-gam-del-paquete-mgcv"><i class="fa fa-check"></i><b>17.4</b> La función <code>gam</code> del paquete <code>mgcv</code></a></li>
<li class="chapter" data-level="17.5" data-path="modelos-aditivos-generalizados.html"><a href="modelos-aditivos-generalizados.html#casos-prácticos-1"><i class="fa fa-check"></i><b>17.5</b> Casos prácticos</a>
<ul>
<li class="chapter" data-level="17.5.1" data-path="modelos-aditivos-generalizados.html"><a href="modelos-aditivos-generalizados.html#modelo-unidimensional-con-fossil"><i class="fa fa-check"></i><b>17.5.1</b> Modelo unidimensional con <code>fossil</code></a></li>
<li class="chapter" data-level="17.5.2" data-path="modelos-aditivos-generalizados.html"><a href="modelos-aditivos-generalizados.html#modelo-aditivo-con-airquality"><i class="fa fa-check"></i><b>17.5.2</b> Modelo aditivo con <code>airquality</code></a></li>
<li class="chapter" data-level="17.5.3" data-path="modelos-aditivos-generalizados.html"><a href="modelos-aditivos-generalizados.html#modelo-semiparamétrico-con-onions"><i class="fa fa-check"></i><b>17.5.3</b> Modelo semiparamétrico con <code>onions</code></a></li>
<li class="chapter" data-level="17.5.4" data-path="modelos-aditivos-generalizados.html"><a href="modelos-aditivos-generalizados.html#modelo-aditivo-generalizado-y-multidimensional-con-smacker"><i class="fa fa-check"></i><b>17.5.4</b> Modelo aditivo generalizado y multidimensional, con <code>smacker</code></a></li>
<li class="chapter" data-level="" data-path="modelos-aditivos-generalizados.html"><a href="modelos-aditivos-generalizados.html#resumen-2"><i class="fa fa-check"></i>Resumen</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="18" data-path="modelos-mixtos.html"><a href="modelos-mixtos.html"><i class="fa fa-check"></i><b>18</b> Modelos mixtos</a>
<ul>
<li class="chapter" data-level="18.1" data-path="modelos-mixtos.html"><a href="modelos-mixtos.html#conceptos-básicos"><i class="fa fa-check"></i><b>18.1</b> Conceptos básicos</a>
<ul>
<li class="chapter" data-level="18.1.1" data-path="modelos-mixtos.html"><a href="modelos-mixtos.html#tipo-y-estructura-de-los-datos"><i class="fa fa-check"></i><b>18.1.1</b> Tipo y estructura de los datos</a></li>
<li class="chapter" data-level="18.1.2" data-path="modelos-mixtos.html"><a href="modelos-mixtos.html#efectos-fijos-o-aleatorios"><i class="fa fa-check"></i><b>18.1.2</b> ¿Efectos fijos o aleatorios?</a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="modelos-mixtos.html"><a href="modelos-mixtos.html#formulación-del-modelo-con-efectos-aleatorios-o-modelos-mixtos"><i class="fa fa-check"></i><b>18.2</b> Formulación del modelo con efectos aleatorios o modelos mixtos</a>
<ul>
<li class="chapter" data-level="18.2.1" data-path="modelos-mixtos.html"><a href="modelos-mixtos.html#formulación-general"><i class="fa fa-check"></i><b>18.2.1</b> Formulación general</a></li>
<li class="chapter" data-level="18.2.2" data-path="modelos-mixtos.html"><a href="modelos-mixtos.html#inferencia-y-selección-del-modelo"><i class="fa fa-check"></i><b>18.2.2</b> Inferencia y selección del modelo</a></li>
<li class="chapter" data-level="18.2.3" data-path="modelos-mixtos.html"><a href="modelos-mixtos.html#diagnosis-del-modelo"><i class="fa fa-check"></i><b>18.2.3</b> Diagnosis del modelo</a></li>
</ul></li>
<li class="chapter" data-level="18.3" data-path="modelos-mixtos.html"><a href="modelos-mixtos.html#funciones-de-r-para-ajustar-modelos-mixtos"><i class="fa fa-check"></i><b>18.3</b> Funciones de <code>R</code> para ajustar modelos mixtos</a>
<ul>
<li class="chapter" data-level="18.3.1" data-path="modelos-mixtos.html"><a href="modelos-mixtos.html#la-función-lmer"><i class="fa fa-check"></i><b>18.3.1</b> La función <code>lmer()</code></a></li>
</ul></li>
<li class="chapter" data-level="18.4" data-path="modelos-mixtos.html"><a href="modelos-mixtos.html#caso-práctico"><i class="fa fa-check"></i><b>18.4</b> Caso práctico</a>
<ul>
<li class="chapter" data-level="18.4.1" data-path="modelos-mixtos.html"><a href="modelos-mixtos.html#modelo-con-ordenada-en-el-origen-aleatoria"><i class="fa fa-check"></i><b>18.4.1</b> Modelo con ordenada en el origen aleatoria</a></li>
<li class="chapter" data-level="18.4.2" data-path="modelos-mixtos.html"><a href="modelos-mixtos.html#modelo-con-pendiente-aleatoria"><i class="fa fa-check"></i><b>18.4.2</b> Modelo con pendiente aleatoria</a></li>
<li class="chapter" data-level="18.4.3" data-path="modelos-mixtos.html"><a href="modelos-mixtos.html#cómo-construir-el-modelo-en-la-práctica"><i class="fa fa-check"></i><b>18.4.3</b> ¿Cómo construir el modelo en la práctica?</a></li>
<li class="chapter" data-level="" data-path="modelos-mixtos.html"><a href="modelos-mixtos.html#resumen-3"><i class="fa fa-check"></i>Resumen</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="19" data-path="modelos-sparse-y-métodos-penalizados-de-regresión.html"><a href="modelos-sparse-y-métodos-penalizados-de-regresión.html"><i class="fa fa-check"></i><b>19</b> Modelos sparse y métodos penalizados de regresión</a>
<ul>
<li class="chapter" data-level="19.1" data-path="modelos-sparse-y-métodos-penalizados-de-regresión.html"><a href="modelos-sparse-y-métodos-penalizados-de-regresión.html#introducción-8"><i class="fa fa-check"></i><b>19.1</b> Introducción</a></li>
<li class="chapter" data-level="19.2" data-path="modelos-sparse-y-métodos-penalizados-de-regresión.html"><a href="modelos-sparse-y-métodos-penalizados-de-regresión.html#selección-del-mejor-subconjunto"><i class="fa fa-check"></i><b>19.2</b> Selección del mejor subconjunto</a>
<ul>
<li class="chapter" data-level="19.2.1" data-path="modelos-sparse-y-métodos-penalizados-de-regresión.html"><a href="modelos-sparse-y-métodos-penalizados-de-regresión.html#ejemplo-sueldo-de-jugadores-de-béisbol"><i class="fa fa-check"></i><b>19.2.1</b> Ejemplo: Sueldo de jugadores de béisbol</a></li>
</ul></li>
<li class="chapter" data-level="19.3" data-path="modelos-sparse-y-métodos-penalizados-de-regresión.html"><a href="modelos-sparse-y-métodos-penalizados-de-regresión.html#selección-stepwise"><i class="fa fa-check"></i><b>19.3</b> Selección <em>Stepwise</em></a>
<ul>
<li class="chapter" data-level="19.3.1" data-path="modelos-sparse-y-métodos-penalizados-de-regresión.html"><a href="modelos-sparse-y-métodos-penalizados-de-regresión.html#forward-stepwise"><i class="fa fa-check"></i><b>19.3.1</b> Forward stepwise</a></li>
<li class="chapter" data-level="19.3.2" data-path="modelos-sparse-y-métodos-penalizados-de-regresión.html"><a href="modelos-sparse-y-métodos-penalizados-de-regresión.html#backward-stepwise"><i class="fa fa-check"></i><b>19.3.2</b> Backward stepwise</a></li>
<li class="chapter" data-level="19.3.3" data-path="modelos-sparse-y-métodos-penalizados-de-regresión.html"><a href="modelos-sparse-y-métodos-penalizados-de-regresión.html#ejemplo-sueldo-de-jugadores-de-béisbol-1"><i class="fa fa-check"></i><b>19.3.3</b> Ejemplo: Sueldo de jugadores de béisbol</a></li>
</ul></li>
<li class="chapter" data-level="19.4" data-path="modelos-sparse-y-métodos-penalizados-de-regresión.html"><a href="modelos-sparse-y-métodos-penalizados-de-regresión.html#métodos-shrinkage"><i class="fa fa-check"></i><b>19.4</b> Métodos Shrinkage</a>
<ul>
<li class="chapter" data-level="19.4.1" data-path="modelos-sparse-y-métodos-penalizados-de-regresión.html"><a href="modelos-sparse-y-métodos-penalizados-de-regresión.html#regresión-ridge"><i class="fa fa-check"></i><b>19.4.1</b> Regresión ridge</a></li>
<li class="chapter" data-level="19.4.2" data-path="modelos-sparse-y-métodos-penalizados-de-regresión.html"><a href="modelos-sparse-y-métodos-penalizados-de-regresión.html#selección-del-parámetro-de-tuneado"><i class="fa fa-check"></i><b>19.4.2</b> Selección del parámetro de tuneado</a></li>
<li class="chapter" data-level="19.4.3" data-path="modelos-sparse-y-métodos-penalizados-de-regresión.html"><a href="modelos-sparse-y-métodos-penalizados-de-regresión.html#regresión-lasso"><i class="fa fa-check"></i><b>19.4.3</b> Regresión Lasso</a></li>
<li class="chapter" data-level="19.4.4" data-path="modelos-sparse-y-métodos-penalizados-de-regresión.html"><a href="modelos-sparse-y-métodos-penalizados-de-regresión.html#elastic-net"><i class="fa fa-check"></i><b>19.4.4</b> Elastic net </a></li>
<li class="chapter" data-level="" data-path="modelos-sparse-y-métodos-penalizados-de-regresión.html"><a href="modelos-sparse-y-métodos-penalizados-de-regresión.html#resumen-4"><i class="fa fa-check"></i>Resumen</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="20" data-path="modelización-de-series-temporales.html"><a href="modelización-de-series-temporales.html"><i class="fa fa-check"></i><b>20</b> Modelización de series temporales</a>
<ul>
<li class="chapter" data-level="20.1" data-path="modelización-de-series-temporales.html"><a href="modelización-de-series-temporales.html#conceptos-básicos-1"><i class="fa fa-check"></i><b>20.1</b> Conceptos básicos</a></li>
<li class="chapter" data-level="20.2" data-path="modelización-de-series-temporales.html"><a href="modelización-de-series-temporales.html#modelos-arima"><i class="fa fa-check"></i><b>20.2</b> Modelos ARIMA</a></li>
<li class="chapter" data-level="20.3" data-path="modelización-de-series-temporales.html"><a href="modelización-de-series-temporales.html#análisis-de-series-temporales-con-r"><i class="fa fa-check"></i><b>20.3</b> Análisis de series temporales con R</a>
<ul>
<li class="chapter" data-level="20.3.1" data-path="modelización-de-series-temporales.html"><a href="modelización-de-series-temporales.html#identificación-o-especificación-del-modelo"><i class="fa fa-check"></i><b>20.3.1</b> Identificación o especificación del modelo</a></li>
<li class="chapter" data-level="20.3.2" data-path="modelización-de-series-temporales.html"><a href="modelización-de-series-temporales.html#estimación-del-modelo"><i class="fa fa-check"></i><b>20.3.2</b> Estimación del modelo</a></li>
<li class="chapter" data-level="20.3.3" data-path="modelización-de-series-temporales.html"><a href="modelización-de-series-temporales.html#diagnosis-validación-y-contrastación"><i class="fa fa-check"></i><b>20.3.3</b> Diagnosis, validación y contrastación</a></li>
<li class="chapter" data-level="20.3.4" data-path="modelización-de-series-temporales.html"><a href="modelización-de-series-temporales.html#predicción-2"><i class="fa fa-check"></i><b>20.3.4</b> Predicción</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="bibliografía.html"><a href="bibliografía.html"><i class="fa fa-check"></i>Bibliografía</a></li>
<li class="chapter" data-level="21" data-path="tablas-contingencia.html"><a href="tablas-contingencia.html"><i class="fa fa-check"></i><b>21</b> Análisis de tablas de contingencia</a>
<ul>
<li class="chapter" data-level="21.1" data-path="tablas-contingencia.html"><a href="tablas-contingencia.html#introducción-9"><i class="fa fa-check"></i><b>21.1</b> Introducción</a>
<ul>
<li class="chapter" data-level="21.1.1" data-path="tablas-contingencia.html"><a href="tablas-contingencia.html#motiv"><i class="fa fa-check"></i><b>21.1.1</b> Motivación</a></li>
<li class="chapter" data-level="21.1.2" data-path="tablas-contingencia.html"><a href="tablas-contingencia.html#notac"><i class="fa fa-check"></i><b>21.1.2</b> Notación</a></li>
<li class="chapter" data-level="21.1.3" data-path="tablas-contingencia.html"><a href="tablas-contingencia.html#diseños-experimentales-o-procedimientos-de-muestreo-que-dan-lugar-a-una-tabla-de-contingencia"><i class="fa fa-check"></i><b>21.1.3</b> Diseños experimentales o procedimientos de muestreo que dan lugar a una tabla de contingencia</a></li>
</ul></li>
<li class="chapter" data-level="21.2" data-path="tablas-contingencia.html"><a href="tablas-contingencia.html#contraste-de-independencia-en-tablas-2times-2"><i class="fa fa-check"></i><b>21.2</b> Contraste de independencia en tablas <span class="math inline">\((2\times 2)\)</span></a>
<ul>
<li class="chapter" data-level="21.2.1" data-path="tablas-contingencia.html"><a href="tablas-contingencia.html#introducción-10"><i class="fa fa-check"></i><b>21.2.1</b> Introducción</a></li>
<li class="chapter" data-level="21.2.2" data-path="tablas-contingencia.html"><a href="tablas-contingencia.html#plantgen"><i class="fa fa-check"></i><b>21.2.2</b> Planteamiento general del contraste exacto de independencia</a></li>
<li class="chapter" data-level="21.2.3" data-path="tablas-contingencia.html"><a href="tablas-contingencia.html#algoritmo"><i class="fa fa-check"></i><b>21.2.3</b> Algoritmo para la realización del contraste exacto de independencia</a></li>
<li class="chapter" data-level="21.2.4" data-path="tablas-contingencia.html"><a href="tablas-contingencia.html#contraste-de-independencia-diseño-tipo-1"><i class="fa fa-check"></i><b>21.2.4</b> Contraste de independencia: Diseño Tipo 1</a></li>
<li class="chapter" data-level="21.2.5" data-path="tablas-contingencia.html"><a href="tablas-contingencia.html#dise"><i class="fa fa-check"></i><b>21.2.5</b> Contraste de independencia: Diseños Tipo 2 y Tipo 3</a></li>
</ul></li>
<li class="chapter" data-level="21.3" data-path="tablas-contingencia.html"><a href="tablas-contingencia.html#contraste-de-independencia-en-tablas-rtimes-c"><i class="fa fa-check"></i><b>21.3</b> Contraste de independencia en tablas <span class="math inline">\(R\times C\)</span></a>
<ul>
<li class="chapter" data-level="21.3.1" data-path="tablas-contingencia.html"><a href="tablas-contingencia.html#IntroRxC"><i class="fa fa-check"></i><b>21.3.1</b> Introducción</a></li>
<li class="chapter" data-level="21.3.2" data-path="tablas-contingencia.html"><a href="tablas-contingencia.html#contaprox"><i class="fa fa-check"></i><b>21.3.2</b> Contrastes aproximados</a></li>
<li class="chapter" data-level="21.3.3" data-path="tablas-contingencia.html"><a href="tablas-contingencia.html#contraste-aproximado-con-corrección-de-continuidad-1"><i class="fa fa-check"></i><b>21.3.3</b> Contraste aproximado con corrección de continuidad</a></li>
</ul></li>
<li class="chapter" data-level="21.4" data-path="tablas-contingencia.html"><a href="tablas-contingencia.html#medidas"><i class="fa fa-check"></i><b>21.4</b> Medidas de asociación en tablas <span class="math inline">\(2\times 2\)</span></a>
<ul>
<li class="chapter" data-level="21.4.1" data-path="tablas-contingencia.html"><a href="tablas-contingencia.html#introducción-11"><i class="fa fa-check"></i><b>21.4.1</b> Introducción</a></li>
<li class="chapter" data-level="21.4.2" data-path="tablas-contingencia.html"><a href="tablas-contingencia.html#la-hatq-de-yule"><i class="fa fa-check"></i><b>21.4.2</b> La <span class="math inline">\(\hat{Q}\)</span> de Yule</a></li>
<li class="chapter" data-level="21.4.3" data-path="tablas-contingencia.html"><a href="tablas-contingencia.html#otras-medidas-de-asociación-para-tablas-2times-2"><i class="fa fa-check"></i><b>21.4.3</b> Otras medidas de asociación para tablas <span class="math inline">\(2\times 2\)</span></a></li>
</ul></li>
<li class="chapter" data-level="21.5" data-path="tablas-contingencia.html"><a href="tablas-contingencia.html#medidas-de-asociación-en-tablas-rtimes-c"><i class="fa fa-check"></i><b>21.5</b> Medidas de asociación en tablas <span class="math inline">\(R\times C\)</span></a>
<ul>
<li class="chapter" data-level="21.5.1" data-path="tablas-contingencia.html"><a href="tablas-contingencia.html#introducción-12"><i class="fa fa-check"></i><b>21.5.1</b> Introducción</a></li>
<li class="chapter" data-level="21.5.2" data-path="tablas-contingencia.html"><a href="tablas-contingencia.html#medidas-derivadas-del-estadístico-chi-cuadrado"><i class="fa fa-check"></i><b>21.5.2</b> Medidas derivadas del estadístico Chi-cuadrado</a></li>
<li class="chapter" data-level="21.5.3" data-path="tablas-contingencia.html"><a href="tablas-contingencia.html#medidas-basadas-en-la-reducción-proporcional-del-error-lambda-de-goodman-y-kruskal"><i class="fa fa-check"></i><b>21.5.3</b> Medidas basadas en la reducción proporcional del error: <span class="math inline">\(\lambda\)</span> de Goodman y Kruskal</a></li>
<li class="chapter" data-level="21.5.4" data-path="tablas-contingencia.html"><a href="tablas-contingencia.html#determinación-de-las-fuentes-de-asociación"><i class="fa fa-check"></i><b>21.5.4</b> Determinación de las fuentes de asociación</a></li>
</ul></li>
<li class="chapter" data-level="21.6" data-path="tablas-contingencia.html"><a href="tablas-contingencia.html#contrastes-de-independencia-en-tablas-multidimensionales"><i class="fa fa-check"></i><b>21.6</b> Contrastes de independencia en tablas multidimensionales</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="correspondencias.html"><a href="correspondencias.html"><i class="fa fa-check"></i><b>22</b> Análisis de correspondencias</a>
<ul>
<li class="chapter" data-level="22.1" data-path="correspondencias.html"><a href="correspondencias.html#introducción-13"><i class="fa fa-check"></i><b>22.1</b> Introducción</a></li>
<li class="chapter" data-level="22.2" data-path="correspondencias.html"><a href="correspondencias.html#metodología-del-análisis-de-correspondencias"><i class="fa fa-check"></i><b>22.2</b> Metodología del análisis de correspondencias</a>
<ul>
<li class="chapter" data-level="22.2.1" data-path="correspondencias.html"><a href="correspondencias.html#proyecciones-fila-columna-y-simétrica"><i class="fa fa-check"></i><b>22.2.1</b> Proyecciones fila, columna y simétrica</a></li>
</ul></li>
<li class="chapter" data-level="22.3" data-path="correspondencias.html"><a href="correspondencias.html#ejemplos-de-análisis-de-correspondencias-con-r"><i class="fa fa-check"></i><b>22.3</b> Ejemplos de análisis de correspondencias con <strong>R</strong></a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="análisis-conjunto.html"><a href="análisis-conjunto.html"><i class="fa fa-check"></i><b>23</b> Análisis conjunto</a>
<ul>
<li class="chapter" data-level="23.1" data-path="análisis-conjunto.html"><a href="análisis-conjunto.html#introducción-conceptos-clave-y-tipos-de-análisis"><i class="fa fa-check"></i><b>23.1</b> Introducción, conceptos clave y tipos de análisis</a></li>
<li class="chapter" data-level="23.2" data-path="análisis-conjunto.html"><a href="análisis-conjunto.html#aplicación-del-análisis-conjunto-etapas"><i class="fa fa-check"></i><b>23.2</b> Aplicación del Análisis Conjunto (etapas):</a></li>
<li class="chapter" data-level="23.3" data-path="análisis-conjunto.html"><a href="análisis-conjunto.html#ejemplo-utilizando-r"><i class="fa fa-check"></i><b>23.3</b> Ejemplo utilizando R:</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="análisis-discriminante.html"><a href="análisis-discriminante.html"><i class="fa fa-check"></i><b>24</b> Análisis discriminante</a>
<ul>
<li class="chapter" data-level="24.1" data-path="análisis-discriminante.html"><a href="análisis-discriminante.html#introducción-14"><i class="fa fa-check"></i><b>24.1</b> Introducción</a></li>
<li class="chapter" data-level="24.2" data-path="análisis-discriminante.html"><a href="análisis-discriminante.html#tipos-de-análisis-discriminantes"><i class="fa fa-check"></i><b>24.2</b> Tipos de análisis discriminantes:</a></li>
<li class="chapter" data-level="24.3" data-path="análisis-discriminante.html"><a href="análisis-discriminante.html#ejemplos"><i class="fa fa-check"></i><b>24.3</b> Ejemplos:</a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="árboles-de-clasificación-y-regresión.html"><a href="árboles-de-clasificación-y-regresión.html"><i class="fa fa-check"></i><b>25</b> Árboles de clasificación y regresión </a>
<ul>
<li class="chapter" data-level="25.1" data-path="árboles-de-clasificación-y-regresión.html"><a href="árboles-de-clasificación-y-regresión.html#introducción-15"><i class="fa fa-check"></i><b>25.1</b> Introducción </a></li>
<li class="chapter" data-level="25.2" data-path="árboles-de-clasificación-y-regresión.html"><a href="árboles-de-clasificación-y-regresión.html#aprendizaje-con-árboles-de-decisión"><i class="fa fa-check"></i><b>25.2</b> Aprendizaje con árboles de decisión</a></li>
<li class="chapter" data-level="25.3" data-path="árboles-de-clasificación-y-regresión.html"><a href="árboles-de-clasificación-y-regresión.html#cómo-se-va-dividiendo-el-árbol"><i class="fa fa-check"></i><b>25.3</b> ¿Cómo se va dividiendo el árbol? </a>
<ul>
<li class="chapter" data-level="25.3.1" data-path="árboles-de-clasificación-y-regresión.html"><a href="árboles-de-clasificación-y-regresión.html#impureza-de-gini"><i class="fa fa-check"></i><b>25.3.1</b> Impureza de Gini</a></li>
<li class="chapter" data-level="25.3.2" data-path="árboles-de-clasificación-y-regresión.html"><a href="árboles-de-clasificación-y-regresión.html#entropía"><i class="fa fa-check"></i><b>25.3.2</b> Entropía </a></li>
<li class="chapter" data-level="25.3.3" data-path="árboles-de-clasificación-y-regresión.html"><a href="árboles-de-clasificación-y-regresión.html#ganancia-de-información"><i class="fa fa-check"></i><b>25.3.3</b> Ganancia de información</a></li>
<li class="chapter" data-level="25.3.4" data-path="árboles-de-clasificación-y-regresión.html"><a href="árboles-de-clasificación-y-regresión.html#suma-residual-de-cuadrados-mínima"><i class="fa fa-check"></i><b>25.3.4</b> Suma residual de cuadrados mínima</a></li>
</ul></li>
<li class="chapter" data-level="25.4" data-path="árboles-de-clasificación-y-regresión.html"><a href="árboles-de-clasificación-y-regresión.html#sobreajuste"><i class="fa fa-check"></i><b>25.4</b> Sobreajuste </a></li>
<li class="chapter" data-level="25.5" data-path="árboles-de-clasificación-y-regresión.html"><a href="árboles-de-clasificación-y-regresión.html#cuánto-debe-crecer-un-árbol"><i class="fa fa-check"></i><b>25.5</b> ¿Cuánto debe crecer un árbol? </a>
<ul>
<li class="chapter" data-level="25.5.1" data-path="árboles-de-clasificación-y-regresión.html"><a href="árboles-de-clasificación-y-regresión.html#la-parada-temprana"><i class="fa fa-check"></i><b>25.5.1</b> La parada temprana </a></li>
<li class="chapter" data-level="25.5.2" data-path="árboles-de-clasificación-y-regresión.html"><a href="árboles-de-clasificación-y-regresión.html#la-poda"><i class="fa fa-check"></i><b>25.5.2</b> La poda </a></li>
</ul></li>
<li class="chapter" data-level="25.6" data-path="árboles-de-clasificación-y-regresión.html"><a href="árboles-de-clasificación-y-regresión.html#el-algoritmo-id3-para-la-construcción-de-un-árbol-de-decisión"><i class="fa fa-check"></i><b>25.6</b> El algoritmo ID3 para la construcción de un árbol de decisión</a></li>
<li class="chapter" data-level="25.7" data-path="árboles-de-clasificación-y-regresión.html"><a href="árboles-de-clasificación-y-regresión.html#procedimiento-con-r-la-funcion-rpart"><i class="fa fa-check"></i><b>25.7</b> Procedimiento con R: la funcion <code>rpart</code></a></li>
<li class="chapter" data-level="25.8" data-path="árboles-de-clasificación-y-regresión.html"><a href="árboles-de-clasificación-y-regresión.html#aplicaciones-de-los-árboles-de-decisión"><i class="fa fa-check"></i><b>25.8</b> Aplicaciones de los árboles de decisión</a>
<ul>
<li class="chapter" data-level="25.8.1" data-path="árboles-de-clasificación-y-regresión.html"><a href="árboles-de-clasificación-y-regresión.html#el-caso-de-negocio"><i class="fa fa-check"></i><b>25.8.1</b> El caso de negocio</a></li>
<li class="chapter" data-level="25.8.2" data-path="árboles-de-clasificación-y-regresión.html"><a href="árboles-de-clasificación-y-regresión.html#árbol-de-clasificación-para-determinar-la-intención-de-compra"><i class="fa fa-check"></i><b>25.8.2</b> Árbol de clasificación para determinar la intención de compra</a></li>
<li class="chapter" data-level="25.8.3" data-path="árboles-de-clasificación-y-regresión.html"><a href="árboles-de-clasificación-y-regresión.html#árbol-de-regresión-para-estimar-el-número-de-días-hospitalizado"><i class="fa fa-check"></i><b>25.8.3</b> Árbol de regresión para estimar el número de días hospitalizado</a></li>
<li class="chapter" data-level="" data-path="árboles-de-clasificación-y-regresión.html"><a href="árboles-de-clasificación-y-regresión.html#resumen-5"><i class="fa fa-check"></i>Resumen</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="26" data-path="máquinas-de-vector-soporte.html"><a href="máquinas-de-vector-soporte.html"><i class="fa fa-check"></i><b>26</b> Máquinas de Vector Soporte</a>
<ul>
<li class="chapter" data-level="26.1" data-path="máquinas-de-vector-soporte.html"><a href="máquinas-de-vector-soporte.html#introducción-16"><i class="fa fa-check"></i><b>26.1</b> Introducción</a></li>
<li class="chapter" data-level="26.2" data-path="máquinas-de-vector-soporte.html"><a href="máquinas-de-vector-soporte.html#algoritmo-svm-para-clasificación-binaria"><i class="fa fa-check"></i><b>26.2</b> Algoritmo SVM para clasificación binaria</a></li>
<li class="chapter" data-level="26.3" data-path="máquinas-de-vector-soporte.html"><a href="máquinas-de-vector-soporte.html#y-si-tengo-más-de-dos-clases"><i class="fa fa-check"></i><b>26.3</b> ¿Y si tengo más de dos clases?</a></li>
<li class="chapter" data-level="26.4" data-path="máquinas-de-vector-soporte.html"><a href="máquinas-de-vector-soporte.html#truco-del-kernel-tratando-con-la-no-linearidad"><i class="fa fa-check"></i><b>26.4</b> Truco del Kernel: Tratando con la no linearidad</a>
<ul>
<li class="chapter" data-level="26.4.1" data-path="máquinas-de-vector-soporte.html"><a href="máquinas-de-vector-soporte.html#algunos-kernels-populares"><i class="fa fa-check"></i><b>26.4.1</b> Algunos kernels populares</a></li>
</ul></li>
<li class="chapter" data-level="26.5" data-path="máquinas-de-vector-soporte.html"><a href="máquinas-de-vector-soporte.html#procedimiento-con-r-la-funcion-svm"><i class="fa fa-check"></i><b>26.5</b> Procedimiento con R: la funcion <code>svm</code></a></li>
<li class="chapter" data-level="26.6" data-path="máquinas-de-vector-soporte.html"><a href="máquinas-de-vector-soporte.html#aplicación-de-un-modelo-svm-radial-con-ajuste-automático-en-r"><i class="fa fa-check"></i><b>26.6</b> Aplicación de un modelo SVM Radial con ajuste automático en R</a>
<ul>
<li class="chapter" data-level="26.6.1" data-path="máquinas-de-vector-soporte.html"><a href="máquinas-de-vector-soporte.html#importancia-de-las-variables"><i class="fa fa-check"></i><b>26.6.1</b> Importancia de las variables</a></li>
<li class="chapter" data-level="" data-path="máquinas-de-vector-soporte.html"><a href="máquinas-de-vector-soporte.html#resumen-6"><i class="fa fa-check"></i>Resumen</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="27" data-path="clasificador-k-vecinos-más-próximos.html"><a href="clasificador-k-vecinos-más-próximos.html"><i class="fa fa-check"></i><b>27</b> Clasificador k-vecinos más próximos</a>
<ul>
<li class="chapter" data-level="27.1" data-path="clasificador-k-vecinos-más-próximos.html"><a href="clasificador-k-vecinos-más-próximos.html#introducción-17"><i class="fa fa-check"></i><b>27.1</b> Introducción</a></li>
<li class="chapter" data-level="27.2" data-path="clasificador-k-vecinos-más-próximos.html"><a href="clasificador-k-vecinos-más-próximos.html#decisiones-a-tener-en-cuenta"><i class="fa fa-check"></i><b>27.2</b> Decisiones a tener en cuenta</a>
<ul>
<li class="chapter" data-level="27.2.1" data-path="clasificador-k-vecinos-más-próximos.html"><a href="clasificador-k-vecinos-más-próximos.html#función-de-distancia-a-utilizar"><i class="fa fa-check"></i><b>27.2.1</b> Función de distancia a utilizar</a></li>
<li class="chapter" data-level="27.2.2" data-path="clasificador-k-vecinos-más-próximos.html"><a href="clasificador-k-vecinos-más-próximos.html#número-de-vecinos-k-seleccionados"><i class="fa fa-check"></i><b>27.2.2</b> Número de vecinos (k) seleccionados</a></li>
</ul></li>
<li class="chapter" data-level="27.3" data-path="clasificador-k-vecinos-más-próximos.html"><a href="clasificador-k-vecinos-más-próximos.html#procedimiento-con-r-la-funcion-knn"><i class="fa fa-check"></i><b>27.3</b> Procedimiento con R: la funcion knn</a></li>
<li class="chapter" data-level="27.4" data-path="clasificador-k-vecinos-más-próximos.html"><a href="clasificador-k-vecinos-más-próximos.html#aplicación-del-modelo-knn-en-r"><i class="fa fa-check"></i><b>27.4</b> Aplicación del modelo KNN en R</a>
<ul>
<li class="chapter" data-level="" data-path="clasificador-k-vecinos-más-próximos.html"><a href="clasificador-k-vecinos-más-próximos.html#resumen-7"><i class="fa fa-check"></i>Resumen</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="28" data-path="naive-bayes.html"><a href="naive-bayes.html"><i class="fa fa-check"></i><b>28</b> Naive Bayes</a>
<ul>
<li class="chapter" data-level="28.1" data-path="naive-bayes.html"><a href="naive-bayes.html#introducción-18"><i class="fa fa-check"></i><b>28.1</b> Introducción</a></li>
<li class="chapter" data-level="28.2" data-path="naive-bayes.html"><a href="naive-bayes.html#teorema-de-bayes"><i class="fa fa-check"></i><b>28.2</b> Teorema de Bayes</a></li>
<li class="chapter" data-level="28.3" data-path="naive-bayes.html"><a href="naive-bayes.html#el-algoritmo-naive-bayes"><i class="fa fa-check"></i><b>28.3</b> El algoritmo Naive Bayes</a></li>
<li class="chapter" data-level="28.4" data-path="naive-bayes.html"><a href="naive-bayes.html#procedimiento-con-r-la-funcion-naive_bayes"><i class="fa fa-check"></i><b>28.4</b> Procedimiento con R: la funcion <code>naive_bayes</code></a></li>
<li class="chapter" data-level="28.5" data-path="naive-bayes.html"><a href="naive-bayes.html#aplicación-del-modelo-naive-bayes"><i class="fa fa-check"></i><b>28.5</b> Aplicación del modelo Naive Bayes</a>
<ul>
<li class="chapter" data-level="" data-path="naive-bayes.html"><a href="naive-bayes.html#resumen-8"><i class="fa fa-check"></i>Resumen</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="29" data-path="bagging.-random-forest.html"><a href="bagging.-random-forest.html"><i class="fa fa-check"></i><b>29</b> Bagging. Random Forest </a>
<ul>
<li class="chapter" data-level="29.1" data-path="bagging.-random-forest.html"><a href="bagging.-random-forest.html#introducción-metodos-de-ensamble"><i class="fa fa-check"></i><b>29.1</b> Introducción: Metodos de Ensamble</a></li>
<li class="chapter" data-level="29.2" data-path="bagging.-random-forest.html"><a href="bagging.-random-forest.html#bagging"><i class="fa fa-check"></i><b>29.2</b> Bagging</a></li>
<li class="chapter" data-level="29.3" data-path="bagging.-random-forest.html"><a href="bagging.-random-forest.html#procedimiento-con-r-la-función-bagging"><i class="fa fa-check"></i><b>29.3</b> Procedimiento con R: la función <code>bagging</code> </a></li>
<li class="chapter" data-level="29.4" data-path="bagging.-random-forest.html"><a href="bagging.-random-forest.html#implementando-bagging-en-r"><i class="fa fa-check"></i><b>29.4</b> Implementando bagging en R</a>
<ul>
<li class="chapter" data-level="29.4.1" data-path="bagging.-random-forest.html"><a href="bagging.-random-forest.html#interpretación-de-variables-en-el-bagging"><i class="fa fa-check"></i><b>29.4.1</b> Interpretación de variables en el bagging</a></li>
</ul></li>
<li class="chapter" data-level="29.5" data-path="bagging.-random-forest.html"><a href="bagging.-random-forest.html#random-forest"><i class="fa fa-check"></i><b>29.5</b> Random Forest</a>
<ul>
<li class="chapter" data-level="29.5.1" data-path="bagging.-random-forest.html"><a href="bagging.-random-forest.html#número-de-árboles-k"><i class="fa fa-check"></i><b>29.5.1</b> Número de árboles (<span class="math inline">\(K\)</span>)</a></li>
<li class="chapter" data-level="29.5.2" data-path="bagging.-random-forest.html"><a href="bagging.-random-forest.html#número-de-variables-a-considerar-mtry"><i class="fa fa-check"></i><b>29.5.2</b> Número de variables a considerar (<span class="math inline">\(mtry\)</span>)</a></li>
<li class="chapter" data-level="29.5.3" data-path="bagging.-random-forest.html"><a href="bagging.-random-forest.html#complejidad-de-los-árboles"><i class="fa fa-check"></i><b>29.5.3</b> Complejidad de los árboles</a></li>
<li class="chapter" data-level="29.5.4" data-path="bagging.-random-forest.html"><a href="bagging.-random-forest.html#esquema-de-muestreo"><i class="fa fa-check"></i><b>29.5.4</b> Esquema de muestreo</a></li>
<li class="chapter" data-level="29.5.5" data-path="bagging.-random-forest.html"><a href="bagging.-random-forest.html#regla-de-división"><i class="fa fa-check"></i><b>29.5.5</b> Regla de división</a></li>
</ul></li>
<li class="chapter" data-level="29.6" data-path="bagging.-random-forest.html"><a href="bagging.-random-forest.html#procedimiento-con-r-la-función-randomforest"><i class="fa fa-check"></i><b>29.6</b> Procedimiento con R: la función <code>randomForest</code></a></li>
<li class="chapter" data-level="29.7" data-path="bagging.-random-forest.html"><a href="bagging.-random-forest.html#aplicación-del-modelo-random-forest-en-r"><i class="fa fa-check"></i><b>29.7</b> Aplicación del modelo Random Forest en R</a>
<ul>
<li class="chapter" data-level="29.7.1" data-path="bagging.-random-forest.html"><a href="bagging.-random-forest.html#aplicación-del-random-forest"><i class="fa fa-check"></i><b>29.7.1</b> Aplicación del Random Forest</a></li>
<li class="chapter" data-level="" data-path="bagging.-random-forest.html"><a href="bagging.-random-forest.html#resumen-9"><i class="fa fa-check"></i>Resumen</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="30" data-path="boosting.-xgboost..html"><a href="boosting.-xgboost..html"><i class="fa fa-check"></i><b>30</b> Boosting. XGBoost.</a>
<ul>
<li class="chapter" data-level="30.1" data-path="boosting.-xgboost..html"><a href="boosting.-xgboost..html#introducción.-boosting."><i class="fa fa-check"></i><b>30.1</b> Introducción. Boosting.</a></li>
<li class="chapter" data-level="30.2" data-path="boosting.-xgboost..html"><a href="boosting.-xgboost..html#gradient-boosting"><i class="fa fa-check"></i><b>30.2</b> Gradient Boosting</a>
<ul>
<li class="chapter" data-level="30.2.1" data-path="boosting.-xgboost..html"><a href="boosting.-xgboost..html#hiperparámetros-del-modelo-gradient-boosting"><i class="fa fa-check"></i><b>30.2.1</b> Hiperparámetros del modelo gradient boosting</a></li>
<li class="chapter" data-level="30.2.2" data-path="boosting.-xgboost..html"><a href="boosting.-xgboost..html#estrategia-de-ajuste-de-hiperparametros"><i class="fa fa-check"></i><b>30.2.2</b> Estrategia de ajuste de hiperparametros</a></li>
</ul></li>
<li class="chapter" data-level="30.3" data-path="boosting.-xgboost..html"><a href="boosting.-xgboost..html#procedimiento-con-r-la-funcion-gbm"><i class="fa fa-check"></i><b>30.3</b> Procedimiento con R: la funcion <code>gbm</code></a></li>
<li class="chapter" data-level="30.4" data-path="boosting.-xgboost..html"><a href="boosting.-xgboost..html#aplicación-del-modelo-gbm-en-r"><i class="fa fa-check"></i><b>30.4</b> Aplicación del modelo GBM en R</a>
<ul>
<li class="chapter" data-level="30.4.1" data-path="boosting.-xgboost..html"><a href="boosting.-xgboost..html#gbm-con-ajuste-automático"><i class="fa fa-check"></i><b>30.4.1</b> GBM con ajuste automático</a></li>
</ul></li>
<li class="chapter" data-level="30.5" data-path="boosting.-xgboost..html"><a href="boosting.-xgboost..html#extreme-gradient-boosting-xgb"><i class="fa fa-check"></i><b>30.5</b> eXtreme Gradient Boosting (XGB)</a>
<ul>
<li class="chapter" data-level="30.5.1" data-path="boosting.-xgboost..html"><a href="boosting.-xgboost..html#hiperparametros-del-modelo-xgboost"><i class="fa fa-check"></i><b>30.5.1</b> Hiperparametros del modelo XGBoost</a></li>
</ul></li>
<li class="chapter" data-level="30.6" data-path="boosting.-xgboost..html"><a href="boosting.-xgboost..html#procedimiento-con-r-la-funcion-xgboost"><i class="fa fa-check"></i><b>30.6</b> Procedimiento con R: la funcion <code>xgboost</code></a></li>
<li class="chapter" data-level="30.7" data-path="boosting.-xgboost..html"><a href="boosting.-xgboost..html#aplicación-del-módelo-xgboost-en-r"><i class="fa fa-check"></i><b>30.7</b> Aplicación del módelo XGBoost en R</a>
<ul>
<li class="chapter" data-level="30.7.1" data-path="boosting.-xgboost..html"><a href="boosting.-xgboost..html#xgboost-y-ajuste-automático"><i class="fa fa-check"></i><b>30.7.1</b> XGBoost y ajuste automático</a></li>
<li class="chapter" data-level="" data-path="boosting.-xgboost..html"><a href="boosting.-xgboost..html#resumen-10"><i class="fa fa-check"></i>Resumen</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://blog.uclm.es/tp-mbsba/"> Ciencia de datos con R </a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Fundamentos de ciencia de datos con R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="modelos-aditivos-generalizados" class="section level1 hasAnchor" number="17">
<h1><span class="header-section-number">Capítulo 17</span> Modelos aditivos generalizados<a href="modelos-aditivos-generalizados.html#modelos-aditivos-generalizados" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p><em>María Durbán y Víctor Casero</em></p>
<div id="introducción-7" class="section level2 hasAnchor" number="17.1">
<h2><span class="header-section-number">17.1</span> Introducción<a href="modelos-aditivos-generalizados.html#introducción-7" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Los modelos lineales, o los lineales generalizados (GLM), vistos en
capítulos anteriores son deseables porque son simples de ajustar, se
entienden fácilmente, y se dispone de técnicas para contrastar las
hipótesis del modelo. Sin embargo, cuando los datos no están
relacionados de forma lineal con las variables explicativas no tiene
sentido utilizar los modelos de regresión lineal, se necesitan modelos
que flexibilicen esta relación, que se puede expresar así:
<span class="math display">\[Y=\beta_0+f(X)+\varepsilon\]</span></p>
<p>Puede que la función <span class="math inline">\(f()\)</span> sea conocida de antemano, como ocurre en
muchos modelos biológicos, donde existe una dependencia de tipo
exponencial, <span class="math inline">\(f(x)=e^{\beta_0+\beta_1x}.\)</span> En otras ocasiones dicha
función es desconocida y se puede utilizar una aproximación. Por
ejemplo, la muy utilizada regresión polinómica:
<span class="math display" id="eq:polinom">\[\begin{equation}
Y = \beta_0 + \beta_1 X + \beta_2 X^2 + \ldots + \beta_p X^p + \varepsilon, \quad \varepsilon \sim \mathcal{N}(0,\sigma^2)
\tag{17.1}
\end{equation}\]</span></p>
<p>Sin embargo, la regresión polinómica tiene un gran inconveniente, que no
se realiza a nivel local: cada vez que se cambia un coeficiente del
modelo, el cambio impacta a los valores ajustados en todo el rango de la
variable explicativa.</p>
<p>La alternativa es utilizar <em>suavizadores</em> de las variables explicativas. Se define así el <strong>modelo aditivo</strong> (en el caso de variable respuesta Gaussiana) para al menos dos variables explicativas:
<span class="math display">\[Y= f(X_{1})+\ldots +f(X_j)+\epsilon.\]</span>
Las funciones <span class="math inline">\(f\)</span> incluyen también a las funciones lineales vistas en el Capítulo 16.
Los modelos aditivos generalizados, GAM, extienden lo anterior a respuestas no gaussianas, como lo hacen los GLMs respecto de los modelos lineales con respuesta gaussiana (véase el Capítulo 17).</p>
</div>
<div id="splines-con-penalizaciones" class="section level2 hasAnchor" number="17.2">
<h2><span class="header-section-number">17.2</span> Splines con penalizaciones<a href="modelos-aditivos-generalizados.html#splines-con-penalizaciones" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Las técnicas de suavizado tienen como objetivo extraer las tendencias (o
señales) subyacentes en los datos. Un suavizador o <em>smoother</em> es una
herramienta que representa la tendencia de la variable respuesta <span class="math inline">\(Y\)</span>
como función de una o más variables predictoras. Tiene menos
variabilidad que <span class="math inline">\(Y\)</span>, por eso se le llama suavizador (la regresión
lineal es una suavizador llevado al extremo). La curva en un punto dado
sólo depende de las observaciones en ese punto y de las observaciones
vecinas. Estás son algunas de las técnicas de regresión no-paramétrica
existentes:</p>
<ol style="list-style-type: decimal">
<li>Regresión polinomial local con pesos, <em>lowess</em>.</li>
<li>Kernels.</li>
<li>Splines.</li>
</ol>
<p>Este libro se centra en el caso de los Splines que son los suavizadores más utilizados y en particular en los splines con penalizaciones (<em>P-splines</em>). Estos se basan en representar la función <span class="math inline">\(f\)</span> mediante una base de funciones y añadir una penalización a la hora de estimar el modelo de manera que se pueda controlar la variabilidad de la curva que se quiere estimar. Hay muchas maneras de representar una función a través de una base, una de las mejores opciones es el uso de los B-splines <span class="citation">(<a href="#ref-boor01" role="doc-biblioref"><strong>boor01?</strong></a>)</span> por sus buenas propiedades numéricas. La penalización se construye a partir de la derivada de la curva que se quiere penalizar, en general, se utilizan penalizaciones de orden 2 lo que implica que se está penalizando todo aquello que no es lineal en la función, es decir, si la penalización es muy grande la curva estimada sería simplemente una línea recta. La penalización está controlada por un parámetros llamado <strong>parámetro de suavizado</strong>.</p>
<p>A la hora de ajustar este tipo de modelos hay dos elecciones importantes:</p>
<ul>
<li>Tamaño de la base: la mayoría de los
autores utilizan como regla:
<span class="math display">\[ \text{número de nodos}=min\{40,\text{valores únicos de }x/4\}\]</span> (por ejemplo si se tienen 100 datos, se elegirían 100/4=25 nodos)</li>
<li>Parámetro de suavizado: Se elegirá utilizando máxima verosimilitud junto con el resto de parámetros del modelo. La Figura <a href="modelos-aditivos-generalizados.html#fig:psplines">17.1</a> muestra el impacto que el parámetro de suavizado tiene en el ajuste final de la curva (los datos corresponden al dataset <code>fossil</code> del paquete <code>Semipar</code>).</li>
</ul>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:psplines"></span>
<img src="Ciencia_de_datos_con_r_files/figure-html/psplines-1.png" alt="Regresión con P-splines  para diferentes valores del parámetro de suavizado" width="60%" />
<p class="caption">
Figura 17.1: Regresión con P-splines para diferentes valores del parámetro de suavizado
</p>
</div>
</div>
<div id="aspectos-metodológicos" class="section level2 hasAnchor" number="17.3">
<h2><span class="header-section-number">17.3</span> Aspectos metodológicos<a href="modelos-aditivos-generalizados.html#aspectos-metodológicos" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Al igual que en el caso de los modelos lineales y los modelos GLM, en los modelos GAM es necesario conocer algunos aspectos metodológicos que son fundamentales llevar a cabo un ajuste correcto de los modelos, y entender los resultados obtenidos en el ajuste. A continuación se muestran los más relevantes</p>
<div id="estimación-de-los-paraámetros-del-modelo" class="section level3 hasAnchor" number="17.3.1">
<h3><span class="header-section-number">17.3.1</span> Estimación de los paraámetros del modelo<a href="modelos-aditivos-generalizados.html#estimación-de-los-paraámetros-del-modelo" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>La estimación de los modelos GAM se lleva a cabo mediante máxima verosimilitud penalizada. Supóngase el caso de una sola variable explicativa y se quiere ajustar el modelo:
<span class="math display">\[Y= f(X)+\epsilon.\]</span>
Como se comentó anteriormente, los modelos GAM tiene como punto de partida la representación básica de funciones, es decir, se busca
transformar el modelo de tal forma que <span class="math inline">\(f(X)\)</span> sea el producto de una
matriz multiplicada por unos coeficientes, es decir, se elige una <em>base</em>
(una matriz <span class="math inline">\(\textbf{B}\)</span>) que permita escribir la función <span class="math inline">\(f\)</span> como una
combinación lineal de sus elementos (los elementos de esta base son
conocidos)
<span class="math display">\[f(X)=\sum_{j=1}^k b_j(X)\beta_j,\]</span>
o en forma matricial:
<span class="math display">\[f(X)=\textbf{B}\boldsymbol{\beta}.\]</span>
y los parámetros <span class="math inline">\(\boldsymbol{\beta}\)</span> se estiman minimizando la siguiente expresión:
<span class="math display">\[(\boldsymbol{y}-\boldsymbol{B}\boldsymbol{\theta})^\prime(\boldsymbol{y}-\boldsymbol{B}\boldsymbol{\theta}) + \lambda\boldsymbol{P},\]</span></p>
<p>Donde <span class="math inline">\(\boldsymbol{P}\)</span> es la matriz de penalización y <span class="math inline">\(\lambda\)</span> es el parámetro de suavizado. Dado un parámetro de suavizado, los parámetros estimados vienen dados por:
<span class="math display">\[\hat{\boldsymbol{\theta}} = (\boldsymbol{B}^T \boldsymbol{B} +\lambda \boldsymbol{P} )^{-1}\boldsymbol{B}^\prime\boldsymbol{y}\]</span>
y los valores ajustados se obtendrían como: <span class="math inline">\(\hat{ \boldsymbol{y}}= \underbrace{\boldsymbol{B}(\boldsymbol{B}^T\boldsymbol{B} +\lambda \boldsymbol{P} )^{-1}\boldsymbol{B}^\prime}_{\boldsymbol{H}}\boldsymbol{y}\)</span>. La matriz <span class="math inline">\(\boldsymbol{H}\)</span> juega un papel importante ya que la suma de su diagonal da una idea de cómo de compleja es la curva ajustada, es lo que se llaman los <em>grados de libertad efectivos</em> (los cuales no se corresponden al número de parámetros ajustados).</p>
</div>
<div id="inferencia-sobre-las-funciones-suaves" class="section level3 hasAnchor" number="17.3.2">
<h3><span class="header-section-number">17.3.2</span> Inferencia sobre las funciones suaves<a href="modelos-aditivos-generalizados.html#inferencia-sobre-las-funciones-suaves" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Si nuestro interés es saber si existe una relación estadísticamente
significativa entre la variable explicativa <span class="math inline">\(X_j\)</span> y la variable
respuesta <span class="math inline">\(Y\)</span>:
<span class="math display">\[\begin{eqnarray*}
H_0: f_j=0  &amp; \text{ (no efecto)}\\
H_1: f_j\neq 0 &amp; \text{ (efecto)}
\end{eqnarray*}\]</span></p>
<ul>
<li><p>Dado que las funciones <span class="math inline">\(f_j\)</span> dependen de los coeficientes que
acompañan a las bases de B-splines, el contraste anterior es
equivalente a:
<span class="math display">\[\begin{eqnarray*}
H_0: \theta_j=0 &amp; \forall j \\
H_1: \theta_j\neq 0 &amp; \text{ para al menos un }j
\end{eqnarray*}\]</span>
La distribución del estadístico de contraste dependerá de si la variable
respuesta sigue una distribución Normal o no:</p></li>
<li><p>Si los datos son Normales, el estadístico de contraste sigue un
distribución <span class="math inline">\(F\)</span>.</p></li>
<li><p>En otro caso sigue una distribución <span class="math inline">\(\chi^2\)</span>.</p></li>
</ul>
<p><strong>Comparación de modelos</strong></p>
<ol style="list-style-type: decimal">
<li><p>Modelos Anidados. La comparación se basa, al igual que en los GLM,
en la diferencia en la <em>deviance</em> residual. Si se quieren comparar dos
modelos <span class="math inline">\(m_1\)</span> y <span class="math inline">\(m_2\)</span> (donde <span class="math inline">\(m_1\subset m_2\)</span>), entonces:</p>
<ul>
<li>En el caso de datos Normales:
<span class="math display">\[\frac{(DR(m_1)-DR(m_2))/(df_2-df_1)}{DR(m_2)/(n-df_2)}\approx F_{(df_2-df_1), (n-df_2)}\]</span></li>
</ul>
<p>donde <span class="math inline">\(DR\)</span> es la deviance residual (Suma de cuadrados residual) y
<span class="math inline">\(df\)</span> son los grados de libertad asociados con cada modelo.</p>
<ul>
<li>En otro caso: <span class="math display">\[ DR^*(m_1)-DR^*(m_2)\approx \chi^2_{df_2-df_1}\]</span>
donde <span class="math inline">\(DR^*\)</span> es la deviance residual escalada.</li>
</ul></li>
<li><p>Modelos no anidados</p>
<p>En este caso los contrastes anteriores no son válidos y se
utilizarán criterios basados en el AIC (Criterio de Información de Akaike).</p></li>
</ol>
</div>
<div id="suavizado-mutidimensional-y-para-datos-no-gaussianos" class="section level3 hasAnchor" number="17.3.3">
<h3><span class="header-section-number">17.3.3</span> Suavizado mutidimensional y para datos no Gaussianos<a href="modelos-aditivos-generalizados.html#suavizado-mutidimensional-y-para-datos-no-gaussianos" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Para el suavizado en 2 dimensiones (o más) también se necesita una base y una penalización. El modelo sería:
<span class="math display">\[\boldsymbol{Y} =  f\left(\boldsymbol{X}_{1},\boldsymbol{X}_{2}\right)+\epsilon_i \]</span>
donde <span class="math inline">\(f()\)</span> es una función suave de las dos covariables <span class="math inline">\(\boldsymbol{X}_{1}\)</span> y <span class="math inline">\(\boldsymbol{X}_{2}\)</span>.
Dicha función se aproxima mediante el producto tensorial de las bases de
B-splines marginales para cada una de las covariables. los términos de suavizado multidimensional se pueden combinar con términos unidimensionales y términos lineales.</p>
<p>La extensión de los modelos de suavizado al caso en el que la variable
respuesta es no Gaussiana, se hace de forma similar al caso lineal,
cuando se pasa de un modelo de regresión lineal a un GLM.</p>
<ul>
<li>Como en el caso de los GLMs <span class="math inline">\(g(\boldsymbol{\mu})=\boldsymbol{\eta}=f(\boldsymbol{X})=\boldsymbol{B} \boldsymbol{\beta}\)</span></li>
<li>Se añade la penalización a la función de verosimilitud
<span class="math display">\[\ell_p(\beta)=\ell(\beta)+\lambda \beta^T P \beta ,\]</span>
donde <span class="math inline">\(\ell(\beta)\)</span> es la log-verosimilitud.</li>
</ul>
</div>
</div>
<div id="la-función-gam-del-paquete-mgcv" class="section level2 hasAnchor" number="17.4">
<h2><span class="header-section-number">17.4</span> La función <code>gam</code> del paquete <code>mgcv</code><a href="modelos-aditivos-generalizados.html#la-función-gam-del-paquete-mgcv" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Aunque hay muchas librerías disponibles la principal es <code>mgcv</code> que
implementa una gran variedad de modelos de suavizado a través de la
función <code>gam</code> (generalized additive models). La principal referencia
para esta sección es el libro de <span class="citation">(<a href="#ref-Wood06book" role="doc-biblioref"><strong>Wood06book?</strong></a>)</span>.</p>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="modelos-aditivos-generalizados.html#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gam</span>(formula, <span class="at">method =</span> <span class="st">&quot;&quot;</span>, <span class="at">select =</span> <span class="st">&quot;&quot;</span>, <span class="at">family =</span> <span class="fu">gaussian</span>())</span></code></pre></div>
<ul>
<li><code>formula</code> es el argumento principal de esta función, es la ecuación
del modelo: por ejemplo, <code>y ~ x1+x2+s(x3)</code>.
<ul>
<li>Lo primero que se tiene que elegir es la base a utilizar para
representar las funciones suaves, <code>s(x)</code> (ver <code>?s</code> o
<code>?smooth.terms</code>), o <code>te(x1,x2)</code> en el caso de suavizado multidimensional. Por defecto son los llamados thin plate splines.<br />
El tipo de base usada se puede modificar utilizando el argumento
<code>bs</code> dentro de <code>s(x, bs = "ps")</code>, en este caso <code>ps</code> indica el uso de
B-splines con penalizaciones. En la siguiente tabla se describen
otras alternativas:</li>
</ul></li>
</ul>
<table>
<thead>
<tr class="header">
<th><strong><code>bs</code> </strong></th>
<th><strong>Descripción</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>"tp"</code></td>
<td>Thin Plate Regression Splines</td>
</tr>
<tr class="even">
<td><code>"ts"</code></td>
<td>Thin Plate Regression Splines con regularización</td>
</tr>
<tr class="odd">
<td><code>"\cr"</code></td>
<td>Spline cúbicos de regresión</td>
</tr>
<tr class="even">
<td><code>" crs"</code></td>
<td>Spline cúbicos de regresión con regularización</td>
</tr>
<tr class="odd">
<td><code>" cc"</code></td>
<td>Spline cíclicos</td>
</tr>
<tr class="even">
<td><code>"ps"</code></td>
<td>P-splines</td>
</tr>
</tbody>
</table>
<ul>
<li><code>m</code> orden de la penalización, por defecto es 2.</li>
<li><code>k</code> número de nodos para construir la base. El número por defecto
suele ser demasiado bajo por lo que siempre se recomienda que el
usuario elija el número.</li>
<li><code>by</code> una variable numérica o factor de la misma dimensión de cada
covariable que permite hacer interacciones entre curvas y variables</li>
<li><code>id</code> se utiliza para forzar que diferentes términos suaves utilicen
la misma base y la misma cantidad de suavizado</li>
<li><code>method</code> método para estimar el parámetro de suavizado, se puede
elegir entre: <code>REML</code>, <code>ML</code>, <code>GCV.Cp</code>, <code>GACV.Cp</code> (en la práctica se
prefiere “REML”)</li>
<li><code>family</code> permite elegir la distribución de los datos (binomial,
Poisson, etc.), por defecto asume datos Gaussianos.</li>
<li><code>select=TRUE</code> : Contrasta si la variable debe entrar o no en el modelo</li>
</ul>
</div>
<div id="casos-prácticos-1" class="section level2 hasAnchor" number="17.5">
<h2><span class="header-section-number">17.5</span> Casos prácticos<a href="modelos-aditivos-generalizados.html#casos-prácticos-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>En este apartado se verán una serie de aplicaciones que permiten
mostrar los diferentes usos de este tipo de modelos.</p>
<div id="modelo-unidimensional-con-fossil" class="section level3 hasAnchor" number="17.5.1">
<h3><span class="header-section-number">17.5.1</span> Modelo unidimensional con <code>fossil</code><a href="modelos-aditivos-generalizados.html#modelo-unidimensional-con-fossil" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Se empezará ilustrando el uso de la función <code>gam</code> con el conjunto de datos <code>fossil</code> del paquete <code>SemiPar</code>.
El objetivo es estimar la relación entre la edad de los fósiles y la proporción de isotopos de estroncio.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:tsfossil"></span>
<img src="Ciencia_de_datos_con_r_files/figure-html/tsfossil-1.png" alt="Edad de fósiles con respecto a la proporción de isótopos de estroncio" width="60%" />
<p class="caption">
Figura 17.2: Edad de fósiles con respecto a la proporción de isótopos de estroncio
</p>
</div>
<p>A la vista de la Figura <a href="modelos-aditivos-generalizados.html#fig:tsfossil">17.2</a>, es claro que se necesita
ajustar una curva (y no una línea) para estimar la relación entre ambas
variables. Para ello se utiliza la función <code>gam</code> que devuelve un objeto de tipo <code>"gam"</code>, que se puede usar
con las típicas funciones <code>print</code>, <code>summary</code>, <code>fitted</code>, <code>plot</code>, <code>residuals</code>,
etc…</p>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="modelos-aditivos-generalizados.html#cb195-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mgcv)</span>
<span id="cb195-2"><a href="modelos-aditivos-generalizados.html#cb195-2" aria-hidden="true" tabindex="-1"></a>fit.gam <span class="ot">&lt;-</span> <span class="fu">gam</span>(Y <span class="sc">~</span> <span class="fu">s</span>(X, <span class="at">k =</span> <span class="dv">25</span>, <span class="at">bs =</span> <span class="st">&quot;ps&quot;</span>), <span class="at">method =</span> <span class="st">&quot;REML&quot;</span>, <span class="at">select =</span> <span class="cn">TRUE</span>)</span>
<span id="cb195-3"><a href="modelos-aditivos-generalizados.html#cb195-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.gam)</span>
<span id="cb195-4"><a href="modelos-aditivos-generalizados.html#cb195-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb195-5"><a href="modelos-aditivos-generalizados.html#cb195-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Family: gaussian </span></span>
<span id="cb195-6"><a href="modelos-aditivos-generalizados.html#cb195-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Link function: identity </span></span>
<span id="cb195-7"><a href="modelos-aditivos-generalizados.html#cb195-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb195-8"><a href="modelos-aditivos-generalizados.html#cb195-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Formula:</span></span>
<span id="cb195-9"><a href="modelos-aditivos-generalizados.html#cb195-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Y ~ s(X, k = 25, bs = &quot;ps&quot;)</span></span>
<span id="cb195-10"><a href="modelos-aditivos-generalizados.html#cb195-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb195-11"><a href="modelos-aditivos-generalizados.html#cb195-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Parametric coefficients:</span></span>
<span id="cb195-12"><a href="modelos-aditivos-generalizados.html#cb195-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;              Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb195-13"><a href="modelos-aditivos-generalizados.html#cb195-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept) 7.074e+03  2.435e-02  290504   &lt;2e-16 ***</span></span>
<span id="cb195-14"><a href="modelos-aditivos-generalizados.html#cb195-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb195-15"><a href="modelos-aditivos-generalizados.html#cb195-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb195-16"><a href="modelos-aditivos-generalizados.html#cb195-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb195-17"><a href="modelos-aditivos-generalizados.html#cb195-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Approximate significance of smooth terms:</span></span>
<span id="cb195-18"><a href="modelos-aditivos-generalizados.html#cb195-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        edf Ref.df     F p-value    </span></span>
<span id="cb195-19"><a href="modelos-aditivos-generalizados.html#cb195-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; s(X) 10.22     24 35.89  &lt;2e-16 ***</span></span>
<span id="cb195-20"><a href="modelos-aditivos-generalizados.html#cb195-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb195-21"><a href="modelos-aditivos-generalizados.html#cb195-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb195-22"><a href="modelos-aditivos-generalizados.html#cb195-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb195-23"><a href="modelos-aditivos-generalizados.html#cb195-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; R-sq.(adj) =  0.891   Deviance explained = 90.2%</span></span>
<span id="cb195-24"><a href="modelos-aditivos-generalizados.html#cb195-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -REML = 23.946  Scale est. = 0.062849  n = 106</span></span></code></pre></div>
<p>Como se puede ver se han especificado la variable respuesta (Y, proporción de estroncio) y la variable explicativa (X, edad) mediante un <em>spline</em>, <code>s()</code>, de tipo penalizado, <code>ps</code>, con 25 nodos, indicando <code>REML</code> como método para estimar el parámetro de suavizado.</p>
<p>De las 2 partes de la salida anterior, en la primera aparecen los términos
que entran como lineales en el modelo (en este caso solo la ordenada en
el origen) y en la parte de abajo aparecen los términos de suavizado.
Como se indicó anteriormente, dado que se ha usado <code>select=TRUE</code>, se está contrastando si la variable <code>edad</code> debe entrar en el modelo o no. En este caso es
claro que ha de entrar ya que el p-valor de <code>s(x)</code> pequeño y los grados de libertad asociados son aproximadamente 10, lo que indica que está lejos de la linealidad.</p>
<p>La función <code>gam.check</code> devuelve los gráficos de residuos usuales
(residuos frente a valores ajustados, gráficos de cuantiles para
comprobar la normalidad, etc.), pero además da información sobre el
proceso de ajuste del modelo.</p>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="modelos-aditivos-generalizados.html#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gam.check</span>(fit.gam)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig8"></span>
<img src="Ciencia_de_datos_con_r_files/figure-html/fig8-1.png" alt="Gráficos de residuos obtenidos con `gam.check` " width="60%" />
<p class="caption">
Figura 17.3: Gráficos de residuos obtenidos con <code>gam.check</code>
</p>
</div>
<pre><code>#&gt; 
#&gt; Method: REML   Optimizer: outer newton
#&gt; full convergence after 5 iterations.
#&gt; Gradient range [-4.557319e-06,5.900236e-06]
#&gt; (score 23.94602 &amp; scale 0.06284944).
#&gt; Hessian positive definite, eigenvalue range [4.557347e-06,53.03185].
#&gt; Model rank =  25 / 25 
#&gt; 
#&gt; Basis dimension (k) checking results. Low p-value (k-index&lt;1) may
#&gt; indicate that k is too low, especially if edf is close to k&#39;.
#&gt; 
#&gt;        k&#39;  edf k-index p-value
#&gt; s(X) 24.0 10.2    1.03    0.59</code></pre>
<p>El test que aparece en la parte de abajo está contrastando si el número
de nodos elegido es suficiente. Si el valor de <code>k</code> está muy próximo a
<code>edf</code> entonces se debería reajustar el modelo con más nodos.</p>
<p>Si se quiere dibujar la función suave se utiliza el comando
<code>plot()</code>.</p>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="modelos-aditivos-generalizados.html#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit.gam, <span class="at">shade =</span> <span class="cn">TRUE</span>, <span class="at">seWithMean =</span> <span class="cn">TRUE</span>, <span class="at">pch =</span> <span class="dv">19</span>, <span class="dv">1</span>, <span class="at">cex =</span> .<span class="dv">55</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig9"></span>
<img src="Ciencia_de_datos_con_r_files/figure-html/fig9-1.png" alt="Curva ajustada e intervalo de confianza" width="60%" />
<p class="caption">
Figura 17.4: Curva ajustada e intervalo de confianza
</p>
</div>
</div>
<div id="modelo-aditivo-con-airquality" class="section level3 hasAnchor" number="17.5.2">
<h3><span class="header-section-number">17.5.2</span> Modelo aditivo con <code>airquality</code><a href="modelos-aditivos-generalizados.html#modelo-aditivo-con-airquality" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>En esta sección se analizan de nuevo los datos <code>airquality</code> (ver ?airquality<a href="#fn57" class="footnote-ref" id="fnref57"><sup>57</sup></a>) que
consisten en 154 medidas de calidad del aire en Nueva
York, de Mayo a Septiembre 1973. El objetivo es establecer la relación entre las variables meteorológicas
y la cantidad de ozono en la atmósfera. Ya se ha analizado la relación en el Capítulo 16 de Modelos lineales, donde los ajustes lineales realizados eran satisfactorios, pero se encontraban problemas en los residuos del modelo, que no daban validez a dicha modelización. Allí se sugería que la relación entre la variable respuesta y alguna explicativa fuese no lineal. Además se consideró la transformación logarítmica de la variable <code>Ozone</code>, que adolece de simetría, y con dicha trasformación se obtenía una distribución más similar a la distribución Normal.</p>
<p>Por lo tanto se va a ajustar el modelo incluyendo las variables explicativas de forma suave, en particular se van a incluir las variables <code>Wind</code>, <code>Temp</code> y <code>Solar.R</code>.
Las variable <code>Wind</code> y <code>Temp</code> tienen sólo 31 y 40 valores únicos respectivamente, aunque el dataset tiene 154 valores, por eso se decide utilizar 10 nodos y no más, mientras que para la variable <code>Solar.R</code> se utilizan 20.</p>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="modelos-aditivos-generalizados.html#cb199-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-2"><a href="modelos-aditivos-generalizados.html#cb199-2" aria-hidden="true" tabindex="-1"></a>airq.gam <span class="ot">&lt;-</span> <span class="fu">gam</span>(</span>
<span id="cb199-3"><a href="modelos-aditivos-generalizados.html#cb199-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">log</span>(Ozone) <span class="sc">~</span> <span class="fu">s</span>(Wind, <span class="at">bs =</span> <span class="st">&quot;ps&quot;</span>, <span class="at">k =</span> <span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb199-4"><a href="modelos-aditivos-generalizados.html#cb199-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">s</span>(Temp, <span class="at">bs =</span> <span class="st">&quot;ps&quot;</span>, <span class="at">k =</span> <span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb199-5"><a href="modelos-aditivos-generalizados.html#cb199-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">s</span>(Solar.R, <span class="at">bs =</span> <span class="st">&quot;ps&quot;</span>, <span class="at">k =</span> <span class="dv">20</span>),</span>
<span id="cb199-6"><a href="modelos-aditivos-generalizados.html#cb199-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">&quot;REML&quot;</span>, <span class="at">select =</span> <span class="cn">TRUE</span>, <span class="at">data =</span> airquality, <span class="at">na.action =</span> na.omit</span>
<span id="cb199-7"><a href="modelos-aditivos-generalizados.html#cb199-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb199-8"><a href="modelos-aditivos-generalizados.html#cb199-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(airq.gam)</span>
<span id="cb199-9"><a href="modelos-aditivos-generalizados.html#cb199-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb199-10"><a href="modelos-aditivos-generalizados.html#cb199-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Family: gaussian </span></span>
<span id="cb199-11"><a href="modelos-aditivos-generalizados.html#cb199-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Link function: identity </span></span>
<span id="cb199-12"><a href="modelos-aditivos-generalizados.html#cb199-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb199-13"><a href="modelos-aditivos-generalizados.html#cb199-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Formula:</span></span>
<span id="cb199-14"><a href="modelos-aditivos-generalizados.html#cb199-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; log(Ozone) ~ s(Wind, bs = &quot;ps&quot;, k = 10) + s(Temp, bs = &quot;ps&quot;, </span></span>
<span id="cb199-15"><a href="modelos-aditivos-generalizados.html#cb199-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     k = 10) + s(Solar.R, bs = &quot;ps&quot;, k = 20)</span></span>
<span id="cb199-16"><a href="modelos-aditivos-generalizados.html#cb199-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb199-17"><a href="modelos-aditivos-generalizados.html#cb199-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Parametric coefficients:</span></span>
<span id="cb199-18"><a href="modelos-aditivos-generalizados.html#cb199-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb199-19"><a href="modelos-aditivos-generalizados.html#cb199-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)  3.41593    0.04586   74.49   &lt;2e-16 ***</span></span>
<span id="cb199-20"><a href="modelos-aditivos-generalizados.html#cb199-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb199-21"><a href="modelos-aditivos-generalizados.html#cb199-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb199-22"><a href="modelos-aditivos-generalizados.html#cb199-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb199-23"><a href="modelos-aditivos-generalizados.html#cb199-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Approximate significance of smooth terms:</span></span>
<span id="cb199-24"><a href="modelos-aditivos-generalizados.html#cb199-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;              edf Ref.df     F  p-value    </span></span>
<span id="cb199-25"><a href="modelos-aditivos-generalizados.html#cb199-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; s(Wind)    2.318      9 2.255 3.13e-05 ***</span></span>
<span id="cb199-26"><a href="modelos-aditivos-generalizados.html#cb199-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; s(Temp)    1.852      9 6.128  &lt; 2e-16 ***</span></span>
<span id="cb199-27"><a href="modelos-aditivos-generalizados.html#cb199-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; s(Solar.R) 2.145     19 1.397 2.31e-06 ***</span></span>
<span id="cb199-28"><a href="modelos-aditivos-generalizados.html#cb199-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb199-29"><a href="modelos-aditivos-generalizados.html#cb199-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb199-30"><a href="modelos-aditivos-generalizados.html#cb199-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb199-31"><a href="modelos-aditivos-generalizados.html#cb199-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; R-sq.(adj) =  0.689   Deviance explained = 70.7%</span></span>
<span id="cb199-32"><a href="modelos-aditivos-generalizados.html#cb199-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -REML = 86.106  Scale est. = 0.23342   n = 111</span></span></code></pre></div>
<p>Los resultados indican que todas las variables son significativas (p-valores pequeños), estando la variable <code>Temp</code> próxima a la linealidad. El
<span class="math inline">\(R^2\)</span> ajustado es 0.68 por lo que el modelo ajusta moderadamente bien
los datos. La Figura <a href="modelos-aditivos-generalizados.html#fig:fig18">17.5</a> muestra la tres curvas ajustadas,
incluyendo los llamados <em>residuos parciales</em> que corresponden a, por
ejemplo en el caso del gráfico del viento,
<span class="math inline">\(log(Ozone)-\hat \beta_0-\hat f(Temp)- \hat f(Solar.R)\)</span>, es decir, lo
que queda sin explicar después de haber ajustado los demás términos del
modelo.</p>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="modelos-aditivos-generalizados.html#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb200-2"><a href="modelos-aditivos-generalizados.html#cb200-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(airq.gam, <span class="at">residuals =</span> <span class="cn">TRUE</span>, <span class="at">scheme =</span> <span class="dv">1</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig18"></span>
<img src="Ciencia_de_datos_con_r_files/figure-html/fig18-1.png" alt="curvas estimadas para  `Wind`, `Temp` y `Solar` " width="60%" />
<p class="caption">
Figura 17.5: curvas estimadas para <code>Wind</code>, <code>Temp</code> y <code>Solar</code>
</p>
</div>
</div>
<div id="modelo-semiparamétrico-con-onions" class="section level3 hasAnchor" number="17.5.3">
<h3><span class="header-section-number">17.5.3</span> Modelo semiparamétrico con <code>onions</code><a href="modelos-aditivos-generalizados.html#modelo-semiparamétrico-con-onions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Es un caso particular del modelo aditivo anterior pues en este tipo de modelos todas
las variables entran de forma lineal excepto una.
<span class="math display">\[\boldsymbol{Y}= \beta_0 +\beta_1 \boldsymbol{X}_{1}+\ldots +
\beta_{j-1}\boldsymbol{X}_{j-1}+f(\boldsymbol{X}_j)+\epsilon\]</span></p>
<p>La forma de ajustar el modelo es exactamente igual a la
anterior. Pero hay un caso que merece especial interés,
cuando en la parte paramétrica se incluye una variable categórica con
dos o más niveles. Al igual que en el caso de regresión lineal se puede
plantear si se quieren ajustar dos rectas paralelas (modelo aditivo) o
no paralelas (modelo con interacción).</p>
<p>Para ilustrar este caso se acude al data.frame <code>onions</code> (librería
<code>SemiPar</code>). Contiene 84 observaciones de un experimento sobre la
producción de un tipo de cebolla en dos localidades (Purnong Landing y Virginia).
El objetivo es relacionar el logaritmo de la producción de cebollas con
la densidad de plantas por metro cuadrado. El modelo lineal básico
sería:
<span class="math display">\[ \log(\text{yield}_i) = \beta_0 + \beta_1\text{location}_{ij} + \beta_2 \text{dens}_i + \epsilon_i\]</span>
donde
<span class="math display">\[\text{location}_{ij} =
\left\{\begin{array}{cl}
0 &amp; \mbox{si la observación $i$ es de Purnong Landing} \\
1 &amp; \mbox{si la observación $i$ es de Virginia}
\end{array}\right.\]</span></p>
<p>Se comienza por ajustar el siguiente modelo: <span class="math display">\[
\log(\text{yield}_i) = \beta_0 + \beta_1\text{location}_{ij} + f(\text{dens}_i) + \epsilon_i\]</span></p>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="modelos-aditivos-generalizados.html#cb201-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mgcv)</span>
<span id="cb201-2"><a href="modelos-aditivos-generalizados.html#cb201-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(SemiPar)</span>
<span id="cb201-3"><a href="modelos-aditivos-generalizados.html#cb201-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(onions)</span>
<span id="cb201-4"><a href="modelos-aditivos-generalizados.html#cb201-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Se indica a R que la variable location es categórica</span></span>
<span id="cb201-5"><a href="modelos-aditivos-generalizados.html#cb201-5" aria-hidden="true" tabindex="-1"></a>onions<span class="sc">$</span>location <span class="ot">&lt;-</span> <span class="fu">factor</span>(onions<span class="sc">$</span>location)</span>
<span id="cb201-6"><a href="modelos-aditivos-generalizados.html#cb201-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Se recodifica la variable</span></span>
<span id="cb201-7"><a href="modelos-aditivos-generalizados.html#cb201-7" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(onions<span class="sc">$</span>location) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Purnong Landing&quot;</span>, <span class="st">&quot;Virginia&quot;</span>)</span>
<span id="cb201-8"><a href="modelos-aditivos-generalizados.html#cb201-8" aria-hidden="true" tabindex="-1"></a>fit1 <span class="ot">&lt;-</span> <span class="fu">gam</span>(<span class="fu">log</span>(yield) <span class="sc">~</span> location <span class="sc">+</span> <span class="fu">s</span>(dens, <span class="at">k =</span> <span class="dv">20</span>, <span class="at">bs =</span> <span class="st">&quot;ps&quot;</span>),</span>
<span id="cb201-9"><a href="modelos-aditivos-generalizados.html#cb201-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">&quot;REML&quot;</span>, <span class="at">select =</span> <span class="cn">TRUE</span>, <span class="at">data =</span> onions</span>
<span id="cb201-10"><a href="modelos-aditivos-generalizados.html#cb201-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb201-11"><a href="modelos-aditivos-generalizados.html#cb201-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit1)</span>
<span id="cb201-12"><a href="modelos-aditivos-generalizados.html#cb201-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb201-13"><a href="modelos-aditivos-generalizados.html#cb201-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Family: gaussian </span></span>
<span id="cb201-14"><a href="modelos-aditivos-generalizados.html#cb201-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Link function: identity </span></span>
<span id="cb201-15"><a href="modelos-aditivos-generalizados.html#cb201-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb201-16"><a href="modelos-aditivos-generalizados.html#cb201-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Formula:</span></span>
<span id="cb201-17"><a href="modelos-aditivos-generalizados.html#cb201-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; log(yield) ~ location + s(dens, k = 20, bs = &quot;ps&quot;)</span></span>
<span id="cb201-18"><a href="modelos-aditivos-generalizados.html#cb201-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb201-19"><a href="modelos-aditivos-generalizados.html#cb201-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Parametric coefficients:</span></span>
<span id="cb201-20"><a href="modelos-aditivos-generalizados.html#cb201-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                  Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb201-21"><a href="modelos-aditivos-generalizados.html#cb201-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)       4.85011    0.01688  287.39   &lt;2e-16 ***</span></span>
<span id="cb201-22"><a href="modelos-aditivos-generalizados.html#cb201-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; locationVirginia -0.33284    0.02409  -13.82   &lt;2e-16 ***</span></span>
<span id="cb201-23"><a href="modelos-aditivos-generalizados.html#cb201-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb201-24"><a href="modelos-aditivos-generalizados.html#cb201-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb201-25"><a href="modelos-aditivos-generalizados.html#cb201-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb201-26"><a href="modelos-aditivos-generalizados.html#cb201-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Approximate significance of smooth terms:</span></span>
<span id="cb201-27"><a href="modelos-aditivos-generalizados.html#cb201-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           edf Ref.df     F p-value    </span></span>
<span id="cb201-28"><a href="modelos-aditivos-generalizados.html#cb201-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; s(dens) 4.568     19 72.76  &lt;2e-16 ***</span></span>
<span id="cb201-29"><a href="modelos-aditivos-generalizados.html#cb201-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb201-30"><a href="modelos-aditivos-generalizados.html#cb201-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb201-31"><a href="modelos-aditivos-generalizados.html#cb201-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb201-32"><a href="modelos-aditivos-generalizados.html#cb201-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; R-sq.(adj) =  0.946   Deviance explained = 94.9%</span></span>
<span id="cb201-33"><a href="modelos-aditivos-generalizados.html#cb201-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -REML = -54.242  Scale est. = 0.011737  n = 84</span></span></code></pre></div>
<p>En este caso se ve que en la parte lineal aparecen dos parámetros, ambos significativos, la
ordenada en el origen y el parámetro que corresponde a la variable
categórica <code>location</code>, concretamente el parámetro correspondiente a la
categoría Virginia que es negativo indicando que la producción media para la
otra localidad es mayor que la producción media en Virginia. El término
de suavizado es significativo también.</p>
<p>En este caso si se utiliza la función <code>plot.gam</code>, sólo dibujará una
curva, pues las curvas para las dos localizaciones son paralelas y la
diferencia entre ellas es igual al valor del parámetro de la variable
localización. Para dibujar las curvas para cada localización se utiliza
la función <code>plot_smooth</code> de la librería <code>tidymv</code>, los argumentos son,
primero el modelo, después la variable con respecto a la que se está
ajustando la curva y por último la variable categórica.</p>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="modelos-aditivos-generalizados.html#cb202-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidymv)</span>
<span id="cb202-2"><a href="modelos-aditivos-generalizados.html#cb202-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_smooths</span>(fit1, dens, location)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig20"></span>
<img src="Ciencia_de_datos_con_r_files/figure-html/fig20-1.png" alt="curvas ajustadas para ambas localidades" width="60%" />
<p class="caption">
Figura 17.6: curvas ajustadas para ambas localidades
</p>
</div>
<p>Asumir curvas paralelas para ambas localidades implica que el descenso
en producción de cebollas a medida que aumenta la densidad de plantas es
el mismo para ambas localidades, y esto no tienen por qué ser cierto,
para relajar esta hipótesis se puede ajustar un modelo con interacción
(de manera similar a lo que se hace en el caso de regresión lineal):
<span class="math display">\[\log(\text{yield}_i) =\beta_0 +  \beta_1\text{location}_{ij} +  f(\text{dens}_i)_{L(j)} + \epsilon_i\]</span>
donde
<span class="math display">\[L(j) =
\left\{\begin{array}{cl}
0 &amp; \mbox{si la $i$-ésima observación es de Purnong Landing} \\
1 &amp; \mbox{si la $i$-ésima observación es de Virginia}
\end{array}\right.\]</span>
Para hacerlo en <code>R</code>, se introduce el argumento <code>by=location</code> dentro de
la curva</p>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="modelos-aditivos-generalizados.html#cb203-1" aria-hidden="true" tabindex="-1"></a>fit2 <span class="ot">&lt;-</span> <span class="fu">gam</span>(<span class="fu">log</span>(yield) <span class="sc">~</span> location <span class="sc">+</span> <span class="fu">s</span>(dens, <span class="at">k =</span> <span class="dv">20</span>, <span class="at">bs =</span> <span class="st">&quot;ps&quot;</span>, <span class="at">by =</span> location),</span>
<span id="cb203-2"><a href="modelos-aditivos-generalizados.html#cb203-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">&quot;REML&quot;</span>, <span class="at">data =</span> onions</span>
<span id="cb203-3"><a href="modelos-aditivos-generalizados.html#cb203-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb203-4"><a href="modelos-aditivos-generalizados.html#cb203-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit2)</span>
<span id="cb203-5"><a href="modelos-aditivos-generalizados.html#cb203-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb203-6"><a href="modelos-aditivos-generalizados.html#cb203-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Family: gaussian </span></span>
<span id="cb203-7"><a href="modelos-aditivos-generalizados.html#cb203-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Link function: identity </span></span>
<span id="cb203-8"><a href="modelos-aditivos-generalizados.html#cb203-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb203-9"><a href="modelos-aditivos-generalizados.html#cb203-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Formula:</span></span>
<span id="cb203-10"><a href="modelos-aditivos-generalizados.html#cb203-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; log(yield) ~ location + s(dens, k = 20, bs = &quot;ps&quot;, by = location)</span></span>
<span id="cb203-11"><a href="modelos-aditivos-generalizados.html#cb203-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb203-12"><a href="modelos-aditivos-generalizados.html#cb203-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Parametric coefficients:</span></span>
<span id="cb203-13"><a href="modelos-aditivos-generalizados.html#cb203-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                  Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb203-14"><a href="modelos-aditivos-generalizados.html#cb203-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)       4.84415    0.01603  302.19   &lt;2e-16 ***</span></span>
<span id="cb203-15"><a href="modelos-aditivos-generalizados.html#cb203-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; locationVirginia -0.33018    0.02270  -14.54   &lt;2e-16 ***</span></span>
<span id="cb203-16"><a href="modelos-aditivos-generalizados.html#cb203-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb203-17"><a href="modelos-aditivos-generalizados.html#cb203-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb203-18"><a href="modelos-aditivos-generalizados.html#cb203-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb203-19"><a href="modelos-aditivos-generalizados.html#cb203-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Approximate significance of smooth terms:</span></span>
<span id="cb203-20"><a href="modelos-aditivos-generalizados.html#cb203-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                                   edf Ref.df     F p-value    </span></span>
<span id="cb203-21"><a href="modelos-aditivos-generalizados.html#cb203-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; s(dens):locationPurnong Landing 3.096  3.834 176.9  &lt;2e-16 ***</span></span>
<span id="cb203-22"><a href="modelos-aditivos-generalizados.html#cb203-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; s(dens):locationVirginia        4.742  5.795 153.0  &lt;2e-16 ***</span></span>
<span id="cb203-23"><a href="modelos-aditivos-generalizados.html#cb203-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb203-24"><a href="modelos-aditivos-generalizados.html#cb203-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb203-25"><a href="modelos-aditivos-generalizados.html#cb203-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb203-26"><a href="modelos-aditivos-generalizados.html#cb203-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; R-sq.(adj) =  0.952   Deviance explained = 95.7%</span></span>
<span id="cb203-27"><a href="modelos-aditivos-generalizados.html#cb203-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -REML = -58.541  Scale est. = 0.010446  n = 84</span></span></code></pre></div>
<p>Ahora aparecen dos términos suaves, uno para cada localidad, de modo que
estas curvas no tienen por qué ser paralelas, sino que cada una se
ajustará a la forma que tengan los datos. En este caso la Figura
<a href="modelos-aditivos-generalizados.html#fig:fig21">17.7</a>, generada de nuevo con <code>plot_smooths</code>, muestra como las curvas se van alejando a medida que
aumenta la densidad de plantas.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig21"></span>
<img src="Ciencia_de_datos_con_r_files/figure-html/fig21-1.png" alt="curvas ajustadas para ambas localidades permitiendo que no sean paralelas" width="60%" />
<p class="caption">
Figura 17.7: curvas ajustadas para ambas localidades permitiendo que no sean paralelas
</p>
</div>
<p>Para finalizar se comparan ambos modelos con el criterio AIC.</p>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="modelos-aditivos-generalizados.html#cb204-1" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(fit1)</span>
<span id="cb204-2"><a href="modelos-aditivos-generalizados.html#cb204-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] -125.2307</span></span>
<span id="cb204-3"><a href="modelos-aditivos-generalizados.html#cb204-3" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(fit2)</span>
<span id="cb204-4"><a href="modelos-aditivos-generalizados.html#cb204-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] -131.2181</span></span></code></pre></div>
<p>Dado que el menor valor se alcanza en el segundo modelo, se escogería el
modelo que incluye la interacción entre la variable densidad y la
localidad.</p>
</div>
<div id="modelo-aditivo-generalizado-y-multidimensional-con-smacker" class="section level3 hasAnchor" number="17.5.4">
<h3><span class="header-section-number">17.5.4</span> Modelo aditivo generalizado y multidimensional, con <code>smacker</code><a href="modelos-aditivos-generalizados.html#modelo-aditivo-generalizado-y-multidimensional-con-smacker" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Se van a analizar los datos <code>smacker</code> del paquete <code>sm</code>.
El objetivo es ver cómo influyen las
condiciones del mar (temperatura de agua, etc.) en la ausencia o
presencia de huevos de jurel en el mar cantábrico, además, se utilizará la posición geográfica (latitud y longitud) como covariables para captar el efecto espacial.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig27"></span>
<img src="Ciencia_de_datos_con_r_files/figure-html/fig27-1.png" alt="Localización donde se midió la ausencia/presecia de huevos de jurel" width="60%" />
<p class="caption">
Figura 17.8: Localización donde se midió la ausencia/presecia de huevos de jurel
</p>
</div>
<p>Dado que la variable respuesta es dicotómica se va a utilizar un modelo
de regresión logística en el que se va a flexibilizar la linealidad de
las variables y además se usará una superficie para estimar el efecto de
la localización como una función en dos dimensiones (en función de la
posición geográfica: latitud y longitud). En este caso en vez de usar el
término <code>te()</code> se usa <code>s()</code> también para el caso de 2 dimensiones. La
diferencia fundamental con <code>te()</code> es que <code>s()</code> asume un suavizado
isotrópico, es decir el mismo parámetro de suavizado para la Latitud y
Longitud. No se debe usar <code>s()</code> para el suavizado en dos dimensiones si
las covariables están medidas en unidades diferentes (en este caso como
sí lo están, se puede usar el suavizado isotrópico)</p>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="modelos-aditivos-generalizados.html#cb205-1" aria-hidden="true" tabindex="-1"></a>logit1 <span class="ot">&lt;-</span> <span class="fu">gam</span>(</span>
<span id="cb205-2"><a href="modelos-aditivos-generalizados.html#cb205-2" aria-hidden="true" tabindex="-1"></a>  Presence <span class="sc">~</span> <span class="fu">s</span>(smack.long, smack.lat, <span class="at">k =</span> <span class="dv">60</span>) <span class="sc">+</span></span>
<span id="cb205-3"><a href="modelos-aditivos-generalizados.html#cb205-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">s</span>(ldepth) <span class="sc">+</span> <span class="fu">s</span>(Temperature),</span>
<span id="cb205-4"><a href="modelos-aditivos-generalizados.html#cb205-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> binomial, <span class="at">select =</span> <span class="cn">TRUE</span>, <span class="at">data =</span> smacker</span>
<span id="cb205-5"><a href="modelos-aditivos-generalizados.html#cb205-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb205-6"><a href="modelos-aditivos-generalizados.html#cb205-6" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">pty =</span> <span class="st">&quot;s&quot;</span>, <span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb205-7"><a href="modelos-aditivos-generalizados.html#cb205-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(logit1, <span class="at">scheme =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="Ciencia_de_datos_con_r_files/figure-html/unnamed-chunk-95-1.png" width="60%" style="display: block; margin: auto;" /><img src="Ciencia_de_datos_con_r_files/figure-html/unnamed-chunk-95-2.png" width="60%" style="display: block; margin: auto;" /></p>
<p>La relación entre la temperatura y la probabilidad de presencia de huevos es
no lineal mientras que es lineal para la profundidad. El <span class="math inline">\(R^2\)</span> es <span class="math inline">\(0.4\)</span>
por lo que sería necesario recoger más variables para poder obtener
buenas predicciones.</p>
<p>Si se quisieran obtener las probabilidades predichas se haría con la
función <code>predict</code>.</p>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="modelos-aditivos-generalizados.html#cb206-1" aria-hidden="true" tabindex="-1"></a>prob <span class="ot">&lt;-</span> <span class="fu">predict</span>(logit1, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span></code></pre></div>
</div>
<div id="resumen-2" class="section level3 unnumbered hasAnchor infobox_resume">
<h3>Resumen<a href="modelos-aditivos-generalizados.html#resumen-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>En este capítulo se han introducido los modelos aditivos generalizados, en particular:</p>
<ul>
<li>Se han presentado distintos aspectos metodológicos relacionados con la estimación e inferencia en modelos GAM.</li>
<li>Se ha mostrado el uso de <code>R</code> para el ajuste de este tipo de modelos.</li>
<li>Se han presentado diversos casos prácticos que ilustran la versatilidad de estos modelos para analizar datos complejos.</li>
</ul>
</div>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="57">
<li id="fn57"><p>conjunto de datos incluido con la instalación base de R.<a href="modelos-aditivos-generalizados.html#fnref57" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="modelos-lineales-generalizados.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="modelos-mixtos.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Ciencia_de_datos_con_r.pdf", "Ciencia_de_datos_con_r.epub"],
"search": {
"engine": "lunr",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
