<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Capítulo 20 Modelización de series temporales | Fundamentos de ciencia de datos con R</title>
<meta name="author" content="Gema Fernández-Avilés y José-María Montero">
<meta name="description" content="Mª Carmen García Centeno Universidad San Pablo-CEU, CEU Universities  20.1 Conceptos básicos El análisis de series temporales es muy útil para analizar el comportamiento de los datos con...">
<meta name="generator" content="bookdown 0.37 with bs4_book()">
<meta property="og:title" content="Capítulo 20 Modelización de series temporales | Fundamentos de ciencia de datos con R">
<meta property="og:type" content="book">
<meta property="og:image" content="/img/cover.png">
<meta property="og:description" content="Mª Carmen García Centeno Universidad San Pablo-CEU, CEU Universities  20.1 Conceptos básicos El análisis de series temporales es muy útil para analizar el comportamiento de los datos con...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Capítulo 20 Modelización de series temporales | Fundamentos de ciencia de datos con R">
<meta name="twitter:description" content="Mª Carmen García Centeno Universidad San Pablo-CEU, CEU Universities  20.1 Conceptos básicos El análisis de series temporales es muy útil para analizar el comportamiento de los datos con...">
<meta name="twitter:image" content="/img/cover.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.6.1/transition.js"></script><script src="libs/bs3compat-0.6.1/tabs.js"></script><script src="libs/bs3compat-0.6.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><link href="libs/tabwid-1.1.3/tabwid.css" rel="stylesheet">
<script src="libs/tabwid-1.1.3/tabwid.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="bs4_style.css">
<link rel="stylesheet" href="bs4_book.css">
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Fundamentos de ciencia de datos con <strong>R</strong></a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Buscar" aria-label="Buscar">
</form>

      <nav aria-label="Contenido"><h2>Contenido</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Prefacio</a></li>
<li><a class="" href="pr%C3%B3logo-by-julia-silge.html">Prólogo (by Julia Silge)</a></li>
<li><a class="" href="pr%C3%B3logo-por-yanina-bellini.html">Prólogo (por Yanina Bellini)</a></li>
<li class="book-part">Ciencia, datos, software… y científicos</li>
<li><a class="" href="ciencia-datos.html"><span class="header-section-number">1</span> ¿Es la ciencia de datos una ciencia?</a></li>
<li><a class="" href="metodologia.html"><span class="header-section-number">2</span> Metodología en ciencia de datos</a></li>
<li><a class="" href="ch-110003.html"><span class="header-section-number">3</span> R para ciencia de datos</a></li>
<li><a class="" href="cap-etica.html"><span class="header-section-number">4</span> Ética en la ciencia de datos</a></li>
<li class="book-part">Bienvenidos a la jungla de datos</li>
<li><a class="" href="datos-sql.html"><span class="header-section-number">5</span> Gestión de bases de datos relacionales</a></li>
<li><a class="" href="cap-nosql.html"><span class="header-section-number">6</span> Gestión de bases de datos NoSQL</a></li>
<li><a class="" href="DGDQM.html"><span class="header-section-number">7</span> Gobierno, gestión y calidad del dato</a></li>
<li><a class="" href="cap-130009.html"><span class="header-section-number">8</span> Integración y limpieza de datos</a></li>
<li><a class="" href="chap-feature.html"><span class="header-section-number">9</span> Selección y transformación de variables</a></li>
<li><a class="" href="chap-herramientas.html"><span class="header-section-number">10</span> Herramientas para el análisis en ciencia de datos</a></li>
<li><a class="" href="cap-120006-aed.html"><span class="header-section-number">11</span> Análisis exploratorio de datos</a></li>
<li class="book-part">Fundamentos de estadística</li>
<li><a class="" href="Funda-probab.html"><span class="header-section-number">12</span> Probabilidad</a></li>
<li><a class="" href="Fundainfer.html"><span class="header-section-number">13</span> Inferencia estadística</a></li>
<li><a class="" href="muestreo.html"><span class="header-section-number">14</span> Muestreo y remuestreo</a></li>
<li class="book-part">Modelización estadística</li>
<li><a class="" href="cap-lm.html"><span class="header-section-number">15</span> Modelización lineal</a></li>
<li><a class="" href="cap-glm.html"><span class="header-section-number">16</span> Modelos lineales generalizados</a></li>
<li><a class="" href="cap-gam.html"><span class="header-section-number">17</span> Modelos aditivos generalizados</a></li>
<li><a class="" href="cap-mxm.html"><span class="header-section-number">18</span> Modelos mixtos</a></li>
<li><a class="" href="cap-sparse.html"><span class="header-section-number">19</span> Modelos \(\textit{sparse}\) y métodos penalizados de regresión</a></li>
<li><a class="active" href="cap-series-temp.html"><span class="header-section-number">20</span> Modelización de series temporales</a></li>
<li><a class="" href="cap-discriminante.html"><span class="header-section-number">21</span> Análisis discriminante</a></li>
<li><a class="" href="cap-conjunto.html"><span class="header-section-number">22</span> Análisis conjunto</a></li>
<li><a class="" href="tablas-contingencia.html"><span class="header-section-number">23</span> Análisis de tablas de contingencia</a></li>
<li class="book-part">Machine learning supervisado</li>
<li><a class="" href="cap-arboles.html"><span class="header-section-number">24</span> Árboles de clasificación y regresión</a></li>
<li><a class="" href="cap-svm.html"><span class="header-section-number">25</span> Máquinas de vector soporte</a></li>
<li><a class="" href="cap-knn.html"><span class="header-section-number">26</span> Clasificador \(k\)-vecinos más próximos</a></li>
<li><a class="" href="cap-naive-bayes.html"><span class="header-section-number">27</span> Naive Bayes</a></li>
<li><a class="" href="cap-bagg-rf.html"><span class="header-section-number">28</span> Métodos ensamblados: \(\bf \textit {bagging}\) y \(\bf \textit{random}\) \(\bf \textit{forest}\)</a></li>
<li><a class="" href="cap-boosting-xgboost.html"><span class="header-section-number">29</span> \(\bf \textit{Boosting}\) y el algoritmo XGBoost</a></li>
<li class="book-part">Machine learning no supervisado</li>
<li><a class="" href="cap-cluster.html"><span class="header-section-number">30</span> Análisis clúster: clusterización jerárquica</a></li>
<li><a class="" href="no-jerarquico.html"><span class="header-section-number">31</span> Análisis clúster: clusterización no jerárquica</a></li>
<li><a class="" href="acp.html"><span class="header-section-number">32</span> Análisis de componentes principales</a></li>
<li><a class="" href="af.html"><span class="header-section-number">33</span> Análisis factorial</a></li>
<li><a class="" href="mds.html"><span class="header-section-number">34</span> Escalamiento multidimensional</a></li>
<li><a class="" href="correspondencias.html"><span class="header-section-number">35</span> Análisis de correspondencias</a></li>
<li class="book-part">Deep learning</li>
<li><a class="" href="capNN.html"><span class="header-section-number">36</span> Redes neuronales artificiales</a></li>
<li><a class="" href="cap-redes-convol.html"><span class="header-section-number">37</span> Redes neuronales convolucionales</a></li>
<li class="book-part">Ciencia de datos de texto y redes</li>
<li><a class="" href="mineria-textos.html"><span class="header-section-number">38</span> Minería de textos</a></li>
<li><a class="" href="grafos.html"><span class="header-section-number">39</span> Análisis de grafos y redes sociales</a></li>
<li class="book-part">Ciencia de datos espaciales</li>
<li><a class="" href="datos-espaciales.html"><span class="header-section-number">40</span> Trabajando con datos espaciales</a></li>
<li><a class="" href="geo.html"><span class="header-section-number">41</span> Geoestadística</a></li>
<li><a class="" href="cap-econom-esp.html"><span class="header-section-number">42</span> Modelos econométricos espaciales</a></li>
<li><a class="" href="cap-pp.html"><span class="header-section-number">43</span> Procesos de puntos</a></li>
<li class="book-part">Comunica y colabora</li>
<li><a class="" href="cap-120007-informes.html"><span class="header-section-number">44</span> Informes reproducibles con R Markdown y Quarto</a></li>
<li><a class="" href="shiny.html"><span class="header-section-number">45</span> Creación de aplicaciones web interactivas con Shiny</a></li>
<li><a class="" href="github.html"><span class="header-section-number">46</span> Git y GitHub R</a></li>
<li><a class="" href="geoproces.html"><span class="header-section-number">47</span> Geoprocesamiento en nube</a></li>
<li class="book-part">Casos de estudio en ciencia de datos</li>
<li><a class="" href="cap-crimen.html"><span class="header-section-number">48</span> Análisis de una red criminal</a></li>
<li><a class="" href="cap-publicidad.html"><span class="header-section-number">49</span> Optimización de inversiones publicitarias</a></li>
<li><a class="" href="cap-twitter.html"><span class="header-section-number">50</span> ¿Cómo tuitea Elon Musk?</a></li>
<li><a class="" href="cap-periodismo.html"><span class="header-section-number">51</span> Análisis electoral: de RStudio a su periódico favorito</a></li>
<li><a class="" href="paro-clm.html"><span class="header-section-number">52</span> El impacto de las crisis financiera y de la COVID-19 en el paro de CLM</a></li>
<li><a class="" href="cap-rfm.html"><span class="header-section-number">53</span> Segmentación de clientes en el comercio minorista</a></li>
<li><a class="" href="cap-medicina.html"><span class="header-section-number">54</span> Análisis de datos en medicina</a></li>
<li><a class="" href="cap-futbol.html"><span class="header-section-number">55</span> Messi y Ronaldo: dos ídolos desde la perspectiva de los datos</a></li>
<li><a class="" href="cambioclimatico.html"><span class="header-section-number">56</span> Una nota sobre el cambio climático</a></li>
<li><a class="" href="cap-sist-exp.html"><span class="header-section-number">57</span> Implementación de un sistema experto en el ámbito pediátrico</a></li>
<li><a class="" href="cap-ree.html"><span class="header-section-number">58</span> Predicción de consumo eléctrico con redes neuronales artificiales</a></li>
<li><a class="" href="nlp-textil.html"><span class="header-section-number">59</span> El procesamiento del lenguaje natural para tendencias de moda en textil</a></li>
<li><a class="" href="cap-fraude.html"><span class="header-section-number">60</span> Detección de fraude de tarjetas de crédito</a></li>
<li class="book-part">Appendix</li>
<li><a class="" href="info-session.html"><span class="header-section-number">A</span> Información de la sesión</a></li>
<li><a class="" href="referencias.html">Referencias</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="cap-series-temp" class="section level1" number="20">
<h1>
<span class="header-section-number">Capítulo 20</span> Modelización de series temporales<a class="anchor" aria-label="anchor" href="#cap-series-temp"><i class="fas fa-link"></i></a>
</h1>
<p><em>Mª Carmen García Centeno</em></p>
<p>Universidad San Pablo-CEU, CEU Universities</p>
<p></p>
<div id="conceptos" class="section level2" number="20.1">
<h2>
<span class="header-section-number">20.1</span> Conceptos básicos<a class="anchor" aria-label="anchor" href="#conceptos"><i class="fas fa-link"></i></a>
</h2>
<p>El análisis de series temporales es muy útil para analizar el comportamiento de los datos con referencia temporal. Con dicho análisis, se trata de obtener modelos que expliquen su dinámica y puedan utilizarse para predecir valores futuros y tomar decisiones.</p>
<p>Una serie temporal se puede definir como el conjunto de valores observados, en períodos consecutivos de tiempo de la misma amplitud, de una característica de interés en la que su valor en cada instante temporal es una variable aleatoria. Por consiguiente, una serie temporal no es sino la realización de un proceso estocástico; por ejemplo: las precipitaciones diarias, la inflación mensual o el PIB trimestral.</p>
<p>A continuación se exponen algunos de los conceptos clave sobre los que se fundamenta el análisis de series temporales:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Proceso estocástico</strong>. Es una sucesión de variables aleatorias <span class="math inline">\(\{Y_t\}\)</span>, donde <span class="math inline">\(t= -\infty,..., -2, -1, 0, 1,2,...,\infty\)</span>, que dependen de un parámetro. En el caso de las series temporales ese parámetro es el tiempo.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Pueden depender de más de un parámetro; pero en este capítulo se aborda el caso de un único parámetro: el tiempo.&lt;/p&gt;"><sup>151</sup></a> Así, en cada momento del tiempo el proceso se particulariza en una variable aleatoria con una determinada distribución de probabilidad. Desde el punto de vista práctico es muy complicado, y a veces imposible, caracterizar un proceso estocástico según su distribución de probabilidad conjunta. Por esta razón, se recurre a caracterizarlo de una forma menos completa, pero más sencilla y práctica, basada en los dos primeros momentos de una distribución; en concreto: la media (<span class="math inline">\(E(Y_t)=\mu_t\)</span>), la varianza (<span class="math inline">\(Var(Y_t)=E(Y_t-\mu_t)^2=\sigma_t^2\)</span>) y las covarianzas (<span class="math inline">\(\gamma(k)=Cov(Y_t,Y_{t-k})=E((Y_t-\mu_t)(Y_{t-k}-\mu_{t-k}))\)</span>).</li>
</ol>
<p></p>
<ol start="2" style="list-style-type: decimal">
<li>
<strong>Estacionariedad</strong>. Un proceso estocástico es estacionario, en sentido simple o amplio, si su media y la varianza se mantienen invariantes a lo largo del tiempo y las covarianzas entre dos variables solo dependen del lapso de tiempo que transcurre entre ellas. Es decir:</li>
</ol>
<p>
3. <strong>Función de autocovarianzas</strong>. Está formada por el conjunto de autocovarianzas calculadas para distintos <em>órdenes</em> <span class="math inline">\((k)\)</span>. Tiene como finalidad determinar las relaciones de dependencia lineales que existen entre las variables del proceso con el fin de identificar el modelo que mejor explica su dinámica a lo largo del tiempo.
4. <strong>Función de autocorrelación simple (ACF)</strong>. Está formada por el conjunto de coeficientes de correlación lineales calculados para distintos <em>órdenes</em> <span class="math inline">\((k)\)</span>. De forma genérica, para medir la correlación lineal existente entre <span class="math inline">\(Y_t\)</span> e <span class="math inline">\(Y_{t-k}\)</span>, el coeficiente de correlación de orden <span class="math inline">\(k\)</span>, <span class="math inline">\(\rho(k)\)</span>, se calcula como el cociente entre la covarianza de y la varianza (ya que, como el proceso es estacionario, las desviaciones típicas de <span class="math inline">\(Y_t\)</span> e <span class="math inline">\(Y_{t-k}\)</span> son iguales).</p>
<p><span class="math display">\[\begin{equation}
\rho(k) = \frac{Cov(Y_t,Y_{t-k})}{(\sqrt{ Var(Y_t)})(\sqrt {Var(Y_{t-k})})}=\frac{\gamma(k)}{\gamma(0)}.
\end{equation}\]</span></p>
<p>La representación gráfica de los coeficientes de correlación <span class="math inline">\(\rho(k)\)</span> para <span class="math inline">\(k=0,1,2,…\)</span> se conoce como .</p>
<p></p>
<ol start="5" style="list-style-type: decimal">
<li>
<strong>Función de autocorrelación parcial (PACF)</strong>. Está formada por el conjunto de las correlaciones lineales parciales obtenidas para los distintos valores de <span class="math inline">\(k\)</span>. Así, para dos instantes de una serie temporal <span class="math inline">\(t\)</span> y <span class="math inline">\((t-k)\)</span>, mide la correlación lineal existente entre las variables <span class="math inline">\(Y_{t}\)</span> e <span class="math inline">\(Y_{t-k}\)</span> asociadas a ellos, ajustada de los valores que toma el proceso temporal en los períodos intermedios (<span class="math inline">\(Y_{t-1},Y_{t-2},..., Y_{t-(k-1)}\)</span>).<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;En el coeficiente de autocorrelación parcial de orden &lt;span class="math inline"&gt;\(k\)&lt;/span&gt; se calcula la correlación entre parejas de valores
separados por esa distancia temporal, pero eliminando el efecto debido a la correlación producida por retardos anteriores a &lt;span class="math inline"&gt;\(k\)&lt;/span&gt;.&lt;/p&gt;'><sup>152</sup></a>
</li>
</ol>
<p> </p>
<ol start="6" style="list-style-type: decimal">
<li>
<strong>Ergodicidad</strong>. Un proceso estocástico es ergódico cuando, a partir de un determinado desfase temporal entre las variables, la correlación lineal existente entre ellas tiende a desaparecer. Esto implica que las covarianzas y el coeficiente de correlación tienden a cero, es decir,</li>
</ol>
<p><span class="math display">\[\lim\limits_{k \to \infty}\gamma(k)=0 \quad  y \quad  \lim\limits_{k \to \infty}\rho(k)=0\]</span></p>
<ol start="7" style="list-style-type: decimal">
<li>
<strong>Ruido blanco</strong>. Es un proceso puramente aleatorio que se puede expresar de la siguiente forma:
<span class="math display">\[Y_t=a_t.\]</span>
Se caracteriza por tener esperanza nula, varianza constante y covarianzas nulas. Es decir,
<span class="math display">\[E(a_t)=0 \quad\forall t;  \quad E(a_t^2)=\sigma^2 \quad\forall t;\quad  E(a_ta_s)=0 \quad\forall t\neq s.\]</span>
Esto implica que un proceso de ruido blanco siempre es estacionario.</li>
</ol>
<p></p>
</div>
<div id="modelos-arima" class="section level2" number="20.2">
<h2>
<span class="header-section-number">20.2</span> Modelos ARIMA<a class="anchor" aria-label="anchor" href="#modelos-arima"><i class="fas fa-link"></i></a>
</h2>
<p>Para determinar las características del proceso estocástico subyacente a la serie temporal, se van a utilizar los modelos ARIMA (acrónimo del inglés <em>AutoRegresive Integrated Moving Average</em>). Estos modelos están formados por tres componentes: <strong>AR</strong> (autorregresivo), <strong>I</strong> (integrado, es decir, número de diferencias necesarias para convertirlo en estacionario cuando no lo es) y <strong>MA</strong> (medias móviles). Fueron propuestos por Box y Jenkins y son un caso paraticular de procesos estocásticos lineales, estacionarios, ergódicos y discretos. Entre este tipo de procesos lineales, los más frecuentes son:</p>
<p>Los modelos ARIMA tratan de captar la dinámica y la dependencia existente en los datos de una serie temporal. Por lo tanto, son muy útiles para describir un valor como una combinación o función lineal de valores pasados y errores debidos al azar. Para detalles sobre la cuestión pueden verse, entre muchos otros, <span class="citation">Hamilton (<a href="referencias.html#ref-Hamilton1994">1994</a>)</span>, <span class="citation">Uriel Jiménez &amp; Peiro Giménez (<a href="referencias.html#ref-Uriel2000">2000</a>)</span>, <span class="citation">Cryer &amp; Chan (<a href="referencias.html#ref-Cryer2008">2010</a>)</span>, <span class="citation">Pemberton (<a href="referencias.html#ref-Pemberton2011">2011</a>)</span>, <span class="citation">Mínguez Salido &amp; García Centeno (<a href="referencias.html#ref-Minguez2011">2011</a>)</span>, <span class="citation">Brockwell &amp; Davis (<a href="referencias.html#ref-Brockwell2016">2016</a>)</span> y <span class="citation">Shumway &amp; Stoffer (<a href="referencias.html#ref-Shumway2017">2017</a>)</span>.</p>
<p>En la modelización ARIMA se pueden destacar varias fases. La primera se centra en la <strong>identificación</strong> del modelo ARIMA que haya podido generar los datos de la serie temporal. En esta fase, es necesario decidir los órdenes del proceso (es decir, el desfase temporal entre el mayor y menor período de tiempo de las variables incluidas en el modelo) tanto de la parte regular como de la estacional.</p>
<p>La ACF y la PACF desempeñan un papel clave en la identificación de estos órdenes. Antes de calcular la ACF y la PACF, es necesario comprobar que la serie es estacionaria, es decir, que no deambula ni tiene tendencia creciente o decreciente. En el caso de que no lo sea, se realizarán las transformaciones necesarias para convertirla en estacionaria, ya que la modelización ARIMA exige que los datos sean estacionarios. Las dos razones fundamentales por las cuales pueden no ser estacionarios son: la no constancia en el tiempo de la media o la existencia de fluctuaciones de diferente amplitud que hacen que la varianza no se mantenga constante.</p>
<p>Si la serie no es estacionaria en varianza, de entre las transformaciones Box-Cox, se puede utilizar una transformación logarítmica porque reduce el rango dinámico de la variable, corrige la asimetría positiva y acerca a la normalidad la distribución de la variable; además, facilita la interpretación de las estimaciones de los coeficientes del modelo, ya que la diferencia del logaritmo de la serie es, aproximadamente, su tasa de variación porcentual.</p>
<p>Si no es estacionaria en media, puede ser debido a la existencia de tendencia en el tiempo o de estacionalidad. Para eliminar la tendencia se calculan las diferencias regulares (una o dos como máximo según el tipo de tendencia lineal o no lineal, es decir, <span class="math inline">\(Y_t-Y_{t-1}=\Delta Y_t\)</span> o <span class="math inline">\(\Delta^2 Y_t=\Delta(\Delta Y_t)\)</span>, respectivamente). Para eliminar la estacionalidad, lo que se calcula es una diferencia estacional (es decir, <span class="math inline">\(Y_t-Y_{t-s}=\Delta_s Y_t\)</span>).</p>
<p></p>
<p>Después de proponer el modelo, y tras dividir el conjunto de datos en dos subconjuntos (el de entrenamiento y el de test), se procede, con los datos del subconjunto apropiado, a la <strong>estimación</strong> del modelo, a su <strong>validación</strong> y a la <strong>realización de predicciones</strong>. Primero se obtienen las estimaciones de los parámetros del modelo propuesto, así como sus desviaciones típicas, y los residuos del modelo. Posteriormente, se aborda la fase de <strong>validación</strong> o <strong>diagnóstico</strong> y se realizan los contrastes necesarios para determinar si el modelo propuesto es adecuado o no, es decir, si los parámetros estimados son estadísticamente significativos o no; si el modelo estimado es estacionario e invertible; y si sus residuos siguen un proceso de ruido blanco o no. En el caso de que no lo sean, será necesario corregir el modelo con la información proporcionada por los residuos hasta obtener un modelo cuyos residuos sean ruido blanco. Finalmente, se procede a la utilización del modelo para <strong>predecir</strong>.</p>
</div>
<div id="análisis-de-series-temporales-con-r" class="section level2" number="20.3">
<h2>
<span class="header-section-number">20.3</span> Análisis de series temporales con <strong>R</strong><a class="anchor" aria-label="anchor" href="#an%C3%A1lisis-de-series-temporales-con-r"><i class="fas fa-link"></i></a>
</h2>
<p>Algunas de las librerías que normalmente se suelen utilizar en la modelización de series temporales con <strong>R</strong> son:</p>
<div class="sourceCode" id="cb296"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st">"tseries"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://dsstoffer.github.io/">"astsa"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://pkg.robjhyndman.com/forecast/">"forecast"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://lubridate.tidyverse.org">"lubridate"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://svn.r-project.org/R-packages/trunk/foreign/">"foreign"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="http://www.quantmod.com">"quantmod"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://ggplot2.tidyverse.org">"ggplot2"</a></span><span class="op">)</span></span></code></pre></div>
<p>La libreria <code>tseries</code> permite manipular datos de series temporales; <code>astsa</code> es adecuada para analizar series de tiempo en los dominios de frecuencia y tiempo; <code>forecast</code> lleva a cabo (y analiza) predicciones con series temporales; <code>lubridate</code> facilita el trabajo con fechas y horas; <code>foreign</code> es esencial para crear objetos en <strong>R</strong> importando datos de casi cualquier formato conocido, como por ejemplo SAS, SPSS, Stata, etc.; <code>quantmod</code> ayuda, de forma cuantitativa, en el desarrollo de estrategias y modelización mediante la utilización de estadísticas; <code>readxl</code> facilita la exportación de datos de Excel a <strong>R</strong>; y <code>ggplot2</code> es muy útil para la realización de gráficos.</p>
<p>En el caso real que se propone, se utilizan datos mensuales del INE (www.ine.es) correspondientes al índice general de precios al consumo (IPC) en el período muestral comprendido entre enero de 2002 y marzo de 2022. Los datos están en el fichero <code>ipc</code> del paquete <code>CDR</code> del libro.</p>
<div class="sourceCode" id="cb297"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ipc</span> <span class="op">&lt;-</span> <span class="fu">CDR</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/CDR/man/IPC.html">ipc</a></span></span></code></pre></div>
<p>Para trabajar con series temporales, la fecha es un requisito imprescindible. En caso de que los datos no tuviesen fecha, habría que incluirla. Por ejemplo, para series mensuales, el código sería:</p>
<div class="sourceCode" id="cb298"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ipc_ts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">ipc</span><span class="op">$</span><span class="va">ipc</span>, start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2002</span>, <span class="fl">1</span><span class="op">)</span>, end <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2022</span>, <span class="fl">3</span><span class="op">)</span>, frequency <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span></code></pre></div>
<p>En el caso del fichero <code>ipc</code> la fecha figura en la primera columna del fichero.</p>
<p>La representación gráfica de la serie original puede ayudar a saber si la serie ha sido generada por un proceso estacionario o no. Para obtener dicha representación, se ejecuta el siguiente código:</p>
<div class="sourceCode" id="cb299"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ipc</span><span class="op">$</span><span class="va">Time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="va">ipc</span><span class="op">$</span><span class="va">Time</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">ipc</span>,</span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">ipc</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span></span>
<span>    axis.title.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">15</span><span class="op">)</span>,</span>
<span>    axis.title.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:ipc"></span>
<img src="img/ipc1.png" alt="Evolución del IPC entre enero de 2002 y marzo de 2022." width="60%"><p class="caption">
Figura 20.1: Evolución del IPC entre enero de 2002 y marzo de 2022.
</p>
</div>
<p>La descomposición aditiva o multiplicativa en <span class="math inline">\((i)\)</span> tendencia, <span class="math inline">\((ii)\)</span> componente estacional, <span class="math inline">\((iii)\)</span> componente cíclico y (<span class="math inline">\(iv\)</span>) componente irregular de la serie del IPC, así como su representación gráfica, también puede ayudar a determinar si la serie es estacionaria o no. El código para la descomposición aditiva de la serie es el siguiente:</p>
<div class="sourceCode" id="cb300"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">componentes_ts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/decompose.html">decompose</a></span><span class="op">(</span><span class="va">ipc_ts</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span><span class="op">(</span><span class="va">componentes_ts</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:DescomposicionST"></span>
<img src="img/decompose.png" alt="Descomposición aditiva del IPC." width="60%"><p class="caption">
Figura 20.2: Descomposición aditiva del IPC.
</p>
</div>
<p>Tanto en el gráfico de la serie original del IPC (Fig. <a href="cap-series-temp.html#fig:ipc">20.1</a>) como en el de su descomposición en componentes (Fig. <a href="cap-series-temp.html#fig:DescomposicionST">20.2</a>), se aprecia que la serie tiene tendencia y componente estacional (mensual). Por lo tanto, no es estacionaria en media, es decir, la media es distinta para diferentes meses y años; tampoco lo es en varianza, ya que la dispersión respecto de la media cambia a lo largo del tiempo.</p>
<p>Si una serie no es estacionaria ni en media ni en varianza es necesario empezar corrigiendo la no estacionariedad en varianza y, posteriormente, la no estacionariedad en media.</p>
<p>Las transformaciones de Box-Cox son las más utilizadas para corregir el problema de no estacionariedad en varianza. De todas estas transformaciones, la más habitual es el logaritmo. Para obtener la representación gráfica del logaritmo de <span class="math inline">\(Y_t\)</span>, se ejecuta el siguiente código:</p>
<div class="sourceCode" id="cb301"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">logipc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">ipc_ts</span><span class="op">)</span></span>
<span><span class="va">ts_logipc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>value <span class="op">=</span> <span class="va">logipc</span>, Time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/time.html">time</a></span><span class="op">(</span><span class="va">logipc</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">ts_logipc</span>,</span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">logipc</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span></span>
<span>    axis.title.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">15</span><span class="op">)</span>,</span>
<span>    axis.title.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:lipc"></span>
<img src="img/ipc3.png" alt="Logaritmo del IPC." width="50%"><p class="caption">
Figura 20.3: Logaritmo del IPC.
</p>
</div>
<p>Corregido el problema de la no estacionariedad en varianza, en la Fig. <a href="cap-series-temp.html#fig:lipc">20.3</a> se aprecia que sigue sin ser estacionaria, ya que al tener estacionalidad y tendencia creciente no es estacionaria en media. Para conseguir que la serie sea estacionaria es necesario corregir tanto su tendencia como su estacionalidad.</p>
<p>Es indiferente cuál de los dos problemas se resuelve primero, pues el resultado final de la transformación es el mismo. En este caso, se empieza corrigiendo la tendencia. Para ello, se calcula una diferencia regular del logaritmo del IPC, obteniéndose la serie <span class="math inline">\((dlogipc_{t} = log(ipc_t) - log(ipc_{t-1})\)</span>. Al ser datos mensuales, esta transformación representa la tasa de variación relativa mensual del IPC. El código para calcular esta diferencia regular y su representación gráfica (Fig. <a href="cap-series-temp.html#fig:dlipc">20.4</a>) es:</p>
<div class="sourceCode" id="cb302"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dlogipc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diff.html">diff</a></span><span class="op">(</span><span class="va">logipc</span>, differences <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">ts_dlogipc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>value <span class="op">=</span> <span class="va">dlogipc</span>, Time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/time.html">time</a></span><span class="op">(</span><span class="va">dlogipc</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">ts_dlogipc</span>,</span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">dlogipc</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span></span>
<span>    axis.title.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">15</span><span class="op">)</span>,</span>
<span>    axis.title.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:dlipc"></span>
<img src="img/ipc4.png" alt="Diferencia regular del logaritmo del IPC." width="60%"><p class="caption">
Figura 20.4: Diferencia regular del logaritmo del IPC.
</p>
</div>
<p>Corregida la tendencia, a continuación se corrige su estacionalidad. Para ello, sobre la diferencia regular del logaritmo del IPC, se calculará una diferencia estacional mensual <span class="math inline">\((d12dlogipc_{t})= log(ipc_t) - log(ipc_{t-12})\)</span>. El código para calcular esta diferencia estacional y su representación gráfica (Fig. <a href="cap-series-temp.html#fig:d12dlipc">20.5</a>) es:</p>
<div class="sourceCode" id="cb303"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d12dlogipc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diff.html">diff</a></span><span class="op">(</span><span class="va">dlogipc</span>, <span class="fl">12</span><span class="op">)</span></span>
<span><span class="va">ts_d12dlogipc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>value <span class="op">=</span> <span class="va">d12dlogipc</span>, Time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/time.html">time</a></span><span class="op">(</span><span class="va">d12dlogipc</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">ts_d12dlogipc</span>,</span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">d12dlogipc</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span></span>
<span>    axis.title.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">15</span><span class="op">)</span>,</span>
<span>    axis.title.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"purple"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:d12dlipc"></span>
<img src="img/ipc5.png" alt="Diferencia estacional de la diferencia regular del logaritmo del IPC." width="60%"><p class="caption">
Figura 20.5: Diferencia estacional de la diferencia regular del logaritmo del IPC.
</p>
</div>
<p>Para contrastar si una serie es estacionaria en media o no, también se puede utilizar un test de raíces unitarias.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Una raíz unitaria es una característica de los procesos que evolucionan a lo largo del tiempo que implica problemas de no estacionariedad en media y también al realizar inferencias.&lt;/p&gt;"><sup>153</sup></a> A partir de la ecuación inicial de un AR:
<span class="math display">\[ \Delta Y_t=\alpha +(\phi-1)Y_{t-1}+a_t,\]</span> las hipótesis del contraste son:</p>
<p><span class="math display">\[ H_0: (\phi-1)=0 \]</span></p>
<p><span class="math display">\[ H_1: (\phi-1)&lt;0. \]</span></p>
<p>En esta ecuación se pueden añadir más retardos de la variable, una tendencia (en series que claramente tengan una tendencia decreciente o creciente) o eliminar la constante (en series con media nula).
En este caso se utiliza el test de raíces unitarias de Dickey-Fuller, que es un test unilateral en el que la hipótesis nula es la existencia de raíces unitarias y, por lo tanto, que la serie no es estacionaria (es decir, es I(1)), mientras que la hipótesis alternativa es que sí es estacionaria (es decir, la serie es I(0)). Si se realiza el test sobre la serie original (<code>ipc_ts</code>) y sobre la serie transformada del IPC (<code>d12dLogIPC</code>), se comprueba que esta última es la transformación estacionaria. El código utilizado para realizar este contraste es:</p>
<div class="sourceCode" id="cb304"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">adf.test</span><span class="op">(</span><span class="va">ipc_ts</span><span class="op">)</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; Augmented Dickey-Fuller Test</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; data: ipc_ts</span></span>
<span><span class="co">#&gt; Dickey-Fuller = -1.8396, Lag order = 6, p-value = 0.6433</span></span>
<span><span class="co">#&gt; alternative hypothesis: stationary</span></span>
<span><span class="fu">adf.test</span><span class="op">(</span><span class="va">d12dlogipc</span><span class="op">)</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; Augmented Dickey-Fuller Test</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; data: d12dlogipc</span></span>
<span><span class="co">#&gt; Dickey-Fuller = -3.3727, Lag order = 6, p-value = 0.06002</span></span>
<span><span class="co">#&gt; alternative hypothesis: stationary</span></span></code></pre></div>
<p>A la luz del <em>p</em>–valor para los valores originales del IPC, si se preestablece un nivel de significación del 10%, no se rechaza la hipótesis nula (y, por tanto, la serie no es estacionaria). Sin embargo, para la serie resultante tras las transformaciones anteriores (<code>d12dLogipc</code>) se rechaza la <span class="math inline">\(H_0\)</span>. Siendo así, se puede concluir que dicha transformación la ha convertido en estacionaria.</p>
<div id="identificación-o-especificación-del-modelo" class="section level3" number="20.3.1">
<h3>
<span class="header-section-number">20.3.1</span> Identificación o especificación del modelo<a class="anchor" aria-label="anchor" href="#identificaci%C3%B3n-o-especificaci%C3%B3n-del-modelo"><i class="fas fa-link"></i></a>
</h3>
<p>A partir de la transformación estacionaria del modelo es necesario calcular la ACF y la PACF muestrales, con el fin de identificar el modelo ARIMA más adecuado, es decir, especificar tanto el modelo como su correspondiente orden. Antes de hacerlo para el caso concreto del IPC, se analizan brevemente los principales modelos teóricos que pueden explicar la dinámica de una serie temporal. Estos modelos, para la parte regular (es decir, de la modelización de la dependencia asociada a observaciones consecutivas de tiempo) pueden ser: autorregresivos puros (AR(<span class="math inline">\(p\)</span>)), medias móviles (MA(<span class="math inline">\(q\)</span>)) o mixtos ARMA(<span class="math inline">\(p\)</span>, <span class="math inline">\(q\)</span>), donde <span class="math inline">\(p\)</span> y <span class="math inline">\(q\)</span> representan sus correspondientes órdenes, respectivamente. En el caso de la parte estacional (<span class="math inline">\(s\)</span>), es decir, de la modelización de la dependencia asociada a observaciones que distan entre sí <span class="math inline">\(s\)</span>-períodos de tiempo o múltiplos de <span class="math inline">\(s\)</span>, se tiene: sAR(<span class="math inline">\(P\)</span>), sMA(<span class="math inline">\(Q\)</span>) o sARMA(<span class="math inline">\(P\)</span>, <span class="math inline">\(Q\)</span>), donde <span class="math inline">\(P\)</span> y <span class="math inline">\(Q\)</span> representan, respectivamente, los órdenes de los modelos correspondientes a la parte estacional. Es necesario destacar que para identificar el modelo de la parte estacional es necesario analizar los coeficientes correspondientes a los retardos estacionales. Así, por ejemplo, en el caso de una serie mensual, habría que fijarse en los coeficientes correspondientes a los retardos 12, 24, 36, etc., para una serie trimestral, en los retardos, 4, 8, 12, 16, etc., y así sucesivamente.</p>
<p>Antes de identificar el modelo correspondiente al IPC en el período muestral analizado, se presentan algunos ejemplos de modelos ARIMA, su ecuación general y el comportamiento de su ACF y PACF.</p>
<ul>
<li>
<p>En el caso de MA(<em>q</em>) o sMA(<em>Q</em>):</p>
<ul>
<li><p>La ACF se anula para órdenes superiores a <em>q</em> (o a <em>Q</em> en el caso estacional). Es decir, solo los <em>q</em> primeros coeficientes son significativos (o <em>Q</em> en el caso estacional). El resto de los coeficientes son nulos (o estadísticamente nulos en el caso muestral).</p></li>
<li><p>La PACF decrece de forma exponencial o sinusoidal hacia cero.</p></li>
</ul>
</li>
</ul>
<div id="ejemplo-de-las-acf-y-pacf-teóricas-de-los-procesos-estacionarios-ma1" class="section level4" number="20.3.1.1">
<h4>
<span class="header-section-number">20.3.1.1</span> Ejemplo de las ACF y PACF teóricas de los procesos estacionarios MA(1)<a class="anchor" aria-label="anchor" href="#ejemplo-de-las-acf-y-pacf-te%C3%B3ricas-de-los-procesos-estacionarios-ma1"><i class="fas fa-link"></i></a>
</h4>
<p>La ecuación que describe la dinámica de un modelo MA(1) o ARMA(0, 1) es:</p>
<p><span class="math display">\[Y_t=a_t-\theta a_{t-1},\]</span></p>
<p>o bien, en forma polinómica:</p>
<p><span class="math display">\[Y_t=(1-\theta L)a_t , \]</span></p>
<p>donde <span class="math inline">\(L\)</span> es el operador de retardos y <span class="math inline">\(a_t\)</span> es un ruido blanco, es decir: <span class="math inline">\(E(a_t)=0 \; \;\forall t\)</span>; <span class="math inline">\(E(a_t^2)=\sigma^2 \; \; \forall t\)</span>; <span class="math inline">\(E(a_ta_s)=0 \quad\forall t\neq s\)</span>.</p>
<p>Este modelo siempre es estacionario (ya que se obtiene como una combinación de procesos de ruido blanco) y para que sea invertible (es decir, para que se pueda expresar en función del pasado de la variable), es necesario que las raíces del polinomio estén fuera del círculo unidad, o lo que es lo mismo, que <span class="math inline">\(|\theta|&lt;1\)</span>.</p>
<p>Su ACF teórica es:</p>
<p><span class="math display">\[
\rho(k)=\left\{
\begin{array}{ll}
\frac{-\theta}{(1+\theta^2)} &amp; \text{si } k=1 \\
0   &amp;  \text{}\forall k&gt;1,
\end{array}
\right.
\]</span>
y su PACF (también teórica) viene dada por:
<span class="math display">\[
\phi_{kk}=\frac{-\theta^k(1-\theta^2)}{1-\theta^{2(k+1)}}\quad \text {para} \quad k\geq 1.
\]</span></p>
<ul>
<li>
<p>En un AR(<em>p</em>) o sAR(<em>P</em>):</p>
<ul>
<li><p>La ACF decrece rápidamente de forma exponencial o sinusoidal hacia cero.</p></li>
<li><p>La PACF se anula para órdenes superiores a <em>p</em> (o a <em>P</em>, en el caso estacional). Es decir, solo los <em>p</em> (o <em>P</em> en el caso estacional) primeros coeficientes son significativamente distintos de cero. El resto de los coeficientes son nulos (o estadísticamente nulos en el caso muestral).</p></li>
</ul>
</li>
</ul>
</div>
<div id="ejemplo-de-las-acf-y-pacf-teóricas-de-los-procesos-estacionarios-ar1" class="section level4" number="20.3.1.2">
<h4>
<span class="header-section-number">20.3.1.2</span> Ejemplo de las ACF y PACF teóricas de los procesos estacionarios AR(1)<a class="anchor" aria-label="anchor" href="#ejemplo-de-las-acf-y-pacf-te%C3%B3ricas-de-los-procesos-estacionarios-ar1"><i class="fas fa-link"></i></a>
</h4>
<p>La ecuación que describe la dinámica de un modelo AR(1) o ARMA(1, 0) es:</p>
<p><span class="math display">\[Y_t=\phi Y_{t-1}+ a_t,\]</span></p>
<p>o bien, en forma polinómica: <span class="math inline">\(Y_t(1-\phi L)=a_t\)</span>, donde <span class="math inline">\(L\)</span> es el operador de retardos y <span class="math inline">\(a_t\)</span> es un ruido blanco.</p>
<p>Este modelo siempre es invertible (ya que está expresado en función del pasado de la variable) y para que sea estacionario es necesario que las raíces del polinomio de retardos estén fuera del círculo unidad, o lo que es lo mismo, que <span class="math inline">\(|\phi|&lt;1\)</span>.</p>
<p>Su ACF teórica es:</p>
<p><span class="math display">\[
\rho(k)=\phi\rho(k-1)=\phi^k,
\]</span></p>
<p>mientras que su PACF (teórica) viene dada por:</p>
<p><span class="math display">\[
\phi_{kk}=\left\{
\begin{array}{ll}
\rho_1=\phi &amp; \text{si } k=1 \\
0   &amp;  \text{}\forall k&gt;1.
\end{array}
\right.
\]</span></p>
<ul>
<li>
<p>En un ARMA(<em>p</em>, <em>q</em>) o sARMA(<em>P</em>, <em>Q</em>):</p>
<ul>
<li><p>La ACF tiene un comportamiento irregular en los <span class="math inline">\(q\)</span> primeros (o en los <span class="math inline">\(Q\)</span> en el caso estacional) coeficientes. A partir del orden <span class="math inline">\(q\)</span> (o <span class="math inline">\(Q\)</span> en el caso estacional), se comporta como la de un AR(<span class="math inline">\(p\)</span>) (o un sAR(<span class="math inline">\(P\)</span>) en el caso estacional).</p></li>
<li><p>La PACF tiene un comportamiento irregular en los <span class="math inline">\(p\)</span> primeros coeficientes (o <span class="math inline">\(P\)</span> en el caso estacional). A partir del orden <span class="math inline">\(p\)</span> (o <span class="math inline">\(P\)</span> en el caso estacional), se comporta como la de un MA(<span class="math inline">\(q\)</span>) (o de un sMA(<span class="math inline">\(Q\)</span>) en el caso estacional).</p></li>
</ul>
</li>
</ul>
</div>
<div id="ejemplo-de-las-acf-y-pacf-teóricas-de-los-procesos-estacionarios-arma11" class="section level4" number="20.3.1.3">
<h4>
<span class="header-section-number">20.3.1.3</span> Ejemplo de las ACF y PACF teóricas de los procesos estacionarios ARMA(1,1)<a class="anchor" aria-label="anchor" href="#ejemplo-de-las-acf-y-pacf-te%C3%B3ricas-de-los-procesos-estacionarios-arma11"><i class="fas fa-link"></i></a>
</h4>
<p>La ecuación que describe la dinámica de un modelo ARMA(1, 1) es:</p>
<p><span class="math inline">\(Y_t=\phi Y_{t-1}+ a_t-\theta a_{t-1}\)</span>, o bien, en forma polinómica, <span class="math inline">\(Y_t(1-\phi L)=(1-\theta L)a_t\)</span>, donde <span class="math inline">\(L\)</span> es el operador de retardos y <span class="math inline">\(a_t\)</span> es un ruido blanco.</p>
<p>Para que el modelo sea estacionario, es necesario que las raíces del polinomio de la parte autorregresiva estén fuera del círculo unidad (es decir, que <span class="math inline">\(|\phi|&lt;1\)</span>).</p>
<p>Para que sea invertible es necesario que las raíces del polinomio de las medias móviles estén fuera del círculo unidad (o que <span class="math inline">\(|\theta |&lt;1\)</span>).</p>
<p>Además, es necesario que no existan raíces comunes, es decir, <span class="math inline">\(\phi \neq \theta\)</span>.</p>
<p>Su ACF teórica es:</p>
<p><span class="math display">\[
\rho(k)=\left\{
\begin{array}{ll}
\frac{(1-\phi\theta)(\phi-\theta)}{1+\theta^2-2\phi\theta} &amp; \text{si } k=1 \\
\phi\rho(k-1)   &amp;  \text{}\forall k&gt;1.
\end{array}
\right.
\]</span></p>
<p>Su PACF teórica se obtiene como:</p>
<p><span class="math display">\[
\begin{array}{l}
\phi_{11}=\rho_1 \\
\\
\phi_{22}=\frac{\begin{vmatrix} 1&amp;\rho_1 \\ \rho_1 &amp;\rho_2\end{vmatrix}}{{\begin{vmatrix} 1&amp;\rho_1 \\ \rho_1 &amp;1\end{vmatrix}}}=\frac{\rho_2-\rho_1^2}{1-\rho_1^2}\\
\\
\phi_{33}=\frac{\begin{vmatrix} 1&amp;\rho_1&amp;\rho_1 \\ \rho_1 &amp;1&amp;\rho_2\\\rho_2 &amp;\rho_1&amp;\rho_3\end{vmatrix}}{{\begin{vmatrix} 1&amp;\rho_1&amp;\rho_2 \\ \rho_1 &amp;1&amp;\rho_1\\\rho_2 &amp;\rho_1&amp;1 \end{vmatrix}}}=\frac{\rho_1^3-\rho_1\rho_2(2-\rho_2)+\rho_3(1-\rho_1^2)}{1-\rho_2^2-2\rho_1^2(1-\rho_2)}\\
\\
\vdots
\end{array}
\]</span></p>
<div class="infobox">
<p><strong>Nota:</strong></p>
<p>La forma de obtener los diferentes coeficientes de la ACF y PACF de los modelos ARIMA estacionales es la misma que para los modelos ARIMA utilizados para la parte regular.</p>
<p>La diferencia fundamental reside en que para la parte regular se calculan los coeficientes de correlación entre las variables que se encuentran en períodos consecutivos de tiempo, mientras que para la parte estacional se hace entre las variables que están separadas entre sí <span class="math inline">\(s\)</span> períodos o múltiplos de <span class="math inline">\(s\)</span> (donde, por ejemplo, <span class="math inline">\(s=12\)</span>, si la serie es mensual; <span class="math inline">\(s=4\)</span> si la serie fuese trimestral, etc.). Por esta razón, solo se muestra la forma de calcular la ACF y la PACF correspondiente a la parte regular.</p>
</div>
<p>Teniendo en cuenta lo anterior, en el caso concreto del IPC, después de obtener su transformación estacionaria, la ACF y la PACF muestrales son muy útiles para identificar el modelo ARIMA más adecuado, así como su correspondiente orden en el período muestral estudiado.</p>
<p>A continuación se muestra el código <strong>R</strong> para ejecutar los comandos que permiten calcular y representar la ACF y la PACF muestrales de la transformación estacionaria del IPC (Fig. <a href="cap-series-temp.html#fig:acfd12dlipc">20.6</a> y Fig. <a href="cap-series-temp.html#fig:pacfd12dlipc">20.7</a>, respectivamente). El número de retardos (<span class="math inline">\(lags\)</span>) se establece en 40 para, así, incluir al menos 3 retardos estacionales (12, 24 y 36):</p>
<div class="sourceCode" id="cb305"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/acf.html">acf</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">d12dlogipc</span>, frequency <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, lag.max <span class="op">=</span> <span class="fl">40</span>, main <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:acfd12dlipc"></span>
<img src="img/acf1.png" alt="ACF. Función de autocorrelación muestral de $d12dLogIPC$." width="70%"><p class="caption">
Figura 20.6: ACF. Función de autocorrelación muestral de <span class="math inline">\(d12dLogIPC\)</span>.
</p>
</div>
<div class="sourceCode" id="cb306"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/acf.html">pacf</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">d12dlogipc</span>, frequency <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, lag.max <span class="op">=</span> <span class="fl">40</span>, main <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:pacfd12dlipc"></span>
<img src="img/pacf1.png" alt="PACF. Función de autocorrelación parcial muestral de $d12dLogIPC$." width="70%"><p class="caption">
Figura 20.7: PACF. Función de autocorrelación parcial muestral de <span class="math inline">\(d12dLogIPC\)</span>.
</p>
</div>
<p>Observando el comportamiento de estas funciones, para la parte regular se podría proponer un AR(1) y para la parte estacional un MA(1)12. Por lo tanto, ya que se ha calculado una diferencia regular y otra estacional para convertir a la serie original en estacionaria, el modelo ARIMA para el IPC, en el período muestral analizado, sería un ARIMA(1, 1, 0)(0, 1, 1) o sARIMA(1, 1, 0)(0, 1, 1). Cabe señalar que <strong>R</strong> permite la identificación automática de los órdenes del modelo.</p>
</div>
</div>
<div id="estimación-del-modelo" class="section level3" number="20.3.2">
<h3>
<span class="header-section-number">20.3.2</span> Estimación del modelo<a class="anchor" aria-label="anchor" href="#estimaci%C3%B3n-del-modelo"><i class="fas fa-link"></i></a>
</h3>
<p>Los parámetros del modelo se estiman por el método de máxima verosimilitud. Dado que la función de máxima verosimilitud no es lineal, para maximizarla se lleva a cabo un procedimiento iterativo de estimación no lineal. El código en <strong>R</strong> que permite obtener las estimaciones de los parámetros del modelo y sus correspondientes desviaciones típicas es:</p>
<div class="sourceCode" id="cb307"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">modelo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/arima.html">arima</a></span><span class="op">(</span><span class="va">ipc_ts</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">modelo</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; arima(x = ipc_ts, order = c(1, 1, 0), seasonal = c(0, 1, 1))</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt; ar1 sma1</span></span>
<span><span class="co">#&gt; 0.4665 -0.8302</span></span>
<span><span class="co">#&gt; s.e. 0.0701 0.0860</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; sigmaˆ2 estimated as 0.1082: log likelihood = -77.76, aic = 161.51</span></span></code></pre></div>
</div>
<div id="validación-1" class="section level3" number="20.3.3">
<h3>
<span class="header-section-number">20.3.3</span> Validación<a class="anchor" aria-label="anchor" href="#validaci%C3%B3n-1"><i class="fas fa-link"></i></a>
</h3>
<p>En la metodología ARIMA desarrollada por Box y Jenkins es necesario determinar si el modelo propuesto es correcto o no, es decir, si se ajusta o no correctamente a los datos de la muestra. Para ello, en la fase de validación, fundamentalmente, es necesario comprobar que:</p>
<ol style="list-style-type: decimal">
<li>Los parámetros del modelo estimado cumplen con las condiciones de estacionariedad e invertibilidad.</li>
</ol>
<p>El modelo estimado para el IPC es invertible y estacionario, ya que (<em>i</em>) la parte regular, al modelizarse mediante un AR(1), siempre va a ser invertible; además, dado que la estimación de <span class="math inline">\(\phi\)</span> es, en valor absoluto, menor que uno, es decir, <span class="math inline">\(|0.4665| &lt;1\)</span>, también es estacionario; (<em>ii</em>) la parte estacional sigue un esquema de medias móviles de primer orden (sMA(1)), que siempre es estacionario; como, adicionalmente, el valor absoluto de la estimación de <span class="math inline">\(\theta\)</span> es menor que uno (<span class="math inline">\(|-0.8302|&lt;1\)</span>), también es invertible.</p>
<p>Si alguna de las raíces del polinomio de retardos de la parte autorregresiva estuviese próxima a uno, entonces es posible que la serie original este subdiferenciada y, por lo tanto, no sería estacionaria, lo que implicaría la necesidad de calcular alguna diferencia adicional. Si fuese alguna de las raíces del polinomio de retardos de las medias móviles la que estuviese próxima a uno, entonces el modelo podría estar sobrediferenciado y habría que eliminar alguna diferencia. Además, si existiesen raíces comunes en ambos polinomios de retardos de la parte regular, sería necesario eliminar diferencias tanto en la parte autorregresiva como en la parte de medias móviles y el modelo correcto sería un ARIMA(<em>p</em>-1, <em>d</em>, <em>q</em>-1). Los comentarios anteriores son válidos para la parte estacional.</p>
<ol start="2" style="list-style-type: decimal">
<li>Los parámetros estimados son estadísticamente significativos.</li>
</ol>
<p>Para comprobar si los parámetros son estadísticamente significativos o no (o en otros términos, para comprobar si se ha sobreparametrizado o no el modelo), se realiza un contraste de significatividad individual para cada uno de ellos. Por ejemplo, para el parámetro del AR(1) la hipótesis nula y alternativa serían:
<span class="math display">\[
\begin{array}{l}
H_0:\phi=0 \\
H_1:\phi\neq 0.
\end{array}
\]</span></p>
<p>Para realizar el contraste se utiliza el estadístico <span class="math inline">\(t\)</span>, que sigue una distribución <span class="math inline">\(t\)</span>–Student con <span class="math inline">\((n-k)\)</span> grados de libertad. Este estadístico <span class="math inline">\(t\)</span> se calcula dividiendo el valor estimado del parámetro entre su correspondiente error estándar. En concreto, para los dos parámetros estimados de este modelo (el correspondiente al AR(1) de la parte regular y al sMA de la parte estacional) se tiene:</p>
<p><span class="math display">\[
t=\frac{0,4665}{0,0701} = 6,654 \quad y\quad |t|=|\frac{-0,8302}{0,0860}|=9,653.
\]</span></p>
<p>Como, para un nivel de significación del 5% y 248 grados de libertad, el valor crítico de la <span class="math inline">\(t\)</span>–Student es aproximadamente 1,96, se rechaza <span class="math inline">\(H_0\)</span>, lo que implica que las estimaciones de los dos parámetros del modelo son estadísticamente distintas de cero.</p>
<ol start="3" style="list-style-type: decimal">
<li>Los residuos del modelo son ruido blanco.</li>
</ol>
<p>Como se avanzó al final de la Sec. <a href="cap-series-temp.html#conceptos">20.1</a>, uno de los supuestos de la modelización ARIMA es que el error del modelo (o perturbación aleatoria) tiene que ser ruido blanco. Como los errores no son observables, las comprobaciones se llevan a cabo sobre los residuos (diferencia entre los valores reales y los predichos por el modelo). Existen varias formas de comprobar si los residuos son ruido blanco o no. Entre ellas, las más utilizadas son: el gráfico de la serie original de residuos, la ACF y la PACF estimadas y el contraste de Portmanteau (planteado inicialmente por Box-Pierce y actualizado posteriormente por Ljung-Box).</p>
<p>En primer lugar, de forma intuitiva, el gráfico de los residuos puede mostrar si la media es constante e igual a cero y si su varianza también es constante. Además, puede reflejar si existen valores atípicos u <em>outliers</em> (se consideran como tales aquellos que superen tres veces su desviación típica). El siguiente código <strong>R</strong> permite obtener los residuos y su representación gráfica (Fig. <a href="cap-series-temp.html#fig:residuos">20.8</a>).</p>
<div class="sourceCode" id="cb308"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">residuos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="va">modelo</span><span class="op">)</span></span>
<span><span class="va">ts_residuos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>value <span class="op">=</span> <span class="va">residuos</span>, Time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/time.html">time</a></span><span class="op">(</span><span class="va">residuos</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">ts_residuos</span>,</span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">Time</span>,</span>
<span>    y <span class="op">=</span> <span class="va">residuos</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:residuos"></span>
<img src="img/ipc-residuos.png" alt="Gráfico de los residuos." width="50%"><p class="caption">
Figura 20.8: Gráfico de los residuos.
</p>
</div>
<p>En la Fig. <a href="cap-series-temp.html#fig:residuos">20.8</a> se observa que la media es constante e igual a cero y que a partir de febrero de 2022, como consecuencia de las tensiones inflacionarias, los residuos son mayores que en el resto del período muestral.</p>
<p>En segundo lugar, se pueden calcular la ACF y la PACF muestrales de los residuos para comprobar que están incorrelacionados, es decir, que los coeficientes de correlación calculados son estadísticamente nulos. Si estos fuesen estadísticamente significativos, los residuos no serían ruido blanco. Entonces, para la correcta modelización habría que identificar el proceso e incorporarlo al modelo inicial propuesto para volver a estimarlo. Los correlogramas obtenidos con el código que se muestra a continuación (Fig. <a href="cap-series-temp.html#fig:acfpacfresiduos">20.9</a>) indican que no hay coeficientes de correlación estadísticamente significativos (ya que se encuentran dentro de los intervalos de confianza) y, por lo tanto, los residuos son ruido blanco.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;A veces, pueden observarse 1 o 2 correlaciones significativas en desfases de mayor orden no estacionales. Ello se debe, generalmente, a un error aleatorio y no constituye una señal de inclumplimiento del supuesto, por lo que se puede concluir que los residuos son independientes. Tal es el caso en la Fig. &lt;a href="cap-series-temp.html#fig:acfpacfresiduos"&gt;20.9&lt;/a&gt;, concretamente en la PACF.&lt;/p&gt;'><sup>154</sup></a></p>
<div class="sourceCode" id="cb309"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/acf.html">acf</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">residuos</span>, frequency <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, lag.max <span class="op">=</span> <span class="fl">40</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/acf.html">pacf</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">residuos</span>, frequency <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, lag.max <span class="op">=</span> <span class="fl">40</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:acfpacfresiduos"></span>
<img src="img/acf-pacf.png" alt="ACF y PACF estimadas de los residuos." width="50%"><p class="caption">
Figura 20.9: ACF y PACF estimadas de los residuos.
</p>
</div>
<p>También se puede utilizar el contraste de Portmanteau (Ljung-Box) para comprobar si los residuos están incorrelacionados y se comportan como un ruido blanco o no. En este contraste global de significación, la hipótesis nula que se plantea, en el caso del IPC, es que los primeros 40 coeficientes de correlación son cero frente a la hipótesis alternativa de que no lo son. Para un nivel de significación del 5%, la evidencia empírica no es suficiente para rechazar <span class="math inline">\(H_0\)</span>, ya que el <em>p</em>–valor correspondiente al estadístico del contraste (Chi-cuadrado) es 0,5448, mayor que el nivel de significación del 5% y, por lo tanto, se concluye que los residuos están incorrelacionados. El código <strong>R</strong> para llevar a cabo el test de Box-Ljung es:</p>
<div class="sourceCode" id="cb310"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/box.test.html">Box.test</a></span><span class="op">(</span><span class="va">residuos</span>, type <span class="op">=</span> <span class="st">"Ljung-Box"</span><span class="op">)</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; Box-Ljung test</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; data: residuos</span></span>
<span><span class="co">#&gt; X-squared = 0.36682, df = 1, p-value = 0.5447</span></span></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li>Análisis de la bondad del ajuste.</li>
</ol>
<p>Finalmente, se debe comprobar la capacidad de ajuste del modelo comparando los valores observados y los estimados. Una forma sencilla e intuitiva de hacerlo es a través de su representación gráfica. El código <strong>R</strong> utilizado para ello es el siguiente:</p>
<div class="sourceCode" id="cb311"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">ipc_ts</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">ipc_ts</span> <span class="op">-</span> <span class="va">modelo</span><span class="op">$</span><span class="va">residuals</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:ajuste"></span>
<img src="img/modelo-ipc.png" alt="Ajuste con el modelo estimado." width="50%"><p class="caption">
Figura 20.10: Ajuste con el modelo estimado.
</p>
</div>
<p>La Fig. <a href="cap-series-temp.html#fig:ajuste">20.10</a> muestra que el modelo estimado se ajusta bastante bien a los valores observados y, por lo tanto, evidencia que el modelo sARIMA (1, 1, 0)(0, 1, 1) propuesto capta la dinámica del IPC en el período muestral analizado.</p>
<p>Para comprobar la adecuación entre el modelo estimado y los valores observados no suele ser adecuado utilizar el coeficiente de determinación o el coeficiente de determinación corregido, ya que si hay que calcular diferencias para convertir la serie en estacionaria, la variable dependiente cambia (es decir, no es lo mismo <span class="math inline">\(Y_t\)</span>, que <span class="math inline">\(dlog(Y_t)\)</span>, que <span class="math inline">\(d12dlog(Y_t)\)</span>). Si se quieren comparar diferentes modelos para elegir cuál es el que mejor se ajusta a los datos, hay que utilizar otros métodos de información, como el criterio de información de Akaike (AIC), el criterio bayesiano o de Schwarz (BIC) o el de Hannan-Quinn (HQC). Si, por ejemplo, se eligiese el AIC será mejor el modelo con menor AIC.</p>
</div>
<div id="predicción-2" class="section level3" number="20.3.4">
<h3>
<span class="header-section-number">20.3.4</span> Predicción<a class="anchor" aria-label="anchor" href="#predicci%C3%B3n-2"><i class="fas fa-link"></i></a>
</h3>
<p>Después de comprobar que el modelo ARIMA estimado es adecuado, se puede utilizar para obtener valores futuros de la variable objeto de análisis. Las predicciones que se obtienen pueden ser de dos tipos: puntuales o por intervalos. Las predicciones puntuales para un horizonte temporal <em>h</em> se obtienen calculando el valor esperado de la variable dependiente en <span class="math inline">\(T+h\)</span> (<span class="math inline">\((Y_{T+h})\)</span>) condicionado al conjunto de información disponible hasta el momento actual (<span class="math inline">\(T\)</span>). Para obtener las predicciones por intervalos es necesario sumar y restar a la predicción puntual la desviación típica del error de predicción multiplicada por el valor crítico tabulado para el nivel de confianza fijado.</p>
<p>Algunas características generales de las prediciones obtenidas con modelos ARIMA son:</p>
<p>En el caso concreto del IPC, para obtener 12 predicciones puntuales y sus correspondientes intervalos de predicción al 80% y 95% de confianza, así como su representación gráfica (Fig. <a href="cap-series-temp.html#fig:prediccion">20.11</a>), el código <strong>R</strong> que hay que utilizar es:</p>
<div class="sourceCode" id="cb312"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">forecast</span><span class="fu">::</span><span class="fu">forecast</span><span class="op">(</span><span class="va">modelo</span>, h <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Point Forecast    Lo 80    Hi 80    Lo 95    Hi 95</span></span>
<span><span class="co">#&gt; Apr 2022 109.7116 109.2900 110.1332 109.0668 110.3564</span></span>
<span><span class="co">#&gt; May 2022 110.5926 109.8443 111.3410 109.4481 111.7371</span></span>
<span><span class="co">#&gt; Jun 2022 111.1030 110.0714 112.1346 109.5253 112.6806</span></span>
<span><span class="co">#&gt; Jul 2022 110.5518 109.2748 111.8289 108.5987 112.5050</span></span>
<span><span class="co">#&gt; Aug 2022 110.7714 109.2787 112.2641 108.4885 113.0543</span></span>
<span><span class="co">#&gt; Sep 2022 111.0288 109.3435 112.7140 108.4515 113.6060</span></span>
<span><span class="co">#&gt; Oct 2022 111.9631 110.1034 113.8228 109.1189 114.8073</span></span>
<span><span class="co">#&gt; Nov 2022 112.1740 110.1540 114.1939 109.0847 115.2632</span></span>
<span><span class="co">#&gt; Dec 2022 112.3896 110.2209 114.5583 109.0728 115.7064</span></span>
<span><span class="co">#&gt; Jan 2023 111.6049 109.2968 113.9130 108.0750 115.1349</span></span>
<span><span class="co">#&gt; Feb 2023 111.6666 109.2270 114.1061 107.9355 115.3976</span></span>
<span><span class="co">#&gt; Mar 2023 112.5012 109.9369 115.0656 108.5794 116.4231</span></span>
<span></span>
<span><span class="va">predicciones</span> <span class="op">&lt;-</span> <span class="fu">forecast</span><span class="fu">::</span><span class="fu">forecast</span><span class="op">(</span><span class="va">modelo</span>, h <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span><span class="op">(</span><span class="va">predicciones</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:prediccion"></span>
<img src="img/ipc-forcast.png" alt="Predicciones con el modelo ARIMA(1, 1, 0)(0, 1, 1) estimado." width="80%"><p class="caption">
Figura 20.11: Predicciones con el modelo ARIMA(1, 1, 0)(0, 1, 1) estimado.
</p>
</div>
</div>
<div id="resumen-19" class="section level3 unnumbered infobox_resume">
<h3>Resumen<a class="anchor" aria-label="anchor" href="#resumen-19"><i class="fas fa-link"></i></a>
</h3>
<p>Los modelos univariantes ARIMA analizan las series de tiempo desde un punto de vista moderno y estocástico y son muy útiles para captar su dinámica. Es importante destacar que:</p>
<ul>
<li><p>Hay que tener en cuenta conceptos básicos que son fundamentales para llevar a cabo una correcta modelización ARIMA. Entre ellos, se pueden destacar los siguientes: proceso estocástico, estacionalidad, estacionariedad, invertibilidad y ruido blanco.</p></li>
<li><p>Las principales fases en el análisis de un modelo ARIMA son: especificación, estimación, validación y predicción.</p></li>
<li><p>Para identificar el modelo ARIMA que mejor capta la dinámica de la serie temporal objeto de análisis, es necesario que los datos sean estacionarios en media y en varianza.</p></li>
<li><p>La ACF y la PACF muestrales son muy útiles para identificar el modelo más adecuado para explicar la dinámica de los datos.</p></li>
<li><p>Para comprobar que el modelo estimado es adecuado es necesario realizar un análisis de los parámetros estimados, un análisis de los residuos y medir la bondad del ajuste.</p></li>
<li><p>Validado el modelo, se suele utilizar, fundamentalmente, para predecir y tomar decisiones.</p></li>
</ul>
</div>

</div>
</div>

  <div class="chapter-nav">
<div class="prev"><a href="cap-sparse.html"><span class="header-section-number">19</span> Modelos \(\textit{sparse}\) y métodos penalizados de regresión</a></div>
<div class="next"><a href="cap-discriminante.html"><span class="header-section-number">21</span> Análisis discriminante</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="Índice del capítulo"><h2>Índice del capítulo</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#cap-series-temp"><span class="header-section-number">20</span> Modelización de series temporales</a></li>
<li><a class="nav-link" href="#conceptos"><span class="header-section-number">20.1</span> Conceptos básicos</a></li>
<li><a class="nav-link" href="#modelos-arima"><span class="header-section-number">20.2</span> Modelos ARIMA</a></li>
<li>
<a class="nav-link" href="#an%C3%A1lisis-de-series-temporales-con-r"><span class="header-section-number">20.3</span> Análisis de series temporales con R</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#identificaci%C3%B3n-o-especificaci%C3%B3n-del-modelo"><span class="header-section-number">20.3.1</span> Identificación o especificación del modelo</a></li>
<li><a class="nav-link" href="#estimaci%C3%B3n-del-modelo"><span class="header-section-number">20.3.2</span> Estimación del modelo</a></li>
<li><a class="nav-link" href="#validaci%C3%B3n-1"><span class="header-section-number">20.3.3</span> Validación</a></li>
<li><a class="nav-link" href="#predicci%C3%B3n-2"><span class="header-section-number">20.3.4</span> Predicción</a></li>
<li><a class="nav-link" href="#resumen-19">Resumen</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Fundamentos de ciencia de datos con <strong>R</strong></strong>" coordinado por <a href="https://blog.uclm.es/gemafaviles/" class="text-light">Gema Fernández-Avilés y José-María Montero</a>. </p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>Este libro ha sido generado con el paquete de R <a class="text-light" href="https://bookdown.org">bookdown</a>.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
