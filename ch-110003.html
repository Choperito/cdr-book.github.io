<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Capítulo 3 R para ciencia de datos | Fundamentos de ciencia de datos con R</title>
<meta name="author" content="Gema Fernández-Avilés y José-María Montero">
<meta name="description" content="Emilio L. Cano Universidad Rey Juan Carlos  3.1 Introducción  El análisis estadístico de datos es una tarea fundamental en la transformación digital de las empresas y organizaciones. Siempre ha...">
<meta name="generator" content="bookdown 0.28 with bs4_book()">
<meta property="og:title" content="Capítulo 3 R para ciencia de datos | Fundamentos de ciencia de datos con R">
<meta property="og:type" content="book">
<meta property="og:image" content="/img/cover.png">
<meta property="og:description" content="Emilio L. Cano Universidad Rey Juan Carlos  3.1 Introducción  El análisis estadístico de datos es una tarea fundamental en la transformación digital de las empresas y organizaciones. Siempre ha...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Capítulo 3 R para ciencia de datos | Fundamentos de ciencia de datos con R">
<meta name="twitter:description" content="Emilio L. Cano Universidad Rey Juan Carlos  3.1 Introducción  El análisis estadístico de datos es una tarea fundamental en la transformación digital de las empresas y organizaciones. Siempre ha...">
<meta name="twitter:image" content="/img/cover.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.4.2/transition.js"></script><script src="libs/bs3compat-0.4.2/tabs.js"></script><script src="libs/bs3compat-0.4.2/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><link href="libs/tabwid-1.1.0/tabwid.css" rel="stylesheet">
<link href="libs/tabwid-1.1.0/scrool.css" rel="stylesheet">
<script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="bs4_style.css">
<link rel="stylesheet" href="bs4_book.css">
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Fundamentos de ciencia de datos con R</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Buscar" aria-label="Buscar">
</form>

      <nav aria-label="Contenido"><h2>Contenido</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Prefacio</a></li>
<li class="book-part">Ciencia, datos, software… y científicos</li>
<li><a class="" href="ciencia-datos.html"><span class="header-section-number">1</span> ¿Es la ciencia de datos una ciencia?</a></li>
<li><a class="" href="metodologia.html"><span class="header-section-number">2</span> Metodología en ciencia de datos</a></li>
<li><a class="active" href="ch-110003.html"><span class="header-section-number">3</span> R para ciencia de datos</a></li>
<li><a class="" href="cap-etica.html"><span class="header-section-number">4</span> Ética en la ciencia de datos</a></li>
<li class="book-part">Bienvenidos a la jungla de datos</li>
<li><a class="" href="datos-sql.html"><span class="header-section-number">5</span> Gestión de bases de datos relacionales</a></li>
<li><a class="" href="cap-nosql.html"><span class="header-section-number">6</span> Gestión de bases de datos NoSQL</a></li>
<li><a class="" href="DGDQM.html"><span class="header-section-number">7</span> Gobierno, gestión y calidad del dato</a></li>
<li><a class="" href="id_130009.html"><span class="header-section-number">8</span> Integración y limpieza de datos</a></li>
<li><a class="" href="chap-feature.html"><span class="header-section-number">9</span> Selección y transformación de variables</a></li>
<li><a class="" href="chap-herramientas.html"><span class="header-section-number">10</span> Herramientas para el análisis en ciencia de datos</a></li>
<li><a class="" href="id_120006-aed.html"><span class="header-section-number">11</span> Análisis exploratorio de datos</a></li>
<li class="book-part">Fundamentos de estadística</li>
<li><a class="" href="Funda-probab.html"><span class="header-section-number">12</span> Probabilidad</a></li>
<li><a class="" href="Fundainfer.html"><span class="header-section-number">13</span> Inferencia estadística</a></li>
<li><a class="" href="muestreo.html"><span class="header-section-number">14</span> Muestreo y remuestreo</a></li>
<li class="book-part">Modelización estadística</li>
<li><a class="" href="cap-lm.html"><span class="header-section-number">15</span> Modelización lineal</a></li>
<li><a class="" href="cap-glm.html"><span class="header-section-number">16</span> Modelos lineales generalizados</a></li>
<li><a class="" href="cap-gam.html"><span class="header-section-number">17</span> Modelos aditivos generalizados</a></li>
<li><a class="" href="cap-mxm.html"><span class="header-section-number">18</span> Modelos mixtos</a></li>
<li><a class="" href="cap-sparse.html"><span class="header-section-number">19</span> Modelos sparse y métodos penalizados de regresión</a></li>
<li><a class="" href="cap-series-temp.html"><span class="header-section-number">20</span> Modelización de series temporales</a></li>
<li><a class="" href="cap-discriminante.html"><span class="header-section-number">21</span> Análisis discriminante</a></li>
<li><a class="" href="cap-conjunto.html"><span class="header-section-number">22</span> Análisis conjunto</a></li>
<li><a class="" href="tablas-contingencia.html"><span class="header-section-number">23</span> Análisis de tablas de contingencia</a></li>
<li class="book-part">Machine learning supervisado</li>
<li><a class="" href="cap-arboles.html"><span class="header-section-number">24</span> Árboles de clasificación y regresión</a></li>
<li><a class="" href="cap-svm.html"><span class="header-section-number">25</span> Máquinas de vector soporte</a></li>
<li><a class="" href="cap-knn.html"><span class="header-section-number">26</span> Clasificador k-vecinos más próximos</a></li>
<li><a class="" href="cap-naive-bayes.html"><span class="header-section-number">27</span> Naive Bayes</a></li>
<li><a class="" href="cap-bagg-rf.html"><span class="header-section-number">28</span> Métodos ensamblados: bagging y random forest</a></li>
<li><a class="" href="cap-boosting-xgboost.html"><span class="header-section-number">29</span> Boosting y el algoritmo XGBoost</a></li>
<li class="book-part">Machine learning no supervisado</li>
<li><a class="" href="jerarquico.html"><span class="header-section-number">30</span> Análisis cluster: clusterización jerárquica</a></li>
<li><a class="" href="no-jerarquico.html"><span class="header-section-number">31</span> Análisis cluster: clusterización no jerárquica</a></li>
<li><a class="" href="acp.html"><span class="header-section-number">32</span> Análisis de componentes principales</a></li>
<li><a class="" href="an%C3%A1lisis-factorial.html"><span class="header-section-number">33</span> Análisis factorial</a></li>
<li><a class="" href="escalamiento-multidimensional.html"><span class="header-section-number">34</span> Escalamiento multidimensional</a></li>
<li><a class="" href="correspondencias.html"><span class="header-section-number">35</span> Análisis de correspondencias</a></li>
<li class="book-part">Deep learning</li>
<li><a class="" href="capNN.html"><span class="header-section-number">36</span> Redes neuronales artificiales</a></li>
<li><a class="" href="cap-redes-convol.html"><span class="header-section-number">37</span> Redes neuronales convolucionales</a></li>
<li class="book-part">Ciencia de datos de texto y redes</li>
<li><a class="" href="mineria-textos.html"><span class="header-section-number">38</span> Minería de textos</a></li>
<li><a class="" href="grafos.html"><span class="header-section-number">39</span> Análisis de grafos y redes sociales</a></li>
<li class="book-part">Ciencia de datos espaciales</li>
<li><a class="" href="datos-espaciales.html"><span class="header-section-number">40</span> Trabajando con datos espaciales</a></li>
<li><a class="" href="geo.html"><span class="header-section-number">41</span> Geoestadística</a></li>
<li><a class="" href="cap-econom-esp.html"><span class="header-section-number">42</span> Modelos econométricos espaciales</a></li>
<li><a class="" href="cap-pp.html"><span class="header-section-number">43</span> Procesos de puntos</a></li>
<li class="book-part">Comunica y colabora</li>
<li><a class="" href="id_120007-informes.html"><span class="header-section-number">44</span> Informes reproducibles con R Markdown y Quarto</a></li>
<li><a class="" href="shiny.html"><span class="header-section-number">45</span> Creación de aplicaciones web interactivas con Shiny</a></li>
<li><a class="" href="github.html"><span class="header-section-number">46</span> Git y GitHub R</a></li>
<li><a class="" href="geoproces.html"><span class="header-section-number">47</span> Geoprocesamiento en nube</a></li>
<li class="book-part">Casos de estudio en ciencia de datos</li>
<li><a class="" href="cap-crimen.html"><span class="header-section-number">48</span> Análisis de una red criminal</a></li>
<li><a class="" href="cap-publicidad.html"><span class="header-section-number">49</span> Optimización de inversiones publicitarias</a></li>
<li><a class="" href="cap-twitter.html"><span class="header-section-number">50</span> ¿Cómo twitea Elon Musk?</a></li>
<li><a class="" href="cap-periodismo.html"><span class="header-section-number">51</span> Análisis electoral: de Rstudio a su periódico</a></li>
<li><a class="" href="paro-clm.html"><span class="header-section-number">52</span> Crisis: impacto en el paro de Castilla-La Mancha</a></li>
<li><a class="" href="cap-rfm.html"><span class="header-section-number">53</span> Segmentación de clientes en el comerico minorista</a></li>
<li><a class="" href="cap-medicina.html"><span class="header-section-number">54</span> Análisis de datos en medicina</a></li>
<li><a class="" href="cap-futbol.html"><span class="header-section-number">55</span> Messi y Ronaldo: dos ídolos desde la perspectiva de los datos</a></li>
<li><a class="" href="cambioclimatico.html"><span class="header-section-number">56</span> Un dato sobre el cambio climático</a></li>
<li><a class="" href="cap-ree.html"><span class="header-section-number">57</span> Predicción de consumo eléctrico con redes neuronales</a></li>
<li><a class="" href="cap-sist-exp.html"><span class="header-section-number">58</span> Implementación de un sistema experto en el ámbito pediátrico</a></li>
<li><a class="" href="nlp-textil.html"><span class="header-section-number">59</span> El procesamiento del lenguaje natural para tendencias de moda en textil</a></li>
<li><a class="" href="cap-fraude.html"><span class="header-section-number">60</span> Detección de fraude de tarjetas de crédito</a></li>
<li class="book-part">Appendix</li>
<li><a class="" href="info-session.html"><span class="header-section-number">A</span> Información de la sesión</a></li>
<li><a class="" href="referncias.html">Referncias</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="ch-110003" class="section level1" number="3">
<h1>
<span class="header-section-number">Capítulo 3</span> R para ciencia de datos<a class="anchor" aria-label="anchor" href="#ch-110003"><i class="fas fa-link"></i></a>
</h1>
<p><em>Emilio L. Cano</em></p>
<p>Universidad Rey Juan Carlos</p>
<div id="introducción" class="section level2" number="3.1">
<h2>
<span class="header-section-number">3.1</span> Introducción<a class="anchor" aria-label="anchor" href="#introducci%C3%B3n"><i class="fas fa-link"></i></a>
</h2>
<p>
</p>
<p>El análisis estadístico de datos es una tarea fundamental
en la transformación digital de las empresas y organizaciones.
Siempre ha estado ahí, pero
en la actualidad la disponibilidad de datos, la cantidad de los mismos,
y la velocidad con la que se requieren resultados, está haciendo
necesario el capacitar a los profesionales
para su análisis con nuevas herramientas. Nuevas tendencias (muchas veces
malinterpretadas) como Inteligencia Artificial, <em>Big Data</em>, Industria 4.0, <em>Internet of Things</em> (IoT),
o <em>Data Science</em>, aumentan el interés por parte de las empresas, los profesionales
y los investigadores en estas técnicas.</p>
<p>El tratamiento de datos y su análisis requiere el uso de
software avanzado. Aunque algunas tareas como, por ejemplo, mecanizar y almacenar datos, se pueden realizar
eficazmente con programas de hoja de cálculo
como Excel,
se debería
utilizar software especializado para el análisis de datos. Existen distintos
paquetes estadísticos comerciales, como SPSS, Statgraphics, Stata, SAS, JMP o Minitab. En los últimos
años se ha abierto camino como alternativa el <a href="http://www.r-project.org">software estadístico y lenguaje de
programación <strong>R</strong></a> <span class="citation">(<a href="referncias.html#ref-R-base">R Core Team 2021</a>)</span>. Hay otras alternativas que, en su mayoría, o son parciales, referidas a un
ámbito concreto, o son más lenguajes de programación que software estadístico, como Python.
<strong>R</strong> es software libre, pero su gratuidad sólo es una
de sus ventajas, como se verá a lo largo del libro. Su gran inconveniente
es la curva de aprendizaje: no es tan fácil de aprender y usar como un
software de ventanas, ya que el uso de <strong>R</strong> se basa en expresiones que
hay que ejecutar desde <em>scripts</em> (archivos de código).</p>
<p><strong>R</strong> es un
sistema para <strong>computación estadística</strong>: software de <strong>análisis de datos</strong> y
<strong>lenguaje de programación</strong>. Ha sido ampliamente utilizado en investigación y docencia,
y actualmente también
en las empresas y organismos públicos. Es la evolución del trabajo de los laboratorios Bell con el
lenguaje S <span class="citation">(<a href="referncias.html#ref-venables2002modern">Venables and Ripley 2002</a>)</span>,
llevado al mundo del software libre por Ross Ihaka y Robert Gentleman en los años 90 <span class="citation">(<a href="referncias.html#ref-ihaka1996r">Ihaka and Gentleman 1996</a>)</span>.
La version R 1.0.0 se publicó el 29 de febrero de 2000.</p>
<p></p>
<p>Uno de los aspectos más espectaculares de <strong>R</strong> es la cantidad de <strong>paquetes</strong>
disponibles. Un paquete (<em>package</em>) de <strong>R</strong> es un componente con funcionalidad adicional que se puede
instalar en el sistema para ser utilizado por <strong>R</strong>. En el momento de
compilar este libro, el número de paquetes disponibles en el repositorio oficial
es de 19724.</p>
<p>Una vez conocido el mundo de <strong>R</strong>, se plantea la siguiente pregunta: ¿y por qué
utilizar <strong>R</strong>? Es imposible dar un único motivo. A continuación se enumeran
algunos de ellos:</p>
<ul>
<li>Es Free and Open Source Software (FOSS). Gratis y libre. En inglés se suele decir <em>free as in free beer, and free as in free speech</em>.</li>
<li>Tiene una amplia comunidad de usuarios que proporciona recursos.</li>
<li>Es multiplataforma.</li>
<li>Se usa cada vez en más empresas e instituciones.</li>
<li>Es posible obtener soporte comercial, por ejemplo a través de Posit Software PBC<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;&lt;a href="https://posit.co" class="uri"&gt;https://posit.co&lt;/a&gt;, antes RStudio PBC.&lt;/p&gt;'><sup>3</sup></a>.</li>
<li>Se ha alcanzado una masa crítica de usuarios que lo hace confiable.</li>
<li>Es extensible (desde pequeñas funciones, hasta paquetes).</li>
<li>Se puede implementar la innovación inmediatamente. En software comercial hay que esperar a nuevas versiones, en el mejor de los casos.</li>
<li>Posee características de “investigación reproducible”. En el Cap. <a href="#120007-informes"><strong>??</strong></a> se tratará
qué implica este enfoque. En contextos distintos a la investigación, se puede hablar de informes reproducibles y trazabilidad del análisis.</li>
</ul>
<p>Por otra parte, el uso de <strong>R</strong> en las empresas está <strong>creciendo exponencialmente</strong> debido, principalmente, a la necesidad de analizar y visualizar datos con herramientas potentes para explotar todo su potencial. Grandes empresas de todos los sectores llevan tiempo utilizándolo, si bien la popularización del software y su conocimiento entre los nuevos titulados está facilitando que empresas de todo tipo y tamaño aprovechen esta herramienta en su estrategia digital. Así, además de la <strong>visualización y presentación efectiva</strong> de los datos, equipos bien formados pueden descubrir relaciones entre variables clave, realizar <strong>predicciones</strong>, tomar mejores decisiones o <strong>mejorar sus procesos</strong> gracias al análisis avanzado de datos más allá de la hoja de cálculo.</p>
</div>
<div id="id_110003-bases" class="section level2" number="3.2">
<h2>
<span class="header-section-number">3.2</span> La sesión de <strong>R</strong><a class="anchor" aria-label="anchor" href="#id_110003-bases"><i class="fas fa-link"></i></a>
</h2>
<p><strong>R</strong> es una aplicación de análisis estadístico
y representación gráfica de datos, y además un lenguaje de programación.
<strong>R</strong> es <strong>interactivo</strong>, en el sentido de que
responde a través de un “intérprete” a las <strong>entradas</strong> que recibe
a través de la <strong>consola</strong>.</p>
<p>La interfaz de usuario de <strong>R</strong> (R GUI, <em>Graphical User Interface</em>) cumple las funciones básicas para
interactuar con <strong>R</strong>, pero es muy pobre a la hora de trabajar con ella. En su lugar,
es más conveniente utilizar el entorno de desarrollo <a href="http://www.rstudio.org">RStudio Desktop</a> (o su versión en la nube <a href="https://posit.cloud/" class="uri">https://posit.cloud/</a>),
que es como un
“envoltorio” del sistema <strong>R</strong> con más funcionalidades y ayudas, pero
manteniendo el mismo nivel de interacción: consola y <em>scripts</em><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;Lo importante
es seguir un estilo consistente en cuanto a nombres de objetos, espacios
en blanco y el uso de delimitadores y tabulación en el &lt;em&gt;script&lt;/em&gt;. Véase por ejemplo
la &lt;a href="http://adv-r.had.co.nz/Style.html"&gt;guía de estilo de Hadley Wickam&lt;/a&gt;
&lt;span class="citation"&gt;(&lt;a href="referncias.html#ref-wickham2015advanced"&gt;H. Wickham 2015a&lt;/a&gt;)&lt;/span&gt;.&lt;/p&gt;'><sup>4</sup></a>. Al igual que <strong>R</strong>, RStudio es una aplicación de software libre, pero, en este caso, desarrollada y mantenida por la compañía privada Posit PBC.</p>
<div class="infobox">
<p>Una cosa muy importante en <strong>R</strong> es que las expresiones son <strong>sensibles a mayúsculas</strong>,
y por tanto los objetos <code>datos</code> y <code>Datos</code> son distintos.</p>
</div>
</div>
<div id="instalación-de-r" class="section level2" number="3.3">
<h2>
<span class="header-section-number">3.3</span> Instalación de <strong>R</strong><a class="anchor" aria-label="anchor" href="#instalaci%C3%B3n-de-r"><i class="fas fa-link"></i></a>
</h2>
<p>Durante todo el libro se utiliza la interfaz RStudio. Pero, como se avanzó anteriormente, RStudio
es solo un “envoltorio” de <strong>R</strong>, por lo que previamente hay que tener instalado
en el ordenador el sistema “base” de <strong>R</strong>. <strong>R</strong> está disponible para sistemas
Windows, MacOS y Linux. Por cuestiones de espacio, no se incluyen detalles en este libro, pero la instalación es sencilla siguiendo las instrucciones en sus correspondientes websites:</p>
<ol style="list-style-type: decimal">
<li>Instalación de <strong>R</strong>: <a href="http://www.r-project.org" class="uri">http://www.r-project.org</a>
</li>
<li>Instalación de RStudio: <a href="https://posit.co" class="uri">https://posit.co</a>
</li>
</ol>
<p>Para completar la instalación de <strong>R</strong>, se muestra cómo instalar<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Una vez instalado un paquete no hay que volver a instalarlo.&lt;/p&gt;"><sup>5</sup></a> los paquetes del <code>tidyverse</code><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;El &lt;em&gt;tidyverse&lt;/em&gt; es un conjunto de paquetes que se irán describiendo a medida que se utilicen, especialmente en la Sec. &lt;a href="#110003-tidyverse"&gt;&lt;strong&gt;??&lt;/strong&gt;&lt;/a&gt;.&lt;/p&gt;'><sup>6</sup></a> mediante expresiones en la consola o <em>script</em> con la función <code><a href="https://rdrr.io/r/utils/install.packages.html">install.packages()</a></code>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span>pkgs <span class="op">=</span> <span class="st">"tidyverse"</span><span class="op">)</span></span></code></pre></div>
<p>Una vez instalado el paquete, se cargará con la instrucción <code><a href="https://rdrr.io/r/base/library.html">library("nombre_paquete")</a></code> en la sesión de <strong>R</strong> donde se quiera utilizar.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://tidyverse.tidyverse.org">"tidyverse"</a></span><span class="op">)</span></span></code></pre></div>
<p>A veces resulta útil usar directamente
la función que se va a utilizar en vez de cargar todo el paquete. Esto se hace con el operador <code>::</code>, es decir, <code>nombre_paquete::funcion()</code>. La siguiente expresión serviría para usar
la función <code><a href="https://dplyr.tidyverse.org/reference/select.html">select()</a></code> del paquete <code>dplyr</code> sin cargar el paquete entero.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="id_110003-proyectos" class="section level2" number="3.4">
<h2>
<span class="header-section-number">3.4</span> Trabajar con proyectos de RStudio<a class="anchor" aria-label="anchor" href="#id_110003-proyectos"><i class="fas fa-link"></i></a>
</h2>
<p></p>
<p>La manera más eficiente de trabajar con <strong>R</strong>, es mediante <strong>proyectos</strong>
de RStudio. Esto permite abstraerse de los detalles de la sesión de <strong>R</strong>
(espacio de trabajo, directorio de trabajo, <em>environment</em>), ya que al abrir
un proyecto estará todo preparado para seguir el trabajo donde se dejó,
o empezar de cero si se acaba de crear.
Para crear un proyecto de RStudio, se despliega el menú de proyectos a la derecha en la barra de herramientas y se selecciona “New Project…” También se puede hacer en el menú “File/New Project…”.</p>
<p>Es aconsejable crear siempre una estructura
de carpetas que permita tener todo organizado desde el principio,
porque al final los proyectos crecen. La estructura perfecta no existe,
y depende del proyecto particular. Las siguientes carpetas pueden ser
útiles en un amplio abanico de proyectos, y
las tres primeras se pueden usar prácticamente en cualquier proyecto:</p>
<ul>
<li>
<svg aria-hidden="true" role="img" viewbox="0 0 512 512" style="height:1em;width:1em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;"><path d="M447.1 96h-172.1L226.7 50.75C214.7 38.74 198.5 32 181.5 32H63.1c-35.35 0-64 28.66-64 64v320c0 35.34 28.65 64 64 64h384c35.35 0 64-28.66 64-64V160C511.1 124.7 483.3 96 447.1 96zM463.1 416c0 8.824-7.178 16-16 16h-384c-8.822 0-16-7.176-16-16V96c0-8.824 7.178-16 16-16h117.5c4.273 0 8.293 1.664 11.31 4.688L255.1 144h192c8.822 0 16 7.176 16 16V416z"></path></svg><code>data</code>: en esta carpeta se tienen los archivos de
datos, tanto aquellos orígenes de datos que se quieran importar, como los
que se puedan guardar desde un <em>script</em>.</li>
<li>
<svg aria-hidden="true" role="img" viewbox="0 0 512 512" style="height:1em;width:1em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;"><path d="M447.1 96h-172.1L226.7 50.75C214.7 38.74 198.5 32 181.5 32H63.1c-35.35 0-64 28.66-64 64v320c0 35.34 28.65 64 64 64h384c35.35 0 64-28.66 64-64V160C511.1 124.7 483.3 96 447.1 96zM463.1 416c0 8.824-7.178 16-16 16h-384c-8.822 0-16-7.176-16-16V96c0-8.824 7.178-16 16-16h117.5c4.273 0 8.293 1.664 11.31 4.688L255.1 144h192c8.822 0 16 7.176 16 16V416z"></path></svg><code>R</code>: para los <em>scripts</em>. Es posible que solamente haya un <em>script</em>
en nuestro proyecto, pero si hubiera más se pueden guardar en esta carpeta.</li>
<li>
<svg aria-hidden="true" role="img" viewbox="0 0 512 512" style="height:1em;width:1em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;"><path d="M447.1 96h-172.1L226.7 50.75C214.7 38.74 198.5 32 181.5 32H63.1c-35.35 0-64 28.66-64 64v320c0 35.34 28.65 64 64 64h384c35.35 0 64-28.66 64-64V160C511.1 124.7 483.3 96 447.1 96zM463.1 416c0 8.824-7.178 16-16 16h-384c-8.822 0-16-7.176-16-16V96c0-8.824 7.178-16 16-16h117.5c4.273 0 8.293 1.664 11.31 4.688L255.1 144h192c8.822 0 16 7.176 16 16V416z"></path></svg><code>inform</code>: aquí se pueden guardar los archivos Quarto o R Markdown
que se utilicen para generar informes o presentaciones.</li>
<li>
<svg aria-hidden="true" role="img" viewbox="0 0 512 512" style="height:1em;width:1em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;"><path d="M447.1 96h-172.1L226.7 50.75C214.7 38.74 198.5 32 181.5 32H63.1c-35.35 0-64 28.66-64 64v320c0 35.34 28.65 64 64 64h384c35.35 0 64-28.66 64-64V160C511.1 124.7 483.3 96 447.1 96zM463.1 416c0 8.824-7.178 16-16 16h-384c-8.822 0-16-7.176-16-16V96c0-8.824 7.178-16 16-16h117.5c4.273 0 8.293 1.664 11.31 4.688L255.1 144h192c8.822 0 16 7.176 16 16V416z"></path></svg><code>img</code>: si en nuestro proyecto se utilizan imágenes
de cualquier tipo, es una buena idea tenerlas en una carpeta aparte.</li>
<li>
<svg aria-hidden="true" role="img" viewbox="0 0 512 512" style="height:1em;width:1em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;"><path d="M447.1 96h-172.1L226.7 50.75C214.7 38.74 198.5 32 181.5 32H63.1c-35.35 0-64 28.66-64 64v320c0 35.34 28.65 64 64 64h384c35.35 0 64-28.66 64-64V160C511.1 124.7 483.3 96 447.1 96zM463.1 416c0 8.824-7.178 16-16 16h-384c-8.822 0-16-7.176-16-16V96c0-8.824 7.178-16 16-16h117.5c4.273 0 8.293 1.664 11.31 4.688L255.1 144h192c8.822 0 16 7.176 16 16V416z"></path></svg><code>test</code>: si se quieren separar los <em>scripts</em> que se utilicen para
pruebas y no se quieren mezclar con los “buenos” en la carpeta <code>R</code>.</li>
<li>
<svg aria-hidden="true" role="img" viewbox="0 0 512 512" style="height:1em;width:1em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;"><path d="M512 416c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64V96C0 60.7 28.7 32 64 32H181.5c17 0 33.3 6.7 45.3 18.7l26.5 26.5c12 12 28.3 18.7 45.3 18.7H448c35.3 0 64 28.7 64 64V416zM232 376c0 13.3 10.7 24 24 24s24-10.7 24-24V312h64c13.3 0 24-10.7 24-24s-10.7-24-24-24H280V200c0-13.3-10.7-24-24-24s-24 10.7-24 24v64H168c-13.3 0-24 10.7-24 24s10.7 24 24 24h64v64z"></path></svg><code>aux</code>, <code>tmp</code>, <code>util</code>, <code>notas</code>, <code>doc</code>, …:
este tipo de carpetas vienen bien cuando
hay información que está relacionada o es útil para un proyecto, pero el archivo no es
del proyecto de análisis de datos en sí. Por ejemplo, unas especificaciones de
un producto o servicio, un artículo científico, fotografías de una fábrica,
comunicaciones con clientes, etc.</li>
<li>
<svg aria-hidden="true" role="img" viewbox="0 0 512 512" style="height:1em;width:1em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;"><path d="M512 416c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64V96C0 60.7 28.7 32 64 32H181.5c17 0 33.3 6.7 45.3 18.7l26.5 26.5c12 12 28.3 18.7 45.3 18.7H448c35.3 0 64 28.7 64 64V416zM232 376c0 13.3 10.7 24 24 24s24-10.7 24-24V312h64c13.3 0 24-10.7 24-24s-10.7-24-24-24H280V200c0-13.3-10.7-24-24-24s-24 10.7-24 24v64H168c-13.3 0-24 10.7-24 24s10.7 24 24 24h64v64z"></path></svg><code>ejercicios</code>, <code>practicas</code>, …: si nuestro proyecto
forma parte de una asignatura, curso, o similar.</li>
</ul>
<div class="infobox">
<p>Un aspecto importante cuando se trabaja en proyectos colaborativos es el control de versiones. Este tema se aborda en el Cap. <a href="github.html#github">46</a>.</p>
</div>
</div>
<div id="tratamiento-de-datos-con-r" class="section level2" number="3.5">
<h2>
<span class="header-section-number">3.5</span> Tratamiento de datos con <strong>R</strong><a class="anchor" aria-label="anchor" href="#tratamiento-de-datos-con-r"><i class="fas fa-link"></i></a>
</h2>
<p>En este apartado se van a empezar a utilizar expresiones de <strong>R</strong>. Las expresionesse escribirn en <em>scripts</em>, que pueden contener “comentarios” (texto que no se ejecutará) utilizando el símbolo “almohadilla” (<code>#</code>). Muchas de las expresiones que se usan son llamadas a funciones<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Por motivos de espacio´, no se incluyen mayores explicaciones de las mismas, pero se anima al lector a explorar la ayuda de cada una de ellas para comprender mejor su funcionamiento.&lt;/p&gt;"><sup>7</sup></a>. La ayuda de cualquier función se puede obtener en la consola usando la expresión <code>?function</code>, donde <code>function</code> es el nombre de la función u objeto del que se quiere obtener ayuda.</p>
<div id="id_110003-estructuras" class="section level3" number="3.5.1">
<h3>
<span class="header-section-number">3.5.1</span> Estructuras y tipos de datos<a class="anchor" aria-label="anchor" href="#id_110003-estructuras"><i class="fas fa-link"></i></a>
</h3>
<p>Las estructuras y tipos de datos más frecuentes con las que se trabaja en <strong>R</strong> son las que se detallan a continuación.</p>
<p><strong>Tablas de datos</strong>. Son colecciones de variables numéricas y/o atributos
organizadas en columnas,
en las que cada fila se corresponde con algún elemento en el que se han
observado las características que representan las variables. La forma más común
es el <code>data.frame</code>. Cada columna del <code>data.frame</code> es, en realidad, otra estructura de datos, en concreto, un <code>vector</code>. Un ejemplo de <code>data.frame</code> es el conjunto de datos <code>tempmin_data</code> del paquete <code>CDR</code> que se analiza en el Cap. <a href="datos-espaciales.html#datos-espaciales">40</a> y del que se muestran a continuación las primeras tres filas con la función <code><a href="https://rdrr.io/r/utils/head.html">head()</a></code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st">"CDR"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">tempmin_data</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt;        fecha indicativo tmin  longitud  latitud</span></span>
<span><span class="co">#&gt; 1 2021-01-06      4358X -4.7 -5.880556 38.95556</span></span>
<span><span class="co">#&gt; 2 2021-01-06      4220X -7.0 -4.616389 39.08861</span></span>
<span><span class="co">#&gt; 3 2021-01-06      6106X  4.7 -4.748333 37.02944</span></span></code></pre></div>
<p>Un <code>data.frame</code> es un objeto de datos en dos dimensiones, en el que las filas
son la dimensión 1 y las columnas la dimensión 2. Los datos se pueden “extraer”
de un <code>data.frame</code> por filas, por columnas o por celdas. Para extraer una
de las variables del <code>data.frame</code> se suele utilizar el operador <code>$</code> después del
nombre del <code>data.frame</code>, y a continuación el nombre de la variable.</p>
<p>El operador <code>&lt;-</code> asigna al “símbolo” que hay a su izquierda el resultado
de la expresión que hay a su derecha, y lo guarda con ese nombre
en el espacio de trabajo<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;También se puede utilizar el símbolo igual (&lt;code&gt;=&lt;/code&gt;) para realizar asignaciones. No obstante, en el marco de este libro se recomienda el uso del operador específico &lt;code&gt;&amp;lt;-&lt;/code&gt;.&lt;/p&gt;"><sup>8</sup></a>. Por ejemplo, la siguiente expresión extrae todas las filas de la
columna <code>tmin</code> o, dicho de otra forma, el vector con todas las temperaturas mínimas registradas y lo guarda en el objeto <code>temp_min</code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">temp_min</span> <span class="op">&lt;-</span> <span class="va">tempmin_data</span><span class="op">$</span><span class="va">tmin</span></span></code></pre></div>
<p>
<strong>Vectores y matrices</strong>. Ya se ha visto que una columna de una tabla de datos es un vector. También se pueden crear vectores con la función <code><a href="https://rdrr.io/r/base/c.html">c()</a></code> y los elementos del vector separados por comas. Una matriz es un vector organizado en filas y columnas. A modo de ejemplo, la primera de las siguientes expresiones crea un vector llamado <code>nombres</code> con dos cadenas de texto, y la segunda crea una matriz numérica llamada <code>coordenadas</code> a partir de las columnas 4 y 5 del conjunto de datos <code>tempmin_data</code>. Nótese que la extracción de valores de un conjunto de datos o de una matriz se puede realizar también por sus índices de filas y columnas entre corchetes separados por una coma. En este caso se extraen todas las filas (pues no se especifica ninguna en la dimensión 1) de las columnas 4 y 5.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nombres</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"longitud"</span>, <span class="st">"latitud"</span><span class="op">)</span></span>
<span><span class="va">coordenadas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">tempmin_data</span><span class="op">[</span>, <span class="fl">4</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p>
<strong>Factor</strong>. Es un tipo especial de vector para representar variables categóricas (también denominadas atributos o factores). En general, una variable categórica suele tomar un número reducido
de valores diferentes (categorías), identificados con etiquetas (<em>labels</em>) y que se llaman
<strong>niveles</strong> del factor (<em>levels</em>).
Un ejemplo es el dataset <code>dp_entr</code> del paquete <code>CDR</code> que se analiza en el Cap. <a href="cap-arboles.html#cap-arboles">24</a>. La columna <code>ind_pro11</code> es un indicador que toma los valores <code>S</code> y <code>N</code>, mientras que <code>des_nivel_edu</code> toma tres posibles valores.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dp_entr</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">17</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#&gt;     ind_pro11 des_nivel_edu</span></span>
<span><span class="co">#&gt; 1           S         MEDIO</span></span>
<span><span class="co">#&gt; 497         N         MEDIO</span></span>
<span><span class="co">#&gt; 265         N        BASICO</span></span>
<span><span class="co">#&gt; 534         N         MEDIO</span></span>
<span><span class="co">#&gt; 415         N        BASICO</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">dp_entr</span><span class="op">$</span><span class="va">des_nivel_edu</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "ALTO"   "BASICO" "MEDIO"</span></span></code></pre></div>
<p>
<strong>Listas</strong>. Son estructuras de datos que contienen una
colección de elementos indexados que, además, pueden tener un
nombre.
Pueden ser heterogéneas,
en el sentido de que cada elemento de la lista puede ser
de cualquier tipo.</p>
<p>A modo de ejemplo, se muestran los nombres del objeto <code>tempmax_data</code> del paquete <code>CDR</code>, que contiene 6 elementos de distintas clases.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">tempmax_data</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "ESP"             "ESP_utm"         "grd_sf"          "grd_sp"         </span></span>
<span><span class="co">#&gt; [5] "temp_max_utm_sf" "temp_max_utm_sp"</span></span></code></pre></div>
<p>
<strong>Fechas</strong>. Son un tipo de datos especial que algunas veces provoca problemas
al compartir datos entre programas. El conjunto de datos <code>tempmin_data</code> contiene la columna <code>fecha</code>, que puede convertirse de manera inmediata a tipo fecha (<code>Date</code>) porque viene en un formato estándar (véase la ayuda de <code>strptime</code> para especificar otros formatos). El paquete <code>lubridate</code> del <em>tidyverse</em> contiene funciones para hacer más fácil el trabajo con fechas.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tempmin_data</span><span class="op">$</span><span class="va">fecha</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="va">tempmin_data</span><span class="op">$</span><span class="va">fecha</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">tempmin_data</span><span class="op">$</span><span class="va">fecha</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Date"</span></span></code></pre></div>
<p>
<strong>Cadenas de texto</strong>. Son estructuras de datos que aparecen en forma de vector de caracteres. La columna <code>indicativo</code> del conjunto de datos <code>tempmin_data</code> es un ejemplo de este tipo de datos. La ayuda de <code><a href="https://rdrr.io/r/base/grep.html">?regexpr</a></code> proporciona la información necesaria sobre cómo extraer texto con expresiones regulares, y la de <code><a href="https://rdrr.io/r/base/paste.html">?paste</a></code> para aprender a unir cadenas de texto. El paquete <code>stringr</code> del <em>tidyverse</em> contiene funciones para facilitar el trabajo con cadenas de texto.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">tempmin_data</span><span class="op">$</span><span class="va">indicativo</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "4358X" "4220X" "6106X" "9698U" "4410X" "1331A"</span></span></code></pre></div>
</div>
<div id="id_110003-importacion" class="section level3" number="3.5.2">
<h3>
<span class="header-section-number">3.5.2</span> Importación de datos<a class="anchor" aria-label="anchor" href="#id_110003-importacion"><i class="fas fa-link"></i></a>
</h3>
<p>
En el apartado anterior se han utilizado tablas de datos que están incluidas en un paquete de <strong>R</strong>. Pero lo habitual es que los datos se tengan que importar de fuentes externas, como ficheros. A continuación, se describen algunas de las formas de importar los tipos de ficheros más habituales<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Para poder reproducir los ejemplos, se debe tener una carpeta &lt;code&gt;data&lt;/code&gt; en el directorio de trabajo.&lt;/p&gt;"><sup>9</sup></a>.</p>
<p><strong>Excel</strong>. Sin duda una forma muy popular de organizar los datos en ficheros es
mediante <strong>hojas de cálculo como Microsoft Excel</strong>.
Hay varios paquetes con los que se puede trabajar con archivos de Excel. En este libro se utiliza
el paquete <code>readxl</code> del <em>tidyverse</em>. Con la siguiente expresión se puede descargar un archivo Excel de ejemplo<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;La función &lt;code&gt;download.file()&lt;/code&gt; permite descargar cualquier archivo disponible en la &lt;code&gt;url&lt;/code&gt; que se indique. Es obligatorio indicar el archivo de destino con el argumento &lt;code&gt;destfile&lt;/code&gt;. Si el archivo no es de texto plano, se debe indicar &lt;code&gt;mode = "wb"&lt;/code&gt;.&lt;/p&gt;'><sup>10</sup></a>.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/download.file.html">download.file</a></span><span class="op">(</span>url <span class="op">=</span> <span class="st">"http://emilio.lcano.com/b/adr/p/datos/RRHH.xlsx"</span>,</span>
<span>              destfile <span class="op">=</span> <span class="st">"data/RRHH.xlsx"</span>,</span>
<span>              mode <span class="op">=</span> <span class="st">"wb"</span><span class="op">)</span></span></code></pre></div>
<p>Una vez el archivo está en el directorio de trabajo de la sesión de <strong>R</strong>, se puede importar su contenido al espacio de trabajo con la siguiente expresión:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rrhh</span> <span class="op">&lt;-</span> <span class="fu">readxl</span><span class="fu">::</span><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="st">"data/RRHH.xlsx"</span><span class="op">)</span></span></code></pre></div>
<p><strong>Texto</strong>. Los <strong>archivos de texto</strong> son el formato más utilizado y conveniente para compartir datos. Es también
muy común que el equipamiento o el software genere datos en formato de texto. Estos
archivos suelen tener extensión <code>.csv</code> (<em>comma separated values</em>) o <code>.txt</code>, aunque
pueden tener cualquier otra, o incluso no tener extensión. A modo de ejemplo, con la siguiente expresión se puede descargar un archivo csv.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/download.file.html">download.file</a></span><span class="op">(</span>url <span class="op">=</span> <span class="st">"http://emilio.lcano.com/b/adr/p/datos/ejDatos.csv"</span>,</span>
<span>              destfile <span class="op">=</span> <span class="st">"data/ejDatos.csv"</span><span class="op">)</span></span></code></pre></div>
<p>Si el archivo tiene extensión <code>.csv</code>, como el anterior, vendrá
ya con una especificación muy concreta, pudiéndose usar directamente las funciones
<code><a href="https://rdrr.io/r/utils/read.table.html">read.csv()</a></code> o <code><a href="https://rdrr.io/r/utils/read.table.html">read.csv2()</a></code> para tener la tabla de datos en el espacio de trabajo.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">merma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv2</a></span><span class="op">(</span><span class="st">"data/ejDatos.csv"</span><span class="op">)</span></span></code></pre></div>
<p>La función genérica de <strong>R</strong> para importar datos de texto es <code><a href="https://rdrr.io/r/utils/read.table.html">read.table()</a></code>, que puede importar cualquier especificación cambiando los argumentos adecuados.
Por ejemplo, la siguiente expresión tendría el mismo resultado que se ha
obtenido con la función <code>read.csv2</code><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Con el argumento &lt;code&gt;header&lt;/code&gt; se indica si la primera fila tiene encabezados (&lt;code&gt;TRUE&lt;/code&gt;) o no (&lt;code&gt;FALSE&lt;/code&gt;, opción por defecto). También hay que especificar el separador de columnas &lt;code&gt;sep&lt;/code&gt; y el símbolo decimal &lt;code&gt;dec&lt;/code&gt;. &lt;code&gt;fileEncoding&lt;/code&gt; es la especificación de la codificación de texto; las más habituales son &lt;code&gt;utf-8&lt;/code&gt; y ’&lt;code&gt;latin1&lt;/code&gt;.&lt;/p&gt;"><sup>11</sup></a>:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">merma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"data/ejDatos.csv"</span>,</span>
<span>                    header <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                    sep <span class="op">=</span> <span class="st">";"</span>,</span>
<span>                    dec <span class="op">=</span> <span class="st">","</span>,</span>
<span>                    fileEncoding <span class="op">=</span> <span class="st">"utf-8"</span><span class="op">)</span></span></code></pre></div>
<div class="infobox">
<p>Para saber cómo importar datos desde sistemas gestores de bases de datos véase el
Cap. <a href="datos-sql.html#datos-sql">5</a>.</p>
</div>
<p>Hay infinidad de otras fuentes de las que se pueden importar datos a <strong>R</strong>. Por ejemplo, el paquete <code>rvest</code>, que forma parte
del <em>tidyverse</em>, se puede utilizar para obtener datos de páginas web y otras fuentes de Internet, lo que se suele llamar <em>web scraping</em>. Por ejemplo, supóngase que se quiere importar la tabla con los datos de comunidades y ciudades autónomas españolas del enlace <a href="https://www.ine.es/daco/daco42/codmun/cod_ccaa_provincia.htm" class="uri">https://www.ine.es/daco/daco42/codmun/cod_ccaa_provincia.htm</a>.
Las siguientes expresiones importan esta tabla al conjunto de datos <code>ccaa_ine</code>.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://rvest.tidyverse.org/">"rvest"</a></span><span class="op">)</span></span>
<span><span class="va">url</span> <span class="op">&lt;-</span> <span class="st">"https://www.ine.es/daco/daco42/codmun/cod_ccaa_provincia.htm"</span></span>
<span><span class="va">ccaa_ine</span> <span class="op">&lt;-</span> <span class="va">url</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="http://xml2.r-lib.org/reference/read_xml.html">read_html</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rvest.tidyverse.org/reference/rename.html">html_node</a></span><span class="op">(</span>xpath <span class="op">=</span> <span class="st">'//*[@id="contieneHtml"]/table'</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rvest.tidyverse.org/reference/html_table.html">html_table</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>La ruta o “xpath” se puede obtener usando las herramientas de desarrollo del navegador, y puede que una vez importada la tabla se requiera algún post-procesamiento antes de poder analizar los datos.</p>
</div>
<div id="exportación-de-datos-y-archivos-de-datos-específicos-de-r" class="section level3" number="3.5.3">
<h3>
<span class="header-section-number">3.5.3</span> Exportación de datos y archivos de datos específicos de R<a class="anchor" aria-label="anchor" href="#exportaci%C3%B3n-de-datos-y-archivos-de-datos-espec%C3%ADficos-de-r"><i class="fas fa-link"></i></a>
</h3>
<p>En algunos proyectos es necesario guardar algunos datos que se han ido creando o
transformando, bien para compartir con otras partes interesadas, bien para
ser utilizados en el mismo u otros proyectos.
Para exportar los datos a Excel, se utiliza la función <code>write.xlsx()</code> del paquete <code>openxlsx</code> (si no está instalado, se instala de la forma habitual).
Si lo que se quiere es exportarlo a texto, se pueden utilizar los equivalentes
a las funciones de importación <code><a href="https://rdrr.io/r/utils/write.table.html">write.csv()</a></code>, <code><a href="https://rdrr.io/r/utils/write.table.html">write.csv2()</a></code> o <code><a href="https://rdrr.io/r/utils/write.table.html">write.table()</a></code>.</p>
<p>La siguiente expresión exporta la tabla de datos <code>tempmin_data</code> a ficheros Excel y csv (formato en inglés).</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">openxlsx</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/write.xlsx.html">write.xlsx</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">tempmin_data</span>, </span>
<span>                     file <span class="op">=</span> <span class="st">"data/temp_min_Filomena.csv"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html">write.csv</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">tempmin_data</span>, file <span class="op">=</span> <span class="st">"data/temp_min_Filomena.csv"</span><span class="op">)</span></span></code></pre></div>
<p>También se pueden guardar los datos en formato “nativo” de <strong>R</strong>. Los archivos <code>.RData</code> almacenan un espacio de trabajo entero, y por tanto
pueden guardar varios objetos en el mismo archivo. Cuando posteriormente se importe,
los objetos estarán en el espacio de trabajo con su nombre original.
Se guardan con la función <code><a href="https://rdrr.io/r/base/save.html">save()</a></code> y se restauran con la función <code><a href="https://rdrr.io/r/base/load.html">load()</a></code>, como en el siguiente ejemplo.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/save.html">save</a></span><span class="op">(</span><span class="va">tempmin_data</span>, <span class="va">tempmax_data</span>, </span>
<span>     file <span class="op">=</span> <span class="st">"data/datos_temperaturas.RData"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/load.html">load</a></span><span class="op">(</span><span class="st">"data/datos_temperaturas.RData"</span><span class="op">)</span> <span class="co">#carga de nuevo el objeto</span></span></code></pre></div>
<p>Los archivos <code>.rds</code> almacenan un único objeto en un archivo. Cuando posteriormente se quieran importar,
hay que asignar el resultado al nombre que se quiera. Se guardan con la
función <code>writeRDS()</code> y se restauran con la función <code><a href="https://rdrr.io/r/base/readRDS.html">readRDS()</a></code>, como en el siguiente ejemplo.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">saveRDS</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">tempmin_data</span>, </span>
<span>        file <span class="op">=</span> <span class="st">"data/datos_temperaturas.rds"</span><span class="op">)</span></span>
<span><span class="va">nuevo_objeto</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"data/datos_temperaturas.rds"</span><span class="op">)</span></span></code></pre></div>
<p>El paquete <code>foreign</code> de <strong>R</strong> base y otros paquetes especializados pueden
exportar datos a otros formatos de archivo, que no se tratan
en detalle en este capítulo.</p>
</div>
</div>
<div id="id_110003-tidyverse" class="section level2" number="3.6">
<h2>
<span class="header-section-number">3.6</span> Organización de datos con el <em>tidyverse</em><a class="anchor" aria-label="anchor" href="#id_110003-tidyverse"><i class="fas fa-link"></i></a>
</h2>
<div id="el-tidyverse-y-su-flujo-de-trabajo" class="section level3" number="3.6.1">
<h3>
<span class="header-section-number">3.6.1</span> El <em>tidyverse</em> y su flujo de trabajo<a class="anchor" aria-label="anchor" href="#el-tidyverse-y-su-flujo-de-trabajo"><i class="fas fa-link"></i></a>
</h3>
<p>
El <em>tidyverse</em> es, según se define en su propia <a href="http://tidyverse.org">página web</a><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;“&lt;em&gt;… an opinionated collection of R packages designed for data science&lt;/em&gt;”. Incluye actualmente 30 paquetes, véase la lista con &lt;code&gt;tidyverse::tidyverse_packages(include_self = TRUE)&lt;/code&gt; y la ayuda de cada paquete para saber más. Los que se vayan usando en el libro se irán explicando oportunamente.&lt;/p&gt;"><sup>12</sup></a>,
un conjunto de paquetes de <strong>R</strong> “opinables” diseñados para ciencia de datos.
Las principales ventajas (opinables) de utilizar el <em>tidyverse</em> son tres:</p>
<ol style="list-style-type: decimal">
<li>Utiliza una gramática, estructuras de datos y filosofía de diseño común.</li>
<li>El flujo de trabajo es más fluido y, una vez se comprenden las ideas principales, más intuitivo.</li>
<li>Para la mayoría de las operaciones, es computacionalmente más eficiente.</li>
</ol>
<p>Uno de los paquetes más populares del <em>tidyverse</em> es <code>ggplot2</code>, que proporciona una “gramática de gráficos”
<span class="citation">(<a href="referncias.html#ref-Wickham2016">Hadley Wickham 2016a</a>)</span> y es una pieza clave del <em>tidyverse</em> actual, junto con los paquetes <code>dplyr</code> (gramática para la manipulación de datos) y <code>tidyr</code> (herramienta para crear datos <em>tidy</em>).
El flujo de trabajo propuesto por el <em>tidyverse</em> se describe en el libro
“R for Data Science” <span class="citation">(<a href="referncias.html#ref-wickham2016r">H. Wickham and Grolemund 2016</a>)</span> y se sintetiza en la Fig. <a href="ch-110003.html#fig:ch-110003-flujods">3.1</a>.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:ch-110003-flujods"></span>
<img src="img/data-science.png" alt="Flujo de trabajo en Ciencia de Datos propuesto por el tidyverse (fuente: Wickham, H. and Grolemund, G. (2016))" width="80%"><p class="caption">
Figura 3.1: Flujo de trabajo en Ciencia de Datos propuesto por el tidyverse (fuente: Wickham, H. and Grolemund, G. (2016))
</p>
</div>
<p>Además del mencionado libro, la web del <em>tidyverse</em> (<a href="http://tidyverse.org" class="uri">http://tidyverse.org</a>) contiene
toda la documentación de los paquetes, incluidos artículos para tareas concretas,
que merece la pena leer alguna vez. En la web están también las conocidas como <em>cheatsheets</em>,
algunas de ellas disponibles también
en la ayuda de RStudio (menú
<em>Help/Cheatsheets</em>).</p>
<p>Dentro del flujo de trabajo de la Fig. <a href="ch-110003.html#fig:ch-110003-flujods">3.1</a>, ya se ha tratado
la primera etapa (<em>Import</em>) en la Sec. <a href="#110003-importacion"><strong>??</strong></a>. Es importante
señalar que, al utilizar las funciones del <em>tidyverse</em>, los datos se organizan
en objetos de clase <code>tibble</code>, que es una extensión del <code>data.frame</code> de <strong>R</strong> base.
Las principales diferencias son:</p>
<ul>
<li>Permite una representación compacta en la consola al mostrar la tabla de datos.</li>
<li>La selección con corchetes simples de una única variable siempre devuelve
otro <code>tibble</code> (a diferencia de un <code>data.frame</code>, que devuelve un vector).</li>
</ul>
<p>Se puede forzar a que una tabla de datos sea de un tipo u otro con las funciones <code>as.data.frame</code> (de tibble a data.frame) y <code>as_tibble</code> (de data.frame a tibble).</p>
<p>Siguiendo con el esquema de la Fig. <a href="ch-110003.html#fig:ch-110003-flujods">3.1</a>, en este apartado se verán
algunas tareas de las etapas <em>Tidy</em> (organizar) y <em>Transform</em> (transformar), que
serán ampliadas en los Cap. <a href="#130009"><strong>??</strong></a> y <a href="chap-feature.html#chap-feature">9</a>. La visualización
(<em>Visualise</em>) se tratará específicamente en el Cap. <a href="#120006-aed"><strong>??</strong></a> y transversalmente en muchos otros. La modelización (<em>Model</em>) se trata extensamente en los capítulos de las partes IV a IX, y la comunicación (<em>Communicate</em>) se verá
en los capítulos de la Parte X.
Una de las características de la forma en que están programados los paquetes del
<em>tidyverse</em> es que se puede trabajar<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;Existe una guía de estilo del &lt;em&gt;tidyverse&lt;/em&gt;, que se puede consultar en &lt;a href="https://style.tidyverse.org" class="uri"&gt;https://style.tidyverse.org&lt;/a&gt;. Hay incluso una serie de &lt;em&gt;Addins&lt;/em&gt; en RStudio para
comprobar y aplicar esta guía de estilo a través del paquete &lt;code&gt;styler&lt;/code&gt;. Los &lt;em&gt;Addins&lt;/em&gt; son menús adicionales en RStudio para usar la funcionalidad de algunos paquetes de forma interactiva.&lt;/p&gt;'><sup>13</sup></a> con <em>pipes</em>.</p>
<p>El <em>pipe</em> es, básicamente, un operador compuesto de dos caracteres, <code>|&gt;</code>,
que se puede obtener con el atajo de teclado <code>CTRL+MAYUS+M</code>. El operador
se pone en medio de dos expresiones de <strong>R</strong>. Sean <code>lado_izquierdo</code>
y <code>lado_derecho</code> las expresiones que se ponen a izquierda y derecha
del <em>pipe</em>. Entonces se utiliza de la siguiente manera:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="ch-110003.html#cb22-1" tabindex="-1"></a>lado_izquierdo <span class="sc">|&gt;</span> lado_derecho</span></code></pre></div>
<div class="infobox">
<p>El operador <em>nativo</em> de <strong>R</strong>, <code>|&gt;</code>, apareció en la versión R-4.1.0. Hay un operador alternativo que proviene del paquete <code>magrittr</code>, <code>%&gt;%</code>, que había que usar antes de esta versión, y mucha literatura y documentación está escrita usándolo. Hay diferencias, pero a los efectos de este capítulo ambos operadores se pueden utilizar indistintamente.</p>
</div>
<p>La expresión <code>lado_izquierdo</code> debe producir un valor, que puede
ser cualquier objeto de <strong>R</strong>.
La expresión <code>lado_derecho</code> debe ser una función, que tomará como primer
argumento el valor producido en la parte izquierda.
Si se desea guardar el resultado final, se debe asignar el resultado
a algún nombre de objeto para que se almacene en el espacio de trabajo.
La siguiente expresión sería un ejemplo de uso.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="ch-110003.html#cb23-1" tabindex="-1"></a>nombre_objeto <span class="ot">&lt;-</span> lado_izquierdo <span class="sc">|&gt;</span></span>
<span id="cb23-2"><a href="ch-110003.html#cb23-2" tabindex="-1"></a>  lado_derecho</span></code></pre></div>
<p>La ventaja de usar los <em>pipes</em> es que se pueden encadenar, de forma que el resultado de cada operación pasa a la siguiente expresión del <em>pipeline</em> (secuencia de operaciones con <em>pipe</em>), como en el siguiente ejemplo:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://dplyr.tidyverse.org">"dplyr"</a></span><span class="op">)</span></span>
<span><span class="va">contam_mad</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 12</span></span></code></pre></div>
</div>
<div id="transformación-de-datos-con-dplyr" class="section level3" number="3.6.2">
<h3>
<span class="header-section-number">3.6.2</span> Transformación de datos con <code>dplyr</code><a class="anchor" aria-label="anchor" href="#transformaci%C3%B3n-de-datos-con-dplyr"><i class="fas fa-link"></i></a>
</h3>
<p>En la gramática del <em>tidyverse</em>, dentro del paquete <code>dplyr</code> se dispone de una
serie de “verbos” (funciones) para una sola tabla, que se pueden
agrupar en tres categorías: para trabajar con filas, para trabajar con
columnas y para resumir datos.</p>
<div id="operaciones-con-filas" class="section level4" number="3.6.2.1">
<h4>
<span class="header-section-number">3.6.2.1</span> Operaciones con filas<a class="anchor" aria-label="anchor" href="#operaciones-con-filas"><i class="fas fa-link"></i></a>
</h4>
<p>
Los verbos definidos para estas operaciones son:</p>
<ul>
<li>
<strong><code><a href="https://dplyr.tidyverse.org/reference/filter.html">filter()</a></code></strong>: elige filas en función de los valores de la columna.</li>
</ul>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pm10</span> <span class="op">&lt;-</span> <span class="va">contam_mad</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">nom_abv</span> <span class="op">==</span> <span class="st">"PM10"</span><span class="op">)</span>   <span class="co"># se filtra por PM10</span></span></code></pre></div>
<p>
- <strong><code><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange()</a></code></strong>: cambia el orden de las filas con algún criterio.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">zonas</span><span class="op">&lt;-</span> <span class="va">contam_mad</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span><span class="op">(</span><span class="va">zona</span><span class="op">)</span>, <span class="va">daily_mean</span><span class="op">)</span></span></code></pre></div>
<p>
- <strong><code><a href="https://dplyr.tidyverse.org/reference/slice.html">slice()</a></code></strong>: extrae filas por su índice. También hay una serie de funciones
“asistentes” (<em>helpers</em>) para obtener los índices que se utilizan con
frecuencia. Por ejemplo:</p>
<ul>
<li>
<code><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_head()</a></code> y <code><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_tail()</a></code> obtienen las primeras y últimas filas
respectivamente (por defecto, una). Se puede especificar <code>n</code> (número) o <code>prop</code>
(proporción) de filas.</li>
<li>
<code><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_sample()</a></code> obtiene una muestra aleatoria de <code>n</code> filas (o proporción <code>prop</code>).</li>
<li>
<code><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_min()</a></code>, <code><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_max()</a></code> obtienen las filas que contienen los menores o mayores
valores respectivamente de la variable indicada en el argumento <code>order_by</code>. Si no
se especifica <code>n</code> o <code>prop</code>, se obtienen sólo las filas que contienen el mínimo o el máximo. Nótese
que puede haber más de una fila que cumpla la condición.</li>
</ul>
<p>Véase el resultado de los siguientes ejemplos:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pm10</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice</a></span><span class="op">(</span><span class="fl">10</span><span class="op">:</span><span class="fl">15</span><span class="op">)</span> <span class="co"># extrae filas desde la 10 a la 15</span></span>
<span><span class="va">pm10</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_tail</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="co"># extrae las tres últimas filas</span></span>
<span><span class="va">pm10</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_max</a></span><span class="op">(</span>order_by <span class="op">=</span> <span class="va">daily_mean</span><span class="op">)</span> <span class="co"># día con mayor valor medio de PM10</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="co"># Para que la muestra aleatoria sea reproducible</span></span>
<span><span class="va">pm10</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_sample</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="co"># muestra 4 registros</span></span></code></pre></div>
</div>
<div id="operaciones-con-columnas" class="section level4" number="3.6.2.2">
<h4>
<span class="header-section-number">3.6.2.2</span> Operaciones con columnas<a class="anchor" aria-label="anchor" href="#operaciones-con-columnas"><i class="fas fa-link"></i></a>
</h4>
<p>Los verbos definidos para estas operaciones son:</p>
<p>
- <strong><code><a href="https://dplyr.tidyverse.org/reference/select.html">select()</a></code></strong>: indica cuando una columna se incluye o no. Se pueden utilizar <em>helpers</em> para seleccionar columnas que cumplan cierta condición (por ejemplo, ser numéricas) y también para “quitar” columnas de la selección (con el signo menos (<code>-</code>)).</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pm10</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">longitud</span>, <span class="va">latitud</span>, <span class="va">daily_mean</span>, <span class="va">tipo</span><span class="op">)</span></span>
<span><span class="va">pm10</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fu">where</span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">pm10</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">id</span><span class="op">:</span><span class="va">latitud</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>En cuanto a la <strong>modificación</strong> de datos, existen múltiples posibilidades. Algunas de ellas son:</p>
<ul>
<li><p><strong><code><a href="https://dplyr.tidyverse.org/reference/rename.html">rename()</a></code></strong>: cambia el nombre de la columna.</p></li>
<li><p><strong><code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code></strong>: cambia los valores de las columnas y crea nuevas columnas. La función <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">transmute()</a></code> funciona igual que <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code>, pero la tabla de datos
resultante sólo contiene las nuevas columnas creadas.</p></li>
<li><p><strong><code><a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate()</a></code></strong>: cambia el orden de las columnas.</p></li>
</ul>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pm10</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>zona_calidad_aire <span class="op">=</span> <span class="va">zona</span><span class="op">)</span></span>
<span><span class="va">pm10</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate</a></span><span class="op">(</span><span class="va">fecha</span>, .before <span class="op">=</span> <span class="va">estaciones</span><span class="op">)</span></span>
<span><span class="va">pm10_na</span> <span class="op">&lt;-</span> <span class="va">pm10</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>isna <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">daily_mean</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>En este punto, es importante señalar que dentro de la función <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code>
se puede usar cualquier función vectorizada para transformar las
variables. Por ejemplo, se podría transformar una columna con las funciones
<code>as.xxx</code> que se vieron en la Sec. <a href="#110003-estructuras"><strong>??</strong></a>, aplicar formatos
a fechas o usar funciones del paquete <code>lubridate</code> para trabajar con este
tipo de datos. A medida que se avance en el libro irán apareciendo aplicaciones
que ahora, quizás, no sean tan evidentes.</p>
</div>
<div id="operaciones-de-resumen-y-agrupación" class="section level4" number="3.6.2.3">
<h4>
<span class="header-section-number">3.6.2.3</span> Operaciones de resumen y agrupación<a class="anchor" aria-label="anchor" href="#operaciones-de-resumen-y-agrupaci%C3%B3n"><i class="fas fa-link"></i></a>
</h4>
<p>La primera operación de resumen que puede surgir es
“contar” filas. La función <code><a href="https://dplyr.tidyverse.org/reference/count.html">tally()</a></code> devuelve el número de filas totales
de un <code>data.frame</code>. La función <code><a href="https://dplyr.tidyverse.org/reference/count.html">count()</a></code> proporciona también este número; si, además, se pasa como argumento alguna variable, lo que devuelve es el número
de filas para cada valor diferente de dicha/s variable/s. Estos recuentos se
pueden añadir a la tabla de datos con las funciones <code><a href="https://dplyr.tidyverse.org/reference/count.html">add_count()</a></code> y <code><a href="https://dplyr.tidyverse.org/reference/count.html">add_tally()</a></code>,
lo que permite calcular frecuencias absolutas y relativas fácilmente.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pm10</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">tally</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;       n</span></span>
<span><span class="co">#&gt; 1 53794</span></span>
<span><span class="va">pm10</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op">(</span><span class="va">zona</span><span class="op">)</span></span>
<span><span class="co">#&gt;            zona     n</span></span>
<span><span class="co">#&gt; 1: Interior M30 20690</span></span>
<span><span class="co">#&gt; 2:      Noreste 12414</span></span>
<span><span class="co">#&gt; 3:     Noroeste  4138</span></span>
<span><span class="co">#&gt; 4:      Sureste  8276</span></span>
<span><span class="co">#&gt; 5:     Suroeste  8276</span></span></code></pre></div>
<p>La función <code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise()</a></code> (o, equivalentemente, <code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize()</a></code>) aplica alguna
función de resumen a la/s variable/s que se especifiquen (<code><a href="https://rdrr.io/r/base/mean.html">mean()</a></code>, <code><a href="https://rdrr.io/r/base/Extremes.html">max()</a></code>, etc.).
El paquete <code>dplyr</code> tiene algunas funciones de resumen adicionales, como
<code><a href="https://dplyr.tidyverse.org/reference/context.html">n()</a></code> (número de filas), <code><a href="https://dplyr.tidyverse.org/reference/n_distinct.html">n_distinct()</a></code> (número de filas con valores distintos) y
<code><a href="https://dplyr.tidyverse.org/reference/nth.html">first()</a></code>, <code><a href="https://dplyr.tidyverse.org/reference/nth.html">last()</a></code>, <code><a href="https://dplyr.tidyverse.org/reference/nth.html">nth()</a></code> (primero, último y <em>n</em>-ésimo valor, en el orden en el que se encuentran, respectivamente).</p>
<p>En muchas ocasiones, las operaciones de análisis se realizan en grupos
definidos por alguna variable de agrupación. La función <code><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by()</a></code>
“prepara” la tabla de datos para realizar operaciones de este tipo.
Una vez agrupados los datos, se pueden añadir operaciones de
resumen como las vistas anteriormente. A veces hay que “desagrupar” los
datos, para lo que se utiliza la función <code><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup()</a></code>.</p>
<p>A continuación, se muestra una expresión un poco más compleja que las anteriores.
En el conjunto de datos <code>contam_mad</code> del paquete <code>CDR</code>, se filtra por el
nombre de contaminante “NOx”. Después se agrupan los datos por zona y se
calculan algunos estadísticos resumen para cada zona.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="ch-110003.html#cb31-1" tabindex="-1"></a>contam_mad <span class="sc">|&gt;</span>  </span>
<span id="cb31-2"><a href="ch-110003.html#cb31-2" tabindex="-1"></a>  <span class="fu">filter</span>(nom_abv <span class="sc">==</span> <span class="st">"NOx"</span>) <span class="sc">|&gt;</span> <span class="co"># se filtra por N0x</span></span>
<span id="cb31-3"><a href="ch-110003.html#cb31-3" tabindex="-1"></a>  <span class="fu">group_by</span>(zona) <span class="sc">|&gt;</span></span>
<span id="cb31-4"><a href="ch-110003.html#cb31-4" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb31-5"><a href="ch-110003.html#cb31-5" tabindex="-1"></a>    <span class="at">min =</span> <span class="fu">min</span>(daily_mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb31-6"><a href="ch-110003.html#cb31-6" tabindex="-1"></a>    <span class="at">q1 =</span> <span class="fu">quantile</span>(daily_mean, <span class="fl">0.25</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb31-7"><a href="ch-110003.html#cb31-7" tabindex="-1"></a>    <span class="at">median =</span> <span class="fu">median</span>(daily_mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb31-8"><a href="ch-110003.html#cb31-8" tabindex="-1"></a>    <span class="at">mean =</span> <span class="fu">mean</span>(daily_mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb31-9"><a href="ch-110003.html#cb31-9" tabindex="-1"></a>    <span class="at">q3 =</span> <span class="fu">quantile</span>(daily_mean, <span class="fl">0.75</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb31-10"><a href="ch-110003.html#cb31-10" tabindex="-1"></a>    <span class="at">max =</span> <span class="fu">max</span>(daily_mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb31-11"><a href="ch-110003.html#cb31-11" tabindex="-1"></a>  )</span>
<span id="cb31-12"><a href="ch-110003.html#cb31-12" tabindex="-1"></a><span class="co">#&gt; A tibble: 5 × 7</span></span>
<span id="cb31-13"><a href="ch-110003.html#cb31-13" tabindex="-1"></a>    zona            min    q1 median  mean    q3   max</span>
<span id="cb31-14"><a href="ch-110003.html#cb31-14" tabindex="-1"></a>    <span class="sc">&lt;</span>chr<span class="sc">&gt;</span>         <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span>  <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span> <span class="er">&lt;</span>dbl<span class="sc">&gt;</span></span>
<span id="cb31-15"><a href="ch-110003.html#cb31-15" tabindex="-1"></a><span class="co">#&gt; 1 Interior M30 0.0833  32.4   54.1  72.9  90.0  759.</span></span>
<span id="cb31-16"><a href="ch-110003.html#cb31-16" tabindex="-1"></a><span class="co">#&gt; 2 Noreste      1       23.8   39.6  56.2  68.9  516.</span></span>
<span id="cb31-17"><a href="ch-110003.html#cb31-17" tabindex="-1"></a><span class="co">#&gt; 3 Noroeste     0       12.0   20.3  29.7  34.5  352.</span></span>
<span id="cb31-18"><a href="ch-110003.html#cb31-18" tabindex="-1"></a><span class="co">#&gt; 4 Sureste      0       29.1   45.4  64.6  77.2  453 </span></span>
<span id="cb31-19"><a href="ch-110003.html#cb31-19" tabindex="-1"></a><span class="co">#&gt; 5 Suroeste     0.667   33.5   59.6  90.5 114.   666.</span></span></code></pre></div>
</div>
</div>
<div id="combinación-de-datos" class="section level3" number="3.6.3">
<h3>
<span class="header-section-number">3.6.3</span> Combinación de datos<a class="anchor" aria-label="anchor" href="#combinaci%C3%B3n-de-datos"><i class="fas fa-link"></i></a>
</h3>
<p>En el apartado anterior se han tratado los “verbos” de una tabla.
Es muy común que haya que combinar datos de distintas
tablas, para lo cual se utilizan lo que el <em>tidyverse</em>
considera <em>two tables verbs</em>. En esencia, para combinar
tablas que contienen información relacionada, hay que
saber cuáles son las columnas que se refieren a lo mismo,
para hacer las uniones (<em>joins</em>) utilizando esas
columnas. Hay cuatro tipos de uniones que se pueden realizar,
usando las siguientes funciones:</p>
<ul>
<li>
<code><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">inner_join()</a></code>: se incluyen las filas de ambas tablas para las que coinciden las variables de unión.</li>
<li>
<code><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join()</a></code>: se incluyen todas las filas de la primer tabla y sólo las de la segunda donde hay coincidencias.</li>
<li>
<code><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">right_join()</a></code>: se incluyen todas las filas de la segunda tabla y sólo las de la primera donde hay coincidencias.</li>
<li>
<code><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">full_join()</a></code>: se incluyen todas las filas de las dos tablas.</li>
</ul>
<p>Las funciones requieren como argumentos dos tablas de datos y
la especificación de las columnas coincidentes. Si no se especifica,
hace las uniones por todas las columnas coincidentes en ambas tablas. Para
las filas que sólo están en una de las tablas, se añaden valores <code>NA</code>
donde no haya coincidencias.</p>
<p>A modo de ejemplo, las siguientes expresiones unen dos datasets para combinar datos de municipios con su renta. En el Cap. <a href="#130009"><strong>??</strong></a> se verán estas uniones en la práctica.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://r-spatial.github.io/sf/">"sf"</a></span><span class="op">)</span></span>
<span><span class="va">munis_renta</span> <span class="op">&lt;-</span> <span class="va">municipios</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">renta_municipio_data</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">name</span>, <span class="va">cpro</span>, <span class="va">cmun</span>, <span class="va">`2019`</span><span class="op">)</span> </span>
<span><span class="co">#&gt; Joining, by = "codigo_ine"</span></span></code></pre></div>
<p>Otra forma de unir tablas es, simplemente, añadiendo columnas (que tengan el mismo
número de filas) o filas (que tengan el mismo número de columnas). Para ello se usan
las funciones <code><a href="https://dplyr.tidyverse.org/reference/bind.html">bind_cols()</a></code> y <code><a href="https://dplyr.tidyverse.org/reference/bind.html">bind_rows()</a></code>, respectivamente.
Otra forma conveniente de añadir nuevas filas o columnas son las funciones
<code><a href="https://tibble.tidyverse.org/reference/add_row.html">add_row()</a></code> y <code><a href="https://tibble.tidyverse.org/reference/add_column.html">add_column()</a></code>. Se pueden añadir antes o después de una fila/columna
especificada con el argumento <code>.before</code>, y pasando los valores como pares “variable = valor” para cada variable en el conjunto de datos.</p>
<p>Como comentario final del paquete <code>dplyr</code>, una característica importante es que
se pueden usar las funciones vistas sobre
tablas de una base de datos, sin necesidad de utilizar sentencias SQL y con
la ventaja de que las operaciones se realizan en el motor de la base de datos.
En el Cap. <a href="datos-sql.html#datos-sql">5</a> se tratarán las cuestiones relacionadas con los gestores de bases de datos y SQL.</p>
</div>
<div id="reorganización-de-datos" class="section level3" number="3.6.4">
<h3>
<span class="header-section-number">3.6.4</span> Reorganización de datos<a class="anchor" aria-label="anchor" href="#reorganizaci%C3%B3n-de-datos"><i class="fas fa-link"></i></a>
</h3>
<p>
A lo largo del capítulo se ha visto la importancia de disponer los
datos de forma rectangular, de forma que se tenga una columna para
cada variable y una fila para cada observación. Algunas veces es
conveniente reorganizar los datos más “a lo ancho” o más
“a lo largo” de lo que se encuentran.</p>
<p>Para estas operaciones se utilizan las funciones <code><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer()</a></code> y
<code><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider()</a></code> del paquete <code>tidyr</code> del <em>tidyverse</em> de la siguiente forma:</p>
<ul>
<li><p><code><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer()</a></code>: el argumento <code>names_to</code> asigna el nombre
de la nueva variable que va a indicar de qué columna vienen los datos; y el
argumento <code>values_to</code> asigna el nombre de la nueva variable que va a contener
el valor de la tabla original.</p></li>
<li><p><code><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider()</a></code>: el argumento <code>names_from</code> indica el nombre
de la variable que contiene los nombres de las nuevas columnas a crear a lo ancho; y el argumento <code>values_from</code> indica el nombre de la variable que contiene los
valores en la tabla original. Las observaciones deben estar identificadas de forma
única por varias variables. Si no es el caso, se puede aplicar una función
al estilo de las tablas dinámicas de las hojas de cálculo con el argumento <code>values_fn</code>.</p></li>
</ul>
<div class="infobox">
<p>Las funciones <code><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer()</a></code> y <code><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider()</a></code> admiten otros argumentos
<code>names_xx</code> y <code>values_xx</code> para personalizar la forma de reestructurar los datos.
En la mayoría de las
ocasiones será suficiente con las comentadas (<code>xx_from</code> y <code>xx_to</code>). Si fuera necesario, se recomienda consultar la ayuda
de las funciones, o la lectura del <a href="https://tidyr.tidyverse.org/articles/pivot.html">artículo sobre <em>pivoting</em></a>.</p>
</div>
<p>A modo de ejemplo, el conjunto de datos <code>contam_mad</code> tiene los datos “mezclados” de varias variables medioambientales en la columna <code>daily_mean</code>. La columna <code>nom_abv</code> contiene el parámetro al que se refiere la columna de datos. Entonces, interesa “extender” la tabla para tener cada parámetro en una columna, de forma que se pueda hacer un análisis de datos adecuado, como en el siguiente código:</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://tidyr.tidyverse.org">"tidyr"</a></span><span class="op">)</span></span>
<span><span class="va">extendida</span> <span class="op">&lt;-</span> <span class="va">contam_mad</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="st">"nom_abv"</span>,</span>
<span>              values_from <span class="op">=</span> <span class="st">"daily_mean"</span>,</span>
<span>              values_fn <span class="op">=</span> <span class="va">mean</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">extendida</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "estaciones" "id"         "id_name"    "longitud"  </span></span>
<span><span class="co">#&gt;  [5] "latitud"    "nom_mag"    "ud_med"     "fecha"     </span></span>
<span><span class="co">#&gt;  [9] "zona"       "tipo"       "BEN"        "SO2"       </span></span>
<span><span class="co">#&gt; [13] "NO2"        "EBE"        "CO"         "NO"        </span></span>
<span><span class="co">#&gt; [17] "PM10"       "PM2.5"      "TOL"        "NOx"</span></span></code></pre></div>
<p>Se deja como ejercicio volver a obtener la tabla original usando la función <code><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer()</a></code> a partir del objeto <code>extendida</code>.</p>
<p>El paquete <code>tidyr</code> también contiene funciones para reorganizar las columnas
de la tabla uniendo columnas con la función <code><a href="https://tidyr.tidyverse.org/reference/unite.html">unite()</a></code>, o separando una columna
en dos o más con la función <code><a href="https://tidyr.tidyverse.org/reference/separate.html">separate()</a></code> (véanse los detalles en la ayuda de las funciones).</p>
<p>
Para terminar este apartado de reorganización de datos, se da una
primera aproximación al tratamiento de valores perdidos, que se tratará en el
Cap. <a href="#130009"><strong>??</strong></a>. En <strong>R</strong>, un valor
perdido se representa por el valor especial <code>NA</code> (<em>not available</em>). Brevemente,
las funciones más utilizadas en este campo son:</p>
<ul>
<li><p><code><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na()</a></code> del paquete <code>tidyr</code>: permite
eliminar las filas que tienen valores perdidos en ciertas variables
(o en cualquiera, si no se especifica ninguna).</p></li>
<li><p><code><a href="https://tidyr.tidyverse.org/reference/replace_na.html">replace_na()</a></code>: sustituye los valores perdidos en cada variable por el valor
especificado.</p></li>
<li><p><code><a href="https://tidyr.tidyverse.org/reference/fill.html">fill()</a></code>: permite “rellenar” valores perdidos con los últimos encontrados.</p></li>
</ul>
<p>Los datos de contaminación a menudo tienen muchos valores perdidos. La siguiente expresión elimina las filas del conjunto de datos <code>contam_mad</code> con valores perdidos y, después, cuenta las filas.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">contam_mad</span> <span class="op">|&gt;</span>  </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="co"># se omiten los NAs para el análisis</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;         n</span></span>
<span><span class="co">#&gt; 1: 505773</span></span></code></pre></div>
</div>
<div id="resumen-2" class="section level3 unnumbered infobox_resume">
<h3>Resumen<a class="anchor" aria-label="anchor" href="#resumen-2"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>
<strong>R</strong> es software libre y gratuito, mantenido por una enorme comunidad.</li>
<li>La forma de interactuar con <strong>R</strong> es mediante expresiones, que se escriben en <em>scripts</em>, y al ejecutarlas se obtienen los resultados.</li>
<li>Los objetos de datos que se vayan a usar deben estar en el espacio de trabajo.</li>
<li>RStudio es un “envoltorio” de <strong>R</strong>, y por tanto <strong>R</strong> tiene que estar instalado
en el sistema para poder usar RStudio.</li>
<li>Los paquetes se instalan una sola vez, y deben cargarse con <code><a href="https://rdrr.io/r/base/library.html">library()</a></code> para usar sus funciones.</li>
<li>La tabla de datos o <code>data.frame</code> es la estructura de datos más adecuada para análisis de datos y cada columna es un <code>vector</code>.</li>
<li>El <em>tidyverse</em> es un conjunto de paquetes que facilita las tareas de análisis de datos.</li>
<li>El operador <em>pipe</em>, <code>|&gt;</code>, permite “pasar” valores a funciones de forma encadenada.</li>
<li>Las operaciones básicas con una tabla son filtrado, selección y resumen.</li>
<li>Para crear nuevas columnas en las tablas de datos se usa la función <code>mutate</code>.</li>
<li>Para combinar tablas con columnas comunes se usan las funciones <code>xx_join</code>.</li>
</ul>
</div>

</div>
</div>

  <div class="chapter-nav">
<div class="prev"><a href="metodologia.html"><span class="header-section-number">2</span> Metodología en ciencia de datos</a></div>
<div class="next"><a href="cap-etica.html"><span class="header-section-number">4</span> Ética en la ciencia de datos</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="Índice capítulo"><h2>Índice capítulo</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#ch-110003"><span class="header-section-number">3</span> R para ciencia de datos</a></li>
<li><a class="nav-link" href="#introducci%C3%B3n"><span class="header-section-number">3.1</span> Introducción</a></li>
<li><a class="nav-link" href="#id_110003-bases"><span class="header-section-number">3.2</span> La sesión de R</a></li>
<li><a class="nav-link" href="#instalaci%C3%B3n-de-r"><span class="header-section-number">3.3</span> Instalación de R</a></li>
<li><a class="nav-link" href="#id_110003-proyectos"><span class="header-section-number">3.4</span> Trabajar con proyectos de RStudio</a></li>
<li>
<a class="nav-link" href="#tratamiento-de-datos-con-r"><span class="header-section-number">3.5</span> Tratamiento de datos con R</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#id_110003-estructuras"><span class="header-section-number">3.5.1</span> Estructuras y tipos de datos</a></li>
<li><a class="nav-link" href="#id_110003-importacion"><span class="header-section-number">3.5.2</span> Importación de datos</a></li>
<li><a class="nav-link" href="#exportaci%C3%B3n-de-datos-y-archivos-de-datos-espec%C3%ADficos-de-r"><span class="header-section-number">3.5.3</span> Exportación de datos y archivos de datos específicos de R</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#id_110003-tidyverse"><span class="header-section-number">3.6</span> Organización de datos con el tidyverse</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#el-tidyverse-y-su-flujo-de-trabajo"><span class="header-section-number">3.6.1</span> El tidyverse y su flujo de trabajo</a></li>
<li><a class="nav-link" href="#transformaci%C3%B3n-de-datos-con-dplyr"><span class="header-section-number">3.6.2</span> Transformación de datos con dplyr</a></li>
<li><a class="nav-link" href="#combinaci%C3%B3n-de-datos"><span class="header-section-number">3.6.3</span> Combinación de datos</a></li>
<li><a class="nav-link" href="#reorganizaci%C3%B3n-de-datos"><span class="header-section-number">3.6.4</span> Reorganización de datos</a></li>
<li><a class="nav-link" href="#resumen-2">Resumen</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Fundamentos de ciencia de datos con R</strong>" coordinado por <a href="https://blog.uclm.es/gemafaviles/" class="text-light">Gema Fernández-Avilés y José-María Montero</a>. Generado por última vez el día 2023-06-16.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>Este libro ha sido generado con el paquete de R <a class="text-light" href="https://bookdown.org">bookdown</a>.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
